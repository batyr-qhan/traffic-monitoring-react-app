(function(){const S=document.createElement("link").relList;if(S&&S.supports&&S.supports("modulepreload"))return;for(const F of document.querySelectorAll('link[rel="modulepreload"]'))M(F);new MutationObserver(F=>{for(const H of F)if(H.type==="childList")for(const P of H.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&M(P)}).observe(document,{childList:!0,subtree:!0});function z(F){const H={};return F.integrity&&(H.integrity=F.integrity),F.referrerPolicy&&(H.referrerPolicy=F.referrerPolicy),F.crossOrigin==="use-credentials"?H.credentials="include":F.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function M(F){if(F.ep)return;F.ep=!0;const H=z(F);fetch(F.href,H)}})();function Gv(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}var Q_={exports:{}},qm={};var ev;function cb(){if(ev)return qm;ev=1;var v=Symbol.for("react.transitional.element"),S=Symbol.for("react.fragment");function z(M,F,H){var P=null;if(H!==void 0&&(P=""+H),F.key!==void 0&&(P=""+F.key),"key"in F){H={};for(var h in F)h!=="key"&&(H[h]=F[h])}else H=F;return F=H.ref,{$$typeof:v,type:M,key:P,ref:F!==void 0?F:null,props:H}}return qm.Fragment=S,qm.jsx=z,qm.jsxs=z,qm}var tv;function hb(){return tv||(tv=1,Q_.exports=cb()),Q_.exports}var wr=hb(),K_={exports:{}},Qt={};var iv;function fb(){if(iv)return Qt;iv=1;var v=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),P=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),ge=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),Xe=Symbol.for("react.activity"),Je=Symbol.iterator;function yt(be){return be===null||typeof be!="object"?null:(be=Je&&be[Je]||be["@@iterator"],typeof be=="function"?be:null)}var Et={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},rt=Object.assign,xe={};function Jt(be,Ke,pt){this.props=be,this.context=Ke,this.refs=xe,this.updater=pt||Et}Jt.prototype.isReactComponent={},Jt.prototype.setState=function(be,Ke){if(typeof be!="object"&&typeof be!="function"&&be!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,be,Ke,"setState")},Jt.prototype.forceUpdate=function(be){this.updater.enqueueForceUpdate(this,be,"forceUpdate")};function Nt(){}Nt.prototype=Jt.prototype;function Ct(be,Ke,pt){this.props=be,this.context=Ke,this.refs=xe,this.updater=pt||Et}var Kt=Ct.prototype=new Nt;Kt.constructor=Ct,rt(Kt,Jt.prototype),Kt.isPureReactComponent=!0;var di=Array.isArray;function Si(){}var St={H:null,A:null,T:null,S:null},pi=Object.prototype.hasOwnProperty;function cn(be,Ke,pt){var bt=pt.ref;return{$$typeof:v,type:be,key:Ke,ref:bt!==void 0?bt:null,props:pt}}function Vn(be,Ke){return cn(be.type,Ke,be.props)}function Un(be){return typeof be=="object"&&be!==null&&be.$$typeof===v}function Ni(be){var Ke={"=":"=0",":":"=2"};return"$"+be.replace(/[=:]/g,function(pt){return Ke[pt]})}var Cn=/\/+/g;function $r(be,Ke){return typeof be=="object"&&be!==null&&be.key!=null?Ni(""+be.key):Ke.toString(36)}function lr(be){switch(be.status){case"fulfilled":return be.value;case"rejected":throw be.reason;default:switch(typeof be.status=="string"?be.then(Si,Si):(be.status="pending",be.then(function(Ke){be.status==="pending"&&(be.status="fulfilled",be.value=Ke)},function(Ke){be.status==="pending"&&(be.status="rejected",be.reason=Ke)})),be.status){case"fulfilled":return be.value;case"rejected":throw be.reason}}throw be}function qe(be,Ke,pt,bt,At){var Vt=typeof be;(Vt==="undefined"||Vt==="boolean")&&(be=null);var ei=!1;if(be===null)ei=!0;else switch(Vt){case"bigint":case"string":case"number":ei=!0;break;case"object":switch(be.$$typeof){case v:case S:ei=!0;break;case Le:return ei=be._init,qe(ei(be._payload),Ke,pt,bt,At)}}if(ei)return At=At(be),ei=bt===""?"."+$r(be,0):bt,di(At)?(pt="",ei!=null&&(pt=ei.replace(Cn,"$&/")+"/"),qe(At,Ke,pt,"",function(Tr){return Tr})):At!=null&&(Un(At)&&(At=Vn(At,pt+(At.key==null||be&&be.key===At.key?"":(""+At.key).replace(Cn,"$&/")+"/")+ei)),Ke.push(At)),1;ei=0;var Pi=bt===""?".":bt+":";if(di(be))for(var qi=0;qi<be.length;qi++)bt=be[qi],Vt=Pi+$r(bt,qi),ei+=qe(bt,Ke,pt,Vt,At);else if(qi=yt(be),typeof qi=="function")for(be=qi.call(be),qi=0;!(bt=be.next()).done;)bt=bt.value,Vt=Pi+$r(bt,qi++),ei+=qe(bt,Ke,pt,Vt,At);else if(Vt==="object"){if(typeof be.then=="function")return qe(lr(be),Ke,pt,bt,At);throw Ke=String(be),Error("Objects are not valid as a React child (found: "+(Ke==="[object Object]"?"object with keys {"+Object.keys(be).join(", ")+"}":Ke)+"). If you meant to render a collection of children, use an array instead.")}return ei}function ot(be,Ke,pt){if(be==null)return be;var bt=[],At=0;return qe(be,bt,"","",function(Vt){return Ke.call(pt,Vt,At++)}),bt}function Pt(be){if(be._status===-1){var Ke=be._result;Ke=Ke(),Ke.then(function(pt){(be._status===0||be._status===-1)&&(be._status=1,be._result=pt)},function(pt){(be._status===0||be._status===-1)&&(be._status=2,be._result=pt)}),be._status===-1&&(be._status=0,be._result=Ke)}if(be._status===1)return be._result.default;throw be._result}var Mt=typeof reportError=="function"?reportError:function(be){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ke=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof be=="object"&&be!==null&&typeof be.message=="string"?String(be.message):String(be),error:be});if(!window.dispatchEvent(Ke))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",be);return}console.error(be)},mi={map:ot,forEach:function(be,Ke,pt){ot(be,function(){Ke.apply(this,arguments)},pt)},count:function(be){var Ke=0;return ot(be,function(){Ke++}),Ke},toArray:function(be){return ot(be,function(Ke){return Ke})||[]},only:function(be){if(!Un(be))throw Error("React.Children.only expected to receive a single React element child.");return be}};return Qt.Activity=Xe,Qt.Children=mi,Qt.Component=Jt,Qt.Fragment=z,Qt.Profiler=F,Qt.PureComponent=Ct,Qt.StrictMode=M,Qt.Suspense=ne,Qt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=St,Qt.__COMPILER_RUNTIME={__proto__:null,c:function(be){return St.H.useMemoCache(be)}},Qt.cache=function(be){return function(){return be.apply(null,arguments)}},Qt.cacheSignal=function(){return null},Qt.cloneElement=function(be,Ke,pt){if(be==null)throw Error("The argument must be a React element, but you passed "+be+".");var bt=rt({},be.props),At=be.key;if(Ke!=null)for(Vt in Ke.key!==void 0&&(At=""+Ke.key),Ke)!pi.call(Ke,Vt)||Vt==="key"||Vt==="__self"||Vt==="__source"||Vt==="ref"&&Ke.ref===void 0||(bt[Vt]=Ke[Vt]);var Vt=arguments.length-2;if(Vt===1)bt.children=pt;else if(1<Vt){for(var ei=Array(Vt),Pi=0;Pi<Vt;Pi++)ei[Pi]=arguments[Pi+2];bt.children=ei}return cn(be.type,At,bt)},Qt.createContext=function(be){return be={$$typeof:P,_currentValue:be,_currentValue2:be,_threadCount:0,Provider:null,Consumer:null},be.Provider=be,be.Consumer={$$typeof:H,_context:be},be},Qt.createElement=function(be,Ke,pt){var bt,At={},Vt=null;if(Ke!=null)for(bt in Ke.key!==void 0&&(Vt=""+Ke.key),Ke)pi.call(Ke,bt)&&bt!=="key"&&bt!=="__self"&&bt!=="__source"&&(At[bt]=Ke[bt]);var ei=arguments.length-2;if(ei===1)At.children=pt;else if(1<ei){for(var Pi=Array(ei),qi=0;qi<ei;qi++)Pi[qi]=arguments[qi+2];At.children=Pi}if(be&&be.defaultProps)for(bt in ei=be.defaultProps,ei)At[bt]===void 0&&(At[bt]=ei[bt]);return cn(be,Vt,At)},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(be){return{$$typeof:h,render:be}},Qt.isValidElement=Un,Qt.lazy=function(be){return{$$typeof:Le,_payload:{_status:-1,_result:be},_init:Pt}},Qt.memo=function(be,Ke){return{$$typeof:ge,type:be,compare:Ke===void 0?null:Ke}},Qt.startTransition=function(be){var Ke=St.T,pt={};St.T=pt;try{var bt=be(),At=St.S;At!==null&&At(pt,bt),typeof bt=="object"&&bt!==null&&typeof bt.then=="function"&&bt.then(Si,Mt)}catch(Vt){Mt(Vt)}finally{Ke!==null&&pt.types!==null&&(Ke.types=pt.types),St.T=Ke}},Qt.unstable_useCacheRefresh=function(){return St.H.useCacheRefresh()},Qt.use=function(be){return St.H.use(be)},Qt.useActionState=function(be,Ke,pt){return St.H.useActionState(be,Ke,pt)},Qt.useCallback=function(be,Ke){return St.H.useCallback(be,Ke)},Qt.useContext=function(be){return St.H.useContext(be)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(be,Ke){return St.H.useDeferredValue(be,Ke)},Qt.useEffect=function(be,Ke){return St.H.useEffect(be,Ke)},Qt.useEffectEvent=function(be){return St.H.useEffectEvent(be)},Qt.useId=function(){return St.H.useId()},Qt.useImperativeHandle=function(be,Ke,pt){return St.H.useImperativeHandle(be,Ke,pt)},Qt.useInsertionEffect=function(be,Ke){return St.H.useInsertionEffect(be,Ke)},Qt.useLayoutEffect=function(be,Ke){return St.H.useLayoutEffect(be,Ke)},Qt.useMemo=function(be,Ke){return St.H.useMemo(be,Ke)},Qt.useOptimistic=function(be,Ke){return St.H.useOptimistic(be,Ke)},Qt.useReducer=function(be,Ke,pt){return St.H.useReducer(be,Ke,pt)},Qt.useRef=function(be){return St.H.useRef(be)},Qt.useState=function(be){return St.H.useState(be)},Qt.useSyncExternalStore=function(be,Ke,pt){return St.H.useSyncExternalStore(be,Ke,pt)},Qt.useTransition=function(){return St.H.useTransition()},Qt.version="19.2.3",Qt}var nv;function T_(){return nv||(nv=1,K_.exports=fb()),K_.exports}var un=T_();const rv=Gv(un);var W_={exports:{}},Zm={},J_={exports:{}},ey={};var av;function db(){return av||(av=1,(function(v){function S(qe,ot){var Pt=qe.length;qe.push(ot);e:for(;0<Pt;){var Mt=Pt-1>>>1,mi=qe[Mt];if(0<F(mi,ot))qe[Mt]=ot,qe[Pt]=mi,Pt=Mt;else break e}}function z(qe){return qe.length===0?null:qe[0]}function M(qe){if(qe.length===0)return null;var ot=qe[0],Pt=qe.pop();if(Pt!==ot){qe[0]=Pt;e:for(var Mt=0,mi=qe.length,be=mi>>>1;Mt<be;){var Ke=2*(Mt+1)-1,pt=qe[Ke],bt=Ke+1,At=qe[bt];if(0>F(pt,Pt))bt<mi&&0>F(At,pt)?(qe[Mt]=At,qe[bt]=Pt,Mt=bt):(qe[Mt]=pt,qe[Ke]=Pt,Mt=Ke);else if(bt<mi&&0>F(At,Pt))qe[Mt]=At,qe[bt]=Pt,Mt=bt;else break e}}return ot}function F(qe,ot){var Pt=qe.sortIndex-ot.sortIndex;return Pt!==0?Pt:qe.id-ot.id}if(v.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var H=performance;v.unstable_now=function(){return H.now()}}else{var P=Date,h=P.now();v.unstable_now=function(){return P.now()-h}}var ne=[],ge=[],Le=1,Xe=null,Je=3,yt=!1,Et=!1,rt=!1,xe=!1,Jt=typeof setTimeout=="function"?setTimeout:null,Nt=typeof clearTimeout=="function"?clearTimeout:null,Ct=typeof setImmediate<"u"?setImmediate:null;function Kt(qe){for(var ot=z(ge);ot!==null;){if(ot.callback===null)M(ge);else if(ot.startTime<=qe)M(ge),ot.sortIndex=ot.expirationTime,S(ne,ot);else break;ot=z(ge)}}function di(qe){if(rt=!1,Kt(qe),!Et)if(z(ne)!==null)Et=!0,Si||(Si=!0,Ni());else{var ot=z(ge);ot!==null&&lr(di,ot.startTime-qe)}}var Si=!1,St=-1,pi=5,cn=-1;function Vn(){return xe?!0:!(v.unstable_now()-cn<pi)}function Un(){if(xe=!1,Si){var qe=v.unstable_now();cn=qe;var ot=!0;try{e:{Et=!1,rt&&(rt=!1,Nt(St),St=-1),yt=!0;var Pt=Je;try{t:{for(Kt(qe),Xe=z(ne);Xe!==null&&!(Xe.expirationTime>qe&&Vn());){var Mt=Xe.callback;if(typeof Mt=="function"){Xe.callback=null,Je=Xe.priorityLevel;var mi=Mt(Xe.expirationTime<=qe);if(qe=v.unstable_now(),typeof mi=="function"){Xe.callback=mi,Kt(qe),ot=!0;break t}Xe===z(ne)&&M(ne),Kt(qe)}else M(ne);Xe=z(ne)}if(Xe!==null)ot=!0;else{var be=z(ge);be!==null&&lr(di,be.startTime-qe),ot=!1}}break e}finally{Xe=null,Je=Pt,yt=!1}ot=void 0}}finally{ot?Ni():Si=!1}}}var Ni;if(typeof Ct=="function")Ni=function(){Ct(Un)};else if(typeof MessageChannel<"u"){var Cn=new MessageChannel,$r=Cn.port2;Cn.port1.onmessage=Un,Ni=function(){$r.postMessage(null)}}else Ni=function(){Jt(Un,0)};function lr(qe,ot){St=Jt(function(){qe(v.unstable_now())},ot)}v.unstable_IdlePriority=5,v.unstable_ImmediatePriority=1,v.unstable_LowPriority=4,v.unstable_NormalPriority=3,v.unstable_Profiling=null,v.unstable_UserBlockingPriority=2,v.unstable_cancelCallback=function(qe){qe.callback=null},v.unstable_forceFrameRate=function(qe){0>qe||125<qe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):pi=0<qe?Math.floor(1e3/qe):5},v.unstable_getCurrentPriorityLevel=function(){return Je},v.unstable_next=function(qe){switch(Je){case 1:case 2:case 3:var ot=3;break;default:ot=Je}var Pt=Je;Je=ot;try{return qe()}finally{Je=Pt}},v.unstable_requestPaint=function(){xe=!0},v.unstable_runWithPriority=function(qe,ot){switch(qe){case 1:case 2:case 3:case 4:case 5:break;default:qe=3}var Pt=Je;Je=qe;try{return ot()}finally{Je=Pt}},v.unstable_scheduleCallback=function(qe,ot,Pt){var Mt=v.unstable_now();switch(typeof Pt=="object"&&Pt!==null?(Pt=Pt.delay,Pt=typeof Pt=="number"&&0<Pt?Mt+Pt:Mt):Pt=Mt,qe){case 1:var mi=-1;break;case 2:mi=250;break;case 5:mi=1073741823;break;case 4:mi=1e4;break;default:mi=5e3}return mi=Pt+mi,qe={id:Le++,callback:ot,priorityLevel:qe,startTime:Pt,expirationTime:mi,sortIndex:-1},Pt>Mt?(qe.sortIndex=Pt,S(ge,qe),z(ne)===null&&qe===z(ge)&&(rt?(Nt(St),St=-1):rt=!0,lr(di,Pt-Mt))):(qe.sortIndex=mi,S(ne,qe),Et||yt||(Et=!0,Si||(Si=!0,Ni()))),qe},v.unstable_shouldYield=Vn,v.unstable_wrapCallback=function(qe){var ot=Je;return function(){var Pt=Je;Je=ot;try{return qe.apply(this,arguments)}finally{Je=Pt}}}})(ey)),ey}var sv;function pb(){return sv||(sv=1,J_.exports=db()),J_.exports}var ty={exports:{}},Oa={};var ov;function mb(){if(ov)return Oa;ov=1;var v=T_();function S(ne){var ge="https://react.dev/errors/"+ne;if(1<arguments.length){ge+="?args[]="+encodeURIComponent(arguments[1]);for(var Le=2;Le<arguments.length;Le++)ge+="&args[]="+encodeURIComponent(arguments[Le])}return"Minified React error #"+ne+"; visit "+ge+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function z(){}var M={d:{f:z,r:function(){throw Error(S(522))},D:z,C:z,L:z,m:z,X:z,S:z,M:z},p:0,findDOMNode:null},F=Symbol.for("react.portal");function H(ne,ge,Le){var Xe=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:F,key:Xe==null?null:""+Xe,children:ne,containerInfo:ge,implementation:Le}}var P=v.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(ne,ge){if(ne==="font")return"";if(typeof ge=="string")return ge==="use-credentials"?ge:""}return Oa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,Oa.createPortal=function(ne,ge){var Le=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ge||ge.nodeType!==1&&ge.nodeType!==9&&ge.nodeType!==11)throw Error(S(299));return H(ne,ge,null,Le)},Oa.flushSync=function(ne){var ge=P.T,Le=M.p;try{if(P.T=null,M.p=2,ne)return ne()}finally{P.T=ge,M.p=Le,M.d.f()}},Oa.preconnect=function(ne,ge){typeof ne=="string"&&(ge?(ge=ge.crossOrigin,ge=typeof ge=="string"?ge==="use-credentials"?ge:"":void 0):ge=null,M.d.C(ne,ge))},Oa.prefetchDNS=function(ne){typeof ne=="string"&&M.d.D(ne)},Oa.preinit=function(ne,ge){if(typeof ne=="string"&&ge&&typeof ge.as=="string"){var Le=ge.as,Xe=h(Le,ge.crossOrigin),Je=typeof ge.integrity=="string"?ge.integrity:void 0,yt=typeof ge.fetchPriority=="string"?ge.fetchPriority:void 0;Le==="style"?M.d.S(ne,typeof ge.precedence=="string"?ge.precedence:void 0,{crossOrigin:Xe,integrity:Je,fetchPriority:yt}):Le==="script"&&M.d.X(ne,{crossOrigin:Xe,integrity:Je,fetchPriority:yt,nonce:typeof ge.nonce=="string"?ge.nonce:void 0})}},Oa.preinitModule=function(ne,ge){if(typeof ne=="string")if(typeof ge=="object"&&ge!==null){if(ge.as==null||ge.as==="script"){var Le=h(ge.as,ge.crossOrigin);M.d.M(ne,{crossOrigin:Le,integrity:typeof ge.integrity=="string"?ge.integrity:void 0,nonce:typeof ge.nonce=="string"?ge.nonce:void 0})}}else ge==null&&M.d.M(ne)},Oa.preload=function(ne,ge){if(typeof ne=="string"&&typeof ge=="object"&&ge!==null&&typeof ge.as=="string"){var Le=ge.as,Xe=h(Le,ge.crossOrigin);M.d.L(ne,Le,{crossOrigin:Xe,integrity:typeof ge.integrity=="string"?ge.integrity:void 0,nonce:typeof ge.nonce=="string"?ge.nonce:void 0,type:typeof ge.type=="string"?ge.type:void 0,fetchPriority:typeof ge.fetchPriority=="string"?ge.fetchPriority:void 0,referrerPolicy:typeof ge.referrerPolicy=="string"?ge.referrerPolicy:void 0,imageSrcSet:typeof ge.imageSrcSet=="string"?ge.imageSrcSet:void 0,imageSizes:typeof ge.imageSizes=="string"?ge.imageSizes:void 0,media:typeof ge.media=="string"?ge.media:void 0})}},Oa.preloadModule=function(ne,ge){if(typeof ne=="string")if(ge){var Le=h(ge.as,ge.crossOrigin);M.d.m(ne,{as:typeof ge.as=="string"&&ge.as!=="script"?ge.as:void 0,crossOrigin:Le,integrity:typeof ge.integrity=="string"?ge.integrity:void 0})}else M.d.m(ne)},Oa.requestFormReset=function(ne){M.d.r(ne)},Oa.unstable_batchedUpdates=function(ne,ge){return ne(ge)},Oa.useFormState=function(ne,ge,Le){return P.H.useFormState(ne,ge,Le)},Oa.useFormStatus=function(){return P.H.useHostTransitionStatus()},Oa.version="19.2.3",Oa}var lv;function qv(){if(lv)return ty.exports;lv=1;function v(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v)}catch(S){console.error(S)}}return v(),ty.exports=mb(),ty.exports}var uv;function gb(){if(uv)return Zm;uv=1;var v=pb(),S=T_(),z=qv();function M(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function F(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function H(r){var s=r,c=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(c=s.return),r=s.return;while(r)}return s.tag===3?c:null}function P(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function ne(r){if(H(r)!==r)throw Error(M(188))}function ge(r){var s=r.alternate;if(!s){if(s=H(r),s===null)throw Error(M(188));return s!==r?null:r}for(var c=r,g=s;;){var T=c.return;if(T===null)break;var C=T.alternate;if(C===null){if(g=T.return,g!==null){c=g;continue}break}if(T.child===C.child){for(C=T.child;C;){if(C===c)return ne(T),r;if(C===g)return ne(T),s;C=C.sibling}throw Error(M(188))}if(c.return!==g.return)c=T,g=C;else{for(var N=!1,K=T.child;K;){if(K===c){N=!0,c=T,g=C;break}if(K===g){N=!0,g=T,c=C;break}K=K.sibling}if(!N){for(K=C.child;K;){if(K===c){N=!0,c=C,g=T;break}if(K===g){N=!0,g=C,c=T;break}K=K.sibling}if(!N)throw Error(M(189))}}if(c.alternate!==g)throw Error(M(190))}if(c.tag!==3)throw Error(M(188));return c.stateNode.current===c?r:s}function Le(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=Le(r),s!==null)return s;r=r.sibling}return null}var Xe=Object.assign,Je=Symbol.for("react.element"),yt=Symbol.for("react.transitional.element"),Et=Symbol.for("react.portal"),rt=Symbol.for("react.fragment"),xe=Symbol.for("react.strict_mode"),Jt=Symbol.for("react.profiler"),Nt=Symbol.for("react.consumer"),Ct=Symbol.for("react.context"),Kt=Symbol.for("react.forward_ref"),di=Symbol.for("react.suspense"),Si=Symbol.for("react.suspense_list"),St=Symbol.for("react.memo"),pi=Symbol.for("react.lazy"),cn=Symbol.for("react.activity"),Vn=Symbol.for("react.memo_cache_sentinel"),Un=Symbol.iterator;function Ni(r){return r===null||typeof r!="object"?null:(r=Un&&r[Un]||r["@@iterator"],typeof r=="function"?r:null)}var Cn=Symbol.for("react.client.reference");function $r(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Cn?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case rt:return"Fragment";case Jt:return"Profiler";case xe:return"StrictMode";case di:return"Suspense";case Si:return"SuspenseList";case cn:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case Et:return"Portal";case Ct:return r.displayName||"Context";case Nt:return(r._context.displayName||"Context")+".Consumer";case Kt:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case St:return s=r.displayName||null,s!==null?s:$r(r.type)||"Memo";case pi:s=r._payload,r=r._init;try{return $r(r(s))}catch{}}return null}var lr=Array.isArray,qe=S.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ot=z.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Pt={pending:!1,data:null,method:null,action:null},Mt=[],mi=-1;function be(r){return{current:r}}function Ke(r){0>mi||(r.current=Mt[mi],Mt[mi]=null,mi--)}function pt(r,s){mi++,Mt[mi]=r.current,r.current=s}var bt=be(null),At=be(null),Vt=be(null),ei=be(null);function Pi(r,s){switch(pt(Vt,s),pt(At,r),pt(bt,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?yu(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=yu(s),r=bm(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}Ke(bt),pt(bt,r)}function qi(){Ke(bt),Ke(At),Ke(Vt)}function Tr(r){r.memoizedState!==null&&pt(ei,r);var s=bt.current,c=bm(s,r.type);s!==c&&(pt(At,r),pt(bt,c))}function ao(r){At.current===r&&(Ke(bt),Ke(At)),ei.current===r&&(Ke(ei),Ih._currentValue=Pt)}var Xr,kl;function rn(r){if(Xr===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);Xr=s&&s[1]||"",kl=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xr+r+kl}var Ir=!1;function pa(r,s){if(!r||Ir)return"";Ir=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(s){var We=function(){throw Error()};if(Object.defineProperty(We.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(We,[])}catch(je){var ke=je}Reflect.construct(r,[],We)}else{try{We.call()}catch(je){ke=je}r.call(We.prototype)}}else{try{throw Error()}catch(je){ke=je}(We=r())&&typeof We.catch=="function"&&We.catch(function(){})}}catch(je){if(je&&ke&&typeof je.stack=="string")return[je.stack,ke.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),N=C[0],K=C[1];if(N&&K){var me=N.split(`
`),Be=K.split(`
`);for(T=g=0;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;for(;T<Be.length&&!Be[T].includes("DetermineComponentFrameRoot");)T++;if(g===me.length||T===Be.length)for(g=me.length-1,T=Be.length-1;1<=g&&0<=T&&me[g]!==Be[T];)T--;for(;1<=g&&0<=T;g--,T--)if(me[g]!==Be[T]){if(g!==1||T!==1)do if(g--,T--,0>T||me[g]!==Be[T]){var Ze=`
`+me[g].replace(" at new "," at ");return r.displayName&&Ze.includes("<anonymous>")&&(Ze=Ze.replace("<anonymous>",r.displayName)),Ze}while(1<=g&&0<=T);break}}}finally{Ir=!1,Error.prepareStackTrace=c}return(c=r?r.displayName||r.name:"")?rn(c):""}function hn(r,s){switch(r.tag){case 26:case 27:case 5:return rn(r.type);case 16:return rn("Lazy");case 13:return r.child!==s&&s!==null?rn("Suspense Fallback"):rn("Suspense");case 19:return rn("SuspenseList");case 0:case 15:return pa(r.type,!1);case 11:return pa(r.type.render,!1);case 1:return pa(r.type,!0);case 31:return rn("Activity");default:return""}}function zs(r){try{var s="",c=null;do s+=hn(r,c),c=r,r=r.return;while(r);return s}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Ps=Object.prototype.hasOwnProperty,so=v.unstable_scheduleCallback,es=v.unstable_cancelCallback,La=v.unstable_shouldYield,Fl=v.unstable_requestPaint,Yn=v.unstable_now,Rr=v.unstable_getCurrentPriorityLevel,Se=v.unstable_ImmediatePriority,$=v.unstable_UserBlockingPriority,Z=v.unstable_NormalPriority,W=v.unstable_LowPriority,fe=v.unstable_IdlePriority,pe=v.log,Ce=v.unstable_setDisableYieldValue,we=null,_e=null;function De(r){if(typeof pe=="function"&&Ce(r),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(we,r)}catch{}}var Ue=Math.clz32?Math.clz32:vt,Ge=Math.log,ht=Math.LN2;function vt(r){return r>>>=0,r===0?32:31-(Ge(r)/ht|0)|0}var Rt=256,gi=262144,ii=4194304;function Ee(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function vi(r,s,c){var g=r.pendingLanes;if(g===0)return 0;var T=0,C=r.suspendedLanes,N=r.pingedLanes;r=r.warmLanes;var K=g&134217727;return K!==0?(g=K&~C,g!==0?T=Ee(g):(N&=K,N!==0?T=Ee(N):c||(c=K&~r,c!==0&&(T=Ee(c))))):(K=g&~C,K!==0?T=Ee(K):N!==0?T=Ee(N):c||(c=g&~r,c!==0&&(T=Ee(c)))),T===0?0:s!==0&&s!==T&&(s&C)===0&&(C=T&-T,c=s&-s,C>=c||C===32&&(c&4194048)!==0)?s:T}function Dn(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function Bt(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bi(){var r=ii;return ii<<=1,(ii&62914560)===0&&(ii=4194304),r}function Gn(r){for(var s=[],c=0;31>c;c++)s.push(r);return s}function Ei(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function fn(r,s,c,g,T,C){var N=r.pendingLanes;r.pendingLanes=c,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=c,r.entangledLanes&=c,r.errorRecoveryDisabledLanes&=c,r.shellSuspendCounter=0;var K=r.entanglements,me=r.expirationTimes,Be=r.hiddenUpdates;for(c=N&~c;0<c;){var Ze=31-Ue(c),We=1<<Ze;K[Ze]=0,me[Ze]=-1;var ke=Be[Ze];if(ke!==null)for(Be[Ze]=null,Ze=0;Ze<ke.length;Ze++){var je=ke[Ze];je!==null&&(je.lane&=-536870913)}c&=~We}g!==0&&Ii(r,g,0),C!==0&&T===0&&r.tag!==0&&(r.suspendedLanes|=C&~(N&~s))}function Ii(r,s,c){r.pendingLanes|=s,r.suspendedLanes&=~s;var g=31-Ue(s);r.entangledLanes|=s,r.entanglements[g]=r.entanglements[g]|1073741824|c&261930}function zn(r,s){var c=r.entangledLanes|=s;for(r=r.entanglements;c;){var g=31-Ue(c),T=1<<g;T&s|r[g]&s&&(r[g]|=s),c&=~T}}function jl(r,s){var c=s&-s;return c=(c&42)!==0?1:Uo(c),(c&(r.suspendedLanes|s))!==0?0:c}function Uo(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function et(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function dr(){var r=ot.p;return r!==0?r:(r=window.event,r===void 0?32:Cc(r.type))}function pr(r,s){var c=ot.p;try{return ot.p=r,s()}finally{ot.p=c}}var Ba=Math.random().toString(36).slice(2),Vi="__reactFiber$"+Ba,nt="__reactProps$"+Ba,Ft="__reactContainer$"+Ba,qt="__reactEvents$"+Ba,Yr="__reactListeners$"+Ba,kc="__reactHandles$"+Ba,ts="__reactResources$"+Ba,kt="__reactMarker$"+Ba;function Go(r){delete r[Vi],delete r[nt],delete r[qt],delete r[Yr],delete r[kc]}function is(r){var s=r[Vi];if(s)return s;for(var c=r.parentNode;c;){if(s=c[Ft]||c[Vi]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(r=Rf(r);r!==null;){if(c=r[Vi])return c;r=Rf(r)}return s}r=c,c=r.parentNode}return null}function Is(r){if(r=r[Vi]||r[Ft]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function ns(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(M(33))}function rs(r){var s=r[ts];return s||(s=r[ts]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function dn(r){r[kt]=!0}var Nl=new Set,mr={};function ni(r,s){Rs(r,s),Rs(r+"Capture",s)}function Rs(r,s){for(mr[r]=s,r=0;r<s.length;r++)Nl.add(s[r])}var Vl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ul={},oo={};function ka(r){return Ps.call(oo,r)?!0:Ps.call(Ul,r)?!1:Vl.test(r)?oo[r]=!0:(Ul[r]=!0,!1)}function Ru(r,s,c){if(ka(s))if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var g=s.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+c)}}function as(r,s,c){if(c===null)r.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+c)}}function ma(r,s,c,g){if(g===null)r.removeAttribute(c);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(c);return}r.setAttributeNS(s,c,""+g)}}function ui(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Nh(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ld(r,s,c){var g=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var T=g.get,C=g.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return T.call(this)},set:function(N){c=""+N,C.call(this,N)}}),Object.defineProperty(r,s,{enumerable:g.enumerable}),{getValue:function(){return c},setValue:function(N){c=""+N},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function qo(r){if(!r._valueTracker){var s=Nh(r)?"checked":"value";r._valueTracker=ld(r,s,""+r[s])}}function Vh(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var c=s.getValue(),g="";return r&&(g=Nh(r)?r.checked?"true":"false":r.value),r=g,r!==c?(s.setValue(r),!0):!1}function Ou(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ud=/[\n"\\]/g;function Sr(r){return r.replace(ud,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Lu(r,s,c,g,T,C,N,K){r.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?r.type=N:r.removeAttribute("type"),s!=null?N==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+ui(s)):r.value!==""+ui(s)&&(r.value=""+ui(s)):N!=="submit"&&N!=="reset"||r.removeAttribute("value"),s!=null?Bu(r,N,ui(s)):c!=null?Bu(r,N,ui(c)):g!=null&&r.removeAttribute("value"),T==null&&C!=null&&(r.defaultChecked=!!C),T!=null&&(r.checked=T&&typeof T!="function"&&typeof T!="symbol"),K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?r.name=""+ui(K):r.removeAttribute("name")}function Fc(r,s,c,g,T,C,N,K){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.type=C),s!=null||c!=null){if(!(C!=="submit"&&C!=="reset"||s!=null)){qo(r);return}c=c!=null?""+ui(c):"",s=s!=null?""+ui(s):c,K||s===r.value||(r.value=s),r.defaultValue=s}g=g??T,g=typeof g!="function"&&typeof g!="symbol"&&!!g,r.checked=K?r.checked:!!g,r.defaultChecked=!!g,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(r.name=N),qo(r)}function Bu(r,s,c){s==="number"&&Ou(r.ownerDocument)===r||r.defaultValue===""+c||(r.defaultValue=""+c)}function lo(r,s,c,g){if(r=r.options,s){s={};for(var T=0;T<c.length;T++)s["$"+c[T]]=!0;for(c=0;c<r.length;c++)T=s.hasOwnProperty("$"+r[c].value),r[c].selected!==T&&(r[c].selected=T),T&&g&&(r[c].defaultSelected=!0)}else{for(c=""+ui(c),s=null,T=0;T<r.length;T++){if(r[T].value===c){r[T].selected=!0,g&&(r[T].defaultSelected=!0);return}s!==null||r[T].disabled||(s=r[T])}s!==null&&(s.selected=!0)}}function cd(r,s,c){if(s!=null&&(s=""+ui(s),s!==r.value&&(r.value=s),c==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=c!=null?""+ui(c):""}function Gl(r,s,c,g){if(s==null){if(g!=null){if(c!=null)throw Error(M(92));if(lr(g)){if(1<g.length)throw Error(M(93));g=g[0]}c=g}c==null&&(c=""),s=c}c=ui(s),r.defaultValue=c,g=r.textContent,g===c&&g!==""&&g!==null&&(r.value=g),qo(r)}function Os(r,s){if(s){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=s;return}}r.textContent=s}var hd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zo(r,s,c){var g=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?g?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":g?r.setProperty(s,c):typeof c!="number"||c===0||hd.has(s)?s==="float"?r.cssFloat=c:r[s]=(""+c).trim():r[s]=c+"px"}function jc(r,s,c){if(s!=null&&typeof s!="object")throw Error(M(62));if(r=r.style,c!=null){for(var g in c)!c.hasOwnProperty(g)||s!=null&&s.hasOwnProperty(g)||(g.indexOf("--")===0?r.setProperty(g,""):g==="float"?r.cssFloat="":r[g]="");for(var T in s)g=s[T],s.hasOwnProperty(T)&&c[T]!==g&&Zo(r,T,g)}else for(var C in s)s.hasOwnProperty(C)&&Zo(r,C,s[C])}function Ho(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ql=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Gt(r){return ql.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Fa(){}var Uh=null;function ku(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var qn=null,Pn=null;function Qi(r){var s=Is(r);if(s&&(r=s.stateNode)){var c=r[nt]||null;e:switch(r=s.stateNode,s.type){case"input":if(Lu(r,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Sr(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var g=c[s];if(g!==r&&g.form===r.form){var T=g[nt]||null;if(!T)throw Error(M(90));Lu(g,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(s=0;s<c.length;s++)g=c[s],g.form===r.form&&Vh(g)}break e;case"textarea":cd(r,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&lo(r,!!c.multiple,s,!1)}}}var zt=!1;function Ri(r,s,c){if(zt)return r(s,c);zt=!0;try{var g=r(s);return g}finally{if(zt=!1,(qn!==null||Pn!==null)&&(Ef(),qn&&(s=qn,r=Pn,Pn=qn=null,Qi(s),r)))for(s=0;s<r.length;s++)Qi(r[s])}}function ga(r,s){var c=r.stateNode;if(c===null)return null;var g=c[nt]||null;if(g===null)return null;c=g[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(M(231,s,typeof c));return c}var pn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Er=!1;if(pn)try{var Zn={};Object.defineProperty(Zn,"passive",{get:function(){Er=!0}}),window.addEventListener("test",Zn,Zn),window.removeEventListener("test",Zn,Zn)}catch{Er=!1}var Qr=null,ss=null,Ki=null;function co(){if(Ki)return Ki;var r,s=ss,c=s.length,g,T="value"in Qr?Qr.value:Qr.textContent,C=T.length;for(r=0;r<c&&s[r]===T[r];r++);var N=c-r;for(g=1;g<=N&&s[c-g]===T[C-g];g++);return Ki=T.slice(r,1<g?1-g:void 0)}function Kr(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function $o(){return!0}function Mr(){return!1}function kn(r){function s(c,g,T,C,N){this._reactName=c,this._targetInst=T,this.type=g,this.nativeEvent=C,this.target=N,this.currentTarget=null;for(var K in r)r.hasOwnProperty(K)&&(c=r[K],this[K]=c?c(C):C[K]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?$o:Mr,this.isPropagationStopped=Mr,this}return Xe(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=$o)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=$o)},persist:function(){},isPersistent:$o}),s}var Ar={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fu=kn(Ar),Xo=Xe({},Ar,{view:0,detail:0}),Yo=kn(Xo),Mi,ho,Xt,jt=Xe({},Xo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vu,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Xt&&(Xt&&r.type==="mousemove"?(Mi=r.screenX-Xt.screenX,ho=r.screenY-Xt.screenY):ho=Mi=0,Xt=r),Mi)},movementY:function(r){return"movementY"in r?r.movementY:ho}}),Qo=kn(jt),ri=Xe({},jt,{dataTransfer:0}),ju=kn(ri),_a=Xe({},Xo,{relatedTarget:0}),fo=kn(_a),po=Xe({},Ar,{animationName:0,elapsedTime:0,pseudoElement:0}),fd=kn(po),Nu=Xe({},Ar,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Gh=kn(Nu),Fp=Xe({},Ar,{data:0}),qh=kn(Fp),Cr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},os={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ko(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Wi[r])?!!s[r]:!1}function Vu(){return Ko}var Uu=Xe({},Xo,{key:function(r){if(r.key){var s=Cr[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=Kr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?os[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vu,charCode:function(r){return r.type==="keypress"?Kr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Kr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),mn=kn(Uu),dd=Xe({},jt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nc=kn(dd),pd=Xe({},Xo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vu}),jp=kn(pd),Zl=Xe({},Ar,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vc=kn(Zl),Hl=Xe({},jt,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Zh=kn(Hl),Gu=Xe({},Ar,{newState:0,oldState:0}),$l=kn(Gu),Xl=[9,13,27,32],wn=pn&&"CompositionEvent"in window,Yl=null;pn&&"documentMode"in document&&(Yl=document.documentMode);var Ql=pn&&"TextEvent"in window&&!Yl,Kl=pn&&(!wn||Yl&&8<Yl&&11>=Yl),mo=" ",md=!1;function qu(r,s){switch(r){case"keyup":return Xl.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gd(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ja=!1;function Uc(r,s){switch(r){case"compositionend":return gd(s);case"keypress":return s.which!==32?null:(md=!0,mo);case"textInput":return r=s.data,r===mo&&md?null:r;default:return null}}function _d(r,s){if(ja)return r==="compositionend"||!wn&&qu(r,s)?(r=co(),Ki=ss=Qr=null,ja=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Kl&&s.locale!=="ko"?null:s.data;default:return null}}var yd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gc(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!yd[r.type]:s==="textarea"}function qc(r,s,c,g){qn?Pn?Pn.push(g):Pn=[g]:qn=g,s=Df(s,"onChange"),0<s.length&&(c=new Fu("onChange","change",null,c,g),r.push({event:c,listeners:s}))}var Wo=null,Wl=null;function vd(r){kg(r,0)}function Zu(r){var s=ns(r);if(Vh(s))return r}function go(r,s){if(r==="change")return s}var Hh=!1;if(pn){var Hu;if(pn){var _o="oninput"in document;if(!_o){var $h=document.createElement("div");$h.setAttribute("oninput","return;"),_o=typeof $h.oninput=="function"}Hu=_o}else Hu=!1;Hh=Hu&&(!document.documentMode||9<document.documentMode)}function $u(){Wo&&(Wo.detachEvent("onpropertychange",bd),Wl=Wo=null)}function bd(r){if(r.propertyName==="value"&&Zu(Wl)){var s=[];qc(s,Wl,r,ku(r)),Ri(vd,s)}}function Np(r,s,c){r==="focusin"?($u(),Wo=s,Wl=c,Wo.attachEvent("onpropertychange",bd)):r==="focusout"&&$u()}function xd(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Zu(Wl)}function Xu(r,s){if(r==="click")return Zu(s)}function wd(r,s){if(r==="input"||r==="change")return Zu(s)}function Xh(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Or=typeof Object.is=="function"?Object.is:Xh;function yo(r,s){if(Or(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var c=Object.keys(r),g=Object.keys(s);if(c.length!==g.length)return!1;for(g=0;g<c.length;g++){var T=c[g];if(!Ps.call(s,T)||!Or(r[T],s[T]))return!1}return!0}function ya(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Yu(r,s){var c=ya(r);r=0;for(var g;c;){if(c.nodeType===3){if(g=r+c.textContent.length,r<=s&&g>=s)return{node:c,offset:s-r};r=g}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ya(c)}}function Zc(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Zc(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Hc(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=Ou(r.document);s instanceof r.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)r=s.contentWindow;else break;s=Ou(r.document)}return s}function Qu(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var $c=pn&&"documentMode"in document&&11>=document.documentMode,va=null,Ku=null,Wu=null,Xc=!1;function Td(r,s,c){var g=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Xc||va==null||va!==Ou(g)||(g=va,"selectionStart"in g&&Qu(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Wu&&yo(Wu,g)||(Wu=g,g=Df(Ku,"onSelect"),0<g.length&&(s=new Fu("onSelect","select",null,s,c),r.push({event:s,listeners:g}),s.target=va)))}function Jo(r,s){var c={};return c[r.toLowerCase()]=s.toLowerCase(),c["Webkit"+r]="webkit"+s,c["Moz"+r]="moz"+s,c}var el={animationend:Jo("Animation","AnimationEnd"),animationiteration:Jo("Animation","AnimationIteration"),animationstart:Jo("Animation","AnimationStart"),transitionrun:Jo("Transition","TransitionRun"),transitionstart:Jo("Transition","TransitionStart"),transitioncancel:Jo("Transition","TransitionCancel"),transitionend:Jo("Transition","TransitionEnd")},Yh={},ci={};pn&&(ci=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function ls(r){if(Yh[r])return Yh[r];if(!el[r])return r;var s=el[r],c;for(c in s)if(s.hasOwnProperty(c)&&c in ci)return Yh[r]=s[c];return r}var Ju=ls("animationend"),ec=ls("animationiteration"),Yc=ls("animationstart"),tl=ls("transitionrun"),tc=ls("transitionstart"),Jl=ls("transitioncancel"),Wr=ls("transitionend"),Qh=new Map,Qc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qc.push("scrollEnd");function Jr(r,s){Qh.set(r,s),ni(s,[r])}var us=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Dr=[],Ls=0,il=0;function nl(){for(var r=Ls,s=il=Ls=0;s<r;){var c=Dr[s];Dr[s++]=null;var g=Dr[s];Dr[s++]=null;var T=Dr[s];Dr[s++]=null;var C=Dr[s];if(Dr[s++]=null,g!==null&&T!==null){var N=g.pending;N===null?T.next=T:(T.next=N.next,N.next=T),g.pending=T}C!==0&&Kh(c,T,C)}}function ic(r,s,c,g){Dr[Ls++]=r,Dr[Ls++]=s,Dr[Ls++]=c,Dr[Ls++]=g,il|=g,r.lanes|=g,r=r.alternate,r!==null&&(r.lanes|=g)}function vo(r,s,c,g){return ic(r,s,c,g),eu(r)}function ba(r,s){return ic(r,null,null,s),eu(r)}function Kh(r,s,c){r.lanes|=c;var g=r.alternate;g!==null&&(g.lanes|=c);for(var T=!1,C=r.return;C!==null;)C.childLanes|=c,g=C.alternate,g!==null&&(g.childLanes|=c),C.tag===22&&(r=C.stateNode,r===null||r._visibility&1||(T=!0)),r=C,C=C.return;return r.tag===3?(C=r.stateNode,T&&s!==null&&(T=31-Ue(c),r=C.hiddenUpdates,g=r[T],g===null?r[T]=[s]:g.push(s),s.lane=c|536870912),C):null}function eu(r){if(50<Sf)throw Sf=0,rm=null,Error(M(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var Ut={};function Kc(r,s,c,g){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ea(r,s,c,g){return new Kc(r,s,c,g)}function Wc(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ta(r,s){var c=r.alternate;return c===null?(c=ea(r.tag,s,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=s,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&65011712,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,s=r.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c.refCleanup=r.refCleanup,c}function Sd(r,s){r.flags&=65011714;var c=r.alternate;return c===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=c.childLanes,r.lanes=c.lanes,r.child=c.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=c.memoizedProps,r.memoizedState=c.memoizedState,r.updateQueue=c.updateQueue,r.type=c.type,s=c.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Jc(r,s,c,g,T,C){var N=0;if(g=r,typeof r=="function")Wc(r)&&(N=1);else if(typeof r=="string")N=_p(r,c,bt.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case cn:return r=ea(31,c,s,T),r.elementType=cn,r.lanes=C,r;case rt:return bo(c.children,T,C,s);case xe:N=8,T|=24;break;case Jt:return r=ea(12,c,s,T|2),r.elementType=Jt,r.lanes=C,r;case di:return r=ea(13,c,s,T),r.elementType=di,r.lanes=C,r;case Si:return r=ea(19,c,s,T),r.elementType=Si,r.lanes=C,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Ct:N=10;break e;case Nt:N=9;break e;case Kt:N=11;break e;case St:N=14;break e;case pi:N=16,g=null;break e}N=29,c=Error(M(130,r===null?"null":typeof r,"")),g=null}return s=ea(N,c,s,T),s.elementType=r,s.type=g,s.lanes=C,s}function bo(r,s,c,g){return r=ea(7,r,g,s),r.lanes=c,r}function Wh(r,s,c){return r=ea(6,r,null,s),r.lanes=c,r}function eh(r){var s=ea(18,null,null,0);return s.stateNode=r,s}function xo(r,s,c){return s=ea(4,r.children!==null?r.children:[],r.key,s),s.lanes=c,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var tu=new WeakMap;function zr(r,s){if(typeof r=="object"&&r!==null){var c=tu.get(r);return c!==void 0?c:(s={value:r,source:s,stack:zs(s)},tu.set(r,s),s)}return{value:r,source:s,stack:zs(s)}}var wo=[],To=0,rl=null,So=0,Hn=[],Qn=0,cs=null,hs=1,Lr="";function Bs(r,s){wo[To++]=So,wo[To++]=rl,rl=r,So=s}function Jh(r,s,c){Hn[Qn++]=hs,Hn[Qn++]=Lr,Hn[Qn++]=cs,cs=r;var g=hs;r=Lr;var T=32-Ue(g)-1;g&=~(1<<T),c+=1;var C=32-Ue(s)+T;if(30<C){var N=T-T%5;C=(g&(1<<N)-1).toString(32),g>>=N,T-=N,hs=1<<32-Ue(s)+T|c<<T|g,Lr=C+r}else hs=1<<C|c<<T|g,Lr=r}function al(r){r.return!==null&&(Bs(r,1),Jh(r,1,0))}function iu(r){for(;r===rl;)rl=wo[--To],wo[To]=null,So=wo[--To],wo[To]=null;for(;r===cs;)cs=Hn[--Qn],Hn[Qn]=null,Lr=Hn[--Qn],Hn[Qn]=null,hs=Hn[--Qn],Hn[Qn]=null}function ef(r,s){Hn[Qn++]=hs,Hn[Qn++]=Lr,Hn[Qn++]=cs,hs=s.id,Lr=s.overflow,cs=r}var Kn=null,Oi=null,ti=!1,ks=null,ia=!1,an=Error(M(519));function Br(r){var s=Error(M(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fs(zr(s,r)),an}function kr(r){var s=r.stateNode,c=r.type,g=r.memoizedProps;switch(s[Vi]=r,s[nt]=g,c){case"dialog":li("cancel",s),li("close",s);break;case"iframe":case"object":case"embed":li("load",s);break;case"video":case"audio":for(c=0;c<_u.length;c++)li(_u[c],s);break;case"source":li("error",s);break;case"img":case"image":case"link":li("error",s),li("load",s);break;case"details":li("toggle",s);break;case"input":li("invalid",s),Fc(s,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":li("invalid",s);break;case"textarea":li("invalid",s),Gl(s,g.value,g.defaultValue,g.children)}c=g.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||g.suppressHydrationWarning===!0||ym(s.textContent,c)?(g.popover!=null&&(li("beforetoggle",s),li("toggle",s)),g.onScroll!=null&&li("scroll",s),g.onScrollEnd!=null&&li("scrollend",s),g.onClick!=null&&(s.onclick=Fa),s=!0):s=!1,s||Br(r,!0)}function nc(r){for(Kn=r.return;Kn;)switch(Kn.tag){case 5:case 31:case 13:ia=!1;return;case 27:case 3:ia=!0;return;default:Kn=Kn.return}}function fs(r){if(r!==Kn)return!1;if(!ti)return nc(r),ti=!0,!1;var s=r.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=r.type,c=!(c!=="form"&&c!=="button")||cp(r.type,r.memoizedProps)),c=!c),c&&Oi&&Br(r),nc(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(M(317));Oi=ar(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(M(317));Oi=ar(r)}else s===27?(s=Oi,bu(r.type)?(r=ca,ca=null,Oi=r):Oi=s):Oi=Kn?Ka(r.stateNode.nextSibling):null;return!0}function ds(){Oi=Kn=null,ti=!1}function ps(){var r=ks;return r!==null&&(za===null?za=r:za.push.apply(za,r),ks=null),r}function Fs(r){ks===null?ks=[r]:ks.push(r)}var js=be(null),xa=null,ms=null;function Ns(r,s,c){pt(js,s._currentValue),s._currentValue=c}function gs(r){r._currentValue=js.current,Ke(js)}function th(r,s,c){for(;r!==null;){var g=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,g!==null&&(g.childLanes|=s)):g!==null&&(g.childLanes&s)!==s&&(g.childLanes|=s),r===c)break;r=r.return}}function ih(r,s,c,g){var T=r.child;for(T!==null&&(T.return=r);T!==null;){var C=T.dependencies;if(C!==null){var N=T.child;C=C.firstContext;e:for(;C!==null;){var K=C;C=T;for(var me=0;me<s.length;me++)if(K.context===s[me]){C.lanes|=c,K=C.alternate,K!==null&&(K.lanes|=c),th(C.return,c,r),g||(N=null);break e}C=K.next}}else if(T.tag===18){if(N=T.return,N===null)throw Error(M(341));N.lanes|=c,C=N.alternate,C!==null&&(C.lanes|=c),th(N,c,r),N=null}else N=T.child;if(N!==null)N.return=T;else for(N=T;N!==null;){if(N===r){N=null;break}if(T=N.sibling,T!==null){T.return=N.return,N=T;break}N=N.return}T=N}}function na(r,s,c,g){r=null;for(var T=s,C=!1;T!==null;){if(!C){if((T.flags&524288)!==0)C=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var N=T.alternate;if(N===null)throw Error(M(387));if(N=N.memoizedProps,N!==null){var K=T.type;Or(T.pendingProps.value,N.value)||(r!==null?r.push(K):r=[K])}}else if(T===ei.current){if(N=T.alternate,N===null)throw Error(M(387));N.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(r!==null?r.push(Ih):r=[Ih])}T=T.return}r!==null&&ih(s,r,c,g),s.flags|=262144}function nu(r){for(r=r.firstContext;r!==null;){if(!Or(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Vs(r){xa=r,ms=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function In(r){return nh(xa,r)}function rc(r,s){return xa===null&&Vs(r),nh(r,s)}function nh(r,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},ms===null){if(r===null)throw Error(M(308));ms=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else ms=ms.next=s;return c}var tf=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(c,g){r.push(g)}};this.abort=function(){s.aborted=!0,r.forEach(function(c){return c()})}},Ed=v.unstable_scheduleCallback,nf=v.unstable_NormalPriority,Tn={$$typeof:Ct,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _s(){return{controller:new tf,data:new Map,refCount:0}}function ru(r){r.refCount--,r.refCount===0&&Ed(nf,function(){r.controller.abort()})}var gr=null,ra=0,sl=0,_r=null;function Vp(r,s){if(gr===null){var c=gr=[];ra=0,sl=dm(),_r={status:"pending",value:void 0,then:function(g){c.push(g)}}}return ra++,s.then(au,au),s}function au(){if(--ra===0&&gr!==null){_r!==null&&(_r.status="fulfilled");var r=gr;gr=null,sl=0,_r=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function ac(r,s){var c=[],g={status:"pending",value:null,reason:null,then:function(T){c.push(T)}};return r.then(function(){g.status="fulfilled",g.value=s;for(var T=0;T<c.length;T++)(0,c[T])(s)},function(T){for(g.status="rejected",g.reason=T,T=0;T<c.length;T++)(0,c[T])(void 0)}),g}var $n=qe.S;qe.S=function(r,s){bg=Yn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&Vp(r,s),$n!==null&&$n(r,s)};var Na=be(null);function rh(){var r=Na.current;return r!==null?r:tn.pooledCache}function ah(r,s){s===null?pt(Na,Na.current):pt(Na,s.pool)}function Md(){var r=rh();return r===null?null:{parent:Tn._currentValue,pool:r}}var Va=Error(M(460)),Eo=Error(M(474)),Fr=Error(M(542)),ut={then:function(){}};function sc(r){return r=r.status,r==="fulfilled"||r==="rejected"}function sh(r,s,c){switch(c=r[c],c===void 0?r.push(s):c!==s&&(s.then(Fa,Fa),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,oh(r),r;default:if(typeof s.status=="string")s.then(Fa,Fa);else{if(r=tn,r!==null&&100<r.shellSuspendCounter)throw Error(M(482));r=s,r.status="pending",r.then(function(g){if(s.status==="pending"){var T=s;T.status="fulfilled",T.value=g}},function(g){if(s.status==="pending"){var T=s;T.status="rejected",T.reason=g}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,oh(r),r}throw Ua=s,Va}}function wa(r){try{var s=r._init;return s(r._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ua=c,Va):c}}var Ua=null;function su(){if(Ua===null)throw Error(M(459));var r=Ua;return Ua=null,r}function oh(r){if(r===Va||r===Fr)throw Error(M(483))}var ys=null,ol=0;function oc(r){var s=ol;return ol+=1,ys===null&&(ys=[]),sh(ys,r,s)}function vs(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function lh(r,s){throw s.$$typeof===Je?Error(M(525)):(r=Object.prototype.toString.call(s),Error(M(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function lc(r){function s(Te,ve){if(r){var Re=Te.deletions;Re===null?(Te.deletions=[ve],Te.flags|=16):Re.push(ve)}}function c(Te,ve){if(!r)return null;for(;ve!==null;)s(Te,ve),ve=ve.sibling;return null}function g(Te){for(var ve=new Map;Te!==null;)Te.key!==null?ve.set(Te.key,Te):ve.set(Te.index,Te),Te=Te.sibling;return ve}function T(Te,ve){return Te=ta(Te,ve),Te.index=0,Te.sibling=null,Te}function C(Te,ve,Re){return Te.index=Re,r?(Re=Te.alternate,Re!==null?(Re=Re.index,Re<ve?(Te.flags|=67108866,ve):Re):(Te.flags|=67108866,ve)):(Te.flags|=1048576,ve)}function N(Te){return r&&Te.alternate===null&&(Te.flags|=67108866),Te}function K(Te,ve,Re,Ye){return ve===null||ve.tag!==6?(ve=Wh(Re,Te.mode,Ye),ve.return=Te,ve):(ve=T(ve,Re),ve.return=Te,ve)}function me(Te,ve,Re,Ye){var It=Re.type;return It===rt?Ze(Te,ve,Re.props.children,Ye,Re.key):ve!==null&&(ve.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===pi&&wa(It)===ve.type)?(ve=T(ve,Re.props),vs(ve,Re),ve.return=Te,ve):(ve=Jc(Re.type,Re.key,Re.props,null,Te.mode,Ye),vs(ve,Re),ve.return=Te,ve)}function Be(Te,ve,Re,Ye){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Re.containerInfo||ve.stateNode.implementation!==Re.implementation?(ve=xo(Re,Te.mode,Ye),ve.return=Te,ve):(ve=T(ve,Re.children||[]),ve.return=Te,ve)}function Ze(Te,ve,Re,Ye,It){return ve===null||ve.tag!==7?(ve=bo(Re,Te.mode,Ye,It),ve.return=Te,ve):(ve=T(ve,Re),ve.return=Te,ve)}function We(Te,ve,Re){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ve=Wh(""+ve,Te.mode,Re),ve.return=Te,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case yt:return Re=Jc(ve.type,ve.key,ve.props,null,Te.mode,Re),vs(Re,ve),Re.return=Te,Re;case Et:return ve=xo(ve,Te.mode,Re),ve.return=Te,ve;case pi:return ve=wa(ve),We(Te,ve,Re)}if(lr(ve)||Ni(ve))return ve=bo(ve,Te.mode,Re,null),ve.return=Te,ve;if(typeof ve.then=="function")return We(Te,oc(ve),Re);if(ve.$$typeof===Ct)return We(Te,rc(Te,ve),Re);lh(Te,ve)}return null}function ke(Te,ve,Re,Ye){var It=ve!==null?ve.key:null;if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return It!==null?null:K(Te,ve,""+Re,Ye);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case yt:return Re.key===It?me(Te,ve,Re,Ye):null;case Et:return Re.key===It?Be(Te,ve,Re,Ye):null;case pi:return Re=wa(Re),ke(Te,ve,Re,Ye)}if(lr(Re)||Ni(Re))return It!==null?null:Ze(Te,ve,Re,Ye,null);if(typeof Re.then=="function")return ke(Te,ve,oc(Re),Ye);if(Re.$$typeof===Ct)return ke(Te,ve,rc(Te,Re),Ye);lh(Te,Re)}return null}function je(Te,ve,Re,Ye,It){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Te=Te.get(Re)||null,K(ve,Te,""+Ye,It);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case yt:return Te=Te.get(Ye.key===null?Re:Ye.key)||null,me(ve,Te,Ye,It);case Et:return Te=Te.get(Ye.key===null?Re:Ye.key)||null,Be(ve,Te,Ye,It);case pi:return Ye=wa(Ye),je(Te,ve,Re,Ye,It)}if(lr(Ye)||Ni(Ye))return Te=Te.get(Re)||null,Ze(ve,Te,Ye,It,null);if(typeof Ye.then=="function")return je(Te,ve,Re,oc(Ye),It);if(Ye.$$typeof===Ct)return je(Te,ve,Re,rc(ve,Ye),It);lh(ve,Ye)}return null}function xt(Te,ve,Re,Ye){for(var It=null,Di=null,wt=ve,Dt=ve=0,ai=null;wt!==null&&Dt<Re.length;Dt++){wt.index>Dt?(ai=wt,wt=null):ai=wt.sibling;var Ti=ke(Te,wt,Re[Dt],Ye);if(Ti===null){wt===null&&(wt=ai);break}r&&wt&&Ti.alternate===null&&s(Te,wt),ve=C(Ti,ve,Dt),Di===null?It=Ti:Di.sibling=Ti,Di=Ti,wt=ai}if(Dt===Re.length)return c(Te,wt),ti&&Bs(Te,Dt),It;if(wt===null){for(;Dt<Re.length;Dt++)wt=We(Te,Re[Dt],Ye),wt!==null&&(ve=C(wt,ve,Dt),Di===null?It=wt:Di.sibling=wt,Di=wt);return ti&&Bs(Te,Dt),It}for(wt=g(wt);Dt<Re.length;Dt++)ai=je(wt,Te,Dt,Re[Dt],Ye),ai!==null&&(r&&ai.alternate!==null&&wt.delete(ai.key===null?Dt:ai.key),ve=C(ai,ve,Dt),Di===null?It=ai:Di.sibling=ai,Di=ai);return r&&wt.forEach(function(Cl){return s(Te,Cl)}),ti&&Bs(Te,Dt),It}function Ot(Te,ve,Re,Ye){if(Re==null)throw Error(M(151));for(var It=null,Di=null,wt=ve,Dt=ve=0,ai=null,Ti=Re.next();wt!==null&&!Ti.done;Dt++,Ti=Re.next()){wt.index>Dt?(ai=wt,wt=null):ai=wt.sibling;var Cl=ke(Te,wt,Ti.value,Ye);if(Cl===null){wt===null&&(wt=ai);break}r&&wt&&Cl.alternate===null&&s(Te,wt),ve=C(Cl,ve,Dt),Di===null?It=Cl:Di.sibling=Cl,Di=Cl,wt=ai}if(Ti.done)return c(Te,wt),ti&&Bs(Te,Dt),It;if(wt===null){for(;!Ti.done;Dt++,Ti=Re.next())Ti=We(Te,Ti.value,Ye),Ti!==null&&(ve=C(Ti,ve,Dt),Di===null?It=Ti:Di.sibling=Ti,Di=Ti);return ti&&Bs(Te,Dt),It}for(wt=g(wt);!Ti.done;Dt++,Ti=Re.next())Ti=je(wt,Te,Dt,Ti.value,Ye),Ti!==null&&(r&&Ti.alternate!==null&&wt.delete(Ti.key===null?Dt:Ti.key),ve=C(Ti,ve,Dt),Di===null?It=Ti:Di.sibling=Ti,Di=Ti);return r&&wt.forEach(function(Nm){return s(Te,Nm)}),ti&&Bs(Te,Dt),It}function Hi(Te,ve,Re,Ye){if(typeof Re=="object"&&Re!==null&&Re.type===rt&&Re.key===null&&(Re=Re.props.children),typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case yt:e:{for(var It=Re.key;ve!==null;){if(ve.key===It){if(It=Re.type,It===rt){if(ve.tag===7){c(Te,ve.sibling),Ye=T(ve,Re.props.children),Ye.return=Te,Te=Ye;break e}}else if(ve.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===pi&&wa(It)===ve.type){c(Te,ve.sibling),Ye=T(ve,Re.props),vs(Ye,Re),Ye.return=Te,Te=Ye;break e}c(Te,ve);break}else s(Te,ve);ve=ve.sibling}Re.type===rt?(Ye=bo(Re.props.children,Te.mode,Ye,Re.key),Ye.return=Te,Te=Ye):(Ye=Jc(Re.type,Re.key,Re.props,null,Te.mode,Ye),vs(Ye,Re),Ye.return=Te,Te=Ye)}return N(Te);case Et:e:{for(It=Re.key;ve!==null;){if(ve.key===It)if(ve.tag===4&&ve.stateNode.containerInfo===Re.containerInfo&&ve.stateNode.implementation===Re.implementation){c(Te,ve.sibling),Ye=T(ve,Re.children||[]),Ye.return=Te,Te=Ye;break e}else{c(Te,ve);break}else s(Te,ve);ve=ve.sibling}Ye=xo(Re,Te.mode,Ye),Ye.return=Te,Te=Ye}return N(Te);case pi:return Re=wa(Re),Hi(Te,ve,Re,Ye)}if(lr(Re))return xt(Te,ve,Re,Ye);if(Ni(Re)){if(It=Ni(Re),typeof It!="function")throw Error(M(150));return Re=It.call(Re),Ot(Te,ve,Re,Ye)}if(typeof Re.then=="function")return Hi(Te,ve,oc(Re),Ye);if(Re.$$typeof===Ct)return Hi(Te,ve,rc(Te,Re),Ye);lh(Te,Re)}return typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint"?(Re=""+Re,ve!==null&&ve.tag===6?(c(Te,ve.sibling),Ye=T(ve,Re),Ye.return=Te,Te=Ye):(c(Te,ve),Ye=Wh(Re,Te.mode,Ye),Ye.return=Te,Te=Ye),N(Te)):c(Te,ve)}return function(Te,ve,Re,Ye){try{ol=0;var It=Hi(Te,ve,Re,Ye);return ys=null,It}catch(wt){if(wt===Va||wt===Fr)throw wt;var Di=ea(29,wt,null,Te.mode);return Di.lanes=Ye,Di.return=Te,Di}}}var bs=lc(!0),rf=lc(!1),xs=!1;function uh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uc(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ws(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Us(r,s,c){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,(ki&2)!==0){var T=g.pending;return T===null?s.next=s:(s.next=T.next,T.next=s),g.pending=s,s=eu(r),Kh(r,null,c),s}return ic(r,g,s,c),eu(r)}function Ta(r,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var g=s.lanes;g&=r.pendingLanes,c|=g,s.lanes=c,zn(r,c)}}function xi(r,s){var c=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,c===g)){var T=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var N={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};C===null?T=C=N:C=C.next=N,c=c.next}while(c!==null);C===null?T=C=s:C=C.next=s}else T=C=s;c={baseState:g.baseState,firstBaseUpdate:T,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=s:r.next=s,c.lastBaseUpdate=s}var af=!1;function Gs(){if(af){var r=_r;if(r!==null)throw r}}function Mo(r,s,c,g){af=!1;var T=r.updateQueue;xs=!1;var C=T.firstBaseUpdate,N=T.lastBaseUpdate,K=T.shared.pending;if(K!==null){T.shared.pending=null;var me=K,Be=me.next;me.next=null,N===null?C=Be:N.next=Be,N=me;var Ze=r.alternate;Ze!==null&&(Ze=Ze.updateQueue,K=Ze.lastBaseUpdate,K!==N&&(K===null?Ze.firstBaseUpdate=Be:K.next=Be,Ze.lastBaseUpdate=me))}if(C!==null){var We=T.baseState;N=0,Ze=Be=me=null,K=C;do{var ke=K.lane&-536870913,je=ke!==K.lane;if(je?(oi&ke)===ke:(g&ke)===ke){ke!==0&&ke===sl&&(af=!0),Ze!==null&&(Ze=Ze.next={lane:0,tag:K.tag,payload:K.payload,callback:null,next:null});e:{var xt=r,Ot=K;ke=s;var Hi=c;switch(Ot.tag){case 1:if(xt=Ot.payload,typeof xt=="function"){We=xt.call(Hi,We,ke);break e}We=xt;break e;case 3:xt.flags=xt.flags&-65537|128;case 0:if(xt=Ot.payload,ke=typeof xt=="function"?xt.call(Hi,We,ke):xt,ke==null)break e;We=Xe({},We,ke);break e;case 2:xs=!0}}ke=K.callback,ke!==null&&(r.flags|=64,je&&(r.flags|=8192),je=T.callbacks,je===null?T.callbacks=[ke]:je.push(ke))}else je={lane:ke,tag:K.tag,payload:K.payload,callback:K.callback,next:null},Ze===null?(Be=Ze=je,me=We):Ze=Ze.next=je,N|=ke;if(K=K.next,K===null){if(K=T.shared.pending,K===null)break;je=K,K=je.next,je.next=null,T.lastBaseUpdate=je,T.shared.pending=null}}while(!0);Ze===null&&(me=We),T.baseState=me,T.firstBaseUpdate=Be,T.lastBaseUpdate=Ze,C===null&&(T.shared.lanes=0),xl|=N,r.lanes=N,r.memoizedState=We}}function cc(r,s){if(typeof r!="function")throw Error(M(191,r));r.call(s)}function ch(r,s){var c=r.callbacks;if(c!==null)for(r.callbacks=null,r=0;r<c.length;r++)cc(c[r],s)}var ll=be(null),hc=be(0);function sf(r,s){r=bl,pt(hc,r),pt(ll,s),bl=r|s.baseLanes}function aa(){pt(hc,bl),pt(ll,ll.current)}function ul(){bl=hc.current,Ke(ll),Ke(hc)}var ft=be(null),_t=null;function Sa(r){var s=r.alternate;pt(gn,gn.current&1),pt(ft,r),_t===null&&(s===null||ll.current!==null||s.memoizedState!==null)&&(_t=r)}function ou(r){pt(gn,gn.current),pt(ft,r),_t===null&&(_t=r)}function fc(r){r.tag===22?(pt(gn,gn.current),pt(ft,r),_t===null&&(_t=r)):Sn()}function Sn(){pt(gn,gn.current),pt(ft,ft.current)}function sn(r){Ke(ft),_t===r&&(_t=null),Ke(gn)}var gn=be(0);function dc(r){for(var s=r;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Ur(c)||jn(c)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var qs=0,$t=null,_i=null,Ht=null,Ji=!1,Ea=!1,Ga=!1,cl=0,hl=0,Zs=null,of=0;function $i(){throw Error(M(321))}function qa(r,s){if(s===null)return!1;for(var c=0;c<s.length&&c<r.length;c++)if(!Or(r[c],s[c]))return!1;return!0}function lu(r,s,c,g,T,C){return qs=C,$t=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,qe.H=r===null||r.memoizedState===null?Bi:Rn,Ga=!1,C=c(g,T),Ga=!1,Ea&&(C=pc(s,c,g,T)),uu(r),C}function uu(r){qe.H=wi;var s=_i!==null&&_i.next!==null;if(qs=0,Ht=_i=$t=null,Ji=!1,hl=0,Zs=null,s)throw Error(M(300));r===null||er||(r=r.dependencies,r!==null&&nu(r)&&(er=!0))}function pc(r,s,c,g){$t=r;var T=0;do{if(Ea&&(Zs=null),hl=0,Ea=!1,25<=T)throw Error(M(301));if(T+=1,Ht=_i=null,r.updateQueue!=null){var C=r.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}qe.H=Fn,C=s(c,g)}while(Ea);return C}function mc(){var r=qe.H,s=r.useState()[0];return s=typeof s.then=="function"?fl(s):s,r=r.useState()[0],(_i!==null?_i.memoizedState:null)!==r&&($t.flags|=1024),s}function gc(){var r=cl!==0;return cl=0,r}function Ao(r,s,c){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~c}function Hs(r){if(Ji){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ji=!1}qs=0,Ht=_i=$t=null,Ea=!1,hl=cl=0,Zs=null}function ur(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ht===null?$t.memoizedState=Ht=r:Ht=Ht.next=r,Ht}function en(){if(_i===null){var r=$t.alternate;r=r!==null?r.memoizedState:null}else r=_i.next;var s=Ht===null?$t.memoizedState:Ht.next;if(s!==null)Ht=s,_i=r;else{if(r===null)throw $t.alternate===null?Error(M(467)):Error(M(310));_i=r,r={memoizedState:_i.memoizedState,baseState:_i.baseState,baseQueue:_i.baseQueue,queue:_i.queue,next:null},Ht===null?$t.memoizedState=Ht=r:Ht=Ht.next=r}return Ht}function Ts(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fl(r){var s=hl;return hl+=1,Zs===null&&(Zs=[]),r=sh(Zs,r,s),s=$t,(Ht===null?s.memoizedState:Ht.next)===null&&(s=s.alternate,qe.H=s===null||s.memoizedState===null?Bi:Rn),r}function dl(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return fl(r);if(r.$$typeof===Ct)return In(r)}throw Error(M(438,String(r)))}function cu(r){var s=null,c=$t.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var g=$t.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(s={data:g.data.map(function(T){return T.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=Ts(),$t.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(r),g=0;g<r;g++)c[g]=Vn;return s.index++,c}function Za(r,s){return typeof s=="function"?s(r):s}function m(r){var s=en();return t(s,_i,r)}function t(r,s,c){var g=r.queue;if(g===null)throw Error(M(311));g.lastRenderedReducer=c;var T=r.baseQueue,C=g.pending;if(C!==null){if(T!==null){var N=T.next;T.next=C.next,C.next=N}s.baseQueue=T=C,g.pending=null}if(C=r.baseState,T===null)r.memoizedState=C;else{s=T.next;var K=N=null,me=null,Be=s,Ze=!1;do{var We=Be.lane&-536870913;if(We!==Be.lane?(oi&We)===We:(qs&We)===We){var ke=Be.revertLane;if(ke===0)me!==null&&(me=me.next={lane:0,revertLane:0,gesture:null,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),We===sl&&(Ze=!0);else if((qs&ke)===ke){Be=Be.next,ke===sl&&(Ze=!0);continue}else We={lane:0,revertLane:Be.revertLane,gesture:null,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},me===null?(K=me=We,N=C):me=me.next=We,$t.lanes|=ke,xl|=ke;We=Be.action,Ga&&c(C,We),C=Be.hasEagerState?Be.eagerState:c(C,We)}else ke={lane:We,revertLane:Be.revertLane,gesture:Be.gesture,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},me===null?(K=me=ke,N=C):me=me.next=ke,$t.lanes|=We,xl|=We;Be=Be.next}while(Be!==null&&Be!==s);if(me===null?N=C:me.next=K,!Or(C,r.memoizedState)&&(er=!0,Ze&&(c=_r,c!==null)))throw c;r.memoizedState=C,r.baseState=N,r.baseQueue=me,g.lastRenderedState=C}return T===null&&(g.lanes=0),[r.memoizedState,g.dispatch]}function a(r){var s=en(),c=s.queue;if(c===null)throw Error(M(311));c.lastRenderedReducer=r;var g=c.dispatch,T=c.pending,C=s.memoizedState;if(T!==null){c.pending=null;var N=T=T.next;do C=r(C,N.action),N=N.next;while(N!==T);Or(C,s.memoizedState)||(er=!0),s.memoizedState=C,s.baseQueue===null&&(s.baseState=C),c.lastRenderedState=C}return[C,g]}function l(r,s,c){var g=$t,T=en(),C=ti;if(C){if(c===void 0)throw Error(M(407));c=c()}else c=s();var N=!Or((_i||T).memoizedState,c);if(N&&(T.memoizedState=c,er=!0),T=T.queue,Pe(b.bind(null,g,T,r),[r]),T.getSnapshot!==s||N||Ht!==null&&Ht.memoizedState.tag&1){if(g.flags|=2048,oe(9,{destroy:void 0},_.bind(null,g,T,c,s),null),tn===null)throw Error(M(349));C||(qs&127)!==0||f(g,s,c)}return c}function f(r,s,c){r.flags|=16384,r={getSnapshot:s,value:c},s=$t.updateQueue,s===null?(s=Ts(),$t.updateQueue=s,s.stores=[r]):(c=s.stores,c===null?s.stores=[r]:c.push(r))}function _(r,s,c,g){s.value=c,s.getSnapshot=g,w(s)&&A(r)}function b(r,s,c){return c(function(){w(s)&&A(r)})}function w(r){var s=r.getSnapshot;r=r.value;try{var c=s();return!Or(r,c)}catch{return!0}}function A(r){var s=ba(r,2);s!==null&&Ia(s,r,2)}function I(r){var s=ur();if(typeof r=="function"){var c=r;if(r=c(),Ga){De(!0);try{c()}finally{De(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:r},s}function O(r,s,c,g){return r.baseState=c,t(r,_i,typeof g=="function"?g:Za)}function j(r,s,c,g,T){if(sa(r))throw Error(M(485));if(r=s.action,r!==null){var C={payload:T,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){C.listeners.push(N)}};qe.T!==null?c(!0):C.isTransition=!1,g(C),c=s.pending,c===null?(C.next=s.pending=C,k(s,C)):(C.next=c.next,s.pending=c.next=C)}}function k(r,s){var c=s.action,g=s.payload,T=r.state;if(s.isTransition){var C=qe.T,N={};qe.T=N;try{var K=c(T,g),me=qe.S;me!==null&&me(N,K),G(r,s,K)}catch(Be){ee(r,s,Be)}finally{C!==null&&N.types!==null&&(C.types=N.types),qe.T=C}}else try{C=c(T,g),G(r,s,C)}catch(Be){ee(r,s,Be)}}function G(r,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(g){X(r,s,g)},function(g){return ee(r,s,g)}):X(r,s,c)}function X(r,s,c){s.status="fulfilled",s.value=c,ie(s),r.state=c,s=r.pending,s!==null&&(c=s.next,c===s?r.pending=null:(c=c.next,s.next=c,k(r,c)))}function ee(r,s,c){var g=r.pending;if(r.pending=null,g!==null){g=g.next;do s.status="rejected",s.reason=c,ie(s),s=s.next;while(s!==g)}r.action=null}function ie(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function te(r,s){return s}function ae(r,s){if(ti){var c=tn.formState;if(c!==null){e:{var g=$t;if(ti){if(Oi){t:{for(var T=Oi,C=ia;T.nodeType!==8;){if(!C){T=null;break t}if(T=Ka(T.nextSibling),T===null){T=null;break t}}C=T.data,T=C==="F!"||C==="F"?T:null}if(T){Oi=Ka(T.nextSibling),g=T.data==="F!";break e}}Br(g)}g=!1}g&&(s=c[0])}}return c=ur(),c.memoizedState=c.baseState=s,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:te,lastRenderedState:s},c.queue=g,c=hu.bind(null,$t,g),g.dispatch=c,g=I(!1),C=Nr.bind(null,$t,!1,g.queue),g=ur(),T={state:s,dispatch:null,action:r,pending:null},g.queue=T,c=j.bind(null,$t,T,C,c),T.dispatch=c,g.memoizedState=r,[s,c,!1]}function ce(r){var s=en();return re(s,_i,r)}function re(r,s,c){if(s=t(r,s,te)[0],r=m(Za)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var g=fl(s)}catch(N){throw N===Va?Fr:N}else g=s;s=en();var T=s.queue,C=T.dispatch;return c!==s.memoizedState&&($t.flags|=2048,oe(9,{destroy:void 0},ue.bind(null,T,c),null)),[g,C,r]}function ue(r,s){r.action=s}function de(r){var s=en(),c=_i;if(c!==null)return re(s,c,r);en(),s=s.memoizedState,c=en();var g=c.queue.dispatch;return c.memoizedState=r,[s,g,!1]}function oe(r,s,c,g){return r={tag:r,create:c,deps:g,inst:s,next:null},s=$t.updateQueue,s===null&&(s=Ts(),$t.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=r.next=r:(g=c.next,c.next=r,r.next=g,s.lastEffect=r),r}function ye(){return en().memoizedState}function Ie(r,s,c,g){var T=ur();$t.flags|=r,T.memoizedState=oe(1|s,{destroy:void 0},c,g===void 0?null:g)}function Me(r,s,c,g){var T=en();g=g===void 0?null:g;var C=T.memoizedState.inst;_i!==null&&g!==null&&qa(g,_i.memoizedState.deps)?T.memoizedState=oe(s,C,c,g):($t.flags|=r,T.memoizedState=oe(1|s,C,c,g))}function ze(r,s){Ie(8390656,8,r,s)}function Pe(r,s){Me(2048,8,r,s)}function tt(r){$t.flags|=4;var s=$t.updateQueue;if(s===null)s=Ts(),$t.updateQueue=s,s.events=[r];else{var c=s.events;c===null?s.events=[r]:c.push(r)}}function it(r){var s=en().memoizedState;return tt({ref:s,nextImpl:r}),function(){if((ki&2)!==0)throw Error(M(440));return s.impl.apply(void 0,arguments)}}function He(r,s){return Me(4,2,r,s)}function at(r,s){return Me(4,4,r,s)}function Lt(r,s){if(typeof s=="function"){r=r();var c=s(r);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function yi(r,s,c){c=c!=null?c.concat([r]):null,Me(4,4,Lt.bind(null,s,r),c)}function Ui(){}function Li(r,s){var c=en();s=s===void 0?null:s;var g=c.memoizedState;return s!==null&&qa(s,g[1])?g[0]:(c.memoizedState=[r,s],r)}function Xi(r,s){var c=en();s=s===void 0?null:s;var g=c.memoizedState;if(s!==null&&qa(s,g[1]))return g[0];if(g=r(),Ga){De(!0);try{r()}finally{De(!1)}}return c.memoizedState=[g,s],g}function Ai(r,s,c){return c===void 0||(qs&1073741824)!==0&&(oi&261930)===0?r.memoizedState=s:(r.memoizedState=c,r=wg(),$t.lanes|=r,xl|=r,c)}function on(r,s,c,g){return Or(c,s)?c:ll.current!==null?(r=Ai(r,c,g),Or(r,s)||(er=!0),r):(qs&42)===0||(qs&1073741824)!==0&&(oi&261930)===0?(er=!0,r.memoizedState=c):(r=wg(),$t.lanes|=r,xl|=r,s)}function Yi(r,s,c,g,T){var C=ot.p;ot.p=C!==0&&8>C?C:8;var N=qe.T,K={};qe.T=K,Nr(r,!1,s,c);try{var me=T(),Be=qe.S;if(Be!==null&&Be(K,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var Ze=ac(me,g);$a(r,s,Ze,Pa(r))}else $a(r,s,g,Pa(r))}catch(We){$a(r,s,{then:function(){},status:"rejected",reason:We},Pa())}finally{ot.p=C,N!==null&&K.types!==null&&(N.types=K.types),qe.T=N}}function Wn(){}function _n(r,s,c,g){if(r.tag!==5)throw Error(M(476));var T=yn(r).queue;Yi(r,T,s,Pt,c===null?Wn:function(){return Jn(r),c(g)})}function yn(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:Pt,baseState:Pt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:Pt},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Za,lastRenderedState:c},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function Jn(r){var s=yn(r);s.next===null&&(s=r.alternate.memoizedState),$a(r,s.next.queue,{},Pa())}function Ss(){return In(Ih)}function Es(){return en().memoizedState}function Ha(){return en().memoizedState}function jr(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var c=Pa();r=ws(c);var g=Us(s,r,c);g!==null&&(Ia(g,s,c),Ta(g,s,c)),s={cache:_s()},r.payload=s;return}s=s.return}}function pl(r,s,c){var g=Pa();c={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},sa(r)?Ma(s,c):(c=vo(r,s,c,g),c!==null&&(Ia(c,r,g),Aa(c,s,g)))}function hu(r,s,c){var g=Pa();$a(r,s,c,g)}function $a(r,s,c,g){var T={lane:g,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(sa(r))Ma(s,T);else{var C=r.alternate;if(r.lanes===0&&(C===null||C.lanes===0)&&(C=s.lastRenderedReducer,C!==null))try{var N=s.lastRenderedState,K=C(N,c);if(T.hasEagerState=!0,T.eagerState=K,Or(K,N))return ic(r,s,T,0),tn===null&&nl(),!1}catch{}if(c=vo(r,s,T,g),c!==null)return Ia(c,r,g),Aa(c,s,g),!0}return!1}function Nr(r,s,c,g){if(g={lane:2,revertLane:dm(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},sa(r)){if(s)throw Error(M(479))}else s=vo(r,c,g,2),s!==null&&Ia(s,r,2)}function sa(r){var s=r.alternate;return r===$t||s!==null&&s===$t}function Ma(r,s){Ea=Ji=!0;var c=r.pending;c===null?s.next=s:(s.next=c.next,c.next=s),r.pending=s}function Aa(r,s,c){if((c&4194048)!==0){var g=s.lanes;g&=r.pendingLanes,c|=g,s.lanes=c,zn(r,c)}}var wi={readContext:In,use:dl,useCallback:$i,useContext:$i,useEffect:$i,useImperativeHandle:$i,useLayoutEffect:$i,useInsertionEffect:$i,useMemo:$i,useReducer:$i,useRef:$i,useState:$i,useDebugValue:$i,useDeferredValue:$i,useTransition:$i,useSyncExternalStore:$i,useId:$i,useHostTransitionStatus:$i,useFormState:$i,useActionState:$i,useOptimistic:$i,useMemoCache:$i,useCacheRefresh:$i};wi.useEffectEvent=$i;var Bi={readContext:In,use:dl,useCallback:function(r,s){return ur().memoizedState=[r,s===void 0?null:s],r},useContext:In,useEffect:ze,useImperativeHandle:function(r,s,c){c=c!=null?c.concat([r]):null,Ie(4194308,4,Lt.bind(null,s,r),c)},useLayoutEffect:function(r,s){return Ie(4194308,4,r,s)},useInsertionEffect:function(r,s){Ie(4,2,r,s)},useMemo:function(r,s){var c=ur();s=s===void 0?null:s;var g=r();if(Ga){De(!0);try{r()}finally{De(!1)}}return c.memoizedState=[g,s],g},useReducer:function(r,s,c){var g=ur();if(c!==void 0){var T=c(s);if(Ga){De(!0);try{c(s)}finally{De(!1)}}}else T=s;return g.memoizedState=g.baseState=T,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:T},g.queue=r,r=r.dispatch=pl.bind(null,$t,r),[g.memoizedState,r]},useRef:function(r){var s=ur();return r={current:r},s.memoizedState=r},useState:function(r){r=I(r);var s=r.queue,c=hu.bind(null,$t,s);return s.dispatch=c,[r.memoizedState,c]},useDebugValue:Ui,useDeferredValue:function(r,s){var c=ur();return Ai(c,r,s)},useTransition:function(){var r=I(!1);return r=Yi.bind(null,$t,r.queue,!0,!1),ur().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,c){var g=$t,T=ur();if(ti){if(c===void 0)throw Error(M(407));c=c()}else{if(c=s(),tn===null)throw Error(M(349));(oi&127)!==0||f(g,s,c)}T.memoizedState=c;var C={value:c,getSnapshot:s};return T.queue=C,ze(b.bind(null,g,C,r),[r]),g.flags|=2048,oe(9,{destroy:void 0},_.bind(null,g,C,c,s),null),c},useId:function(){var r=ur(),s=tn.identifierPrefix;if(ti){var c=Lr,g=hs;c=(g&~(1<<32-Ue(g)-1)).toString(32)+c,s="_"+s+"R_"+c,c=cl++,0<c&&(s+="H"+c.toString(32)),s+="_"}else c=of++,s="_"+s+"r_"+c.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:Ss,useFormState:ae,useActionState:ae,useOptimistic:function(r){var s=ur();s.memoizedState=s.baseState=r;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=Nr.bind(null,$t,!0,c),c.dispatch=s,[r,s]},useMemoCache:cu,useCacheRefresh:function(){return ur().memoizedState=jr.bind(null,$t)},useEffectEvent:function(r){var s=ur(),c={impl:r};return s.memoizedState=c,function(){if((ki&2)!==0)throw Error(M(440));return c.impl.apply(void 0,arguments)}}},Rn={readContext:In,use:dl,useCallback:Li,useContext:In,useEffect:Pe,useImperativeHandle:yi,useInsertionEffect:He,useLayoutEffect:at,useMemo:Xi,useReducer:m,useRef:ye,useState:function(){return m(Za)},useDebugValue:Ui,useDeferredValue:function(r,s){var c=en();return on(c,_i.memoizedState,r,s)},useTransition:function(){var r=m(Za)[0],s=en().memoizedState;return[typeof r=="boolean"?r:fl(r),s]},useSyncExternalStore:l,useId:Es,useHostTransitionStatus:Ss,useFormState:ce,useActionState:ce,useOptimistic:function(r,s){var c=en();return O(c,_i,r,s)},useMemoCache:cu,useCacheRefresh:Ha};Rn.useEffectEvent=it;var Fn={readContext:In,use:dl,useCallback:Li,useContext:In,useEffect:Pe,useImperativeHandle:yi,useInsertionEffect:He,useLayoutEffect:at,useMemo:Xi,useReducer:a,useRef:ye,useState:function(){return a(Za)},useDebugValue:Ui,useDeferredValue:function(r,s){var c=en();return _i===null?Ai(c,r,s):on(c,_i.memoizedState,r,s)},useTransition:function(){var r=a(Za)[0],s=en().memoizedState;return[typeof r=="boolean"?r:fl(r),s]},useSyncExternalStore:l,useId:Es,useHostTransitionStatus:Ss,useFormState:de,useActionState:de,useOptimistic:function(r,s){var c=en();return _i!==null?O(c,_i,r,s):(c.baseState=r,[r,c.queue.dispatch])},useMemoCache:cu,useCacheRefresh:Ha};Fn.useEffectEvent=it;function hh(r,s,c,g){s=r.memoizedState,c=c(g,s),c=c==null?s:Xe({},s,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var fh={enqueueSetState:function(r,s,c){r=r._reactInternals;var g=Pa(),T=ws(g);T.payload=s,c!=null&&(T.callback=c),s=Us(r,T,g),s!==null&&(Ia(s,r,g),Ta(s,r,g))},enqueueReplaceState:function(r,s,c){r=r._reactInternals;var g=Pa(),T=ws(g);T.tag=1,T.payload=s,c!=null&&(T.callback=c),s=Us(r,T,g),s!==null&&(Ia(s,r,g),Ta(s,r,g))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var c=Pa(),g=ws(c);g.tag=2,s!=null&&(g.callback=s),s=Us(r,g,c),s!==null&&(Ia(s,r,c),Ta(s,r,c))}};function Co(r,s,c,g,T,C,N){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,C,N):s.prototype&&s.prototype.isPureReactComponent?!yo(c,g)||!yo(T,C):!0}function Ad(r,s,c,g){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,g),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,g),s.state!==r&&fh.enqueueReplaceState(s,s.state,null)}function Do(r,s){var c=s;if("ref"in s){c={};for(var g in s)g!=="ref"&&(c[g]=s[g])}if(r=r.defaultProps){c===s&&(c=Xe({},c));for(var T in r)c[T]===void 0&&(c[T]=r[T])}return c}function dh(r){us(r)}function $s(r){console.error(r)}function Xs(r){us(r)}function Xa(r,s){try{var c=r.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(g){setTimeout(function(){throw g})}}function ph(r,s,c){try{var g=r.onCaughtError;g(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function _c(r,s,c){return c=ws(c),c.tag=3,c.payload={element:null},c.callback=function(){Xa(r,s)},c}function yc(r){return r=ws(r),r.tag=3,r}function vc(r,s,c,g){var T=c.type.getDerivedStateFromError;if(typeof T=="function"){var C=g.value;r.payload=function(){return T(C)},r.callback=function(){ph(s,c,g)}}var N=c.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(r.callback=function(){ph(s,c,g),typeof T!="function"&&(wl===null?wl=new Set([this]):wl.add(this));var K=g.stack;this.componentDidCatch(g.value,{componentStack:K!==null?K:""})})}function Cd(r,s,c,g,T){if(c.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(s=c.alternate,s!==null&&na(s,c,T,!0),c=ft.current,c!==null){switch(c.tag){case 31:case 13:return _t===null?Mf():c.alternate===null&&On===0&&(On=3),c.flags&=-257,c.flags|=65536,c.lanes=T,g===ut?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([g]):s.add(g),Jd(r,g,T)),!1;case 22:return c.flags|=65536,g===ut?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([g])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([g]):c.add(g)),Jd(r,g,T)),!1}throw Error(M(435,c.tag))}return Jd(r,g,T),Mf(),!1}if(ti)return s=ft.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=T,g!==an&&(r=Error(M(422),{cause:g}),Fs(zr(r,c)))):(g!==an&&(s=Error(M(423),{cause:g}),Fs(zr(s,c))),r=r.current.alternate,r.flags|=65536,T&=-T,r.lanes|=T,g=zr(g,c),T=_c(r.stateNode,g,T),xi(r,T),On!==4&&(On=2)),!1;var C=Error(M(520),{cause:g});if(C=zr(C,c),wf===null?wf=[C]:wf.push(C),On!==4&&(On=2),s===null)return!0;g=zr(g,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,r=T&-T,c.lanes|=r,r=_c(c.stateNode,g,r),xi(c,r),!1;case 1:if(s=c.type,C=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(wl===null||!wl.has(C))))return c.flags|=65536,T&=-T,c.lanes|=T,T=yc(T),vc(T,r,c,g),xi(c,T),!1}c=c.return}while(c!==null);return!1}var Dd=Error(M(461)),er=!1;function cr(r,s,c,g){s.child=r===null?rf(s,null,c,g):bs(s,r.child,c,g)}function ag(r,s,c,g,T){c=c.render;var C=s.ref;if("ref"in g){var N={};for(var K in g)K!=="ref"&&(N[K]=g[K])}else N=g;return Vs(s),g=lu(r,s,c,N,C,T),K=gc(),r!==null&&!er?(Ao(r,s,T),Po(r,s,T)):(ti&&K&&al(s),s.flags|=1,cr(r,s,g,T),s.child)}function zd(r,s,c,g,T){if(r===null){var C=c.type;return typeof C=="function"&&!Wc(C)&&C.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=C,Up(r,s,C,g,T)):(r=Jc(c.type,null,g,s,s.mode,T),r.ref=s.ref,r.return=s,s.child=r)}if(C=r.child,!cf(r,T)){var N=C.memoizedProps;if(c=c.compare,c=c!==null?c:yo,c(N,g)&&r.ref===s.ref)return Po(r,s,T)}return s.flags|=1,r=ta(C,g),r.ref=s.ref,r.return=s,s.child=r}function Up(r,s,c,g,T){if(r!==null){var C=r.memoizedProps;if(yo(C,g)&&r.ref===s.ref)if(er=!1,s.pendingProps=g=C,cf(r,T))(r.flags&131072)!==0&&(er=!0);else return s.lanes=r.lanes,Po(r,s,T)}return qp(r,s,c,g,T)}function Gp(r,s,c,g){var T=g.children,C=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((s.flags&128)!==0){if(C=C!==null?C.baseLanes|c:c,r!==null){for(g=s.child=r.child,T=0;g!==null;)T=T|g.lanes|g.childLanes,g=g.sibling;g=T&~C}else g=0,s.child=null;return sg(r,s,C,c,g)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&ah(s,C!==null?C.cachePool:null),C!==null?sf(s,C):aa(),fc(s);else return g=s.lanes=536870912,sg(r,s,C!==null?C.baseLanes|c:c,c,g)}else C!==null?(ah(s,C.cachePool),sf(s,C),Sn(),s.memoizedState=null):(r!==null&&ah(s,null),aa(),Sn());return cr(r,s,T,c),s.child}function zo(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function sg(r,s,c,g,T){var C=rh();return C=C===null?null:{parent:Tn._currentValue,pool:C},s.memoizedState={baseLanes:c,cachePool:C},r!==null&&ah(s,null),aa(),fc(s),r!==null&&na(r,s,g,!0),s.childLanes=T,null}function ml(r,s){return s=Ld({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function lf(r,s,c){return bs(s,r.child,null,c),r=ml(s,s.pendingProps),r.flags|=2,sn(s),s.memoizedState=null,r}function Pd(r,s,c){var g=s.pendingProps,T=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(ti){if(g.mode==="hidden")return r=ml(s,g),s.lanes=536870912,zo(null,r);if(ou(s),(r=Oi)?(r=xu(r,ia),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:hs,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},c=eh(r),c.return=s,s.child=c,Kn=s,Oi=null)):r=null,r===null)throw Br(s);return s.lanes=536870912,null}return ml(s,g)}var C=r.memoizedState;if(C!==null){var N=C.dehydrated;if(ou(s),T)if(s.flags&256)s.flags&=-257,s=lf(r,s,c);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(M(558));else if(er||na(r,s,c,!1),T=(c&r.childLanes)!==0,er||T){if(g=tn,g!==null&&(N=jl(g,c),N!==0&&N!==C.retryLane))throw C.retryLane=N,ba(r,N),Ia(g,r,N),Dd;Mf(),s=lf(r,s,c)}else r=C.treeContext,Oi=Ka(N.nextSibling),Kn=s,ti=!0,ks=null,ia=!1,r!==null&&ef(s,r),s=ml(s,g),s.flags|=4096;return s}return r=ta(r.child,{mode:g.mode,children:g.children}),r.ref=s.ref,s.child=r,r.return=s,r}function Id(r,s){var c=s.ref;if(c===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(M(284));(r===null||r.ref!==c)&&(s.flags|=4194816)}}function qp(r,s,c,g,T){return Vs(s),c=lu(r,s,c,g,void 0,T),g=gc(),r!==null&&!er?(Ao(r,s,T),Po(r,s,T)):(ti&&g&&al(s),s.flags|=1,cr(r,s,c,T),s.child)}function og(r,s,c,g,T,C){return Vs(s),s.updateQueue=null,c=pc(s,g,c,T),uu(r),g=gc(),r!==null&&!er?(Ao(r,s,C),Po(r,s,C)):(ti&&g&&al(s),s.flags|=1,cr(r,s,c,C),s.child)}function lg(r,s,c,g,T){if(Vs(s),s.stateNode===null){var C=Ut,N=c.contextType;typeof N=="object"&&N!==null&&(C=In(N)),C=new c(g,C),s.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=fh,s.stateNode=C,C._reactInternals=s,C=s.stateNode,C.props=g,C.state=s.memoizedState,C.refs={},uh(s),N=c.contextType,C.context=typeof N=="object"&&N!==null?In(N):Ut,C.state=s.memoizedState,N=c.getDerivedStateFromProps,typeof N=="function"&&(hh(s,c,N,g),C.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(N=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),N!==C.state&&fh.enqueueReplaceState(C,C.state,null),Mo(s,g,C,T),Gs(),C.state=s.memoizedState),typeof C.componentDidMount=="function"&&(s.flags|=4194308),g=!0}else if(r===null){C=s.stateNode;var K=s.memoizedProps,me=Do(c,K);C.props=me;var Be=C.context,Ze=c.contextType;N=Ut,typeof Ze=="object"&&Ze!==null&&(N=In(Ze));var We=c.getDerivedStateFromProps;Ze=typeof We=="function"||typeof C.getSnapshotBeforeUpdate=="function",K=s.pendingProps!==K,Ze||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(K||Be!==N)&&Ad(s,C,g,N),xs=!1;var ke=s.memoizedState;C.state=ke,Mo(s,g,C,T),Gs(),Be=s.memoizedState,K||ke!==Be||xs?(typeof We=="function"&&(hh(s,c,We,g),Be=s.memoizedState),(me=xs||Co(s,c,me,g,ke,Be,N))?(Ze||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(s.flags|=4194308)):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=g,s.memoizedState=Be),C.props=g,C.state=Be,C.context=N,g=me):(typeof C.componentDidMount=="function"&&(s.flags|=4194308),g=!1)}else{C=s.stateNode,uc(r,s),N=s.memoizedProps,Ze=Do(c,N),C.props=Ze,We=s.pendingProps,ke=C.context,Be=c.contextType,me=Ut,typeof Be=="object"&&Be!==null&&(me=In(Be)),K=c.getDerivedStateFromProps,(Be=typeof K=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(N!==We||ke!==me)&&Ad(s,C,g,me),xs=!1,ke=s.memoizedState,C.state=ke,Mo(s,g,C,T),Gs();var je=s.memoizedState;N!==We||ke!==je||xs||r!==null&&r.dependencies!==null&&nu(r.dependencies)?(typeof K=="function"&&(hh(s,c,K,g),je=s.memoizedState),(Ze=xs||Co(s,c,Ze,g,ke,je,me)||r!==null&&r.dependencies!==null&&nu(r.dependencies))?(Be||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,je,me),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,je,me)),typeof C.componentDidUpdate=="function"&&(s.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof C.componentDidUpdate!="function"||N===r.memoizedProps&&ke===r.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ke===r.memoizedState||(s.flags|=1024),s.memoizedProps=g,s.memoizedState=je),C.props=g,C.state=je,C.context=me,g=Ze):(typeof C.componentDidUpdate!="function"||N===r.memoizedProps&&ke===r.memoizedState||(s.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ke===r.memoizedState||(s.flags|=1024),g=!1)}return C=g,Id(r,s),g=(s.flags&128)!==0,C||g?(C=s.stateNode,c=g&&typeof c.getDerivedStateFromError!="function"?null:C.render(),s.flags|=1,r!==null&&g?(s.child=bs(s,r.child,null,T),s.child=bs(s,null,c,T)):cr(r,s,c,T),s.memoizedState=C.state,r=s.child):r=Po(r,s,T),r}function ug(r,s,c,g){return ds(),s.flags|=256,cr(r,s,c,g),s.child}var Rd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function uf(r){return{baseLanes:r,cachePool:Md()}}function Od(r,s,c){return r=r!==null?r.childLanes&~c:0,s&&(r|=Pr),r}function Zp(r,s,c){var g=s.pendingProps,T=!1,C=(s.flags&128)!==0,N;if((N=C)||(N=r!==null&&r.memoizedState===null?!1:(gn.current&2)!==0),N&&(T=!0,s.flags&=-129),N=(s.flags&32)!==0,s.flags&=-33,r===null){if(ti){if(T?Sa(s):Sn(),(r=Oi)?(r=xu(r,ia),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:cs!==null?{id:hs,overflow:Lr}:null,retryLane:536870912,hydrationErrors:null},c=eh(r),c.return=s,s.child=c,Kn=s,Oi=null)):r=null,r===null)throw Br(s);return jn(r)?s.lanes=32:s.lanes=536870912,null}var K=g.children;return g=g.fallback,T?(Sn(),T=s.mode,K=Ld({mode:"hidden",children:K},T),g=bo(g,T,c,null),K.return=s,g.return=s,K.sibling=g,s.child=K,g=s.child,g.memoizedState=uf(c),g.childLanes=Od(r,N,c),s.memoizedState=Rd,zo(null,g)):(Sa(s),Hp(s,K))}var me=r.memoizedState;if(me!==null&&(K=me.dehydrated,K!==null)){if(C)s.flags&256?(Sa(s),s.flags&=-257,s=Bd(r,s,c)):s.memoizedState!==null?(Sn(),s.child=r.child,s.flags|=128,s=null):(Sn(),K=g.fallback,T=s.mode,g=Ld({mode:"visible",children:g.children},T),K=bo(K,T,c,null),K.flags|=2,g.return=s,K.return=s,g.sibling=K,s.child=g,bs(s,r.child,null,c),g=s.child,g.memoizedState=uf(c),g.childLanes=Od(r,N,c),s.memoizedState=Rd,s=zo(null,g));else if(Sa(s),jn(K)){if(N=K.nextSibling&&K.nextSibling.dataset,N)var Be=N.dgst;N=Be,g=Error(M(419)),g.stack="",g.digest=N,Fs({value:g,source:null,stack:null}),s=Bd(r,s,c)}else if(er||na(r,s,c,!1),N=(c&r.childLanes)!==0,er||N){if(N=tn,N!==null&&(g=jl(N,c),g!==0&&g!==me.retryLane))throw me.retryLane=g,ba(r,g),Ia(N,r,g),Dd;Ur(K)||Mf(),s=Bd(r,s,c)}else Ur(K)?(s.flags|=192,s.child=r.child,s=null):(r=me.treeContext,Oi=Ka(K.nextSibling),Kn=s,ti=!0,ks=null,ia=!1,r!==null&&ef(s,r),s=Hp(s,g.children),s.flags|=4096);return s}return T?(Sn(),K=g.fallback,T=s.mode,me=r.child,Be=me.sibling,g=ta(me,{mode:"hidden",children:g.children}),g.subtreeFlags=me.subtreeFlags&65011712,Be!==null?K=ta(Be,K):(K=bo(K,T,c,null),K.flags|=2),K.return=s,g.return=s,g.sibling=K,s.child=g,zo(null,g),g=s.child,K=r.child.memoizedState,K===null?K=uf(c):(T=K.cachePool,T!==null?(me=Tn._currentValue,T=T.parent!==me?{parent:me,pool:me}:T):T=Md(),K={baseLanes:K.baseLanes|c,cachePool:T}),g.memoizedState=K,g.childLanes=Od(r,N,c),s.memoizedState=Rd,zo(r.child,g)):(Sa(s),c=r.child,r=c.sibling,c=ta(c,{mode:"visible",children:g.children}),c.return=s,c.sibling=null,r!==null&&(N=s.deletions,N===null?(s.deletions=[r],s.flags|=16):N.push(r)),s.child=c,s.memoizedState=null,c)}function Hp(r,s){return s=Ld({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function Ld(r,s){return r=ea(22,r,null,s),r.lanes=0,r}function Bd(r,s,c){return bs(s,r.child,null,c),r=Hp(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function $p(r,s,c){r.lanes|=s;var g=r.alternate;g!==null&&(g.lanes|=s),th(r.return,s,c)}function Xp(r,s,c,g,T,C){var N=r.memoizedState;N===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:g,tail:c,tailMode:T,treeForkCount:C}:(N.isBackwards=s,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=c,N.tailMode=T,N.treeForkCount=C)}function kd(r,s,c){var g=s.pendingProps,T=g.revealOrder,C=g.tail;g=g.children;var N=gn.current,K=(N&2)!==0;if(K?(N=N&1|2,s.flags|=128):N&=1,pt(gn,N),cr(r,s,g,c),g=ti?So:0,!K&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&$p(r,c,s);else if(r.tag===19)$p(r,c,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(T){case"forwards":for(c=s.child,T=null;c!==null;)r=c.alternate,r!==null&&dc(r)===null&&(T=c),c=c.sibling;c=T,c===null?(T=s.child,s.child=null):(T=c.sibling,c.sibling=null),Xp(s,!1,T,c,C,g);break;case"backwards":case"unstable_legacy-backwards":for(c=null,T=s.child,s.child=null;T!==null;){if(r=T.alternate,r!==null&&dc(r)===null){s.child=T;break}r=T.sibling,T.sibling=c,c=T,T=r}Xp(s,!0,c,null,C,g);break;case"together":Xp(s,!1,null,null,void 0,g);break;default:s.memoizedState=null}return s.child}function Po(r,s,c){if(r!==null&&(s.dependencies=r.dependencies),xl|=s.lanes,(c&s.childLanes)===0)if(r!==null){if(na(r,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(M(153));if(s.child!==null){for(r=s.child,c=ta(r,r.pendingProps),s.child=c,c.return=s;r.sibling!==null;)r=r.sibling,c=c.sibling=ta(r,r.pendingProps),c.return=s;c.sibling=null}return s.child}function cf(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&nu(r)))}function hf(r,s,c){switch(s.tag){case 3:Pi(s,s.stateNode.containerInfo),Ns(s,Tn,r.memoizedState.cache),ds();break;case 27:case 5:Tr(s);break;case 4:Pi(s,s.stateNode.containerInfo);break;case 10:Ns(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,ou(s),null;break;case 13:var g=s.memoizedState;if(g!==null)return g.dehydrated!==null?(Sa(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Zp(r,s,c):(Sa(s),r=Po(r,s,c),r!==null?r.sibling:null);Sa(s);break;case 19:var T=(r.flags&128)!==0;if(g=(c&s.childLanes)!==0,g||(na(r,s,c,!1),g=(c&s.childLanes)!==0),T){if(g)return kd(r,s,c);s.flags|=128}if(T=s.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),pt(gn,gn.current),g)break;return null;case 22:return s.lanes=0,Gp(r,s,c,s.pendingProps);case 24:Ns(s,Tn,r.memoizedState.cache)}return Po(r,s,c)}function Vr(r,s,c){if(r!==null)if(r.memoizedProps!==s.pendingProps)er=!0;else{if(!cf(r,c)&&(s.flags&128)===0)return er=!1,hf(r,s,c);er=(r.flags&131072)!==0}else er=!1,ti&&(s.flags&1048576)!==0&&Jh(s,So,s.index);switch(s.lanes=0,s.tag){case 16:e:{var g=s.pendingProps;if(r=wa(s.elementType),s.type=r,typeof r=="function")Wc(r)?(g=Do(r,g),s.tag=1,s=lg(null,s,r,g,c)):(s.tag=0,s=qp(null,s,r,g,c));else{if(r!=null){var T=r.$$typeof;if(T===Kt){s.tag=11,s=ag(null,s,r,g,c);break e}else if(T===St){s.tag=14,s=zd(null,s,r,g,c);break e}}throw s=$r(r)||r,Error(M(306,s,""))}}return s;case 0:return qp(r,s,s.type,s.pendingProps,c);case 1:return g=s.type,T=Do(g,s.pendingProps),lg(r,s,g,T,c);case 3:e:{if(Pi(s,s.stateNode.containerInfo),r===null)throw Error(M(387));g=s.pendingProps;var C=s.memoizedState;T=C.element,uc(r,s),Mo(s,g,null,c);var N=s.memoizedState;if(g=N.cache,Ns(s,Tn,g),g!==C.cache&&ih(s,[Tn],c,!0),Gs(),g=N.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:N.cache},s.updateQueue.baseState=C,s.memoizedState=C,s.flags&256){s=ug(r,s,g,c);break e}else if(g!==T){T=zr(Error(M(424)),s),Fs(T),s=ug(r,s,g,c);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Oi=Ka(r.firstChild),Kn=s,ti=!0,ks=null,ia=!0,c=rf(s,null,g,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(ds(),g===T){s=Po(r,s,c);break e}cr(r,s,g,c)}s=s.child}return s;case 26:return Id(r,s),r===null?(c=Cm(s.type,null,s.pendingProps,null))?s.memoizedState=c:ti||(c=s.type,r=s.pendingProps,g=If(Vt.current).createElement(c),g[Vi]=s,g[nt]=r,fr(g,c,r),dn(g),s.stateNode=g):s.memoizedState=Cm(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return Tr(s),r===null&&ti&&(g=s.stateNode=Gg(s.type,s.pendingProps,Vt.current),Kn=s,ia=!0,T=Oi,bu(s.type)?(ca=T,Oi=Ka(g.firstChild)):Oi=T),cr(r,s,s.pendingProps.children,c),Id(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&ti&&((T=g=Oi)&&(g=yr(g,s.type,s.pendingProps,ia),g!==null?(s.stateNode=g,Kn=s,Oi=Ka(g.firstChild),ia=!1,T=!0):T=!1),T||Br(s)),Tr(s),T=s.type,C=s.pendingProps,N=r!==null?r.memoizedProps:null,g=C.children,cp(T,C)?g=null:N!==null&&cp(T,N)&&(s.flags|=32),s.memoizedState!==null&&(T=lu(r,s,mc,null,null,c),Ih._currentValue=T),Id(r,s),cr(r,s,g,c),s.child;case 6:return r===null&&ti&&((r=c=Oi)&&(c=Js(c,s.pendingProps,ia),c!==null?(s.stateNode=c,Kn=s,Oi=null,r=!0):r=!1),r||Br(s)),null;case 13:return Zp(r,s,c);case 4:return Pi(s,s.stateNode.containerInfo),g=s.pendingProps,r===null?s.child=bs(s,null,g,c):cr(r,s,g,c),s.child;case 11:return ag(r,s,s.type,s.pendingProps,c);case 7:return cr(r,s,s.pendingProps,c),s.child;case 8:return cr(r,s,s.pendingProps.children,c),s.child;case 12:return cr(r,s,s.pendingProps.children,c),s.child;case 10:return g=s.pendingProps,Ns(s,s.type,g.value),cr(r,s,g.children,c),s.child;case 9:return T=s.type._context,g=s.pendingProps.children,Vs(s),T=In(T),g=g(T),s.flags|=1,cr(r,s,g,c),s.child;case 14:return zd(r,s,s.type,s.pendingProps,c);case 15:return Up(r,s,s.type,s.pendingProps,c);case 19:return kd(r,s,c);case 31:return Pd(r,s,c);case 22:return Gp(r,s,c,s.pendingProps);case 24:return Vs(s),g=In(Tn),r===null?(T=rh(),T===null&&(T=tn,C=_s(),T.pooledCache=C,C.refCount++,C!==null&&(T.pooledCacheLanes|=c),T=C),s.memoizedState={parent:g,cache:T},uh(s),Ns(s,Tn,T)):((r.lanes&c)!==0&&(uc(r,s),Mo(s,null,null,c),Gs()),T=r.memoizedState,C=s.memoizedState,T.parent!==g?(T={parent:g,cache:g},s.memoizedState=T,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=T),Ns(s,Tn,g)):(g=C.cache,Ns(s,Tn,g),g!==T.cache&&ih(s,[Tn],c,!0))),cr(r,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(M(156,s.tag))}function Io(r){r.flags|=4}function ff(r,s,c,g,T){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(T&335544128)===T)if(r.stateNode.complete)r.flags|=8192;else if(sm())r.flags|=8192;else throw Ua=ut,Eo}else r.flags&=-16777217}function cg(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Bf(s))if(sm())r.flags|=8192;else throw Ua=ut,Eo}function df(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?bi():536870912,r.lanes|=s,Sc|=s)}function pf(r,s){if(!ti)switch(r.tailMode){case"hidden":s=r.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function vn(r){var s=r.alternate!==null&&r.alternate.child===r.child,c=0,g=0;if(s)for(var T=r.child;T!==null;)c|=T.lanes|T.childLanes,g|=T.subtreeFlags&65011712,g|=T.flags&65011712,T.return=r,T=T.sibling;else for(T=r.child;T!==null;)c|=T.lanes|T.childLanes,g|=T.subtreeFlags,g|=T.flags,T.return=r,T=T.sibling;return r.subtreeFlags|=g,r.childLanes=c,s}function hg(r,s,c){var g=s.pendingProps;switch(iu(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vn(s),null;case 1:return vn(s),null;case 3:return c=s.stateNode,g=null,r!==null&&(g=r.memoizedState.cache),s.memoizedState.cache!==g&&(s.flags|=2048),gs(Tn),qi(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(r===null||r.child===null)&&(fs(s)?Io(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,ps())),vn(s),null;case 26:var T=s.type,C=s.memoizedState;return r===null?(Io(s),C!==null?(vn(s),cg(s,C)):(vn(s),ff(s,T,null,g,c))):C?C!==r.memoizedState?(Io(s),vn(s),cg(s,C)):(vn(s),s.flags&=-16777217):(r=r.memoizedProps,r!==g&&Io(s),vn(s),ff(s,T,r,g,c)),null;case 27:if(ao(s),c=Vt.current,T=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==g&&Io(s);else{if(!g){if(s.stateNode===null)throw Error(M(166));return vn(s),null}r=bt.current,fs(s)?kr(s):(r=Gg(T,g,c),s.stateNode=r,Io(s))}return vn(s),null;case 5:if(ao(s),T=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==g&&Io(s);else{if(!g){if(s.stateNode===null)throw Error(M(166));return vn(s),null}if(C=bt.current,fs(s))kr(s);else{var N=If(Vt.current);switch(C){case 1:C=N.createElementNS("http://www.w3.org/2000/svg",T);break;case 2:C=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;default:switch(T){case"svg":C=N.createElementNS("http://www.w3.org/2000/svg",T);break;case"math":C=N.createElementNS("http://www.w3.org/1998/Math/MathML",T);break;case"script":C=N.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof g.is=="string"?N.createElement("select",{is:g.is}):N.createElement("select"),g.multiple?C.multiple=!0:g.size&&(C.size=g.size);break;default:C=typeof g.is=="string"?N.createElement(T,{is:g.is}):N.createElement(T)}}C[Vi]=s,C[nt]=g;e:for(N=s.child;N!==null;){if(N.tag===5||N.tag===6)C.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===s)break e;for(;N.sibling===null;){if(N.return===null||N.return===s)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}s.stateNode=C;e:switch(fr(C,T,g),T){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Io(s)}}return vn(s),ff(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,c),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==g&&Io(s);else{if(typeof g!="string"&&s.stateNode===null)throw Error(M(166));if(r=Vt.current,fs(s)){if(r=s.stateNode,c=s.memoizedProps,g=null,T=Kn,T!==null)switch(T.tag){case 27:case 5:g=T.memoizedProps}r[Vi]=s,r=!!(r.nodeValue===c||g!==null&&g.suppressHydrationWarning===!0||ym(r.nodeValue,c)),r||Br(s,!0)}else r=If(r).createTextNode(g),r[Vi]=s,s.stateNode=r}return vn(s),null;case 31:if(c=s.memoizedState,r===null||r.memoizedState!==null){if(g=fs(s),c!==null){if(r===null){if(!g)throw Error(M(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(M(557));r[Vi]=s}else ds(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;vn(s),r=!1}else c=ps(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=c),r=!0;if(!r)return s.flags&256?(sn(s),s):(sn(s),null);if((s.flags&128)!==0)throw Error(M(558))}return vn(s),null;case 13:if(g=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(T=fs(s),g!==null&&g.dehydrated!==null){if(r===null){if(!T)throw Error(M(318));if(T=s.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(M(317));T[Vi]=s}else ds(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;vn(s),T=!1}else T=ps(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=T),T=!0;if(!T)return s.flags&256?(sn(s),s):(sn(s),null)}return sn(s),(s.flags&128)!==0?(s.lanes=c,s):(c=g!==null,r=r!==null&&r.memoizedState!==null,c&&(g=s.child,T=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(T=g.alternate.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==T&&(g.flags|=2048)),c!==r&&c&&(s.child.flags|=8192),df(s,s.updateQueue),vn(s),null);case 4:return qi(),r===null&&gm(s.stateNode.containerInfo),vn(s),null;case 10:return gs(s.type),vn(s),null;case 19:if(Ke(gn),g=s.memoizedState,g===null)return vn(s),null;if(T=(s.flags&128)!==0,C=g.rendering,C===null)if(T)pf(g,!1);else{if(On!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(C=dc(r),C!==null){for(s.flags|=128,pf(g,!1),r=C.updateQueue,s.updateQueue=r,df(s,r),s.subtreeFlags=0,r=c,c=s.child;c!==null;)Sd(c,r),c=c.sibling;return pt(gn,gn.current&1|2),ti&&Bs(s,g.treeForkCount),s.child}r=r.sibling}g.tail!==null&&Yn()>Tf&&(s.flags|=128,T=!0,pf(g,!1),s.lanes=4194304)}else{if(!T)if(r=dc(C),r!==null){if(s.flags|=128,T=!0,r=r.updateQueue,s.updateQueue=r,df(s,r),pf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!C.alternate&&!ti)return vn(s),null}else 2*Yn()-g.renderingStartTime>Tf&&c!==536870912&&(s.flags|=128,T=!0,pf(g,!1),s.lanes=4194304);g.isBackwards?(C.sibling=s.child,s.child=C):(r=g.last,r!==null?r.sibling=C:s.child=C,g.last=C)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=Yn(),r.sibling=null,c=gn.current,pt(gn,T?c&1|2:c&1),ti&&Bs(s,g.treeForkCount),r):(vn(s),null);case 22:case 23:return sn(s),ul(),g=s.memoizedState!==null,r!==null?r.memoizedState!==null!==g&&(s.flags|=8192):g&&(s.flags|=8192),g?(c&536870912)!==0&&(s.flags&128)===0&&(vn(s),s.subtreeFlags&6&&(s.flags|=8192)):vn(s),c=s.updateQueue,c!==null&&df(s,c.retryQueue),c=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),g=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(g=s.memoizedState.cachePool.pool),g!==c&&(s.flags|=2048),r!==null&&Ke(Na),null;case 24:return c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),gs(Tn),vn(s),null;case 25:return null;case 30:return null}throw Error(M(156,s.tag))}function R_(r,s){switch(iu(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return gs(Tn),qi(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return ao(s),null;case 31:if(s.memoizedState!==null){if(sn(s),s.alternate===null)throw Error(M(340));ds()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(sn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(M(340));ds()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return Ke(gn),null;case 4:return qi(),null;case 10:return gs(s.type),null;case 22:case 23:return sn(s),ul(),r!==null&&Ke(Na),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return gs(Tn),null;case 25:return null;default:return null}}function Fd(r,s){switch(iu(s),s.tag){case 3:gs(Tn),qi();break;case 26:case 27:case 5:ao(s);break;case 4:qi();break;case 31:s.memoizedState!==null&&sn(s);break;case 13:sn(s);break;case 19:Ke(gn);break;case 10:gs(s.type);break;case 22:case 23:sn(s),ul(),r!==null&&Ke(Na);break;case 24:gs(Tn)}}function mh(r,s){try{var c=s.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var T=g.next;c=T;do{if((c.tag&r)===r){g=void 0;var C=c.create,N=c.inst;g=C(),N.destroy=g}c=c.next}while(c!==T)}}catch(K){Fi(s,s.return,K)}}function gl(r,s,c){try{var g=s.updateQueue,T=g!==null?g.lastEffect:null;if(T!==null){var C=T.next;g=C;do{if((g.tag&r)===r){var N=g.inst,K=N.destroy;if(K!==void 0){N.destroy=void 0,T=s;var me=c,Be=K;try{Be()}catch(Ze){Fi(T,me,Ze)}}}g=g.next}while(g!==C)}}catch(Ze){Fi(s,s.return,Ze)}}function fg(r){var s=r.updateQueue;if(s!==null){var c=r.stateNode;try{ch(s,c)}catch(g){Fi(r,r.return,g)}}}function dg(r,s,c){c.props=Do(r.type,r.memoizedProps),c.state=r.memoizedState;try{c.componentWillUnmount()}catch(g){Fi(r,s,g)}}function mf(r,s){try{var c=r.ref;if(c!==null){switch(r.tag){case 26:case 27:case 5:var g=r.stateNode;break;case 30:g=r.stateNode;break;default:g=r.stateNode}typeof c=="function"?r.refCleanup=c(g):c.current=g}}catch(T){Fi(r,s,T)}}function Ya(r,s){var c=r.ref,g=r.refCleanup;if(c!==null)if(typeof g=="function")try{g()}catch(T){Fi(r,s,T)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(T){Fi(r,s,T)}else c.current=null}function jd(r){var s=r.type,c=r.memoizedProps,g=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&g.focus();break e;case"img":c.src?g.src=c.src:c.srcSet&&(g.srcset=c.srcSet)}}catch(T){Fi(r,r.return,T)}}function Nd(r,s,c){try{var g=r.stateNode;Vg(g,r.type,c,s),g[nt]=s}catch(T){Fi(r,r.return,T)}}function fu(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&bu(r.type)||r.tag===4}function bc(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||fu(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&bu(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Yp(r,s,c){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(r,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(r),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Fa));else if(g!==4&&(g===27&&bu(r.type)&&(c=r.stateNode,s=null),r=r.child,r!==null))for(Yp(r,s,c),r=r.sibling;r!==null;)Yp(r,s,c),r=r.sibling}function Vd(r,s,c){var g=r.tag;if(g===5||g===6)r=r.stateNode,s?c.insertBefore(r,s):c.appendChild(r);else if(g!==4&&(g===27&&bu(r.type)&&(c=r.stateNode),r=r.child,r!==null))for(Vd(r,s,c),r=r.sibling;r!==null;)Vd(r,s,c),r=r.sibling}function pg(r){var s=r.stateNode,c=r.memoizedProps;try{for(var g=r.type,T=s.attributes;T.length;)s.removeAttributeNode(T[0]);fr(s,g,c),s[Vi]=r,s[nt]=c}catch(C){Fi(r,r.return,C)}}var _l=!1,tr=!1,Qp=!1,mg=typeof WeakSet=="function"?WeakSet:Set,ir=null;function O_(r,s){if(r=r.containerInfo,Pf=Vf,r=Hc(r),Qu(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var g=c.getSelection&&c.getSelection();if(g&&g.rangeCount!==0){c=g.anchorNode;var T=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var N=0,K=-1,me=-1,Be=0,Ze=0,We=r,ke=null;t:for(;;){for(var je;We!==c||T!==0&&We.nodeType!==3||(K=N+T),We!==C||g!==0&&We.nodeType!==3||(me=N+g),We.nodeType===3&&(N+=We.nodeValue.length),(je=We.firstChild)!==null;)ke=We,We=je;for(;;){if(We===r)break t;if(ke===c&&++Be===T&&(K=N),ke===C&&++Ze===g&&(me=N),(je=We.nextSibling)!==null)break;We=ke,ke=We.parentNode}We=je}c=K===-1||me===-1?null:{start:K,end:me}}else c=null}c=c||{start:0,end:0}}else c=null;for(vm={focusedElem:r,selectionRange:c},Vf=!1,ir=s;ir!==null;)if(s=ir,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,ir=r;else for(;ir!==null;){switch(s=ir,C=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(c=0;c<r.length;c++)T=r[c],T.ref.impl=T.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&C!==null){r=void 0,c=s,T=C.memoizedProps,C=C.memoizedState,g=c.stateNode;try{var xt=Do(c.type,T);r=g.getSnapshotBeforeUpdate(xt,C),g.__reactInternalSnapshotBeforeUpdate=r}catch(Ot){Fi(c,c.return,Ot)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,c=r.nodeType,c===9)Ws(r);else if(c===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Ws(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(M(163))}if(r=s.sibling,r!==null){r.return=s.return,ir=r;break}ir=s.return}}function Kp(r,s,c){var g=c.flags;switch(c.tag){case 0:case 11:case 15:Da(r,c),g&4&&mh(5,c);break;case 1:if(Da(r,c),g&4)if(r=c.stateNode,s===null)try{r.componentDidMount()}catch(N){Fi(c,c.return,N)}else{var T=Do(c.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(T,s,r.__reactInternalSnapshotBeforeUpdate)}catch(N){Fi(c,c.return,N)}}g&64&&fg(c),g&512&&mf(c,c.return);break;case 3:if(Da(r,c),g&64&&(r=c.updateQueue,r!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{ch(r,s)}catch(N){Fi(c,c.return,N)}}break;case 27:s===null&&g&4&&pg(c);case 26:case 5:Da(r,c),s===null&&g&4&&jd(c),g&512&&mf(c,c.return);break;case 12:Da(r,c);break;case 31:Da(r,c),g&4&&gf(r,c);break;case 13:Da(r,c),g&4&&_f(r,c),g&64&&(r=c.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(c=lm.bind(null,c),rr(r,c))));break;case 22:if(g=c.memoizedState!==null||_l,!g){s=s!==null&&s.memoizedState!==null||tr,T=_l;var C=tr;_l=g,(tr=s)&&!C?yl(r,c,(c.subtreeFlags&8772)!==0):Da(r,c),_l=T,tr=C}break;case 30:break;default:Da(r,c)}}function gh(r){var s=r.alternate;s!==null&&(r.alternate=null,gh(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&Go(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var En=null,hi=!1;function Ca(r,s,c){for(c=c.child;c!==null;)Wp(r,s,c),c=c.sibling}function Wp(r,s,c){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(we,c)}catch{}switch(c.tag){case 26:tr||Ya(c,s),Ca(r,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:tr||Ya(c,s);var g=En,T=hi;bu(c.type)&&(En=c.stateNode,hi=!1),Ca(r,s,c),Dh(c.stateNode),En=g,hi=T;break;case 5:tr||Ya(c,s);case 6:if(g=En,T=hi,En=null,Ca(r,s,c),En=g,hi=T,En!==null)if(hi)try{(En.nodeType===9?En.body:En.nodeName==="HTML"?En.ownerDocument.body:En).removeChild(c.stateNode)}catch(C){Fi(c,s,C)}else try{En.removeChild(c.stateNode)}catch(C){Fi(c,s,C)}break;case 18:En!==null&&(hi?(r=En,Ug(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,c.stateNode),Mu(r)):Ug(En,c.stateNode));break;case 4:g=En,T=hi,En=c.stateNode.containerInfo,hi=!0,Ca(r,s,c),En=g,hi=T;break;case 0:case 11:case 14:case 15:gl(2,c,s),tr||gl(4,c,s),Ca(r,s,c);break;case 1:tr||(Ya(c,s),g=c.stateNode,typeof g.componentWillUnmount=="function"&&dg(c,s,g)),Ca(r,s,c);break;case 21:Ca(r,s,c);break;case 22:tr=(g=tr)||c.memoizedState!==null,Ca(r,s,c),tr=g;break;default:Ca(r,s,c)}}function gf(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Mu(r)}catch(c){Fi(s,s.return,c)}}}function _f(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Mu(r)}catch(c){Fi(s,s.return,c)}}function yf(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new mg),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new mg),s;default:throw Error(M(435,r.tag))}}function vf(r,s){var c=yf(r);s.forEach(function(g){if(!c.has(g)){c.add(g);var T=k_.bind(null,r,g);g.then(T,T)}})}function oa(r,s){var c=s.deletions;if(c!==null)for(var g=0;g<c.length;g++){var T=c[g],C=r,N=s,K=N;e:for(;K!==null;){switch(K.tag){case 27:if(bu(K.type)){En=K.stateNode,hi=!1;break e}break;case 5:En=K.stateNode,hi=!1;break e;case 3:case 4:En=K.stateNode.containerInfo,hi=!0;break e}K=K.return}if(En===null)throw Error(M(160));Wp(C,N,T),En=null,hi=!1,C=T.alternate,C!==null&&(C.return=null),T.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Ud(s,r),s=s.sibling}var la=null;function Ud(r,s){var c=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:oa(s,r),hr(r),g&4&&(gl(3,r,r.return),mh(3,r),gl(5,r,r.return));break;case 1:oa(s,r),hr(r),g&512&&(tr||c===null||Ya(c,c.return)),g&64&&_l&&(r=r.updateQueue,r!==null&&(g=r.callbacks,g!==null&&(c=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=c===null?g:c.concat(g))));break;case 26:var T=la;if(oa(s,r),hr(r),g&512&&(tr||c===null||Ya(c,c.return)),g&4){var C=c!==null?c.memoizedState:null;if(g=r.memoizedState,c===null)if(g===null)if(r.stateNode===null){e:{g=r.type,c=r.memoizedProps,T=T.ownerDocument||T;t:switch(g){case"title":C=T.getElementsByTagName("title")[0],(!C||C[kt]||C[Vi]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=T.createElement(g),T.head.insertBefore(C,T.querySelector("head > title"))),fr(C,g,c),C[Vi]=r,dn(C),g=C;break e;case"link":var N=Im("link","href",T).get(g+(c.href||""));if(N){for(var K=0;K<N.length;K++)if(C=N[K],C.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&C.getAttribute("rel")===(c.rel==null?null:c.rel)&&C.getAttribute("title")===(c.title==null?null:c.title)&&C.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){N.splice(K,1);break t}}C=T.createElement(g),fr(C,g,c),T.head.appendChild(C);break;case"meta":if(N=Im("meta","content",T).get(g+(c.content||""))){for(K=0;K<N.length;K++)if(C=N[K],C.getAttribute("content")===(c.content==null?null:""+c.content)&&C.getAttribute("name")===(c.name==null?null:c.name)&&C.getAttribute("property")===(c.property==null?null:c.property)&&C.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&C.getAttribute("charset")===(c.charSet==null?null:c.charSet)){N.splice(K,1);break t}}C=T.createElement(g),fr(C,g,c),T.head.appendChild(C);break;default:throw Error(M(468,g))}C[Vi]=r,dn(C),g=C}r.stateNode=g}else Lf(T,r.type,r.stateNode);else r.stateNode=Pm(T,g,r.memoizedProps);else C!==g?(C===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):C.count--,g===null?Lf(T,r.type,r.stateNode):Pm(T,g,r.memoizedProps)):g===null&&r.stateNode!==null&&Nd(r,r.memoizedProps,c.memoizedProps)}break;case 27:oa(s,r),hr(r),g&512&&(tr||c===null||Ya(c,c.return)),c!==null&&g&4&&Nd(r,r.memoizedProps,c.memoizedProps);break;case 5:if(oa(s,r),hr(r),g&512&&(tr||c===null||Ya(c,c.return)),r.flags&32){T=r.stateNode;try{Os(T,"")}catch(xt){Fi(r,r.return,xt)}}g&4&&r.stateNode!=null&&(T=r.memoizedProps,Nd(r,T,c!==null?c.memoizedProps:T)),g&1024&&(Qp=!0);break;case 6:if(oa(s,r),hr(r),g&4){if(r.stateNode===null)throw Error(M(162));g=r.memoizedProps,c=r.stateNode;try{c.nodeValue=g}catch(xt){Fi(r,r.return,xt)}}break;case 3:if(gp=null,T=la,la=dp(s.containerInfo),oa(s,r),la=T,hr(r),g&4&&c!==null&&c.memoizedState.isDehydrated)try{Mu(s.containerInfo)}catch(xt){Fi(r,r.return,xt)}Qp&&(Qp=!1,bf(r));break;case 4:g=la,la=dp(r.stateNode.containerInfo),oa(s,r),hr(r),la=g;break;case 12:oa(s,r),hr(r);break;case 31:oa(s,r),hr(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,vf(r,g)));break;case 13:oa(s,r),hr(r),r.child.flags&8192&&r.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(Zd=Yn()),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,vf(r,g)));break;case 22:T=r.memoizedState!==null;var me=c!==null&&c.memoizedState!==null,Be=_l,Ze=tr;if(_l=Be||T,tr=Ze||me,oa(s,r),tr=Ze,_l=Be,hr(r),g&8192)e:for(s=r.stateNode,s._visibility=T?s._visibility&-2:s._visibility|1,T&&(c===null||me||_l||tr||Ys(r)),c=null,s=r;;){if(s.tag===5||s.tag===26){if(c===null){me=c=s;try{if(C=me.stateNode,T)N=C.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{K=me.stateNode;var We=me.memoizedProps.style,ke=We!=null&&We.hasOwnProperty("display")?We.display:null;K.style.display=ke==null||typeof ke=="boolean"?"":(""+ke).trim()}}catch(xt){Fi(me,me.return,xt)}}}else if(s.tag===6){if(c===null){me=s;try{me.stateNode.nodeValue=T?"":me.memoizedProps}catch(xt){Fi(me,me.return,xt)}}}else if(s.tag===18){if(c===null){me=s;try{var je=me.stateNode;T?Yt(je,!0):Yt(me.stateNode,!1)}catch(xt){Fi(me,me.return,xt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}g&4&&(g=r.updateQueue,g!==null&&(c=g.retryQueue,c!==null&&(g.retryQueue=null,vf(r,c))));break;case 19:oa(s,r),hr(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,vf(r,g)));break;case 30:break;case 21:break;default:oa(s,r),hr(r)}}function hr(r){var s=r.flags;if(s&2){try{for(var c,g=r.return;g!==null;){if(fu(g)){c=g;break}g=g.return}if(c==null)throw Error(M(160));switch(c.tag){case 27:var T=c.stateNode,C=bc(r);Vd(r,C,T);break;case 5:var N=c.stateNode;c.flags&32&&(Os(N,""),c.flags&=-33);var K=bc(r);Vd(r,K,N);break;case 3:case 4:var me=c.stateNode.containerInfo,Be=bc(r);Yp(r,Be,me);break;default:throw Error(M(161))}}catch(Ze){Fi(r,r.return,Ze)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function bf(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;bf(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Da(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Kp(r,s.alternate,s),s=s.sibling}function Ys(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:gl(4,s,s.return),Ys(s);break;case 1:Ya(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&dg(s,s.return,c),Ys(s);break;case 27:Dh(s.stateNode);case 26:case 5:Ya(s,s.return),Ys(s);break;case 22:s.memoizedState===null&&Ys(s);break;case 30:Ys(s);break;default:Ys(s)}r=r.sibling}}function yl(r,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var g=s.alternate,T=r,C=s,N=C.flags;switch(C.tag){case 0:case 11:case 15:yl(T,C,c),mh(4,C);break;case 1:if(yl(T,C,c),g=C,T=g.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(Be){Fi(g,g.return,Be)}if(g=C,T=g.updateQueue,T!==null){var K=g.stateNode;try{var me=T.shared.hiddenCallbacks;if(me!==null)for(T.shared.hiddenCallbacks=null,T=0;T<me.length;T++)cc(me[T],K)}catch(Be){Fi(g,g.return,Be)}}c&&N&64&&fg(C),mf(C,C.return);break;case 27:pg(C);case 26:case 5:yl(T,C,c),c&&g===null&&N&4&&jd(C),mf(C,C.return);break;case 12:yl(T,C,c);break;case 31:yl(T,C,c),c&&N&4&&gf(T,C);break;case 13:yl(T,C,c),c&&N&4&&_f(T,C);break;case 22:C.memoizedState===null&&yl(T,C,c),mf(C,C.return);break;case 30:break;default:yl(T,C,c)}s=s.sibling}}function Gd(r,s){var c=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==c&&(r!=null&&r.refCount++,c!=null&&ru(c))}function vl(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ru(r))}function Qs(r,s,c,g){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Jp(r,s,c,g),s=s.sibling}function Jp(r,s,c,g){var T=s.flags;switch(s.tag){case 0:case 11:case 15:Qs(r,s,c,g),T&2048&&mh(9,s);break;case 1:Qs(r,s,c,g);break;case 3:Qs(r,s,c,g),T&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&ru(r)));break;case 12:if(T&2048){Qs(r,s,c,g),r=s.stateNode;try{var C=s.memoizedProps,N=C.id,K=C.onPostCommit;typeof K=="function"&&K(N,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(me){Fi(s,s.return,me)}}else Qs(r,s,c,g);break;case 31:Qs(r,s,c,g);break;case 13:Qs(r,s,c,g);break;case 23:break;case 22:C=s.stateNode,N=s.alternate,s.memoizedState!==null?C._visibility&2?Qs(r,s,c,g):xc(r,s):C._visibility&2?Qs(r,s,c,g):(C._visibility|=2,Ro(r,s,c,g,(s.subtreeFlags&10256)!==0||!1)),T&2048&&Gd(N,s);break;case 24:Qs(r,s,c,g),T&2048&&vl(s.alternate,s);break;default:Qs(r,s,c,g)}}function Ro(r,s,c,g,T){for(T=T&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var C=r,N=s,K=c,me=g,Be=N.flags;switch(N.tag){case 0:case 11:case 15:Ro(C,N,K,me,T),mh(8,N);break;case 23:break;case 22:var Ze=N.stateNode;N.memoizedState!==null?Ze._visibility&2?Ro(C,N,K,me,T):xc(C,N):(Ze._visibility|=2,Ro(C,N,K,me,T)),T&&Be&2048&&Gd(N.alternate,N);break;case 24:Ro(C,N,K,me,T),T&&Be&2048&&vl(N.alternate,N);break;default:Ro(C,N,K,me,T)}s=s.sibling}}function xc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=r,g=s,T=g.flags;switch(g.tag){case 22:xc(c,g),T&2048&&Gd(g.alternate,g);break;case 24:xc(c,g),T&2048&&vl(g.alternate,g);break;default:xc(c,g)}s=s.sibling}}var _h=8192;function wc(r,s,c){if(r.subtreeFlags&_h)for(r=r.child;r!==null;)gg(r,s,c),r=r.sibling}function gg(r,s,c){switch(r.tag){case 26:wc(r,s,c),r.flags&_h&&r.memoizedState!==null&&Rm(c,la,r.memoizedState,r.memoizedProps);break;case 5:wc(r,s,c);break;case 3:case 4:var g=la;la=dp(r.stateNode.containerInfo),wc(r,s,c),la=g;break;case 22:r.memoizedState===null&&(g=r.alternate,g!==null&&g.memoizedState!==null?(g=_h,_h=16777216,wc(r,s,c),_h=g):wc(r,s,c));break;default:wc(r,s,c)}}function _g(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function xf(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var g=s[c];ir=g,yh(g,r)}_g(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)yg(r),r=r.sibling}function yg(r){switch(r.tag){case 0:case 11:case 15:xf(r),r.flags&2048&&gl(9,r,r.return);break;case 3:xf(r);break;case 12:xf(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,qd(r)):xf(r);break;default:xf(r)}}function qd(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var g=s[c];ir=g,yh(g,r)}_g(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:gl(8,s,s.return),qd(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,qd(s));break;default:qd(s)}r=r.sibling}}function yh(r,s){for(;ir!==null;){var c=ir;switch(c.tag){case 0:case 11:case 15:gl(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var g=c.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:ru(c.memoizedState.cache)}if(g=c.child,g!==null)g.return=c,ir=g;else e:for(c=r;ir!==null;){g=ir;var T=g.sibling,C=g.return;if(gh(g),g===c){ir=null;break e}if(T!==null){T.return=C,ir=T;break e}ir=C}}}var L_={getCacheForType:function(r){var s=In(Tn),c=s.data.get(r);return c===void 0&&(c=r(),s.data.set(r,c)),c},cacheSignal:function(){return In(Tn).controller.signal}},vg=typeof WeakMap=="function"?WeakMap:Map,ki=0,tn=null,si=null,oi=0,Zi=0,ua=null,Ms=!1,du=!1,em=!1,bl=0,On=0,xl=0,Tc=0,tm=0,Pr=0,Sc=0,wf=null,za=null,im=!1,Zd=0,bg=0,Tf=1/0,vh=null,wl=null,nr=0,Tl=null,bh=null,As=0,nm=0,Hd=null,xg=null,Sf=0,rm=null;function Pa(){return(ki&2)!==0&&oi!==0?oi&-oi:qe.T!==null?dm():dr()}function wg(){if(Pr===0)if((oi&536870912)===0||ti){var r=gi;gi<<=1,(gi&3932160)===0&&(gi=262144),Pr=r}else Pr=536870912;return r=ft.current,r!==null&&(r.flags|=32),Pr}function Ia(r,s,c){(r===tn&&(Zi===2||Zi===9)||r.cancelPendingCommit!==null)&&(wh(r,0),pu(r,oi,Pr,!1)),Ei(r,c),((ki&2)===0||r!==tn)&&(r===tn&&((ki&2)===0&&(Tc|=c),On===4&&pu(r,oi,Pr,!1)),Ks(r))}function Xn(r,s,c){if((ki&6)!==0)throw Error(M(327));var g=!c&&(s&127)===0&&(s&r.expiredLanes)===0||Dn(r,s),T=g?Th(r,s):Yd(r,s,!0),C=g;do{if(T===0){du&&!g&&pu(r,s,0,!1);break}else{if(c=r.current.alternate,C&&!B_(c)){T=Yd(r,s,!1),C=!1;continue}if(T===2){if(C=s,r.errorRecoveryDisabledLanes&C)var N=0;else N=r.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){s=N;e:{var K=r;T=wf;var me=K.current.memoizedState.isDehydrated;if(me&&(wh(K,N).flags|=256),N=Yd(K,N,!1),N!==2){if(em&&!me){K.errorRecoveryDisabledLanes|=C,Tc|=C,T=4;break e}C=za,za=T,C!==null&&(za===null?za=C:za.push.apply(za,C))}T=N}if(C=!1,T!==2)continue}}if(T===1){wh(r,0),pu(r,s,0,!0);break}e:{switch(g=r,C=T,C){case 0:case 1:throw Error(M(345));case 4:if((s&4194048)!==s)break;case 6:pu(g,s,Pr,!Ms);break e;case 2:za=null;break;case 3:case 5:break;default:throw Error(M(329))}if((s&62914560)===s&&(T=Zd+300-Yn(),10<T)){if(pu(g,s,Pr,!Ms),vi(g,0,!0)!==0)break e;As=s,g.timeoutHandle=fp(xh.bind(null,g,c,za,vh,im,s,Pr,Tc,Sc,Ms,C,"Throttled",-0,0),T);break e}xh(g,c,za,vh,im,s,Pr,Tc,Sc,Ms,C,null,-0,0)}}break}while(!0);Ks(r)}function xh(r,s,c,g,T,C,N,K,me,Be,Ze,We,ke,je){if(r.timeoutHandle=-1,We=s.subtreeFlags,We&8192||(We&16785408)===16785408){We={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fa},gg(s,C,We);var xt=(C&62914560)===C?Zd-Yn():(C&4194048)===C?bg-Yn():0;if(xt=Om(We,xt),xt!==null){As=C,r.cancelPendingCommit=xt(Ag.bind(null,r,s,C,c,g,T,N,K,me,Ze,We,null,ke,je)),pu(r,C,N,!Be);return}}Ag(r,s,C,c,g,T,N,K,me)}function B_(r){for(var s=r;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var g=0;g<c.length;g++){var T=c[g],C=T.getSnapshot;T=T.value;try{if(!Or(C(),T))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function pu(r,s,c,g){s&=~tm,s&=~Tc,r.suspendedLanes|=s,r.pingedLanes&=~s,g&&(r.warmLanes|=s),g=r.expirationTimes;for(var T=s;0<T;){var C=31-Ue(T),N=1<<C;g[C]=-1,T&=~N}c!==0&&Ii(r,c,s)}function Ef(){return(ki&6)===0?(Qa(0),!1):!0}function $d(){if(si!==null){if(Zi===0)var r=si.return;else r=si,ms=xa=null,Hs(r),ys=null,ol=0,r=si;for(;r!==null;)Fd(r.alternate,r),r=r.return;si=null}}function wh(r,s){var c=r.timeoutHandle;c!==-1&&(r.timeoutHandle=-1,xm(c)),c=r.cancelPendingCommit,c!==null&&(r.cancelPendingCommit=null,c()),As=0,$d(),tn=r,si=c=ta(r.current,null),oi=s,Zi=0,ua=null,Ms=!1,du=Dn(r,s),em=!1,Sc=Pr=tm=Tc=xl=On=0,za=wf=null,im=!1,(s&8)!==0&&(s|=s&32);var g=r.entangledLanes;if(g!==0)for(r=r.entanglements,g&=s;0<g;){var T=31-Ue(g),C=1<<T;s|=r[T],g&=~C}return bl=s,nl(),c}function am(r,s){$t=null,qe.H=wi,s===Va||s===Fr?(s=su(),Zi=3):s===Eo?(s=su(),Zi=4):Zi=s===Dd?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ua=s,si===null&&(On=1,Xa(r,zr(s,r.current)))}function sm(){var r=ft.current;return r===null?!0:(oi&4194048)===oi?_t===null:(oi&62914560)===oi||(oi&536870912)!==0?r===_t:!1}function Ec(){var r=qe.H;return qe.H=wi,r===null?wi:r}function Xd(){var r=qe.A;return qe.A=L_,r}function Mf(){On=4,Ms||(oi&4194048)!==oi&&ft.current!==null||(du=!0),(xl&134217727)===0&&(Tc&134217727)===0||tn===null||pu(tn,oi,Pr,!1)}function Yd(r,s,c){var g=ki;ki|=2;var T=Ec(),C=Xd();(tn!==r||oi!==s)&&(vh=null,wh(r,s)),s=!1;var N=On;e:do try{if(Zi!==0&&si!==null){var K=si,me=ua;switch(Zi){case 8:$d(),N=6;break e;case 3:case 2:case 9:case 6:ft.current===null&&(s=!0);var Be=Zi;if(Zi=0,ua=null,Sh(r,K,me,Be),c&&du){N=0;break e}break;default:Be=Zi,Zi=0,ua=null,Sh(r,K,me,Be)}}Qd(),N=On;break}catch(Ze){am(r,Ze)}while(!0);return s&&r.shellSuspendCounter++,ms=xa=null,ki=g,qe.H=T,qe.A=C,si===null&&(tn=null,oi=0,nl()),N}function Qd(){for(;si!==null;)Sg(si)}function Th(r,s){var c=ki;ki|=2;var g=Ec(),T=Xd();tn!==r||oi!==s?(vh=null,Tf=Yn()+500,wh(r,s)):du=Dn(r,s);e:do try{if(Zi!==0&&si!==null){s=si;var C=ua;t:switch(Zi){case 1:Zi=0,ua=null,Sh(r,s,C,1);break;case 2:case 9:if(sc(C)){Zi=0,ua=null,Eg(s);break}s=function(){Zi!==2&&Zi!==9||tn!==r||(Zi=7),Ks(r)},C.then(s,s);break e;case 3:Zi=7;break e;case 4:Zi=5;break e;case 7:sc(C)?(Zi=0,ua=null,Eg(s)):(Zi=0,ua=null,Sh(r,s,C,7));break;case 5:var N=null;switch(si.tag){case 26:N=si.memoizedState;case 5:case 27:var K=si;if(N?Bf(N):K.stateNode.complete){Zi=0,ua=null;var me=K.sibling;if(me!==null)si=me;else{var Be=K.return;Be!==null?(si=Be,Kd(Be)):si=null}break t}}Zi=0,ua=null,Sh(r,s,C,5);break;case 6:Zi=0,ua=null,Sh(r,s,C,6);break;case 8:$d(),On=6;break e;default:throw Error(M(462))}}Tg();break}catch(Ze){am(r,Ze)}while(!0);return ms=xa=null,qe.H=g,qe.A=T,ki=c,si!==null?0:(tn=null,oi=0,nl(),On)}function Tg(){for(;si!==null&&!La();)Sg(si)}function Sg(r){var s=Vr(r.alternate,r,bl);r.memoizedProps=r.pendingProps,s===null?Kd(r):si=s}function Eg(r){var s=r,c=s.alternate;switch(s.tag){case 15:case 0:s=og(c,s,s.pendingProps,s.type,void 0,oi);break;case 11:s=og(c,s,s.pendingProps,s.type.render,s.ref,oi);break;case 5:Hs(s);default:Fd(c,s),s=si=Sd(s,bl),s=Vr(c,s,bl)}r.memoizedProps=r.pendingProps,s===null?Kd(r):si=s}function Sh(r,s,c,g){ms=xa=null,Hs(s),ys=null,ol=0;var T=s.return;try{if(Cd(r,T,s,c,oi)){On=1,Xa(r,zr(c,r.current)),si=null;return}}catch(C){if(T!==null)throw si=T,C;On=1,Xa(r,zr(c,r.current)),si=null;return}s.flags&32768?(ti||g===1?r=!0:du||(oi&536870912)!==0?r=!1:(Ms=r=!0,(g===2||g===9||g===3||g===6)&&(g=ft.current,g!==null&&g.tag===13&&(g.flags|=16384))),Mg(s,r)):Kd(s)}function Kd(r){var s=r;do{if((s.flags&32768)!==0){Mg(s,Ms);return}r=s.return;var c=hg(s.alternate,s,bl);if(c!==null){si=c;return}if(s=s.sibling,s!==null){si=s;return}si=s=r}while(s!==null);On===0&&(On=5)}function Mg(r,s){do{var c=R_(r.alternate,r);if(c!==null){c.flags&=32767,si=c;return}if(c=r.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(r=r.sibling,r!==null)){si=r;return}si=r=c}while(r!==null);On=6,si=null}function Ag(r,s,c,g,T,C,N,K,me){r.cancelPendingCommit=null;do Wd();while(nr!==0);if((ki&6)!==0)throw Error(M(327));if(s!==null){if(s===r.current)throw Error(M(177));if(C=s.lanes|s.childLanes,C|=il,fn(r,c,C,N,K,me),r===tn&&(si=tn=null,oi=0),bh=s,Tl=r,As=c,nm=C,Hd=T,xg=g,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Rg(Z,function(){return Ig(),null})):(r.callbackNode=null,r.callbackPriority=0),g=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||g){g=qe.T,qe.T=null,T=ot.p,ot.p=2,N=ki,ki|=4;try{O_(r,s,c)}finally{ki=N,ot.p=T,qe.T=g}}nr=1,Cg(),Dg(),zg()}}function Cg(){if(nr===1){nr=0;var r=Tl,s=bh,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=qe.T,qe.T=null;var g=ot.p;ot.p=2;var T=ki;ki|=4;try{Ud(s,r);var C=vm,N=Hc(r.containerInfo),K=C.focusedElem,me=C.selectionRange;if(N!==K&&K&&K.ownerDocument&&Zc(K.ownerDocument.documentElement,K)){if(me!==null&&Qu(K)){var Be=me.start,Ze=me.end;if(Ze===void 0&&(Ze=Be),"selectionStart"in K)K.selectionStart=Be,K.selectionEnd=Math.min(Ze,K.value.length);else{var We=K.ownerDocument||document,ke=We&&We.defaultView||window;if(ke.getSelection){var je=ke.getSelection(),xt=K.textContent.length,Ot=Math.min(me.start,xt),Hi=me.end===void 0?Ot:Math.min(me.end,xt);!je.extend&&Ot>Hi&&(N=Hi,Hi=Ot,Ot=N);var Te=Yu(K,Ot),ve=Yu(K,Hi);if(Te&&ve&&(je.rangeCount!==1||je.anchorNode!==Te.node||je.anchorOffset!==Te.offset||je.focusNode!==ve.node||je.focusOffset!==ve.offset)){var Re=We.createRange();Re.setStart(Te.node,Te.offset),je.removeAllRanges(),Ot>Hi?(je.addRange(Re),je.extend(ve.node,ve.offset)):(Re.setEnd(ve.node,ve.offset),je.addRange(Re))}}}}for(We=[],je=K;je=je.parentNode;)je.nodeType===1&&We.push({element:je,left:je.scrollLeft,top:je.scrollTop});for(typeof K.focus=="function"&&K.focus(),K=0;K<We.length;K++){var Ye=We[K];Ye.element.scrollLeft=Ye.left,Ye.element.scrollTop=Ye.top}}Vf=!!Pf,vm=Pf=null}finally{ki=T,ot.p=g,qe.T=c}}r.current=s,nr=2}}function Dg(){if(nr===2){nr=0;var r=Tl,s=bh,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=qe.T,qe.T=null;var g=ot.p;ot.p=2;var T=ki;ki|=4;try{Kp(r,s.alternate,s)}finally{ki=T,ot.p=g,qe.T=c}}nr=3}}function zg(){if(nr===4||nr===3){nr=0,Fl();var r=Tl,s=bh,c=As,g=xg;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?nr=5:(nr=0,bh=Tl=null,Pg(r,r.pendingLanes));var T=r.pendingLanes;if(T===0&&(wl=null),et(c),s=s.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(we,s,void 0,(s.current.flags&128)===128)}catch{}if(g!==null){s=qe.T,T=ot.p,ot.p=2,qe.T=null;try{for(var C=r.onRecoverableError,N=0;N<g.length;N++){var K=g[N];C(K.value,{componentStack:K.stack})}}finally{qe.T=s,ot.p=T}}(As&3)!==0&&Wd(),Ks(r),T=r.pendingLanes,(c&261930)!==0&&(T&42)!==0?r===rm?Sf++:(Sf=0,rm=r):Sf=0,Qa(0)}}function Pg(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,ru(s)))}function Wd(){return Cg(),Dg(),zg(),Ig()}function Ig(){if(nr!==5)return!1;var r=Tl,s=nm;nm=0;var c=et(As),g=qe.T,T=ot.p;try{ot.p=32>c?32:c,qe.T=null,c=Hd,Hd=null;var C=Tl,N=As;if(nr=0,bh=Tl=null,As=0,(ki&6)!==0)throw Error(M(331));var K=ki;if(ki|=4,yg(C.current),Jp(C,C.current,N,c),ki=K,Qa(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(we,C)}catch{}return!0}finally{ot.p=T,qe.T=g,Pg(r,s)}}function om(r,s,c){s=zr(c,s),s=_c(r.stateNode,s,2),r=Us(r,s,2),r!==null&&(Ei(r,2),Ks(r))}function Fi(r,s,c){if(r.tag===3)om(r,r,c);else for(;s!==null;){if(s.tag===3){om(s,r,c);break}else if(s.tag===1){var g=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(wl===null||!wl.has(g))){r=zr(c,r),c=yc(2),g=Us(s,c,2),g!==null&&(vc(c,g,s,r),Ei(g,2),Ks(g));break}}s=s.return}}function Jd(r,s,c){var g=r.pingCache;if(g===null){g=r.pingCache=new vg;var T=new Set;g.set(s,T)}else T=g.get(s),T===void 0&&(T=new Set,g.set(s,T));T.has(c)||(em=!0,T.add(c),r=mu.bind(null,r,s,c),s.then(r,r))}function mu(r,s,c){var g=r.pingCache;g!==null&&g.delete(s),r.pingedLanes|=r.suspendedLanes&c,r.warmLanes&=~c,tn===r&&(oi&c)===c&&(On===4||On===3&&(oi&62914560)===oi&&300>Yn()-Zd?(ki&2)===0&&wh(r,0):tm|=c,Sc===oi&&(Sc=0)),Ks(r)}function Af(r,s){s===0&&(s=bi()),r=ba(r,s),r!==null&&(Ei(r,s),Ks(r))}function lm(r){var s=r.memoizedState,c=0;s!==null&&(c=s.retryLane),Af(r,c)}function k_(r,s){var c=0;switch(r.tag){case 31:case 13:var g=r.stateNode,T=r.memoizedState;T!==null&&(c=T.retryLane);break;case 19:g=r.stateNode;break;case 22:g=r.stateNode._retryCache;break;default:throw Error(M(314))}g!==null&&g.delete(s),Af(r,c)}function Rg(r,s){return so(r,s)}var ep=null,Eh=null,um=!1,tp=!1,cm=!1,Sl=0;function Ks(r){r!==Eh&&r.next===null&&(Eh===null?ep=Eh=r:Eh=Eh.next=r),tp=!0,um||(um=!0,fm())}function Qa(r,s){if(!cm&&tp){cm=!0;do for(var c=!1,g=ep;g!==null;){if(r!==0){var T=g.pendingLanes;if(T===0)var C=0;else{var N=g.suspendedLanes,K=g.pingedLanes;C=(1<<31-Ue(42|r)+1)-1,C&=T&~(N&~K),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(c=!0,Cf(g,C))}else C=oi,C=vi(g,g===tn?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||Dn(g,C)||(c=!0,Cf(g,C));g=g.next}while(c);cm=!1}}function gu(){hm()}function hm(){tp=um=!1;var r=0;Sl!==0&&hp()&&(r=Sl);for(var s=Yn(),c=null,g=ep;g!==null;){var T=g.next,C=ip(g,s);C===0?(g.next=null,c===null?ep=T:c.next=T,T===null&&(Eh=c)):(c=g,(r!==0||(C&3)!==0)&&(tp=!0)),g=T}nr!==0&&nr!==5||Qa(r),Sl!==0&&(Sl=0)}function ip(r,s){for(var c=r.suspendedLanes,g=r.pingedLanes,T=r.expirationTimes,C=r.pendingLanes&-62914561;0<C;){var N=31-Ue(C),K=1<<N,me=T[N];me===-1?((K&c)===0||(K&g)!==0)&&(T[N]=Bt(K,s)):me<=s&&(r.expiredLanes|=K),C&=~K}if(s=tn,c=oi,c=vi(r,r===s?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g=r.callbackNode,c===0||r===s&&(Zi===2||Zi===9)||r.cancelPendingCommit!==null)return g!==null&&g!==null&&es(g),r.callbackNode=null,r.callbackPriority=0;if((c&3)===0||Dn(r,c)){if(s=c&-c,s===r.callbackPriority)return s;switch(g!==null&&es(g),et(c)){case 2:case 8:c=$;break;case 32:c=Z;break;case 268435456:c=fe;break;default:c=Z}return g=Og.bind(null,r),c=so(c,g),r.callbackPriority=s,r.callbackNode=c,s}return g!==null&&g!==null&&es(g),r.callbackPriority=2,r.callbackNode=null,2}function Og(r,s){if(nr!==0&&nr!==5)return r.callbackNode=null,r.callbackPriority=0,null;var c=r.callbackNode;if(Wd()&&r.callbackNode!==c)return null;var g=oi;return g=vi(r,r===tn?g:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g===0?null:(Xn(r,g,s),ip(r,Yn()),r.callbackNode!=null&&r.callbackNode===c?Og.bind(null,r):null)}function Cf(r,s){if(Wd())return null;Xn(r,s,!0)}function fm(){Tm(function(){(ki&6)!==0?so(Se,gu):hm()})}function dm(){if(Sl===0){var r=sl;r===0&&(r=Rt,Rt<<=1,(Rt&261888)===0&&(Rt=256)),Sl=r}return Sl}function np(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Gt(""+r)}function rp(r,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,r.id&&c.setAttribute("form",r.id),s.parentNode.insertBefore(c,s),r=new FormData(r),c.parentNode.removeChild(c),r}function Mh(r,s,c,g,T){if(s==="submit"&&c&&c.stateNode===T){var C=np((T[nt]||null).action),N=g.submitter;N&&(s=(s=N[nt]||null)?np(s.formAction):N.getAttribute("formAction"),s!==null&&(C=s,N=null));var K=new Fu("action","action",null,g,T);r.push({event:K,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Sl!==0){var me=N?rp(T,N):new FormData(T);_n(c,{pending:!0,data:me,method:T.method,action:C},null,me)}}else typeof C=="function"&&(K.preventDefault(),me=N?rp(T,N):new FormData(T),_n(c,{pending:!0,data:me,method:T.method,action:C},C,me))},currentTarget:T}]})}}for(var ap=0;ap<Qc.length;ap++){var sp=Qc[ap],pm=sp.toLowerCase(),Lg=sp[0].toUpperCase()+sp.slice(1);Jr(pm,"on"+Lg)}Jr(Ju,"onAnimationEnd"),Jr(ec,"onAnimationIteration"),Jr(Yc,"onAnimationStart"),Jr("dblclick","onDoubleClick"),Jr("focusin","onFocus"),Jr("focusout","onBlur"),Jr(tl,"onTransitionRun"),Jr(tc,"onTransitionStart"),Jr(Jl,"onTransitionCancel"),Jr(Wr,"onTransitionEnd"),Rs("onMouseEnter",["mouseout","mouseover"]),Rs("onMouseLeave",["mouseout","mouseover"]),Rs("onPointerEnter",["pointerout","pointerover"]),Rs("onPointerLeave",["pointerout","pointerover"]),ni("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ni("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ni("onBeforeInput",["compositionend","keypress","textInput","paste"]),ni("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ni("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ni("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_u));function kg(r,s){s=(s&4)!==0;for(var c=0;c<r.length;c++){var g=r[c],T=g.event;g=g.listeners;e:{var C=void 0;if(s)for(var N=g.length-1;0<=N;N--){var K=g[N],me=K.instance,Be=K.currentTarget;if(K=K.listener,me!==C&&T.isPropagationStopped())break e;C=K,T.currentTarget=Be;try{C(T)}catch(Ze){us(Ze)}T.currentTarget=null,C=me}else for(N=0;N<g.length;N++){if(K=g[N],me=K.instance,Be=K.currentTarget,K=K.listener,me!==C&&T.isPropagationStopped())break e;C=K,T.currentTarget=Be;try{C(T)}catch(Ze){us(Ze)}T.currentTarget=null,C=me}}}}function li(r,s){var c=s[qt];c===void 0&&(c=s[qt]=new Set);var g=r+"__bubble";c.has(g)||(lp(s,r,2,!1),c.add(g))}function mm(r,s,c){var g=0;s&&(g|=4),lp(c,r,g,s)}var op="_reactListening"+Math.random().toString(36).slice(2);function gm(r){if(!r[op]){r[op]=!0,Nl.forEach(function(c){c!=="selectionchange"&&(Bg.has(c)||mm(c,!1,r),mm(c,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[op]||(s[op]=!0,mm("selectionchange",!1,s))}}function lp(r,s,c,g){switch(Cc(s)){case 2:var T=Uf;break;case 8:T=Kg;break;default:T=Bm}c=T.bind(null,s,c,r),T=void 0,!Er||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(T=!0),g?T!==void 0?r.addEventListener(s,c,{capture:!0,passive:T}):r.addEventListener(s,c,!0):T!==void 0?r.addEventListener(s,c,{passive:T}):r.addEventListener(s,c,!1)}function Oo(r,s,c,g,T){var C=g;if((s&1)===0&&(s&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var K=g.stateNode.containerInfo;if(K===T)break;if(N===4)for(N=g.return;N!==null;){var me=N.tag;if((me===3||me===4)&&N.stateNode.containerInfo===T)return;N=N.return}for(;K!==null;){if(N=is(K),N===null)return;if(me=N.tag,me===5||me===6||me===26||me===27){g=C=N;continue e}K=K.parentNode}}g=g.return}Ri(function(){var Be=C,Ze=ku(c),We=[];e:{var ke=Qh.get(r);if(ke!==void 0){var je=Fu,xt=r;switch(r){case"keypress":if(Kr(c)===0)break e;case"keydown":case"keyup":je=mn;break;case"focusin":xt="focus",je=fo;break;case"focusout":xt="blur",je=fo;break;case"beforeblur":case"afterblur":je=fo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":je=Qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":je=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":je=jp;break;case Ju:case ec:case Yc:je=fd;break;case Wr:je=Vc;break;case"scroll":case"scrollend":je=Yo;break;case"wheel":je=Zh;break;case"copy":case"cut":case"paste":je=Gh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":je=Nc;break;case"toggle":case"beforetoggle":je=$l}var Ot=(s&4)!==0,Hi=!Ot&&(r==="scroll"||r==="scrollend"),Te=Ot?ke!==null?ke+"Capture":null:ke;Ot=[];for(var ve=Be,Re;ve!==null;){var Ye=ve;if(Re=Ye.stateNode,Ye=Ye.tag,Ye!==5&&Ye!==26&&Ye!==27||Re===null||Te===null||(Ye=ga(ve,Te),Ye!=null&&Ot.push(Ah(ve,Ye,Re))),Hi)break;ve=ve.return}0<Ot.length&&(ke=new je(ke,xt,null,c,Ze),We.push({event:ke,listeners:Ot}))}}if((s&7)===0){e:{if(ke=r==="mouseover"||r==="pointerover",je=r==="mouseout"||r==="pointerout",ke&&c!==Uh&&(xt=c.relatedTarget||c.fromElement)&&(is(xt)||xt[Ft]))break e;if((je||ke)&&(ke=Ze.window===Ze?Ze:(ke=Ze.ownerDocument)?ke.defaultView||ke.parentWindow:window,je?(xt=c.relatedTarget||c.toElement,je=Be,xt=xt?is(xt):null,xt!==null&&(Hi=H(xt),Ot=xt.tag,xt!==Hi||Ot!==5&&Ot!==27&&Ot!==6)&&(xt=null)):(je=null,xt=Be),je!==xt)){if(Ot=Qo,Ye="onMouseLeave",Te="onMouseEnter",ve="mouse",(r==="pointerout"||r==="pointerover")&&(Ot=Nc,Ye="onPointerLeave",Te="onPointerEnter",ve="pointer"),Hi=je==null?ke:ns(je),Re=xt==null?ke:ns(xt),ke=new Ot(Ye,ve+"leave",je,c,Ze),ke.target=Hi,ke.relatedTarget=Re,Ye=null,is(Ze)===Be&&(Ot=new Ot(Te,ve+"enter",xt,c,Ze),Ot.target=Re,Ot.relatedTarget=Hi,Ye=Ot),Hi=Ye,je&&xt)t:{for(Ot=Fg,Te=je,ve=xt,Re=0,Ye=Te;Ye;Ye=Ot(Ye))Re++;Ye=0;for(var It=ve;It;It=Ot(It))Ye++;for(;0<Re-Ye;)Te=Ot(Te),Re--;for(;0<Ye-Re;)ve=Ot(ve),Ye--;for(;Re--;){if(Te===ve||ve!==null&&Te===ve.alternate){Ot=Te;break t}Te=Ot(Te),ve=Ot(ve)}Ot=null}else Ot=null;je!==null&&_m(We,ke,je,Ot,!1),xt!==null&&Hi!==null&&_m(We,Hi,xt,Ot,!0)}}e:{if(ke=Be?ns(Be):window,je=ke.nodeName&&ke.nodeName.toLowerCase(),je==="select"||je==="input"&&ke.type==="file")var Di=go;else if(Gc(ke))if(Hh)Di=wd;else{Di=xd;var wt=Np}else je=ke.nodeName,!je||je.toLowerCase()!=="input"||ke.type!=="checkbox"&&ke.type!=="radio"?Be&&Ho(Be.elementType)&&(Di=go):Di=Xu;if(Di&&(Di=Di(r,Be))){qc(We,Di,c,Ze);break e}wt&&wt(r,ke,Be),r==="focusout"&&Be&&ke.type==="number"&&Be.memoizedProps.value!=null&&Bu(ke,"number",ke.value)}switch(wt=Be?ns(Be):window,r){case"focusin":(Gc(wt)||wt.contentEditable==="true")&&(va=wt,Ku=Be,Wu=null);break;case"focusout":Wu=Ku=va=null;break;case"mousedown":Xc=!0;break;case"contextmenu":case"mouseup":case"dragend":Xc=!1,Td(We,c,Ze);break;case"selectionchange":if($c)break;case"keydown":case"keyup":Td(We,c,Ze)}var Dt;if(wn)e:{switch(r){case"compositionstart":var ai="onCompositionStart";break e;case"compositionend":ai="onCompositionEnd";break e;case"compositionupdate":ai="onCompositionUpdate";break e}ai=void 0}else ja?qu(r,c)&&(ai="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(ai="onCompositionStart");ai&&(Kl&&c.locale!=="ko"&&(ja||ai!=="onCompositionStart"?ai==="onCompositionEnd"&&ja&&(Dt=co()):(Qr=Ze,ss="value"in Qr?Qr.value:Qr.textContent,ja=!0)),wt=Df(Be,ai),0<wt.length&&(ai=new qh(ai,r,null,c,Ze),We.push({event:ai,listeners:wt}),Dt?ai.data=Dt:(Dt=gd(c),Dt!==null&&(ai.data=Dt)))),(Dt=Ql?Uc(r,c):_d(r,c))&&(ai=Df(Be,"onBeforeInput"),0<ai.length&&(wt=new qh("onBeforeInput","beforeinput",null,c,Ze),We.push({event:wt,listeners:ai}),wt.data=Dt)),Mh(We,r,Be,c,Ze)}kg(We,s)})}function Ah(r,s,c){return{instance:r,listener:s,currentTarget:c}}function Df(r,s){for(var c=s+"Capture",g=[];r!==null;){var T=r,C=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||C===null||(T=ga(r,c),T!=null&&g.unshift(Ah(r,T,C)),T=ga(r,s),T!=null&&g.push(Ah(r,T,C))),r.tag===3)return g;r=r.return}return[]}function Fg(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function _m(r,s,c,g,T){for(var C=s._reactName,N=[];c!==null&&c!==g;){var K=c,me=K.alternate,Be=K.stateNode;if(K=K.tag,me!==null&&me===g)break;K!==5&&K!==26&&K!==27||Be===null||(me=Be,T?(Be=ga(c,C),Be!=null&&N.unshift(Ah(c,Be,me))):T||(Be=ga(c,C),Be!=null&&N.push(Ah(c,Be,me)))),c=c.return}N.length!==0&&r.push({event:s,listeners:N})}var jg=/\r\n?/g,Ng=/\u0000|\uFFFD/g;function zf(r){return(typeof r=="string"?r:""+r).replace(jg,`
`).replace(Ng,"")}function ym(r,s){return s=zf(s),zf(r)===s}function Ci(r,s,c,g,T,C){switch(c){case"children":typeof g=="string"?s==="body"||s==="textarea"&&g===""||Os(r,g):(typeof g=="number"||typeof g=="bigint")&&s!=="body"&&Os(r,""+g);break;case"className":as(r,"class",g);break;case"tabIndex":as(r,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":as(r,c,g);break;case"style":jc(r,g,C);break;case"data":if(s!=="object"){as(r,"data",g);break}case"src":case"href":if(g===""&&(s!=="a"||c!=="href")){r.removeAttribute(c);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(c);break}g=Gt(""+g),r.setAttribute(c,g);break;case"action":case"formAction":if(typeof g=="function"){r.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(c==="formAction"?(s!=="input"&&Ci(r,s,"name",T.name,T,null),Ci(r,s,"formEncType",T.formEncType,T,null),Ci(r,s,"formMethod",T.formMethod,T,null),Ci(r,s,"formTarget",T.formTarget,T,null)):(Ci(r,s,"encType",T.encType,T,null),Ci(r,s,"method",T.method,T,null),Ci(r,s,"target",T.target,T,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(c);break}g=Gt(""+g),r.setAttribute(c,g);break;case"onClick":g!=null&&(r.onclick=Fa);break;case"onScroll":g!=null&&li("scroll",r);break;case"onScrollEnd":g!=null&&li("scrollend",r);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(M(61));if(c=g.__html,c!=null){if(T.children!=null)throw Error(M(60));r.innerHTML=c}}break;case"multiple":r.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":r.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){r.removeAttribute("xlink:href");break}c=Gt(""+g),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(c,""+g):r.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(c,""):r.removeAttribute(c);break;case"capture":case"download":g===!0?r.setAttribute(c,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(c,g):r.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?r.setAttribute(c,g):r.removeAttribute(c);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?r.removeAttribute(c):r.setAttribute(c,g);break;case"popover":li("beforetoggle",r),li("toggle",r),Ru(r,"popover",g);break;case"xlinkActuate":ma(r,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":ma(r,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":ma(r,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":ma(r,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":ma(r,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":ma(r,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":ma(r,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":ma(r,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":ma(r,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":Ru(r,"is",g);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=uo.get(c)||c,Ru(r,c,g))}}function up(r,s,c,g,T,C){switch(c){case"style":jc(r,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(M(61));if(c=g.__html,c!=null){if(T.children!=null)throw Error(M(60));r.innerHTML=c}}break;case"children":typeof g=="string"?Os(r,g):(typeof g=="number"||typeof g=="bigint")&&Os(r,""+g);break;case"onScroll":g!=null&&li("scroll",r);break;case"onScrollEnd":g!=null&&li("scrollend",r);break;case"onClick":g!=null&&(r.onclick=Fa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!mr.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(T=c.endsWith("Capture"),s=c.slice(2,T?c.length-7:void 0),C=r[nt]||null,C=C!=null?C[c]:null,typeof C=="function"&&r.removeEventListener(s,C,T),typeof g=="function")){typeof C!="function"&&C!==null&&(c in r?r[c]=null:r.hasAttribute(c)&&r.removeAttribute(c)),r.addEventListener(s,g,T);break e}c in r?r[c]=g:g===!0?r.setAttribute(c,""):Ru(r,c,g)}}}function fr(r,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":li("error",r),li("load",r);var g=!1,T=!1,C;for(C in c)if(c.hasOwnProperty(C)){var N=c[C];if(N!=null)switch(C){case"src":g=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(M(137,s));default:Ci(r,s,C,N,c,null)}}T&&Ci(r,s,"srcSet",c.srcSet,c,null),g&&Ci(r,s,"src",c.src,c,null);return;case"input":li("invalid",r);var K=C=N=T=null,me=null,Be=null;for(g in c)if(c.hasOwnProperty(g)){var Ze=c[g];if(Ze!=null)switch(g){case"name":T=Ze;break;case"type":N=Ze;break;case"checked":me=Ze;break;case"defaultChecked":Be=Ze;break;case"value":C=Ze;break;case"defaultValue":K=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(M(137,s));break;default:Ci(r,s,g,Ze,c,null)}}Fc(r,C,K,me,Be,N,T,!1);return;case"select":li("invalid",r),g=N=C=null;for(T in c)if(c.hasOwnProperty(T)&&(K=c[T],K!=null))switch(T){case"value":C=K;break;case"defaultValue":N=K;break;case"multiple":g=K;default:Ci(r,s,T,K,c,null)}s=C,c=N,r.multiple=!!g,s!=null?lo(r,!!g,s,!1):c!=null&&lo(r,!!g,c,!0);return;case"textarea":li("invalid",r),C=T=g=null;for(N in c)if(c.hasOwnProperty(N)&&(K=c[N],K!=null))switch(N){case"value":g=K;break;case"defaultValue":T=K;break;case"children":C=K;break;case"dangerouslySetInnerHTML":if(K!=null)throw Error(M(91));break;default:Ci(r,s,N,K,c,null)}Gl(r,g,T,C);return;case"option":for(me in c)c.hasOwnProperty(me)&&(g=c[me],g!=null)&&(me==="selected"?r.selected=g&&typeof g!="function"&&typeof g!="symbol":Ci(r,s,me,g,c,null));return;case"dialog":li("beforetoggle",r),li("toggle",r),li("cancel",r),li("close",r);break;case"iframe":case"object":li("load",r);break;case"video":case"audio":for(g=0;g<_u.length;g++)li(_u[g],r);break;case"image":li("error",r),li("load",r);break;case"details":li("toggle",r);break;case"embed":case"source":case"link":li("error",r),li("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Be in c)if(c.hasOwnProperty(Be)&&(g=c[Be],g!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":throw Error(M(137,s));default:Ci(r,s,Be,g,c,null)}return;default:if(Ho(s)){for(Ze in c)c.hasOwnProperty(Ze)&&(g=c[Ze],g!==void 0&&up(r,s,Ze,g,c,void 0));return}}for(K in c)c.hasOwnProperty(K)&&(g=c[K],g!=null&&Ci(r,s,K,g,c,null))}function Vg(r,s,c,g){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,C=null,N=null,K=null,me=null,Be=null,Ze=null;for(je in c){var We=c[je];if(c.hasOwnProperty(je)&&We!=null)switch(je){case"checked":break;case"value":break;case"defaultValue":me=We;default:g.hasOwnProperty(je)||Ci(r,s,je,null,g,We)}}for(var ke in g){var je=g[ke];if(We=c[ke],g.hasOwnProperty(ke)&&(je!=null||We!=null))switch(ke){case"type":C=je;break;case"name":T=je;break;case"checked":Be=je;break;case"defaultChecked":Ze=je;break;case"value":N=je;break;case"defaultValue":K=je;break;case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(M(137,s));break;default:je!==We&&Ci(r,s,ke,je,g,We)}}Lu(r,N,K,me,Be,Ze,C,T);return;case"select":je=N=K=ke=null;for(C in c)if(me=c[C],c.hasOwnProperty(C)&&me!=null)switch(C){case"value":break;case"multiple":je=me;default:g.hasOwnProperty(C)||Ci(r,s,C,null,g,me)}for(T in g)if(C=g[T],me=c[T],g.hasOwnProperty(T)&&(C!=null||me!=null))switch(T){case"value":ke=C;break;case"defaultValue":K=C;break;case"multiple":N=C;default:C!==me&&Ci(r,s,T,C,g,me)}s=K,c=N,g=je,ke!=null?lo(r,!!c,ke,!1):!!g!=!!c&&(s!=null?lo(r,!!c,s,!0):lo(r,!!c,c?[]:"",!1));return;case"textarea":je=ke=null;for(K in c)if(T=c[K],c.hasOwnProperty(K)&&T!=null&&!g.hasOwnProperty(K))switch(K){case"value":break;case"children":break;default:Ci(r,s,K,null,g,T)}for(N in g)if(T=g[N],C=c[N],g.hasOwnProperty(N)&&(T!=null||C!=null))switch(N){case"value":ke=T;break;case"defaultValue":je=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(M(91));break;default:T!==C&&Ci(r,s,N,T,g,C)}cd(r,ke,je);return;case"option":for(var xt in c)ke=c[xt],c.hasOwnProperty(xt)&&ke!=null&&!g.hasOwnProperty(xt)&&(xt==="selected"?r.selected=!1:Ci(r,s,xt,null,g,ke));for(me in g)ke=g[me],je=c[me],g.hasOwnProperty(me)&&ke!==je&&(ke!=null||je!=null)&&(me==="selected"?r.selected=ke&&typeof ke!="function"&&typeof ke!="symbol":Ci(r,s,me,ke,g,je));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ot in c)ke=c[Ot],c.hasOwnProperty(Ot)&&ke!=null&&!g.hasOwnProperty(Ot)&&Ci(r,s,Ot,null,g,ke);for(Be in g)if(ke=g[Be],je=c[Be],g.hasOwnProperty(Be)&&ke!==je&&(ke!=null||je!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(M(137,s));break;default:Ci(r,s,Be,ke,g,je)}return;default:if(Ho(s)){for(var Hi in c)ke=c[Hi],c.hasOwnProperty(Hi)&&ke!==void 0&&!g.hasOwnProperty(Hi)&&up(r,s,Hi,void 0,g,ke);for(Ze in g)ke=g[Ze],je=c[Ze],!g.hasOwnProperty(Ze)||ke===je||ke===void 0&&je===void 0||up(r,s,Ze,ke,g,je);return}}for(var Te in c)ke=c[Te],c.hasOwnProperty(Te)&&ke!=null&&!g.hasOwnProperty(Te)&&Ci(r,s,Te,null,g,ke);for(We in g)ke=g[We],je=c[We],!g.hasOwnProperty(We)||ke===je||ke==null&&je==null||Ci(r,s,We,ke,g,je)}function Ra(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Ch(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,c=performance.getEntriesByType("resource"),g=0;g<c.length;g++){var T=c[g],C=T.transferSize,N=T.initiatorType,K=T.duration;if(C&&K&&Ra(N)){for(N=0,K=T.responseEnd,g+=1;g<c.length;g++){var me=c[g],Be=me.startTime;if(Be>K)break;var Ze=me.transferSize,We=me.initiatorType;Ze&&Ra(We)&&(me=me.responseEnd,N+=Ze*(me<K?1:(K-Be)/(me-Be)))}if(--g,s+=8*(C+N)/(T.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Pf=null,vm=null;function If(r){return r.nodeType===9?r:r.ownerDocument}function yu(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bm(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function cp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var vu=null;function hp(){var r=window.event;return r&&r.type==="popstate"?r===vu?!1:(vu=r,!0):(vu=null,!1)}var fp=typeof setTimeout=="function"?setTimeout:void 0,xm=typeof clearTimeout=="function"?clearTimeout:void 0,wm=typeof Promise=="function"?Promise:void 0,Tm=typeof queueMicrotask=="function"?queueMicrotask:typeof wm<"u"?function(r){return wm.resolve(null).then(r).catch(Sm)}:fp;function Sm(r){setTimeout(function(){throw r})}function bu(r){return r==="head"}function Ug(r,s){var c=s,g=0;do{var T=c.nextSibling;if(r.removeChild(c),T&&T.nodeType===8)if(c=T.data,c==="/$"||c==="/&"){if(g===0){r.removeChild(T),Mu(s);return}g--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")g++;else if(c==="html")Dh(r.ownerDocument.documentElement);else if(c==="head"){c=r.ownerDocument.head,Dh(c);for(var C=c.firstChild;C;){var N=C.nextSibling,K=C.nodeName;C[kt]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&C.rel.toLowerCase()==="stylesheet"||c.removeChild(C),C=N}}else c==="body"&&Dh(r.ownerDocument.body);c=T}while(c);Mu(s)}function Yt(r,s){var c=r;r=0;do{var g=c.nextSibling;if(c.nodeType===1?s?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(s?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(r===0)break;r--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||r++;c=g}while(c)}function Ws(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Ws(c),Go(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}r.removeChild(c)}}function yr(r,s,c,g){for(;r.nodeType===1;){var T=c;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!g&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(g){if(!r[kt])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(C=r.getAttribute("rel"),C==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(C!==T.rel||r.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||r.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||r.getAttribute("title")!==(T.title==null?null:T.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(C=r.getAttribute("src"),(C!==(T.src==null?null:T.src)||r.getAttribute("type")!==(T.type==null?null:T.type)||r.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&C&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var C=T.name==null?null:""+T.name;if(T.type==="hidden"&&r.getAttribute("name")===C)return r}else return r;if(r=Ka(r.nextSibling),r===null)break}return null}function Js(r,s,c){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!c||(r=Ka(r.nextSibling),r===null))return null;return r}function xu(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=Ka(r.nextSibling),r===null))return null;return r}function Ur(r){return r.data==="$?"||r.data==="$~"}function jn(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function rr(r,s){var c=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||c.readyState!=="loading")s();else{var g=function(){s(),c.removeEventListener("DOMContentLoaded",g)};c.addEventListener("DOMContentLoaded",g),r._reactRetry=g}}function Ka(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ca=null;function ar(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"||c==="/&"){if(s===0)return Ka(r.nextSibling);s--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||s++}r=r.nextSibling}return null}function Rf(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(s===0)return r;s--}else c!=="/$"&&c!=="/&"||s++}r=r.previousSibling}return null}function Gg(r,s,c){switch(s=If(c),r){case"html":if(r=s.documentElement,!r)throw Error(M(452));return r;case"head":if(r=s.head,!r)throw Error(M(453));return r;case"body":if(r=s.body,!r)throw Error(M(454));return r;default:throw Error(M(451))}}function Dh(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Go(r)}var vr=new Map,Mc=new Set;function dp(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Lo=ot.d;ot.d={f:qg,r:Zg,D:Mm,C:Gr,L:eo,m:qr,X:pp,S:Tu,M:Am};function qg(){var r=Lo.f(),s=Ef();return r||s}function Zg(r){var s=Is(r);s!==null&&s.tag===5&&s.type==="form"?Jn(s):Lo.r(r)}var wu=typeof document>"u"?null:document;function Em(r,s,c){var g=wu;if(g&&typeof s=="string"&&s){var T=Sr(s);T='link[rel="'+r+'"][href="'+T+'"]',typeof c=="string"&&(T+='[crossorigin="'+c+'"]'),Mc.has(T)||(Mc.add(T),r={rel:r,crossOrigin:c,href:s},g.querySelector(T)===null&&(s=g.createElement("link"),fr(s,"link",r),dn(s),g.head.appendChild(s)))}}function Mm(r){Lo.D(r),Em("dns-prefetch",r,null)}function Gr(r,s){Lo.C(r,s),Em("preconnect",r,s)}function eo(r,s,c){Lo.L(r,s,c);var g=wu;if(g&&r&&s){var T='link[rel="preload"][as="'+Sr(s)+'"]';s==="image"&&c&&c.imageSrcSet?(T+='[imagesrcset="'+Sr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(T+='[imagesizes="'+Sr(c.imageSizes)+'"]')):T+='[href="'+Sr(r)+'"]';var C=T;switch(s){case"style":C=Ac(r);break;case"script":C=El(r)}vr.has(C)||(r=Xe({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:r,as:s},c),vr.set(C,r),g.querySelector(T)!==null||s==="style"&&g.querySelector(zh(C))||s==="script"&&g.querySelector(Ph(C))||(s=g.createElement("link"),fr(s,"link",r),dn(s),g.head.appendChild(s)))}}function qr(r,s){Lo.m(r,s);var c=wu;if(c&&r){var g=s&&typeof s.as=="string"?s.as:"script",T='link[rel="modulepreload"][as="'+Sr(g)+'"][href="'+Sr(r)+'"]',C=T;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=El(r)}if(!vr.has(C)&&(r=Xe({rel:"modulepreload",href:r},s),vr.set(C,r),c.querySelector(T)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Ph(C)))return}g=c.createElement("link"),fr(g,"link",r),dn(g),c.head.appendChild(g)}}}function Tu(r,s,c){Lo.S(r,s,c);var g=wu;if(g&&r){var T=rs(g).hoistableStyles,C=Ac(r);s=s||"default";var N=T.get(C);if(!N){var K={loading:0,preload:null};if(N=g.querySelector(zh(C)))K.loading=5;else{r=Xe({rel:"stylesheet",href:r,"data-precedence":s},c),(c=vr.get(C))&&Of(r,c);var me=N=g.createElement("link");dn(me),fr(me,"link",r),me._p=new Promise(function(Be,Ze){me.onload=Be,me.onerror=Ze}),me.addEventListener("load",function(){K.loading|=1}),me.addEventListener("error",function(){K.loading|=2}),K.loading|=4,Ml(N,s,g)}N={type:"stylesheet",instance:N,count:1,state:K},T.set(C,N)}}}function pp(r,s){Lo.X(r,s);var c=wu;if(c&&r){var g=rs(c).hoistableScripts,T=El(r),C=g.get(T);C||(C=c.querySelector(Ph(T)),C||(r=Xe({src:r,async:!0},s),(s=vr.get(T))&&mp(r,s),C=c.createElement("script"),dn(C),fr(C,"link",r),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(T,C))}}function Am(r,s){Lo.M(r,s);var c=wu;if(c&&r){var g=rs(c).hoistableScripts,T=El(r),C=g.get(T);C||(C=c.querySelector(Ph(T)),C||(r=Xe({src:r,async:!0,type:"module"},s),(s=vr.get(T))&&mp(r,s),C=c.createElement("script"),dn(C),fr(C,"link",r),c.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(T,C))}}function Cm(r,s,c,g){var T=(T=Vt.current)?dp(T):null;if(!T)throw Error(M(446));switch(r){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Ac(c.href),c=rs(T).hoistableStyles,g=c.get(s),g||(g={type:"style",instance:null,count:0,state:null},c.set(s,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){r=Ac(c.href);var C=rs(T).hoistableStyles,N=C.get(r);if(N||(T=T.ownerDocument||T,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(r,N),(C=T.querySelector(zh(r)))&&!C._p&&(N.instance=C,N.state.loading=5),vr.has(r)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},vr.set(r,c),C||zm(T,r,c,N.state))),s&&g===null)throw Error(M(528,""));return N}if(s&&g!==null)throw Error(M(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=El(c),c=rs(T).hoistableScripts,g=c.get(s),g||(g={type:"script",instance:null,count:0,state:null},c.set(s,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(M(444,r))}}function Ac(r){return'href="'+Sr(r)+'"'}function zh(r){return'link[rel="stylesheet"]['+r+"]"}function Dm(r){return Xe({},r,{"data-precedence":r.precedence,precedence:null})}function zm(r,s,c,g){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?g.loading=1:(s=r.createElement("link"),g.preload=s,s.addEventListener("load",function(){return g.loading|=1}),s.addEventListener("error",function(){return g.loading|=2}),fr(s,"link",c),dn(s),r.head.appendChild(s))}function El(r){return'[src="'+Sr(r)+'"]'}function Ph(r){return"script[async]"+r}function Pm(r,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var g=r.querySelector('style[data-href~="'+Sr(c.href)+'"]');if(g)return s.instance=g,dn(g),g;var T=Xe({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return g=(r.ownerDocument||r).createElement("style"),dn(g),fr(g,"style",T),Ml(g,c.precedence,r),s.instance=g;case"stylesheet":T=Ac(c.href);var C=r.querySelector(zh(T));if(C)return s.state.loading|=4,s.instance=C,dn(C),C;g=Dm(c),(T=vr.get(T))&&Of(g,T),C=(r.ownerDocument||r).createElement("link"),dn(C);var N=C;return N._p=new Promise(function(K,me){N.onload=K,N.onerror=me}),fr(C,"link",g),s.state.loading|=4,Ml(C,c.precedence,r),s.instance=C;case"script":return C=El(c.src),(T=r.querySelector(Ph(C)))?(s.instance=T,dn(T),T):(g=c,(T=vr.get(C))&&(g=Xe({},c),mp(g,T)),r=r.ownerDocument||r,T=r.createElement("script"),dn(T),fr(T,"link",g),r.head.appendChild(T),s.instance=T);case"void":return null;default:throw Error(M(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(g=s.instance,s.state.loading|=4,Ml(g,c.precedence,r));return s.instance}function Ml(r,s,c){for(var g=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=g.length?g[g.length-1]:null,C=T,N=0;N<g.length;N++){var K=g[N];if(K.dataset.precedence===s)C=K;else if(C!==T)break}C?C.parentNode.insertBefore(r,C.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(r,s.firstChild))}function Of(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function mp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var gp=null;function Im(r,s,c){if(gp===null){var g=new Map,T=gp=new Map;T.set(c,g)}else T=gp,g=T.get(c),g||(g=new Map,T.set(c,g));if(g.has(r))return g;for(g.set(r,null),c=c.getElementsByTagName(r),T=0;T<c.length;T++){var C=c[T];if(!(C[kt]||C[Vi]||r==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var N=C.getAttribute(s)||"";N=r+N;var K=g.get(N);K?K.push(C):g.set(N,[C])}}return g}function Lf(r,s,c){r=r.ownerDocument||r,r.head.insertBefore(c,s==="title"?r.querySelector("head > title"):null)}function _p(r,s,c){if(c===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Bf(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function Rm(r,s,c,g){if(c.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var T=Ac(g.href),C=s.querySelector(zh(T));if(C){s=C._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Ff.bind(r),s.then(r,r)),c.state.loading|=4,c.instance=C,dn(C);return}C=s.ownerDocument||s,g=Dm(g),(T=vr.get(T))&&Of(g,T),C=C.createElement("link"),dn(C);var N=C;N._p=new Promise(function(K,me){N.onload=K,N.onerror=me}),fr(C,"link",g),c.instance=C}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(c,s),(s=c.state.preload)&&(c.state.loading&3)===0&&(r.count++,c=Ff.bind(r),s.addEventListener("load",c),s.addEventListener("error",c))}}var kf=0;function Om(r,s){return r.stylesheets&&r.count===0&&Nf(r,r.stylesheets),0<r.count||0<r.imgCount?function(c){var g=setTimeout(function(){if(r.stylesheets&&Nf(r,r.stylesheets),r.unsuspend){var C=r.unsuspend;r.unsuspend=null,C()}},6e4+s);0<r.imgBytes&&kf===0&&(kf=62500*Ch());var T=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Nf(r,r.stylesheets),r.unsuspend)){var C=r.unsuspend;r.unsuspend=null,C()}},(r.imgBytes>kf?50:800)+s);return r.unsuspend=c,function(){r.unsuspend=null,clearTimeout(g),clearTimeout(T)}}:null}function Ff(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var jf=null;function Nf(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,jf=new Map,s.forEach(Hg,r),jf=null,Ff.call(r))}function Hg(r,s){if(!(s.state.loading&4)){var c=jf.get(r);if(c)var g=c.get(null);else{c=new Map,jf.set(r,c);for(var T=r.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<T.length;C++){var N=T[C];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(c.set(N.dataset.precedence,N),g=N)}g&&c.set(null,g)}T=s.instance,N=T.getAttribute("data-precedence"),C=c.get(N)||g,C===g&&c.set(null,T),c.set(N,T),this.count++,g=Ff.bind(this),T.addEventListener("load",g),T.addEventListener("error",g),C?C.parentNode.insertBefore(T,C.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(T,r.firstChild)),s.state.loading|=4}}var Ih={$$typeof:Ct,Provider:null,Consumer:null,_currentValue:Pt,_currentValue2:Pt,_threadCount:0};function F_(r,s,c,g,T,C,N,K,me){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gn(0),this.hiddenUpdates=Gn(null),this.identifierPrefix=g,this.onUncaughtError=T,this.onCaughtError=C,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function Lm(r,s,c,g,T,C,N,K,me,Be,Ze,We){return r=new F_(r,s,c,N,me,Be,Ze,We,K),s=1,C===!0&&(s|=24),C=ea(3,null,null,s),r.current=C,C.stateNode=r,s=_s(),s.refCount++,r.pooledCache=s,s.refCount++,C.memoizedState={element:g,isDehydrated:c,cache:s},uh(C),r}function $g(r){return r?(r=Ut,r):Ut}function Xg(r,s,c,g,T,C){T=$g(T),g.context===null?g.context=T:g.pendingContext=T,g=ws(s),g.payload={element:c},C=C===void 0?null:C,C!==null&&(g.callback=C),c=Us(r,g,s),c!==null&&(Ia(c,r,s),Ta(c,r,s))}function yp(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<s?c:s}}function vp(r,s){yp(r,s),(r=r.alternate)&&yp(r,s)}function Yg(r){if(r.tag===13||r.tag===31){var s=ba(r,67108864);s!==null&&Ia(s,r,67108864),vp(r,67108864)}}function Qg(r){if(r.tag===13||r.tag===31){var s=Pa();s=Uo(s);var c=ba(r,s);c!==null&&Ia(c,r,s),vp(r,s)}}var Vf=!0;function Uf(r,s,c,g){var T=qe.T;qe.T=null;var C=ot.p;try{ot.p=2,Bm(r,s,c,g)}finally{ot.p=C,qe.T=T}}function Kg(r,s,c,g){var T=qe.T;qe.T=null;var C=ot.p;try{ot.p=8,Bm(r,s,c,g)}finally{ot.p=C,qe.T=T}}function Bm(r,s,c,g){if(Vf){var T=Gf(g);if(T===null)Oo(r,s,g,Rh,c),Wg(r,g);else if(N_(T,r,s,c,g))g.stopPropagation();else if(Wg(r,g),s&4&&-1<j_.indexOf(r)){for(;T!==null;){var C=Is(T);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var N=Ee(C.pendingLanes);if(N!==0){var K=C;for(K.pendingLanes|=2,K.entangledLanes|=2;N;){var me=1<<31-Ue(N);K.entanglements[1]|=me,N&=~me}Ks(C),(ki&6)===0&&(Tf=Yn()+500,Qa(0))}}break;case 31:case 13:K=ba(C,2),K!==null&&Ia(K,C,2),Ef(),vp(C,2)}if(C=Gf(g),C===null&&Oo(r,s,g,Rh,c),C===T)break;T=C}T!==null&&g.stopPropagation()}else Oo(r,s,g,null,c)}}function Gf(r){return r=ku(r),bp(r)}var Rh=null;function bp(r){if(Rh=null,r=is(r),r!==null){var s=H(r);if(s===null)r=null;else{var c=s.tag;if(c===13){if(r=P(s),r!==null)return r;r=null}else if(c===31){if(r=h(s),r!==null)return r;r=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Rh=r,null}function Cc(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Rr()){case Se:return 2;case $:return 8;case Z:case W:return 32;case fe:return 268435456;default:return 32}default:return 32}}var xp=!1,Su=null,Cs=null,Eu=null,qf=new Map,Oh=new Map,Al=[],j_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wg(r,s){switch(r){case"focusin":case"focusout":Su=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Eu=null;break;case"pointerover":case"pointerout":qf.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oh.delete(s.pointerId)}}function Zf(r,s,c,g,T,C){return r===null||r.nativeEvent!==C?(r={blockedOn:s,domEventName:c,eventSystemFlags:g,nativeEvent:C,targetContainers:[T]},s!==null&&(s=Is(s),s!==null&&Yg(s)),r):(r.eventSystemFlags|=g,s=r.targetContainers,T!==null&&s.indexOf(T)===-1&&s.push(T),r)}function N_(r,s,c,g,T){switch(s){case"focusin":return Su=Zf(Su,r,s,c,g,T),!0;case"dragenter":return Cs=Zf(Cs,r,s,c,g,T),!0;case"mouseover":return Eu=Zf(Eu,r,s,c,g,T),!0;case"pointerover":var C=T.pointerId;return qf.set(C,Zf(qf.get(C)||null,r,s,c,g,T)),!0;case"gotpointercapture":return C=T.pointerId,Oh.set(C,Zf(Oh.get(C)||null,r,s,c,g,T)),!0}return!1}function Jg(r){var s=is(r.target);if(s!==null){var c=H(s);if(c!==null){if(s=c.tag,s===13){if(s=P(c),s!==null){r.blockedOn=s,pr(r.priority,function(){Qg(c)});return}}else if(s===31){if(s=h(c),s!==null){r.blockedOn=s,pr(r.priority,function(){Qg(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Hf(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var c=Gf(r.nativeEvent);if(c===null){c=r.nativeEvent;var g=new c.constructor(c.type,c);Uh=g,c.target.dispatchEvent(g),Uh=null}else return s=Is(c),s!==null&&Yg(s),r.blockedOn=c,!1;s.shift()}return!0}function e_(r,s,c){Hf(r)&&c.delete(s)}function $f(){xp=!1,Su!==null&&Hf(Su)&&(Su=null),Cs!==null&&Hf(Cs)&&(Cs=null),Eu!==null&&Hf(Eu)&&(Eu=null),qf.forEach(e_),Oh.forEach(e_)}function wp(r,s){r.blockedOn===s&&(r.blockedOn=null,xp||(xp=!0,v.unstable_scheduleCallback(v.unstable_NormalPriority,$f)))}var Tp=null;function t_(r){Tp!==r&&(Tp=r,v.unstable_scheduleCallback(v.unstable_NormalPriority,function(){Tp===r&&(Tp=null);for(var s=0;s<r.length;s+=3){var c=r[s],g=r[s+1],T=r[s+2];if(typeof g!="function"){if(bp(g||c)===null)continue;break}var C=Is(c);C!==null&&(r.splice(s,3),s-=3,_n(C,{pending:!0,data:T,method:c.method,action:g},g,T))}}))}function Mu(r){function s(me){return wp(me,r)}Su!==null&&wp(Su,r),Cs!==null&&wp(Cs,r),Eu!==null&&wp(Eu,r),qf.forEach(s),Oh.forEach(s);for(var c=0;c<Al.length;c++){var g=Al[c];g.blockedOn===r&&(g.blockedOn=null)}for(;0<Al.length&&(c=Al[0],c.blockedOn===null);)Jg(c),c.blockedOn===null&&Al.shift();if(c=(r.ownerDocument||r).$$reactFormReplay,c!=null)for(g=0;g<c.length;g+=3){var T=c[g],C=c[g+1],N=T[nt]||null;if(typeof C=="function")N||t_(c);else if(N){var K=null;if(C&&C.hasAttribute("formAction")){if(T=C,N=C[nt]||null)K=N.formAction;else if(bp(T)!==null)continue}else K=N.action;typeof K=="function"?c[g+1]=K:(c.splice(g,3),g-=3),t_(c)}}}function km(){function r(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(N){return T=N})},focusReset:"manual",scroll:"manual"})}function s(){T!==null&&(T(),T=null),g||setTimeout(c,20)}function c(){if(!g&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,T=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(c,100),function(){g=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),T!==null&&(T(),T=null)}}}function Fm(r){this._internalRoot=r}Sp.prototype.render=Fm.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(M(409));var c=s.current,g=Pa();Xg(c,g,r,s,null,null)},Sp.prototype.unmount=Fm.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Xg(r.current,2,null,r,null,null),Ef(),s[Ft]=null}};function Sp(r){this._internalRoot=r}Sp.prototype.unstable_scheduleHydration=function(r){if(r){var s=dr();r={blockedOn:null,target:r,priority:s};for(var c=0;c<Al.length&&s!==0&&s<Al[c].priority;c++);Al.splice(c,0,r),c===0&&Jg(r)}};var jm=S.version;if(jm!=="19.2.3")throw Error(M(527,jm,"19.2.3"));ot.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(M(188)):(r=Object.keys(r).join(","),Error(M(268,r)));return r=ge(s),r=r!==null?Le(r):null,r=r===null?null:r.stateNode,r};var i_={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:qe,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ep=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ep.isDisabled&&Ep.supportsFiber)try{we=Ep.inject(i_),_e=Ep}catch{}}return Zm.createRoot=function(r,s){if(!F(r))throw Error(M(299));var c=!1,g="",T=dh,C=$s,N=Xs;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onUncaughtError!==void 0&&(T=s.onUncaughtError),s.onCaughtError!==void 0&&(C=s.onCaughtError),s.onRecoverableError!==void 0&&(N=s.onRecoverableError)),s=Lm(r,1,!1,null,null,c,g,null,T,C,N,km),r[Ft]=s.current,gm(r),new Fm(s)},Zm.hydrateRoot=function(r,s,c){if(!F(r))throw Error(M(299));var g=!1,T="",C=dh,N=$s,K=Xs,me=null;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(T=c.identifierPrefix),c.onUncaughtError!==void 0&&(C=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(K=c.onRecoverableError),c.formState!==void 0&&(me=c.formState)),s=Lm(r,1,!0,s,c??null,g,T,me,C,N,K,km),s.context=$g(null),c=s.current,g=Pa(),g=Uo(g),T=ws(g),T.callback=null,Us(c,T,g),c=g,s.current.lanes=c,Ei(s,c),Ks(s),r[Ft]=s.current,gm(r),new Sp(s)},Zm.version="19.2.3",Zm}var cv;function _b(){if(cv)return W_.exports;cv=1;function v(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v)}catch(S){console.error(S)}}return v(),W_.exports=gb(),W_.exports}var yb=_b(),Wm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(v){return this.listeners.add(v),this.onSubscribe(),()=>{this.listeners.delete(v),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},vb={setTimeout:(v,S)=>setTimeout(v,S),clearTimeout:v=>clearTimeout(v),setInterval:(v,S)=>setInterval(v,S),clearInterval:v=>clearInterval(v)},bb=class{#e=vb;#t=!1;setTimeoutProvider(v){this.#e=v}setTimeout(v,S){return this.#e.setTimeout(v,S)}clearTimeout(v){this.#e.clearTimeout(v)}setInterval(v,S){return this.#e.setInterval(v,S)}clearInterval(v){this.#e.clearInterval(v)}},Kf=new bb;function xb(v){setTimeout(v,0)}var Jf=typeof window>"u"||"Deno"in globalThis;function Ds(){}function wb(v,S){return typeof v=="function"?v(S):v}function cy(v){return typeof v=="number"&&v>=0&&v!==1/0}function Zv(v,S){return Math.max(v+(S||0)-Date.now(),0)}function kh(v,S){return typeof v=="function"?v(S):v}function ko(v,S){return typeof v=="function"?v(S):v}function hv(v,S){const{type:z="all",exact:M,fetchStatus:F,predicate:H,queryKey:P,stale:h}=v;if(P){if(M){if(S.queryHash!==zy(P,S.options))return!1}else if(!Ym(S.queryKey,P))return!1}if(z!=="all"){const ne=S.isActive();if(z==="active"&&!ne||z==="inactive"&&ne)return!1}return!(typeof h=="boolean"&&S.isStale()!==h||F&&F!==S.state.fetchStatus||H&&!H(S))}function fv(v,S){const{exact:z,status:M,predicate:F,mutationKey:H}=v;if(H){if(!S.options.mutationKey)return!1;if(z){if(Xm(S.options.mutationKey)!==Xm(H))return!1}else if(!Ym(S.options.mutationKey,H))return!1}return!(M&&S.state.status!==M||F&&!F(S))}function zy(v,S){return(S?.queryKeyHashFn||Xm)(v)}function Xm(v){return JSON.stringify(v,(S,z)=>fy(z)?Object.keys(z).sort().reduce((M,F)=>(M[F]=z[F],M),{}):z)}function Ym(v,S){return v===S?!0:typeof v!=typeof S?!1:v&&S&&typeof v=="object"&&typeof S=="object"?Object.keys(S).every(z=>Ym(v[z],S[z])):!1}var Tb=Object.prototype.hasOwnProperty;function Hv(v,S,z=0){if(v===S)return v;if(z>500)return S;const M=dv(v)&&dv(S);if(!M&&!(fy(v)&&fy(S)))return S;const H=(M?v:Object.keys(v)).length,P=M?S:Object.keys(S),h=P.length,ne=M?new Array(h):{};let ge=0;for(let Le=0;Le<h;Le++){const Xe=M?Le:P[Le],Je=v[Xe],yt=S[Xe];if(Je===yt){ne[Xe]=Je,(M?Le<H:Tb.call(v,Xe))&&ge++;continue}if(Je===null||yt===null||typeof Je!="object"||typeof yt!="object"){ne[Xe]=yt;continue}const Et=Hv(Je,yt,z+1);ne[Xe]=Et,Et===Je&&ge++}return H===h&&ge===H?v:ne}function hy(v,S){if(!S||Object.keys(v).length!==Object.keys(S).length)return!1;for(const z in v)if(v[z]!==S[z])return!1;return!0}function dv(v){return Array.isArray(v)&&v.length===Object.keys(v).length}function fy(v){if(!pv(v))return!1;const S=v.constructor;if(S===void 0)return!0;const z=S.prototype;return!(!pv(z)||!z.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(v)!==Object.prototype)}function pv(v){return Object.prototype.toString.call(v)==="[object Object]"}function Sb(v){return new Promise(S=>{Kf.setTimeout(S,v)})}function dy(v,S,z){return typeof z.structuralSharing=="function"?z.structuralSharing(v,S):z.structuralSharing!==!1?Hv(v,S):S}function Eb(v,S,z=0){const M=[...v,S];return z&&M.length>z?M.slice(1):M}function Mb(v,S,z=0){const M=[S,...v];return z&&M.length>z?M.slice(0,-1):M}var Py=Symbol();function $v(v,S){return!v.queryFn&&S?.initialPromise?()=>S.initialPromise:!v.queryFn||v.queryFn===Py?()=>Promise.reject(new Error(`Missing queryFn: '${v.queryHash}'`)):v.queryFn}function Xv(v,S){return typeof v=="function"?v(...S):!!v}function Ab(v,S,z){let M=!1,F;return Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(F??=S(),M||(M=!0,F.aborted?z():F.addEventListener("abort",z,{once:!0})),F)}),v}var Cb=class extends Wm{#e;#t;#i;constructor(){super(),this.#i=v=>{if(!Jf&&window.addEventListener){const S=()=>v();return window.addEventListener("visibilitychange",S,!1),()=>{window.removeEventListener("visibilitychange",S)}}}}onSubscribe(){this.#t||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(v){this.#i=v,this.#t?.(),this.#t=v(S=>{typeof S=="boolean"?this.setFocused(S):this.onFocus()})}setFocused(v){this.#e!==v&&(this.#e=v,this.onFocus())}onFocus(){const v=this.isFocused();this.listeners.forEach(S=>{S(v)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Iy=new Cb;function py(){let v,S;const z=new Promise((F,H)=>{v=F,S=H});z.status="pending",z.catch(()=>{});function M(F){Object.assign(z,F),delete z.resolve,delete z.reject}return z.resolve=F=>{M({status:"fulfilled",value:F}),v(F)},z.reject=F=>{M({status:"rejected",reason:F}),S(F)},z}var Db=xb;function zb(){let v=[],S=0,z=h=>{h()},M=h=>{h()},F=Db;const H=h=>{S?v.push(h):F(()=>{z(h)})},P=()=>{const h=v;v=[],h.length&&F(()=>{M(()=>{h.forEach(ne=>{z(ne)})})})};return{batch:h=>{let ne;S++;try{ne=h()}finally{S--,S||P()}return ne},batchCalls:h=>(...ne)=>{H(()=>{h(...ne)})},schedule:H,setNotifyFunction:h=>{z=h},setBatchNotifyFunction:h=>{M=h},setScheduler:h=>{F=h}}}var fa=zb(),Pb=class extends Wm{#e=!0;#t;#i;constructor(){super(),this.#i=v=>{if(!Jf&&window.addEventListener){const S=()=>v(!0),z=()=>v(!1);return window.addEventListener("online",S,!1),window.addEventListener("offline",z,!1),()=>{window.removeEventListener("online",S),window.removeEventListener("offline",z)}}}}onSubscribe(){this.#t||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(v){this.#i=v,this.#t?.(),this.#t=v(this.setOnline.bind(this))}setOnline(v){this.#e!==v&&(this.#e=v,this.listeners.forEach(z=>{z(v)}))}isOnline(){return this.#e}},d_=new Pb;function Ib(v){return Math.min(1e3*2**v,3e4)}function Yv(v){return(v??"online")==="online"?d_.isOnline():!0}var my=class extends Error{constructor(v){super("CancelledError"),this.revert=v?.revert,this.silent=v?.silent}};function Qv(v){let S=!1,z=0,M;const F=py(),H=()=>F.status!=="pending",P=rt=>{if(!H()){const xe=new my(rt);Je(xe),v.onCancel?.(xe)}},h=()=>{S=!0},ne=()=>{S=!1},ge=()=>Iy.isFocused()&&(v.networkMode==="always"||d_.isOnline())&&v.canRun(),Le=()=>Yv(v.networkMode)&&v.canRun(),Xe=rt=>{H()||(M?.(),F.resolve(rt))},Je=rt=>{H()||(M?.(),F.reject(rt))},yt=()=>new Promise(rt=>{M=xe=>{(H()||ge())&&rt(xe)},v.onPause?.()}).then(()=>{M=void 0,H()||v.onContinue?.()}),Et=()=>{if(H())return;let rt;const xe=z===0?v.initialPromise:void 0;try{rt=xe??v.fn()}catch(Jt){rt=Promise.reject(Jt)}Promise.resolve(rt).then(Xe).catch(Jt=>{if(H())return;const Nt=v.retry??(Jf?0:3),Ct=v.retryDelay??Ib,Kt=typeof Ct=="function"?Ct(z,Jt):Ct,di=Nt===!0||typeof Nt=="number"&&z<Nt||typeof Nt=="function"&&Nt(z,Jt);if(S||!di){Je(Jt);return}z++,v.onFail?.(z,Jt),Sb(Kt).then(()=>ge()?void 0:yt()).then(()=>{S?Je(Jt):Et()})})};return{promise:F,status:()=>F.status,cancel:P,continue:()=>(M?.(),F),cancelRetry:h,continueRetry:ne,canStart:Le,start:()=>(Le()?Et():yt().then(Et),F)}}var Kv=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),cy(this.gcTime)&&(this.#e=Kf.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(v){this.gcTime=Math.max(this.gcTime||0,v??(Jf?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Kf.clearTimeout(this.#e),this.#e=void 0)}},Rb=class extends Kv{#e;#t;#i;#r;#n;#o;#s;constructor(v){super(),this.#s=!1,this.#o=v.defaultOptions,this.setOptions(v.options),this.observers=[],this.#r=v.client,this.#i=this.#r.getQueryCache(),this.queryKey=v.queryKey,this.queryHash=v.queryHash,this.#e=gv(this.options),this.state=v.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(v){if(this.options={...this.#o,...v},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const S=gv(this.options);S.data!==void 0&&(this.setState(mv(S.data,S.dataUpdatedAt)),this.#e=S)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#i.remove(this)}setData(v,S){const z=dy(this.state.data,v,this.options);return this.#a({data:z,type:"success",dataUpdatedAt:S?.updatedAt,manual:S?.manual}),z}setState(v,S){this.#a({type:"setState",state:v,setStateOptions:S})}cancel(v){const S=this.#n?.promise;return this.#n?.cancel(v),S?S.then(Ds).catch(Ds):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(v=>ko(v.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Py||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(v=>kh(v.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(v=>v.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(v=0){return this.state.data===void 0?!0:v==="static"?!1:this.state.isInvalidated?!0:!Zv(this.state.dataUpdatedAt,v)}onFocus(){this.observers.find(S=>S.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(S=>S.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(v){this.observers.includes(v)||(this.observers.push(v),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:v}))}removeObserver(v){this.observers.includes(v)&&(this.observers=this.observers.filter(S=>S!==v),this.observers.length||(this.#n&&(this.#s?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:v}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(v,S){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&S?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(v&&this.setOptions(v),!this.options.queryFn){const h=this.observers.find(ne=>ne.options.queryFn);h&&this.setOptions(h.options)}const z=new AbortController,M=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(this.#s=!0,z.signal)})},F=()=>{const h=$v(this.options,S),ge=(()=>{const Le={client:this.#r,queryKey:this.queryKey,meta:this.meta};return M(Le),Le})();return this.#s=!1,this.options.persister?this.options.persister(h,ge,this):h(ge)},P=(()=>{const h={fetchOptions:S,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:F};return M(h),h})();this.options.behavior?.onFetch(P,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==P.fetchOptions?.meta)&&this.#a({type:"fetch",meta:P.fetchOptions?.meta}),this.#n=Qv({initialPromise:S?.initialPromise,fn:P.fetchFn,onCancel:h=>{h instanceof my&&h.revert&&this.setState({...this.#t,fetchStatus:"idle"}),z.abort()},onFail:(h,ne)=>{this.#a({type:"failed",failureCount:h,error:ne})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:P.options.retry,retryDelay:P.options.retryDelay,networkMode:P.options.networkMode,canRun:()=>!0});try{const h=await this.#n.start();if(h===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(h),this.#i.config.onSuccess?.(h,this),this.#i.config.onSettled?.(h,this.state.error,this),h}catch(h){if(h instanceof my){if(h.silent)return this.#n.promise;if(h.revert){if(this.state.data===void 0)throw h;return this.state.data}}throw this.#a({type:"error",error:h}),this.#i.config.onError?.(h,this),this.#i.config.onSettled?.(this.state.data,h,this),h}finally{this.scheduleGc()}}#a(v){const S=z=>{switch(v.type){case"failed":return{...z,fetchFailureCount:v.failureCount,fetchFailureReason:v.error};case"pause":return{...z,fetchStatus:"paused"};case"continue":return{...z,fetchStatus:"fetching"};case"fetch":return{...z,...Wv(z.data,this.options),fetchMeta:v.meta??null};case"success":const M={...z,...mv(v.data,v.dataUpdatedAt),dataUpdateCount:z.dataUpdateCount+1,...!v.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=v.manual?M:void 0,M;case"error":const F=v.error;return{...z,error:F,errorUpdateCount:z.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:z.fetchFailureCount+1,fetchFailureReason:F,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...z,isInvalidated:!0};case"setState":return{...z,...v.state}}};this.state=S(this.state),fa.batch(()=>{this.observers.forEach(z=>{z.onQueryUpdate()}),this.#i.notify({query:this,type:"updated",action:v})})}};function Wv(v,S){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Yv(S.networkMode)?"fetching":"paused",...v===void 0&&{error:null,status:"pending"}}}function mv(v,S){return{data:v,dataUpdatedAt:S??Date.now(),error:null,isInvalidated:!1,status:"success"}}function gv(v){const S=typeof v.initialData=="function"?v.initialData():v.initialData,z=S!==void 0,M=z?typeof v.initialDataUpdatedAt=="function"?v.initialDataUpdatedAt():v.initialDataUpdatedAt:0;return{data:S,dataUpdateCount:0,dataUpdatedAt:z?M??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:z?"success":"pending",fetchStatus:"idle"}}var Ob=class extends Wm{constructor(v,S){super(),this.options=S,this.#e=v,this.#a=null,this.#s=py(),this.bindMethods(),this.setOptions(S)}#e;#t=void 0;#i=void 0;#r=void 0;#n;#o;#s;#a;#m;#f;#d;#u;#c;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),_v(this.#t,this.options)?this.#h():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return gy(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return gy(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(v){const S=this.options,z=this.#t;if(this.options=this.#e.defaultQueryOptions(v),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ko(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#t.setOptions(this.options),S._defaulted&&!hy(this.options,S)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const M=this.hasListeners();M&&yv(this.#t,z,this.options,S)&&this.#h(),this.updateResult(),M&&(this.#t!==z||ko(this.options.enabled,this.#t)!==ko(S.enabled,this.#t)||kh(this.options.staleTime,this.#t)!==kh(S.staleTime,this.#t))&&this.#g();const F=this.#_();M&&(this.#t!==z||ko(this.options.enabled,this.#t)!==ko(S.enabled,this.#t)||F!==this.#l)&&this.#y(F)}getOptimisticResult(v){const S=this.#e.getQueryCache().build(this.#e,v),z=this.createResult(S,v);return Bb(this,z)&&(this.#r=z,this.#o=this.options,this.#n=this.#t.state),z}getCurrentResult(){return this.#r}trackResult(v,S){return new Proxy(v,{get:(z,M)=>(this.trackProp(M),S?.(M),M==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#s.status==="pending"&&this.#s.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(z,M))})}trackProp(v){this.#p.add(v)}getCurrentQuery(){return this.#t}refetch({...v}={}){return this.fetch({...v})}fetchOptimistic(v){const S=this.#e.defaultQueryOptions(v),z=this.#e.getQueryCache().build(this.#e,S);return z.fetch().then(()=>this.createResult(z,S))}fetch(v){return this.#h({...v,cancelRefetch:v.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#h(v){this.#w();let S=this.#t.fetch(this.options,v);return v?.throwOnError||(S=S.catch(Ds)),S}#g(){this.#b();const v=kh(this.options.staleTime,this.#t);if(Jf||this.#r.isStale||!cy(v))return;const z=Zv(this.#r.dataUpdatedAt,v)+1;this.#u=Kf.setTimeout(()=>{this.#r.isStale||this.updateResult()},z)}#_(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#y(v){this.#x(),this.#l=v,!(Jf||ko(this.options.enabled,this.#t)===!1||!cy(this.#l)||this.#l===0)&&(this.#c=Kf.setInterval(()=>{(this.options.refetchIntervalInBackground||Iy.isFocused())&&this.#h()},this.#l))}#v(){this.#g(),this.#y(this.#_())}#b(){this.#u&&(Kf.clearTimeout(this.#u),this.#u=void 0)}#x(){this.#c&&(Kf.clearInterval(this.#c),this.#c=void 0)}createResult(v,S){const z=this.#t,M=this.options,F=this.#r,H=this.#n,P=this.#o,ne=v!==z?v.state:this.#i,{state:ge}=v;let Le={...ge},Xe=!1,Je;if(S._optimisticResults){const pi=this.hasListeners(),cn=!pi&&_v(v,S),Vn=pi&&yv(v,z,S,M);(cn||Vn)&&(Le={...Le,...Wv(ge.data,v.options)}),S._optimisticResults==="isRestoring"&&(Le.fetchStatus="idle")}let{error:yt,errorUpdatedAt:Et,status:rt}=Le;Je=Le.data;let xe=!1;if(S.placeholderData!==void 0&&Je===void 0&&rt==="pending"){let pi;F?.isPlaceholderData&&S.placeholderData===P?.placeholderData?(pi=F.data,xe=!0):pi=typeof S.placeholderData=="function"?S.placeholderData(this.#d?.state.data,this.#d):S.placeholderData,pi!==void 0&&(rt="success",Je=dy(F?.data,pi,S),Xe=!0)}if(S.select&&Je!==void 0&&!xe)if(F&&Je===H?.data&&S.select===this.#m)Je=this.#f;else try{this.#m=S.select,Je=S.select(Je),Je=dy(F?.data,Je,S),this.#f=Je,this.#a=null}catch(pi){this.#a=pi}this.#a&&(yt=this.#a,Je=this.#f,Et=Date.now(),rt="error");const Jt=Le.fetchStatus==="fetching",Nt=rt==="pending",Ct=rt==="error",Kt=Nt&&Jt,di=Je!==void 0,St={status:rt,fetchStatus:Le.fetchStatus,isPending:Nt,isSuccess:rt==="success",isError:Ct,isInitialLoading:Kt,isLoading:Kt,data:Je,dataUpdatedAt:Le.dataUpdatedAt,error:yt,errorUpdatedAt:Et,failureCount:Le.fetchFailureCount,failureReason:Le.fetchFailureReason,errorUpdateCount:Le.errorUpdateCount,isFetched:Le.dataUpdateCount>0||Le.errorUpdateCount>0,isFetchedAfterMount:Le.dataUpdateCount>ne.dataUpdateCount||Le.errorUpdateCount>ne.errorUpdateCount,isFetching:Jt,isRefetching:Jt&&!Nt,isLoadingError:Ct&&!di,isPaused:Le.fetchStatus==="paused",isPlaceholderData:Xe,isRefetchError:Ct&&di,isStale:Ry(v,S),refetch:this.refetch,promise:this.#s,isEnabled:ko(S.enabled,v)!==!1};if(this.options.experimental_prefetchInRender){const pi=St.data!==void 0,cn=St.status==="error"&&!pi,Vn=Cn=>{cn?Cn.reject(St.error):pi&&Cn.resolve(St.data)},Un=()=>{const Cn=this.#s=St.promise=py();Vn(Cn)},Ni=this.#s;switch(Ni.status){case"pending":v.queryHash===z.queryHash&&Vn(Ni);break;case"fulfilled":(cn||St.data!==Ni.value)&&Un();break;case"rejected":(!cn||St.error!==Ni.reason)&&Un();break}}return St}updateResult(){const v=this.#r,S=this.createResult(this.#t,this.options);if(this.#n=this.#t.state,this.#o=this.options,this.#n.data!==void 0&&(this.#d=this.#t),hy(S,v))return;this.#r=S;const z=()=>{if(!v)return!0;const{notifyOnChangeProps:M}=this.options,F=typeof M=="function"?M():M;if(F==="all"||!F&&!this.#p.size)return!0;const H=new Set(F??this.#p);return this.options.throwOnError&&H.add("error"),Object.keys(this.#r).some(P=>{const h=P;return this.#r[h]!==v[h]&&H.has(h)})};this.#T({listeners:z()})}#w(){const v=this.#e.getQueryCache().build(this.#e,this.options);if(v===this.#t)return;const S=this.#t;this.#t=v,this.#i=v.state,this.hasListeners()&&(S?.removeObserver(this),v.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#T(v){fa.batch(()=>{v.listeners&&this.listeners.forEach(S=>{S(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function Lb(v,S){return ko(S.enabled,v)!==!1&&v.state.data===void 0&&!(v.state.status==="error"&&S.retryOnMount===!1)}function _v(v,S){return Lb(v,S)||v.state.data!==void 0&&gy(v,S,S.refetchOnMount)}function gy(v,S,z){if(ko(S.enabled,v)!==!1&&kh(S.staleTime,v)!=="static"){const M=typeof z=="function"?z(v):z;return M==="always"||M!==!1&&Ry(v,S)}return!1}function yv(v,S,z,M){return(v!==S||ko(M.enabled,v)===!1)&&(!z.suspense||v.state.status!=="error")&&Ry(v,z)}function Ry(v,S){return ko(S.enabled,v)!==!1&&v.isStaleByTime(kh(S.staleTime,v))}function Bb(v,S){return!hy(v.getCurrentResult(),S)}function vv(v){return{onFetch:(S,z)=>{const M=S.options,F=S.fetchOptions?.meta?.fetchMore?.direction,H=S.state.data?.pages||[],P=S.state.data?.pageParams||[];let h={pages:[],pageParams:[]},ne=0;const ge=async()=>{let Le=!1;const Xe=Et=>{Ab(Et,()=>S.signal,()=>Le=!0)},Je=$v(S.options,S.fetchOptions),yt=async(Et,rt,xe)=>{if(Le)return Promise.reject();if(rt==null&&Et.pages.length)return Promise.resolve(Et);const Nt=(()=>{const Si={client:S.client,queryKey:S.queryKey,pageParam:rt,direction:xe?"backward":"forward",meta:S.options.meta};return Xe(Si),Si})(),Ct=await Je(Nt),{maxPages:Kt}=S.options,di=xe?Mb:Eb;return{pages:di(Et.pages,Ct,Kt),pageParams:di(Et.pageParams,rt,Kt)}};if(F&&H.length){const Et=F==="backward",rt=Et?kb:bv,xe={pages:H,pageParams:P},Jt=rt(M,xe);h=await yt(xe,Jt,Et)}else{const Et=v??H.length;do{const rt=ne===0?P[0]??M.initialPageParam:bv(M,h);if(ne>0&&rt==null)break;h=await yt(h,rt),ne++}while(ne<Et)}return h};S.options.persister?S.fetchFn=()=>S.options.persister?.(ge,{client:S.client,queryKey:S.queryKey,meta:S.options.meta,signal:S.signal},z):S.fetchFn=ge}}}function bv(v,{pages:S,pageParams:z}){const M=S.length-1;return S.length>0?v.getNextPageParam(S[M],S,z[M],z):void 0}function kb(v,{pages:S,pageParams:z}){return S.length>0?v.getPreviousPageParam?.(S[0],S,z[0],z):void 0}var Fb=class extends Kv{#e;#t;#i;#r;constructor(v){super(),this.#e=v.client,this.mutationId=v.mutationId,this.#i=v.mutationCache,this.#t=[],this.state=v.state||jb(),this.setOptions(v.options),this.scheduleGc()}setOptions(v){this.options=v,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(v){this.#t.includes(v)||(this.#t.push(v),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",mutation:this,observer:v}))}removeObserver(v){this.#t=this.#t.filter(S=>S!==v),this.scheduleGc(),this.#i.notify({type:"observerRemoved",mutation:this,observer:v})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#i.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(v){const S=()=>{this.#n({type:"continue"})},z={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#r=Qv({fn:()=>this.options.mutationFn?this.options.mutationFn(v,z):Promise.reject(new Error("No mutationFn found")),onFail:(H,P)=>{this.#n({type:"failed",failureCount:H,error:P})},onPause:()=>{this.#n({type:"pause"})},onContinue:S,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#i.canRun(this)});const M=this.state.status==="pending",F=!this.#r.canStart();try{if(M)S();else{this.#n({type:"pending",variables:v,isPaused:F}),this.#i.config.onMutate&&await this.#i.config.onMutate(v,this,z);const P=await this.options.onMutate?.(v,z);P!==this.state.context&&this.#n({type:"pending",context:P,variables:v,isPaused:F})}const H=await this.#r.start();return await this.#i.config.onSuccess?.(H,v,this.state.context,this,z),await this.options.onSuccess?.(H,v,this.state.context,z),await this.#i.config.onSettled?.(H,null,this.state.variables,this.state.context,this,z),await this.options.onSettled?.(H,null,v,this.state.context,z),this.#n({type:"success",data:H}),H}catch(H){try{await this.#i.config.onError?.(H,v,this.state.context,this,z)}catch(P){Promise.reject(P)}try{await this.options.onError?.(H,v,this.state.context,z)}catch(P){Promise.reject(P)}try{await this.#i.config.onSettled?.(void 0,H,this.state.variables,this.state.context,this,z)}catch(P){Promise.reject(P)}try{await this.options.onSettled?.(void 0,H,v,this.state.context,z)}catch(P){Promise.reject(P)}throw this.#n({type:"error",error:H}),H}finally{this.#i.runNext(this)}}#n(v){const S=z=>{switch(v.type){case"failed":return{...z,failureCount:v.failureCount,failureReason:v.error};case"pause":return{...z,isPaused:!0};case"continue":return{...z,isPaused:!1};case"pending":return{...z,context:v.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:v.isPaused,status:"pending",variables:v.variables,submittedAt:Date.now()};case"success":return{...z,data:v.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...z,data:void 0,error:v.error,failureCount:z.failureCount+1,failureReason:v.error,isPaused:!1,status:"error"}}};this.state=S(this.state),fa.batch(()=>{this.#t.forEach(z=>{z.onMutationUpdate(v)}),this.#i.notify({mutation:this,type:"updated",action:v})})}};function jb(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Nb=class extends Wm{constructor(v={}){super(),this.config=v,this.#e=new Set,this.#t=new Map,this.#i=0}#e;#t;#i;build(v,S,z){const M=new Fb({client:v,mutationCache:this,mutationId:++this.#i,options:v.defaultMutationOptions(S),state:z});return this.add(M),M}add(v){this.#e.add(v);const S=a_(v);if(typeof S=="string"){const z=this.#t.get(S);z?z.push(v):this.#t.set(S,[v])}this.notify({type:"added",mutation:v})}remove(v){if(this.#e.delete(v)){const S=a_(v);if(typeof S=="string"){const z=this.#t.get(S);if(z)if(z.length>1){const M=z.indexOf(v);M!==-1&&z.splice(M,1)}else z[0]===v&&this.#t.delete(S)}}this.notify({type:"removed",mutation:v})}canRun(v){const S=a_(v);if(typeof S=="string"){const M=this.#t.get(S)?.find(F=>F.state.status==="pending");return!M||M===v}else return!0}runNext(v){const S=a_(v);return typeof S=="string"?this.#t.get(S)?.find(M=>M!==v&&M.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){fa.batch(()=>{this.#e.forEach(v=>{this.notify({type:"removed",mutation:v})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(v){const S={exact:!0,...v};return this.getAll().find(z=>fv(S,z))}findAll(v={}){return this.getAll().filter(S=>fv(v,S))}notify(v){fa.batch(()=>{this.listeners.forEach(S=>{S(v)})})}resumePausedMutations(){const v=this.getAll().filter(S=>S.state.isPaused);return fa.batch(()=>Promise.all(v.map(S=>S.continue().catch(Ds))))}};function a_(v){return v.options.scope?.id}var Vb=class extends Wm{constructor(v={}){super(),this.config=v,this.#e=new Map}#e;build(v,S,z){const M=S.queryKey,F=S.queryHash??zy(M,S);let H=this.get(F);return H||(H=new Rb({client:v,queryKey:M,queryHash:F,options:v.defaultQueryOptions(S),state:z,defaultOptions:v.getQueryDefaults(M)}),this.add(H)),H}add(v){this.#e.has(v.queryHash)||(this.#e.set(v.queryHash,v),this.notify({type:"added",query:v}))}remove(v){const S=this.#e.get(v.queryHash);S&&(v.destroy(),S===v&&this.#e.delete(v.queryHash),this.notify({type:"removed",query:v}))}clear(){fa.batch(()=>{this.getAll().forEach(v=>{this.remove(v)})})}get(v){return this.#e.get(v)}getAll(){return[...this.#e.values()]}find(v){const S={exact:!0,...v};return this.getAll().find(z=>hv(S,z))}findAll(v={}){const S=this.getAll();return Object.keys(v).length>0?S.filter(z=>hv(v,z)):S}notify(v){fa.batch(()=>{this.listeners.forEach(S=>{S(v)})})}onFocus(){fa.batch(()=>{this.getAll().forEach(v=>{v.onFocus()})})}onOnline(){fa.batch(()=>{this.getAll().forEach(v=>{v.onOnline()})})}},Ub=class{#e;#t;#i;#r;#n;#o;#s;#a;constructor(v={}){this.#e=v.queryCache||new Vb,this.#t=v.mutationCache||new Nb,this.#i=v.defaultOptions||{},this.#r=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#s=Iy.subscribe(async v=>{v&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=d_.subscribe(async v=>{v&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#s?.(),this.#s=void 0,this.#a?.(),this.#a=void 0)}isFetching(v){return this.#e.findAll({...v,fetchStatus:"fetching"}).length}isMutating(v){return this.#t.findAll({...v,status:"pending"}).length}getQueryData(v){const S=this.defaultQueryOptions({queryKey:v});return this.#e.get(S.queryHash)?.state.data}ensureQueryData(v){const S=this.defaultQueryOptions(v),z=this.#e.build(this,S),M=z.state.data;return M===void 0?this.fetchQuery(v):(v.revalidateIfStale&&z.isStaleByTime(kh(S.staleTime,z))&&this.prefetchQuery(S),Promise.resolve(M))}getQueriesData(v){return this.#e.findAll(v).map(({queryKey:S,state:z})=>{const M=z.data;return[S,M]})}setQueryData(v,S,z){const M=this.defaultQueryOptions({queryKey:v}),H=this.#e.get(M.queryHash)?.state.data,P=wb(S,H);if(P!==void 0)return this.#e.build(this,M).setData(P,{...z,manual:!0})}setQueriesData(v,S,z){return fa.batch(()=>this.#e.findAll(v).map(({queryKey:M})=>[M,this.setQueryData(M,S,z)]))}getQueryState(v){const S=this.defaultQueryOptions({queryKey:v});return this.#e.get(S.queryHash)?.state}removeQueries(v){const S=this.#e;fa.batch(()=>{S.findAll(v).forEach(z=>{S.remove(z)})})}resetQueries(v,S){const z=this.#e;return fa.batch(()=>(z.findAll(v).forEach(M=>{M.reset()}),this.refetchQueries({type:"active",...v},S)))}cancelQueries(v,S={}){const z={revert:!0,...S},M=fa.batch(()=>this.#e.findAll(v).map(F=>F.cancel(z)));return Promise.all(M).then(Ds).catch(Ds)}invalidateQueries(v,S={}){return fa.batch(()=>(this.#e.findAll(v).forEach(z=>{z.invalidate()}),v?.refetchType==="none"?Promise.resolve():this.refetchQueries({...v,type:v?.refetchType??v?.type??"active"},S)))}refetchQueries(v,S={}){const z={...S,cancelRefetch:S.cancelRefetch??!0},M=fa.batch(()=>this.#e.findAll(v).filter(F=>!F.isDisabled()&&!F.isStatic()).map(F=>{let H=F.fetch(void 0,z);return z.throwOnError||(H=H.catch(Ds)),F.state.fetchStatus==="paused"?Promise.resolve():H}));return Promise.all(M).then(Ds)}fetchQuery(v){const S=this.defaultQueryOptions(v);S.retry===void 0&&(S.retry=!1);const z=this.#e.build(this,S);return z.isStaleByTime(kh(S.staleTime,z))?z.fetch(S):Promise.resolve(z.state.data)}prefetchQuery(v){return this.fetchQuery(v).then(Ds).catch(Ds)}fetchInfiniteQuery(v){return v.behavior=vv(v.pages),this.fetchQuery(v)}prefetchInfiniteQuery(v){return this.fetchInfiniteQuery(v).then(Ds).catch(Ds)}ensureInfiniteQueryData(v){return v.behavior=vv(v.pages),this.ensureQueryData(v)}resumePausedMutations(){return d_.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#i}setDefaultOptions(v){this.#i=v}setQueryDefaults(v,S){this.#r.set(Xm(v),{queryKey:v,defaultOptions:S})}getQueryDefaults(v){const S=[...this.#r.values()],z={};return S.forEach(M=>{Ym(v,M.queryKey)&&Object.assign(z,M.defaultOptions)}),z}setMutationDefaults(v,S){this.#n.set(Xm(v),{mutationKey:v,defaultOptions:S})}getMutationDefaults(v){const S=[...this.#n.values()],z={};return S.forEach(M=>{Ym(v,M.mutationKey)&&Object.assign(z,M.defaultOptions)}),z}defaultQueryOptions(v){if(v._defaulted)return v;const S={...this.#i.queries,...this.getQueryDefaults(v.queryKey),...v,_defaulted:!0};return S.queryHash||(S.queryHash=zy(S.queryKey,S)),S.refetchOnReconnect===void 0&&(S.refetchOnReconnect=S.networkMode!=="always"),S.throwOnError===void 0&&(S.throwOnError=!!S.suspense),!S.networkMode&&S.persister&&(S.networkMode="offlineFirst"),S.queryFn===Py&&(S.enabled=!1),S}defaultMutationOptions(v){return v?._defaulted?v:{...this.#i.mutations,...v?.mutationKey&&this.getMutationDefaults(v.mutationKey),...v,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Jv=un.createContext(void 0),Gb=v=>{const S=un.useContext(Jv);if(!S)throw new Error("No QueryClient set, use QueryClientProvider to set one");return S},qb=({client:v,children:S})=>(un.useEffect(()=>(v.mount(),()=>{v.unmount()}),[v]),wr.jsx(Jv.Provider,{value:v,children:S})),e0=un.createContext(!1),Zb=()=>un.useContext(e0);e0.Provider;function Hb(){let v=!1;return{clearReset:()=>{v=!1},reset:()=>{v=!0},isReset:()=>v}}var $b=un.createContext(Hb()),Xb=()=>un.useContext($b),Yb=(v,S,z)=>{const M=z?.state.error&&typeof v.throwOnError=="function"?Xv(v.throwOnError,[z.state.error,z]):v.throwOnError;(v.suspense||v.experimental_prefetchInRender||M)&&(S.isReset()||(v.retryOnMount=!1))},Qb=v=>{un.useEffect(()=>{v.clearReset()},[v])},Kb=({result:v,errorResetBoundary:S,throwOnError:z,query:M,suspense:F})=>v.isError&&!S.isReset()&&!v.isFetching&&M&&(F&&v.data===void 0||Xv(z,[v.error,M])),Wb=v=>{if(v.suspense){const z=F=>F==="static"?F:Math.max(F??1e3,1e3),M=v.staleTime;v.staleTime=typeof M=="function"?(...F)=>z(M(...F)):z(M),typeof v.gcTime=="number"&&(v.gcTime=Math.max(v.gcTime,1e3))}},Jb=(v,S)=>v.isLoading&&v.isFetching&&!S,ex=(v,S)=>v?.suspense&&S.isPending,xv=(v,S,z)=>S.fetchOptimistic(v).catch(()=>{z.clearReset()});function tx(v,S,z){const M=Zb(),F=Xb(),H=Gb(),P=H.defaultQueryOptions(v);H.getDefaultOptions().queries?._experimental_beforeQuery?.(P);const h=H.getQueryCache().get(P.queryHash);P._optimisticResults=M?"isRestoring":"optimistic",Wb(P),Yb(P,F,h),Qb(F);const ne=!H.getQueryCache().get(P.queryHash),[ge]=un.useState(()=>new S(H,P)),Le=ge.getOptimisticResult(P),Xe=!M&&v.subscribed!==!1;if(un.useSyncExternalStore(un.useCallback(Je=>{const yt=Xe?ge.subscribe(fa.batchCalls(Je)):Ds;return ge.updateResult(),yt},[ge,Xe]),()=>ge.getCurrentResult(),()=>ge.getCurrentResult()),un.useEffect(()=>{ge.setOptions(P)},[P,ge]),ex(P,Le))throw xv(P,ge,F);if(Kb({result:Le,errorResetBoundary:F,throwOnError:P.throwOnError,query:h,suspense:P.suspense}))throw Le.error;return H.getDefaultOptions().queries?._experimental_afterQuery?.(P,Le),P.experimental_prefetchInRender&&!Jf&&Jb(Le,M)&&(ne?xv(P,ge,F):h?.promise)?.catch(Ds).finally(()=>{ge.updateResult()}),P.notifyOnChangeProps?Le:ge.trackResult(Le)}function t0(v,S){return tx(v,Ob)}function ji(v){for(var S=arguments.length,z=new Array(S>1?S-1:0),M=1;M<S;M++)z[M-1]=arguments[M];throw new Error(typeof v=="number"?"[MobX] minified error nr: "+v+(z.length?" "+z.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+v)}var ix={};function S_(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:ix}var i0=Object.assign,p_=Object.getOwnPropertyDescriptor,zu=Object.defineProperty,E_=Object.prototype,_y=[];Object.freeze(_y);var n0={};Object.freeze(n0);var nx=typeof Proxy<"u",rx=Object.toString();function r0(){nx||ji("Proxy not available")}function a0(v){var S=!1;return function(){if(!S)return S=!0,v.apply(this,arguments)}}var zp=function(){};function Ol(v){return typeof v=="function"}function ed(v){var S=typeof v;switch(S){case"string":case"symbol":case"number":return!0}return!1}function M_(v){return v!==null&&typeof v=="object"}function Lc(v){if(!M_(v))return!1;var S=Object.getPrototypeOf(v);if(S==null)return!0;var z=Object.hasOwnProperty.call(S,"constructor")&&S.constructor;return typeof z=="function"&&z.toString()===rx}function s0(v){var S=v?.constructor;return S?S.name==="GeneratorFunction"||S.displayName==="GeneratorFunction":!1}function Jm(v,S,z){zu(v,S,{enumerable:!1,writable:!0,configurable:!0,value:z})}function o0(v,S,z){zu(v,S,{enumerable:!1,writable:!1,configurable:!0,value:z})}function rd(v,S){var z="isMobX"+v;return S.prototype[z]=!0,function(M){return M_(M)&&M[z]===!0}}function Bp(v){return v!=null&&Object.prototype.toString.call(v)==="[object Map]"}function ax(v){var S=Object.getPrototypeOf(v),z=Object.getPrototypeOf(S),M=Object.getPrototypeOf(z);return M===null}function Pc(v){return v!=null&&Object.prototype.toString.call(v)==="[object Set]"}var l0=typeof Object.getOwnPropertySymbols<"u";function sx(v){var S=Object.keys(v);if(!l0)return S;var z=Object.getOwnPropertySymbols(v);return z.length?[].concat(S,z.filter(function(M){return E_.propertyIsEnumerable.call(v,M)})):S}var Rp=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:l0?function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:Object.getOwnPropertyNames;function u0(v){return v===null?null:typeof v=="object"?""+v:v}function Rc(v,S){return E_.hasOwnProperty.call(v,S)}var ox=Object.getOwnPropertyDescriptors||function(S){var z={};return Rp(S).forEach(function(M){z[M]=p_(S,M)}),z};function io(v,S){return!!(v&S)}function no(v,S,z){return z?v|=S:v&=~S,v}function wv(v,S){(S==null||S>v.length)&&(S=v.length);for(var z=0,M=Array(S);z<S;z++)M[z]=v[z];return M}function lx(v,S){for(var z=0;z<S.length;z++){var M=S[z];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(v,cx(M.key),M)}}function kp(v,S,z){return S&&lx(v.prototype,S),Object.defineProperty(v,"prototype",{writable:!1}),v}function Pp(v,S){var z=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(z)return(z=z.call(v)).next.bind(z);if(Array.isArray(v)||(z=hx(v))||S){z&&(v=z);var M=0;return function(){return M>=v.length?{done:!0}:{done:!1,value:v[M++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function td(){return td=Object.assign?Object.assign.bind():function(v){for(var S=1;S<arguments.length;S++){var z=arguments[S];for(var M in z)({}).hasOwnProperty.call(z,M)&&(v[M]=z[M])}return v},td.apply(null,arguments)}function c0(v,S){v.prototype=Object.create(S.prototype),v.prototype.constructor=v,yy(v,S)}function yy(v,S){return yy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(z,M){return z.__proto__=M,z},yy(v,S)}function ux(v,S){if(typeof v!="object"||!v)return v;var z=v[Symbol.toPrimitive];if(z!==void 0){var M=z.call(v,S);if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(v)}function cx(v){var S=ux(v,"string");return typeof S=="symbol"?S:S+""}function hx(v,S){if(v){if(typeof v=="string")return wv(v,S);var z={}.toString.call(v).slice(8,-1);return z==="Object"&&v.constructor&&(z=v.constructor.name),z==="Map"||z==="Set"?Array.from(v):z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z)?wv(v,S):void 0}}var Du=Symbol("mobx-stored-annotations");function Pu(v){function S(z,M){if(tg(M))return v.decorate_20223_(z,M);eg(z,M,v)}return Object.assign(S,v)}function eg(v,S,z){Rc(v,Du)||Jm(v,Du,td({},v[Du])),yx(z)||(v[Du][S]=z)}function fx(v){return Rc(v,Du)||Jm(v,Du,td({},v[Du])),v[Du]}function tg(v){return typeof v=="object"&&typeof v.kind=="string"}var Zt=Symbol("mobx administration"),Fh=(function(){function v(z){z===void 0&&(z="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Gi.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=z}var S=v.prototype;return S.onBO=function(){this.onBOL&&this.onBOL.forEach(function(M){return M()})},S.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(M){return M()})},S.reportObserved=function(){return M0(this)},S.reportChanged=function(){No(),A0(this),Vo()},S.toString=function(){return this.name_},kp(v,[{key:"isBeingObserved",get:function(){return io(this.flags_,v.isBeingObservedMask_)},set:function(M){this.flags_=no(this.flags_,v.isBeingObservedMask_,M)}},{key:"isPendingUnobservation",get:function(){return io(this.flags_,v.isPendingUnobservationMask_)},set:function(M){this.flags_=no(this.flags_,v.isPendingUnobservationMask_,M)}},{key:"diffValue",get:function(){return io(this.flags_,v.diffValueMask_)?1:0},set:function(M){this.flags_=no(this.flags_,v.diffValueMask_,M===1)}}])})();Fh.isBeingObservedMask_=1;Fh.isPendingUnobservationMask_=2;Fh.diffValueMask_=4;var Oy=rd("Atom",Fh);function h0(v,S,z){S===void 0&&(S=zp),z===void 0&&(z=zp);var M=new Fh(v);return S!==zp&&w1(M,S),z!==zp&&I0(M,z),M}function dx(v,S){return H0(v,S)}function px(v,S){return Object.is?Object.is(v,S):v===S?v!==0||1/v===1/S:v!==v&&S!==S}var m_={structural:dx,default:px};function id(v,S,z){return k0(v)?v:Array.isArray(v)?da.array(v,{name:z}):Lc(v)?da.object(v,void 0,{name:z}):Bp(v)?da.map(v,{name:z}):Pc(v)?da.set(v,{name:z}):typeof v=="function"&&!Op(v)&&!Km(v)?s0(v)?Lp(v):Qm(z,v):v}function mx(v,S,z){if(v==null||I_(v)||P_(v)||sd(v)||Cu(v))return v;if(Array.isArray(v))return da.array(v,{name:z,deep:!1});if(Lc(v))return da.object(v,void 0,{name:z,deep:!1});if(Bp(v))return da.map(v,{name:z,deep:!1});if(Pc(v))return da.set(v,{name:z,deep:!1})}function A_(v){return v}function gx(v,S){return H0(v,S)?S:v}var _x="override";function yx(v){return v.annotationType_===_x}function ig(v,S){return{annotationType_:v,options_:S,make_:vx,extend_:bx,decorate_20223_:xx}}function vx(v,S,z,M){var F;if((F=this.options_)!=null&&F.bound)return this.extend_(v,S,z,!1)===null?0:1;if(M===v.target_)return this.extend_(v,S,z,!1)===null?0:2;if(Op(z.value))return 1;var H=f0(v,this,S,z,!1);return zu(M,S,H),2}function bx(v,S,z,M){var F=f0(v,this,S,z);return v.defineProperty_(S,F,M)}function xx(v,S){var z=S.kind,M=S.name,F=S.addInitializer,H=this,P=function(ge){var Le,Xe,Je,yt;return nd((Le=(Xe=H.options_)==null?void 0:Xe.name)!=null?Le:M.toString(),ge,(Je=(yt=H.options_)==null?void 0:yt.autoAction)!=null?Je:!1)};if(z=="field")return function(ne){var ge,Le=ne;return Op(Le)||(Le=P(Le)),(ge=H.options_)!=null&&ge.bound&&(Le=Le.bind(this),Le.isMobxAction=!0),Le};if(z=="method"){var h;return Op(v)||(v=P(v)),(h=this.options_)!=null&&h.bound&&F(function(){var ne=this,ge=ne[M].bind(ne);ge.isMobxAction=!0,ne[M]=ge}),v}ji("Cannot apply '"+H.annotationType_+"' to '"+String(M)+"' (kind: "+z+"):"+(`
'`+H.annotationType_+"' can only be used on properties with a function value."))}function wx(v,S,z,M){S.annotationType_,M.value}function f0(v,S,z,M,F){var H,P,h,ne,ge,Le,Xe;F===void 0&&(F=gt.safeDescriptors),wx(v,S,z,M);var Je=M.value;if((H=S.options_)!=null&&H.bound){var yt;Je=Je.bind((yt=v.proxy_)!=null?yt:v.target_)}return{value:nd((P=(h=S.options_)==null?void 0:h.name)!=null?P:z.toString(),Je,(ne=(ge=S.options_)==null?void 0:ge.autoAction)!=null?ne:!1,(Le=S.options_)!=null&&Le.bound?(Xe=v.proxy_)!=null?Xe:v.target_:void 0),configurable:F?v.isPlainObject_:!0,enumerable:!1,writable:!F}}function d0(v,S){return{annotationType_:v,options_:S,make_:Tx,extend_:Sx,decorate_20223_:Ex}}function Tx(v,S,z,M){var F;if(M===v.target_)return this.extend_(v,S,z,!1)===null?0:2;if((F=this.options_)!=null&&F.bound&&(!Rc(v.target_,S)||!Km(v.target_[S]))&&this.extend_(v,S,z,!1)===null)return 0;if(Km(z.value))return 1;var H=p0(v,this,S,z,!1,!1);return zu(M,S,H),2}function Sx(v,S,z,M){var F,H=p0(v,this,S,z,(F=this.options_)==null?void 0:F.bound);return v.defineProperty_(S,H,M)}function Ex(v,S){var z,M=S.name,F=S.addInitializer;return Km(v)||(v=Lp(v)),(z=this.options_)!=null&&z.bound&&F(function(){var H=this,P=H[M].bind(H);P.isMobXFlow=!0,H[M]=P}),v}function Mx(v,S,z,M){S.annotationType_,M.value}function p0(v,S,z,M,F,H){H===void 0&&(H=gt.safeDescriptors),Mx(v,S,z,M);var P=M.value;if(Km(P)||(P=Lp(P)),F){var h;P=P.bind((h=v.proxy_)!=null?h:v.target_),P.isMobXFlow=!0}return{value:P,configurable:H?v.isPlainObject_:!0,enumerable:!1,writable:!H}}function Ly(v,S){return{annotationType_:v,options_:S,make_:Ax,extend_:Cx,decorate_20223_:Dx}}function Ax(v,S,z){return this.extend_(v,S,z,!1)===null?0:1}function Cx(v,S,z,M){return zx(v,this,S,z),v.defineComputedProperty_(S,td({},this.options_,{get:z.get,set:z.set}),M)}function Dx(v,S){var z=this,M=S.name,F=S.addInitializer;return F(function(){var H=od(this)[Zt],P=td({},z.options_,{get:v,context:this});P.name||(P.name="ObservableObject."+M.toString()),H.values_.set(M,new Ll(P))}),function(){return this[Zt].getObservablePropValue_(M)}}function zx(v,S,z,M){S.annotationType_,M.get}function C_(v,S){return{annotationType_:v,options_:S,make_:Px,extend_:Ix,decorate_20223_:Rx}}function Px(v,S,z){return this.extend_(v,S,z,!1)===null?0:1}function Ix(v,S,z,M){var F,H;return Ox(v,this),v.defineObservableProperty_(S,z.value,(F=(H=this.options_)==null?void 0:H.enhancer)!=null?F:id,M)}function Rx(v,S){var z=this,M=S.kind,F=S.name,H=new WeakSet;function P(h,ne){var ge,Le,Xe=od(h)[Zt],Je=new Wf(ne,(ge=(Le=z.options_)==null?void 0:Le.enhancer)!=null?ge:id,"ObservableObject."+F.toString(),!1);Xe.values_.set(F,Je),H.add(h)}if(M=="accessor")return{get:function(){return H.has(this)||P(this,v.get.call(this)),this[Zt].getObservablePropValue_(F)},set:function(ne){return H.has(this)||P(this,ne),this[Zt].setObservablePropValue_(F,ne)},init:function(ne){return H.has(this)||P(this,ne),ne}}}function Ox(v,S,z,M){S.annotationType_}var Lx="true",Bx=m0();function m0(v){return{annotationType_:Lx,options_:v,make_:kx,extend_:Fx,decorate_20223_:jx}}function kx(v,S,z,M){var F,H;if(z.get)return D_.make_(v,S,z,M);if(z.set){var P=Op(z.set)?z.set:nd(S.toString(),z.set);return M===v.target_?v.defineProperty_(S,{configurable:gt.safeDescriptors?v.isPlainObject_:!0,set:P})===null?0:2:(zu(M,S,{configurable:!0,set:P}),2)}if(M!==v.target_&&typeof z.value=="function"){var h;if(s0(z.value)){var ne,ge=(ne=this.options_)!=null&&ne.autoBind?Lp.bound:Lp;return ge.make_(v,S,z,M)}var Le=(h=this.options_)!=null&&h.autoBind?Qm.bound:Qm;return Le.make_(v,S,z,M)}var Xe=((F=this.options_)==null?void 0:F.deep)===!1?da.ref:da;if(typeof z.value=="function"&&(H=this.options_)!=null&&H.autoBind){var Je;z.value=z.value.bind((Je=v.proxy_)!=null?Je:v.target_)}return Xe.make_(v,S,z,M)}function Fx(v,S,z,M){var F,H;if(z.get)return D_.extend_(v,S,z,M);if(z.set)return v.defineProperty_(S,{configurable:gt.safeDescriptors?v.isPlainObject_:!0,set:nd(S.toString(),z.set)},M);if(typeof z.value=="function"&&(F=this.options_)!=null&&F.autoBind){var P;z.value=z.value.bind((P=v.proxy_)!=null?P:v.target_)}var h=((H=this.options_)==null?void 0:H.deep)===!1?da.ref:da;return h.extend_(v,S,z,M)}function jx(v,S){ji("'"+this.annotationType_+"' cannot be used as a decorator")}var Nx="observable",Vx="observable.ref",Ux="observable.shallow",Gx="observable.struct",g0={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(g0);function s_(v){return v||g0}var vy=C_(Nx),qx=C_(Vx,{enhancer:A_}),Zx=C_(Ux,{enhancer:mx}),Hx=C_(Gx,{enhancer:gx}),_0=Pu(vy);function o_(v){return v.deep===!0?id:v.deep===!1?A_:Xx(v.defaultDecorator)}function $x(v){var S;return v?(S=v.defaultDecorator)!=null?S:m0(v):void 0}function Xx(v){var S,z;return v&&(S=(z=v.options_)==null?void 0:z.enhancer)!=null?S:id}function y0(v,S,z){if(tg(S))return vy.decorate_20223_(v,S);if(ed(S)){eg(v,S,vy);return}return k0(v)?v:Lc(v)?da.object(v,S,z):Array.isArray(v)?da.array(v,S):Bp(v)?da.map(v,S):Pc(v)?da.set(v,S):typeof v=="object"&&v!==null?v:da.box(v,S)}i0(y0,_0);var Yx={box:function(S,z){var M=s_(z);return new Wf(S,o_(M),M.name,!0,M.equals)},array:function(S,z){var M=s_(z);return(gt.useProxies===!1||M.proxy===!1?H1:B1)(S,o_(M),M.name)},map:function(S,z){var M=s_(z);return new N0(S,o_(M),M.name)},set:function(S,z){var M=s_(z);return new V0(S,o_(M),M.name)},object:function(S,z,M){return jh(function(){return O0(gt.useProxies===!1||M?.proxy===!1?od({},M):I1({},M),S,z)})},ref:Pu(qx),shallow:Pu(Zx),deep:_0,struct:Pu(Hx)},da=i0(y0,Yx),v0="computed",Qx="computed.struct",by=Ly(v0),Kx=Ly(Qx,{equals:m_.structural}),D_=function(S,z){if(tg(z))return by.decorate_20223_(S,z);if(ed(z))return eg(S,z,by);if(Lc(S))return Pu(Ly(v0,S));var M=Lc(z)?z:{};return M.get=S,M.name||(M.name=S.name||""),new Ll(M)};Object.assign(D_,by);D_.struct=Pu(Kx);var Tv,Sv,g_=0,Wx=1,Jx=(Tv=(Sv=p_(function(){},"name"))==null?void 0:Sv.configurable)!=null?Tv:!1,Ev={value:"action",configurable:!0,writable:!1,enumerable:!1};function nd(v,S,z,M){z===void 0&&(z=!1);function F(){return e1(v,z,S,M||this,arguments)}return F.isMobxAction=!0,F.toString=function(){return S.toString()},Jx&&(Ev.value=v,zu(F,"name",Ev)),F}function e1(v,S,z,M,F){var H=t1(v,S);try{return z.apply(M,F)}catch(P){throw H.error_=P,P}finally{i1(H)}}function t1(v,S,z,M){var F=!1,H=0,P=gt.trackingDerivation,h=!S||!P;No();var ne=gt.allowStateChanges;h&&(ad(),ne=By(!0));var ge=Fy(!0),Le={runAsAction_:h,prevDerivation_:P,prevAllowStateChanges_:ne,prevAllowStateReads_:ge,notifySpy_:F,startTime_:H,actionId_:Wx++,parentActionId_:g_};return g_=Le.actionId_,Le}function i1(v){g_!==v.actionId_&&ji(30),g_=v.parentActionId_,v.error_!==void 0&&(gt.suppressReactionErrors=!0),ky(v.prevAllowStateChanges_),Hm(v.prevAllowStateReads_),Vo(),v.runAsAction_&&Oc(v.prevDerivation_),gt.suppressReactionErrors=!1}function By(v){var S=gt.allowStateChanges;return gt.allowStateChanges=v,S}function ky(v){gt.allowStateChanges=v}var Wf=(function(v){function S(M,F,H,P,h){var ne;return H===void 0&&(H="ObservableValue"),h===void 0&&(h=m_.default),ne=v.call(this,H)||this,ne.enhancer=void 0,ne.name_=void 0,ne.equals=void 0,ne.hasUnreportedChange_=!1,ne.interceptors_=void 0,ne.changeListeners_=void 0,ne.value_=void 0,ne.dehancer=void 0,ne.enhancer=F,ne.name_=H,ne.equals=h,ne.value_=F(M,void 0,H),ne}c0(S,v);var z=S.prototype;return z.dehanceValue=function(F){return this.dehancer!==void 0?this.dehancer(F):F},z.set=function(F){this.value_,F=this.prepareNewValue_(F),F!==gt.UNCHANGED&&this.setNewValue_(F)},z.prepareNewValue_=function(F){if(Fo(this)){var H=jo(this,{object:this,type:Iu,newValue:F});if(!H)return gt.UNCHANGED;F=H.newValue}return F=this.enhancer(F,this.value_,this.name_),this.equals(this.value_,F)?gt.UNCHANGED:F},z.setNewValue_=function(F){var H=this.value_;this.value_=F,this.reportChanged(),Il(this)&&Rl(this,{type:Iu,object:this,newValue:F,oldValue:H})},z.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},z.intercept_=function(F){return ng(this,F)},z.observe_=function(F,H){return H&&F({observableKind:"value",debugObjectName:this.name_,object:this,type:Iu,newValue:this.value_,oldValue:void 0}),rg(this,F)},z.raw=function(){return this.value_},z.toJSON=function(){return this.get()},z.toString=function(){return this.name_+"["+this.value_+"]"},z.valueOf=function(){return u0(this.get())},z[Symbol.toPrimitive]=function(){return this.valueOf()},S})(Fh),Ll=(function(){function v(z){this.dependenciesState_=Gi.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Gi.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new y_(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=__.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,z.get||ji(31),this.derivation=z.get,this.name_=z.name||"ComputedValue",z.set&&(this.setter_=nd("ComputedValue-setter",z.set)),this.equals_=z.equals||(z.compareStructural||z.struct?m_.structural:m_.default),this.scope_=z.context,this.requiresReaction_=z.requiresReaction,this.keepAlive_=!!z.keepAlive}var S=v.prototype;return S.onBecomeStale_=function(){o1(this)},S.onBO=function(){this.onBOL&&this.onBOL.forEach(function(M){return M()})},S.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(M){return M()})},S.get=function(){if(this.isComputing&&ji(32,this.name_,this.derivation),gt.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)xy(this)&&(this.warnAboutUntrackedRead_(),No(),this.value_=this.computeValue_(!1),Vo());else if(M0(this),xy(this)){var M=gt.trackingContext;this.keepAlive_&&!M&&(gt.trackingContext=this),this.trackAndCompute()&&s1(this),gt.trackingContext=M}var F=this.value_;if(u_(F))throw F.cause;return F},S.set=function(M){if(this.setter_){this.isRunningSetter&&ji(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,M)}finally{this.isRunningSetter=!1}}else ji(34,this.name_)},S.trackAndCompute=function(){var M=this.value_,F=this.dependenciesState_===Gi.NOT_TRACKING_,H=this.computeValue_(!0),P=F||u_(M)||u_(H)||!this.equals_(M,H);return P&&(this.value_=H),P},S.computeValue_=function(M){this.isComputing=!0;var F=By(!1),H;if(M)H=b0(this,this.derivation,this.scope_);else if(gt.disableErrorBoundaries===!0)H=this.derivation.call(this.scope_);else try{H=this.derivation.call(this.scope_)}catch(P){H=new y_(P)}return ky(F),this.isComputing=!1,H},S.suspend_=function(){this.keepAlive_||(wy(this),this.value_=void 0)},S.observe_=function(M,F){var H=this,P=!0,h=void 0;return _1(function(){var ne=H.get();if(!P||F){var ge=ad();M({observableKind:"computed",debugObjectName:H.name_,type:Iu,object:H,newValue:ne,oldValue:h}),Oc(ge)}P=!1,h=ne})},S.warnAboutUntrackedRead_=function(){},S.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},S.valueOf=function(){return u0(this.get())},S[Symbol.toPrimitive]=function(){return this.valueOf()},kp(v,[{key:"isComputing",get:function(){return io(this.flags_,v.isComputingMask_)},set:function(M){this.flags_=no(this.flags_,v.isComputingMask_,M)}},{key:"isRunningSetter",get:function(){return io(this.flags_,v.isRunningSetterMask_)},set:function(M){this.flags_=no(this.flags_,v.isRunningSetterMask_,M)}},{key:"isBeingObserved",get:function(){return io(this.flags_,v.isBeingObservedMask_)},set:function(M){this.flags_=no(this.flags_,v.isBeingObservedMask_,M)}},{key:"isPendingUnobservation",get:function(){return io(this.flags_,v.isPendingUnobservationMask_)},set:function(M){this.flags_=no(this.flags_,v.isPendingUnobservationMask_,M)}},{key:"diffValue",get:function(){return io(this.flags_,v.diffValueMask_)?1:0},set:function(M){this.flags_=no(this.flags_,v.diffValueMask_,M===1)}}])})();Ll.isComputingMask_=1;Ll.isRunningSetterMask_=2;Ll.isBeingObservedMask_=4;Ll.isPendingUnobservationMask_=8;Ll.diffValueMask_=16;var z_=rd("ComputedValue",Ll),Gi;(function(v){v[v.NOT_TRACKING_=-1]="NOT_TRACKING_",v[v.UP_TO_DATE_=0]="UP_TO_DATE_",v[v.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",v[v.STALE_=2]="STALE_"})(Gi||(Gi={}));var __;(function(v){v[v.NONE=0]="NONE",v[v.LOG=1]="LOG",v[v.BREAK=2]="BREAK"})(__||(__={}));var y_=function(S){this.cause=void 0,this.cause=S};function u_(v){return v instanceof y_}function xy(v){switch(v.dependenciesState_){case Gi.UP_TO_DATE_:return!1;case Gi.NOT_TRACKING_:case Gi.STALE_:return!0;case Gi.POSSIBLY_STALE_:{for(var S=Fy(!0),z=ad(),M=v.observing_,F=M.length,H=0;H<F;H++){var P=M[H];if(z_(P)){if(gt.disableErrorBoundaries)P.get();else try{P.get()}catch{return Oc(z),Hm(S),!0}if(v.dependenciesState_===Gi.STALE_)return Oc(z),Hm(S),!0}}return w0(v),Oc(z),Hm(S),!1}}}function b0(v,S,z){var M=Fy(!0);w0(v),v.newObserving_=new Array(v.runId_===0?100:v.observing_.length),v.unboundDepsCount_=0,v.runId_=++gt.runId;var F=gt.trackingDerivation;gt.trackingDerivation=v,gt.inBatch++;var H;if(gt.disableErrorBoundaries===!0)H=S.call(z);else try{H=S.call(z)}catch(P){H=new y_(P)}return gt.inBatch--,gt.trackingDerivation=F,n1(v),Hm(M),H}function n1(v){for(var S=v.observing_,z=v.observing_=v.newObserving_,M=Gi.UP_TO_DATE_,F=0,H=v.unboundDepsCount_,P=0;P<H;P++){var h=z[P];h.diffValue===0&&(h.diffValue=1,F!==P&&(z[F]=h),F++),h.dependenciesState_>M&&(M=h.dependenciesState_)}for(z.length=F,v.newObserving_=null,H=S.length;H--;){var ne=S[H];ne.diffValue===0&&S0(ne,v),ne.diffValue=0}for(;F--;){var ge=z[F];ge.diffValue===1&&(ge.diffValue=0,a1(ge,v))}M!==Gi.UP_TO_DATE_&&(v.dependenciesState_=M,v.onBecomeStale_())}function wy(v){var S=v.observing_;v.observing_=[];for(var z=S.length;z--;)S0(S[z],v);v.dependenciesState_=Gi.NOT_TRACKING_}function x0(v){var S=ad();try{return v()}finally{Oc(S)}}function ad(){var v=gt.trackingDerivation;return gt.trackingDerivation=null,v}function Oc(v){gt.trackingDerivation=v}function Fy(v){var S=gt.allowStateReads;return gt.allowStateReads=v,S}function Hm(v){gt.allowStateReads=v}function w0(v){if(v.dependenciesState_!==Gi.UP_TO_DATE_){v.dependenciesState_=Gi.UP_TO_DATE_;for(var S=v.observing_,z=S.length;z--;)S[z].lowestObserverState_=Gi.UP_TO_DATE_}}var c_=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},h_=!0,T0=!1,gt=(function(){var v=S_();return v.__mobxInstanceCount>0&&!v.__mobxGlobals&&(h_=!1),v.__mobxGlobals&&v.__mobxGlobals.version!==new c_().version&&(h_=!1),h_?v.__mobxGlobals?(v.__mobxInstanceCount+=1,v.__mobxGlobals.UNCHANGED||(v.__mobxGlobals.UNCHANGED={}),v.__mobxGlobals):(v.__mobxInstanceCount=1,v.__mobxGlobals=new c_):(setTimeout(function(){T0||ji(35)},1),new c_)})();function r1(){if((gt.pendingReactions.length||gt.inBatch||gt.isRunningReactions)&&ji(36),T0=!0,h_){var v=S_();--v.__mobxInstanceCount===0&&(v.__mobxGlobals=void 0),gt=new c_}}function a1(v,S){v.observers_.add(S),v.lowestObserverState_>S.dependenciesState_&&(v.lowestObserverState_=S.dependenciesState_)}function S0(v,S){v.observers_.delete(S),v.observers_.size===0&&E0(v)}function E0(v){v.isPendingUnobservation===!1&&(v.isPendingUnobservation=!0,gt.pendingUnobservations.push(v))}function No(){gt.inBatch++}function Vo(){if(--gt.inBatch===0){C0();for(var v=gt.pendingUnobservations,S=0;S<v.length;S++){var z=v[S];z.isPendingUnobservation=!1,z.observers_.size===0&&(z.isBeingObserved&&(z.isBeingObserved=!1,z.onBUO()),z instanceof Ll&&z.suspend_())}gt.pendingUnobservations=[]}}function M0(v){var S=gt.trackingDerivation;return S!==null?(S.runId_!==v.lastAccessedBy_&&(v.lastAccessedBy_=S.runId_,S.newObserving_[S.unboundDepsCount_++]=v,!v.isBeingObserved&&gt.trackingContext&&(v.isBeingObserved=!0,v.onBO())),v.isBeingObserved):(v.observers_.size===0&&gt.inBatch>0&&E0(v),!1)}function A0(v){v.lowestObserverState_!==Gi.STALE_&&(v.lowestObserverState_=Gi.STALE_,v.observers_.forEach(function(S){S.dependenciesState_===Gi.UP_TO_DATE_&&S.onBecomeStale_(),S.dependenciesState_=Gi.STALE_}))}function s1(v){v.lowestObserverState_!==Gi.STALE_&&(v.lowestObserverState_=Gi.STALE_,v.observers_.forEach(function(S){S.dependenciesState_===Gi.POSSIBLY_STALE_?S.dependenciesState_=Gi.STALE_:S.dependenciesState_===Gi.UP_TO_DATE_&&(v.lowestObserverState_=Gi.UP_TO_DATE_)}))}function o1(v){v.lowestObserverState_===Gi.UP_TO_DATE_&&(v.lowestObserverState_=Gi.POSSIBLY_STALE_,v.observers_.forEach(function(S){S.dependenciesState_===Gi.UP_TO_DATE_&&(S.dependenciesState_=Gi.POSSIBLY_STALE_,S.onBecomeStale_())}))}var Bc=(function(){function v(z,M,F,H){z===void 0&&(z="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Gi.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=__.NONE,this.name_=z,this.onInvalidate_=M,this.errorHandler_=F,this.requiresObservable_=H}var S=v.prototype;return S.onBecomeStale_=function(){this.schedule_()},S.schedule_=function(){this.isScheduled||(this.isScheduled=!0,gt.pendingReactions.push(this),C0())},S.runReaction_=function(){if(!this.isDisposed){No(),this.isScheduled=!1;var M=gt.trackingContext;if(gt.trackingContext=this,xy(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(F){this.reportExceptionInDerivation_(F)}}gt.trackingContext=M,Vo()}},S.track=function(M){if(!this.isDisposed){No(),this.isRunning=!0;var F=gt.trackingContext;gt.trackingContext=this;var H=b0(this,M,void 0);gt.trackingContext=F,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&wy(this),u_(H)&&this.reportExceptionInDerivation_(H.cause),Vo()}},S.reportExceptionInDerivation_=function(M){var F=this;if(this.errorHandler_){this.errorHandler_(M,this);return}if(gt.disableErrorBoundaries)throw M;var H="[mobx] uncaught error in '"+this+"'";gt.suppressReactionErrors||console.error(H,M),gt.globalReactionErrorHandlers.forEach(function(P){return P(M,F)})},S.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(No(),wy(this),Vo()))},S.getDisposer_=function(M){var F=this,H=function P(){F.dispose(),M==null||M.removeEventListener==null||M.removeEventListener("abort",P)};return M==null||M.addEventListener==null||M.addEventListener("abort",H),H[Zt]=this,"dispose"in Symbol&&typeof Symbol.dispose=="symbol"&&(H[Symbol.dispose]=H),H},S.toString=function(){return"Reaction["+this.name_+"]"},S.trace=function(M){},kp(v,[{key:"isDisposed",get:function(){return io(this.flags_,v.isDisposedMask_)},set:function(M){this.flags_=no(this.flags_,v.isDisposedMask_,M)}},{key:"isScheduled",get:function(){return io(this.flags_,v.isScheduledMask_)},set:function(M){this.flags_=no(this.flags_,v.isScheduledMask_,M)}},{key:"isTrackPending",get:function(){return io(this.flags_,v.isTrackPendingMask_)},set:function(M){this.flags_=no(this.flags_,v.isTrackPendingMask_,M)}},{key:"isRunning",get:function(){return io(this.flags_,v.isRunningMask_)},set:function(M){this.flags_=no(this.flags_,v.isRunningMask_,M)}},{key:"diffValue",get:function(){return io(this.flags_,v.diffValueMask_)?1:0},set:function(M){this.flags_=no(this.flags_,v.diffValueMask_,M===1)}}])})();Bc.isDisposedMask_=1;Bc.isScheduledMask_=2;Bc.isTrackPendingMask_=4;Bc.isRunningMask_=8;Bc.diffValueMask_=16;var l1=100,Ty=function(S){return S()};function C0(){gt.inBatch>0||gt.isRunningReactions||Ty(u1)}function u1(){gt.isRunningReactions=!0;for(var v=gt.pendingReactions,S=0;v.length>0;){++S===l1&&(console.error("[mobx] cycle in reaction: "+v[0]),v.splice(0));for(var z=v.splice(0),M=0,F=z.length;M<F;M++)z[M].runReaction_()}gt.isRunningReactions=!1}var v_=rd("Reaction",Bc);function c1(v){var S=Ty;Ty=function(M){return v(function(){return S(M)})}}function $m(){return!1}function h1(v){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var D0="action",f1="action.bound",z0="autoAction",d1="autoAction.bound",p1="<unnamed action>",Sy=ig(D0),m1=ig(f1,{bound:!0}),Ey=ig(z0,{autoAction:!0}),g1=ig(d1,{autoAction:!0,bound:!0});function P0(v){var S=function(M,F){if(Ol(M))return nd(M.name||p1,M,v);if(Ol(F))return nd(M,F,v);if(tg(F))return(v?Ey:Sy).decorate_20223_(M,F);if(ed(F))return eg(M,F,v?Ey:Sy);if(ed(M))return Pu(ig(v?z0:D0,{name:M,autoAction:v}))};return S}var Ip=P0(!1);Object.assign(Ip,Sy);var Qm=P0(!0);Object.assign(Qm,Ey);Ip.bound=Pu(m1);Qm.bound=Pu(g1);function Op(v){return Ol(v)&&v.isMobxAction===!0}function _1(v,S){var z,M,F,H;S===void 0&&(S=n0);var P=(z=(M=S)==null?void 0:M.name)!=null?z:"Autorun",h=!S.scheduler&&!S.delay,ne;if(h)ne=new Bc(P,function(){this.track(Xe)},S.onError,S.requiresObservable);else{var ge=v1(S),Le=!1;ne=new Bc(P,function(){Le||(Le=!0,ge(function(){Le=!1,ne.isDisposed||ne.track(Xe)}))},S.onError,S.requiresObservable)}function Xe(){v(ne)}return(F=S)!=null&&(F=F.signal)!=null&&F.aborted||ne.schedule_(),ne.getDisposer_((H=S)==null?void 0:H.signal)}var y1=function(S){return S()};function v1(v){return v.scheduler?v.scheduler:v.delay?function(S){return setTimeout(S,v.delay)}:y1}var b1="onBO",x1="onBUO";function w1(v,S,z){return R0(b1,v,S,z)}function I0(v,S,z){return R0(x1,v,S,z)}function R0(v,S,z,M){var F=w_(S),H=Ol(M)?M:z,P=v+"L";return F[P]?F[P].add(H):F[P]=new Set([H]),function(){var h=F[P];h&&(h.delete(H),h.size===0&&delete F[P])}}var T1="never",l_="always",S1="observed";function E1(v){v.isolateGlobalState===!0&&r1();var S=v.useProxies,z=v.enforceActions;if(S!==void 0&&(gt.useProxies=S===l_?!0:S===T1?!1:typeof Proxy<"u"),S==="ifavailable"&&(gt.verifyProxies=!0),z!==void 0){var M=z===l_?l_:z===S1;gt.enforceActions=M,gt.allowStateChanges=!(M===!0||M===l_)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(F){F in v&&(gt[F]=!!v[F])}),gt.allowStateReads=!gt.observableRequiresReaction,v.reactionScheduler&&c1(v.reactionScheduler)}function O0(v,S,z,M){var F=ox(S);return jh(function(){var H=od(v,M)[Zt];Rp(F).forEach(function(P){H.extend_(P,F[P],z&&P in z?z[P]:!0)})}),v}function M1(v,S){return L0(w_(v,S))}function L0(v){var S={name:v.name_};return v.observing_&&v.observing_.length>0&&(S.dependencies=A1(v.observing_).map(L0)),S}function A1(v){return Array.from(new Set(v))}var C1=0;function B0(){this.message="FLOW_CANCELLED"}B0.prototype=Object.create(Error.prototype);var iy=d0("flow"),D1=d0("flow.bound",{bound:!0}),Lp=Object.assign(function(S,z){if(tg(z))return iy.decorate_20223_(S,z);if(ed(z))return eg(S,z,iy);var M=S,F=M.name||"<unnamed flow>",H=function(){var h=this,ne=arguments,ge=++C1,Le=Ip(F+" - runid: "+ge+" - init",M).apply(h,ne),Xe,Je=void 0,yt=new Promise(function(Et,rt){var xe=0;Xe=rt;function Jt(Kt){Je=void 0;var di;try{di=Ip(F+" - runid: "+ge+" - yield "+xe++,Le.next).call(Le,Kt)}catch(Si){return rt(Si)}Ct(di)}function Nt(Kt){Je=void 0;var di;try{di=Ip(F+" - runid: "+ge+" - yield "+xe++,Le.throw).call(Le,Kt)}catch(Si){return rt(Si)}Ct(di)}function Ct(Kt){if(Ol(Kt?.then)){Kt.then(Ct,rt);return}return Kt.done?Et(Kt.value):(Je=Promise.resolve(Kt.value),Je.then(Jt,Nt))}Jt(void 0)});return yt.cancel=Ip(F+" - runid: "+ge+" - cancel",function(){try{Je&&Mv(Je);var Et=Le.return(void 0),rt=Promise.resolve(Et.value);rt.then(zp,zp),Mv(rt),Xe(new B0)}catch(xe){Xe(xe)}}),yt};return H.isMobXFlow=!0,H},iy);Lp.bound=Pu(D1);function Mv(v){Ol(v.cancel)&&v.cancel()}function Km(v){return v?.isMobXFlow===!0}function z1(v,S){return v?I_(v)||!!v[Zt]||Oy(v)||v_(v)||z_(v):!1}function k0(v){return z1(v)}function Ic(v,S){S===void 0&&(S=void 0),No();try{return v.apply(S)}finally{Vo()}}function Dp(v){return v[Zt]}var P1={has:function(S,z){return Dp(S).has_(z)},get:function(S,z){return Dp(S).get_(z)},set:function(S,z,M){var F;return ed(z)?(F=Dp(S).set_(z,M,!0))!=null?F:!0:!1},deleteProperty:function(S,z){var M;return ed(z)?(M=Dp(S).delete_(z,!0))!=null?M:!0:!1},defineProperty:function(S,z,M){var F;return(F=Dp(S).defineProperty_(z,M))!=null?F:!0},ownKeys:function(S){return Dp(S).ownKeys_()},preventExtensions:function(S){ji(13)}};function I1(v,S){var z,M;return r0(),v=od(v,S),(M=(z=v[Zt]).proxy_)!=null?M:z.proxy_=new Proxy(v,P1)}function Fo(v){return v.interceptors_!==void 0&&v.interceptors_.length>0}function ng(v,S){var z=v.interceptors_||(v.interceptors_=[]);return z.push(S),a0(function(){var M=z.indexOf(S);M!==-1&&z.splice(M,1)})}function jo(v,S){var z=ad();try{for(var M=[].concat(v.interceptors_||[]),F=0,H=M.length;F<H&&(S=M[F](S),S&&!S.type&&ji(14),!!S);F++);return S}finally{Oc(z)}}function Il(v){return v.changeListeners_!==void 0&&v.changeListeners_.length>0}function rg(v,S){var z=v.changeListeners_||(v.changeListeners_=[]);return z.push(S),a0(function(){var M=z.indexOf(S);M!==-1&&z.splice(M,1)})}function Rl(v,S){var z=ad(),M=v.changeListeners_;if(M){M=M.slice();for(var F=0,H=M.length;F<H;F++)M[F](S);Oc(z)}}function R1(v,S,z){return jh(function(){var M,F=od(v,z)[Zt];(M=S)!=null||(S=fx(v)),Rp(S).forEach(function(H){return F.make_(H,S[H])})}),v}var ny=Symbol("mobx-keys");function F0(v,S,z){return Lc(v)?O0(v,v,S,z):(jh(function(){var M=od(v,z)[Zt];if(!v[ny]){var F=Object.getPrototypeOf(v),H=new Set([].concat(Rp(v),Rp(F)));H.delete("constructor"),H.delete(Zt),Jm(F,ny,H)}v[ny].forEach(function(P){return M.make_(P,S&&P in S?S[P]:!0)})}),v)}var Av="splice",Iu="update",O1=1e4,L1={get:function(S,z){var M=S[Zt];return z===Zt?M:z==="length"?M.getArrayLength_():typeof z=="string"&&!isNaN(z)?M.get_(parseInt(z)):Rc(b_,z)?b_[z]:S[z]},set:function(S,z,M){var F=S[Zt];return z==="length"&&F.setArrayLength_(M),typeof z=="symbol"||isNaN(z)?S[z]=M:F.set_(parseInt(z),M),!0},preventExtensions:function(){ji(15)}},jy=(function(){function v(z,M,F,H){z===void 0&&(z="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=F,this.legacyMode_=H,this.atom_=new Fh(z),this.enhancer_=function(P,h){return M(P,h,"ObservableArray[..]")}}var S=v.prototype;return S.dehanceValue_=function(M){return this.dehancer!==void 0?this.dehancer(M):M},S.dehanceValues_=function(M){return this.dehancer!==void 0&&M.length>0?M.map(this.dehancer):M},S.intercept_=function(M){return ng(this,M)},S.observe_=function(M,F){return F===void 0&&(F=!1),F&&M({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),rg(this,M)},S.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},S.setArrayLength_=function(M){(typeof M!="number"||isNaN(M)||M<0)&&ji("Out of range: "+M);var F=this.values_.length;if(M!==F)if(M>F){for(var H=new Array(M-F),P=0;P<M-F;P++)H[P]=void 0;this.spliceWithArray_(F,0,H)}else this.spliceWithArray_(M,F-M)},S.updateArrayLength_=function(M,F){M!==this.lastKnownLength_&&ji(16),this.lastKnownLength_+=F,this.legacyMode_&&F>0&&Z0(M+F+1)},S.spliceWithArray_=function(M,F,H){var P=this;this.atom_;var h=this.values_.length;if(M===void 0?M=0:M>h?M=h:M<0&&(M=Math.max(0,h+M)),arguments.length===1?F=h-M:F==null?F=0:F=Math.max(0,Math.min(F,h-M)),H===void 0&&(H=_y),Fo(this)){var ne=jo(this,{object:this.proxy_,type:Av,index:M,removedCount:F,added:H});if(!ne)return _y;F=ne.removedCount,H=ne.added}if(H=H.length===0?H:H.map(function(Xe){return P.enhancer_(Xe,void 0)}),this.legacyMode_){var ge=H.length-F;this.updateArrayLength_(h,ge)}var Le=this.spliceItemsIntoValues_(M,F,H);return(F!==0||H.length!==0)&&this.notifyArraySplice_(M,H,Le),this.dehanceValues_(Le)},S.spliceItemsIntoValues_=function(M,F,H){if(H.length<O1){var P;return(P=this.values_).splice.apply(P,[M,F].concat(H))}else{var h=this.values_.slice(M,M+F),ne=this.values_.slice(M+F);this.values_.length+=H.length-F;for(var ge=0;ge<H.length;ge++)this.values_[M+ge]=H[ge];for(var Le=0;Le<ne.length;Le++)this.values_[M+H.length+Le]=ne[Le];return h}},S.notifyArrayChildUpdate_=function(M,F,H){var P=!this.owned_&&$m(),h=Il(this),ne=h||P?{observableKind:"array",object:this.proxy_,type:Iu,debugObjectName:this.atom_.name_,index:M,newValue:F,oldValue:H}:null;this.atom_.reportChanged(),h&&Rl(this,ne)},S.notifyArraySplice_=function(M,F,H){var P=!this.owned_&&$m(),h=Il(this),ne=h||P?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Av,index:M,removed:H,added:F,removedCount:H.length,addedCount:F.length}:null;this.atom_.reportChanged(),h&&Rl(this,ne)},S.get_=function(M){if(this.legacyMode_&&M>=this.values_.length){console.warn("[mobx] Out of bounds read: "+M);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[M])},S.set_=function(M,F){var H=this.values_;if(this.legacyMode_&&M>H.length&&ji(17,M,H.length),M<H.length){this.atom_;var P=H[M];if(Fo(this)){var h=jo(this,{type:Iu,object:this.proxy_,index:M,newValue:F});if(!h)return;F=h.newValue}F=this.enhancer_(F,P);var ne=F!==P;ne&&(H[M]=F,this.notifyArrayChildUpdate_(M,F,P))}else{for(var ge=new Array(M+1-H.length),Le=0;Le<ge.length-1;Le++)ge[Le]=void 0;ge[ge.length-1]=F,this.spliceWithArray_(H.length,0,ge)}},v})();function B1(v,S,z,M){return z===void 0&&(z="ObservableArray"),M===void 0&&(M=!1),r0(),jh(function(){var F=new jy(z,S,M,!1);o0(F.values_,Zt,F);var H=new Proxy(F.values_,L1);return F.proxy_=H,v&&v.length&&F.spliceWithArray_(0,0,v),H})}var b_={clear:function(){return this.splice(0)},replace:function(S){var z=this[Zt];return z.spliceWithArray_(0,z.values_.length,S)},toJSON:function(){return this.slice()},splice:function(S,z){for(var M=arguments.length,F=new Array(M>2?M-2:0),H=2;H<M;H++)F[H-2]=arguments[H];var P=this[Zt];switch(arguments.length){case 0:return[];case 1:return P.spliceWithArray_(S);case 2:return P.spliceWithArray_(S,z)}return P.spliceWithArray_(S,z,F)},spliceWithArray:function(S,z,M){return this[Zt].spliceWithArray_(S,z,M)},push:function(){for(var S=this[Zt],z=arguments.length,M=new Array(z),F=0;F<z;F++)M[F]=arguments[F];return S.spliceWithArray_(S.values_.length,0,M),S.values_.length},pop:function(){return this.splice(Math.max(this[Zt].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var S=this[Zt],z=arguments.length,M=new Array(z),F=0;F<z;F++)M[F]=arguments[F];return S.spliceWithArray_(0,0,M),S.values_.length},reverse:function(){return gt.trackingDerivation&&ji(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){gt.trackingDerivation&&ji(37,"sort");var S=this.slice();return S.sort.apply(S,arguments),this.replace(S),this},remove:function(S){var z=this[Zt],M=z.dehanceValues_(z.values_).indexOf(S);return M>-1?(this.splice(M,1),!0):!1}};An("at",ro);An("concat",ro);An("flat",ro);An("includes",ro);An("indexOf",ro);An("join",ro);An("lastIndexOf",ro);An("slice",ro);An("toString",ro);An("toLocaleString",ro);An("toSorted",ro);An("toSpliced",ro);An("with",ro);An("every",Bl);An("filter",Bl);An("find",Bl);An("findIndex",Bl);An("findLast",Bl);An("findLastIndex",Bl);An("flatMap",Bl);An("forEach",Bl);An("map",Bl);An("some",Bl);An("toReversed",Bl);An("reduce",j0);An("reduceRight",j0);function An(v,S){typeof Array.prototype[v]=="function"&&(b_[v]=S(v))}function ro(v){return function(){var S=this[Zt];S.atom_.reportObserved();var z=S.dehanceValues_(S.values_);return z[v].apply(z,arguments)}}function Bl(v){return function(S,z){var M=this,F=this[Zt];F.atom_.reportObserved();var H=F.dehanceValues_(F.values_);return H[v](function(P,h){return S.call(z,P,h,M)})}}function j0(v){return function(){var S=this,z=this[Zt];z.atom_.reportObserved();var M=z.dehanceValues_(z.values_),F=arguments[0];return arguments[0]=function(H,P,h){return F(H,P,h,S)},M[v].apply(M,arguments)}}var k1=rd("ObservableArrayAdministration",jy);function P_(v){return M_(v)&&k1(v[Zt])}var F1={},Bh="add",x_="delete",N0=(function(){function v(z,M,F){var H=this;M===void 0&&(M=id),F===void 0&&(F="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[Zt]=F1,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=M,this.name_=F,Ol(Map)||ji(18),jh(function(){H.keysAtom_=h0("ObservableMap.keys()"),H.data_=new Map,H.hasMap_=new Map,z&&H.merge(z)})}var S=v.prototype;return S.has_=function(M){return this.data_.has(M)},S.has=function(M){var F=this;if(!gt.trackingDerivation)return this.has_(M);var H=this.hasMap_.get(M);if(!H){var P=H=new Wf(this.has_(M),A_,"ObservableMap.key?",!1);this.hasMap_.set(M,P),I0(P,function(){return F.hasMap_.delete(M)})}return H.get()},S.set=function(M,F){var H=this.has_(M);if(Fo(this)){var P=jo(this,{type:H?Iu:Bh,object:this,newValue:F,name:M});if(!P)return this;F=P.newValue}return H?this.updateValue_(M,F):this.addValue_(M,F),this},S.delete=function(M){var F=this;if(this.keysAtom_,Fo(this)){var H=jo(this,{type:x_,object:this,name:M});if(!H)return!1}if(this.has_(M)){var P=$m(),h=Il(this),ne=h||P?{observableKind:"map",debugObjectName:this.name_,type:x_,object:this,oldValue:this.data_.get(M).value_,name:M}:null;return Ic(function(){var ge;F.keysAtom_.reportChanged(),(ge=F.hasMap_.get(M))==null||ge.setNewValue_(!1);var Le=F.data_.get(M);Le.setNewValue_(void 0),F.data_.delete(M)}),h&&Rl(this,ne),!0}return!1},S.updateValue_=function(M,F){var H=this.data_.get(M);if(F=H.prepareNewValue_(F),F!==gt.UNCHANGED){var P=$m(),h=Il(this),ne=h||P?{observableKind:"map",debugObjectName:this.name_,type:Iu,object:this,oldValue:H.value_,name:M,newValue:F}:null;H.setNewValue_(F),h&&Rl(this,ne)}},S.addValue_=function(M,F){var H=this;this.keysAtom_,Ic(function(){var ge,Le=new Wf(F,H.enhancer_,"ObservableMap.key",!1);H.data_.set(M,Le),F=Le.value_,(ge=H.hasMap_.get(M))==null||ge.setNewValue_(!0),H.keysAtom_.reportChanged()});var P=$m(),h=Il(this),ne=h||P?{observableKind:"map",debugObjectName:this.name_,type:Bh,object:this,name:M,newValue:F}:null;h&&Rl(this,ne)},S.get=function(M){return this.has(M)?this.dehanceValue_(this.data_.get(M).get()):this.dehanceValue_(void 0)},S.dehanceValue_=function(M){return this.dehancer!==void 0?this.dehancer(M):M},S.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},S.values=function(){var M=this,F=this.keys();return Cv({next:function(){var P=F.next(),h=P.done,ne=P.value;return{done:h,value:h?void 0:M.get(ne)}}})},S.entries=function(){var M=this,F=this.keys();return Cv({next:function(){var P=F.next(),h=P.done,ne=P.value;return{done:h,value:h?void 0:[ne,M.get(ne)]}}})},S[Symbol.iterator]=function(){return this.entries()},S.forEach=function(M,F){for(var H=Pp(this),P;!(P=H()).done;){var h=P.value,ne=h[0],ge=h[1];M.call(F,ge,ne,this)}},S.merge=function(M){var F=this;return sd(M)&&(M=new Map(M)),Ic(function(){Lc(M)?sx(M).forEach(function(H){return F.set(H,M[H])}):Array.isArray(M)?M.forEach(function(H){var P=H[0],h=H[1];return F.set(P,h)}):Bp(M)?(ax(M)||ji(19,M),M.forEach(function(H,P){return F.set(P,H)})):M!=null&&ji(20,M)}),this},S.clear=function(){var M=this;Ic(function(){x0(function(){for(var F=Pp(M.keys()),H;!(H=F()).done;){var P=H.value;M.delete(P)}})})},S.replace=function(M){var F=this;return Ic(function(){for(var H=j1(M),P=new Map,h=!1,ne=Pp(F.data_.keys()),ge;!(ge=ne()).done;){var Le=ge.value;if(!H.has(Le)){var Xe=F.delete(Le);if(Xe)h=!0;else{var Je=F.data_.get(Le);P.set(Le,Je)}}}for(var yt=Pp(H.entries()),Et;!(Et=yt()).done;){var rt=Et.value,xe=rt[0],Jt=rt[1],Nt=F.data_.has(xe);if(F.set(xe,Jt),F.data_.has(xe)){var Ct=F.data_.get(xe);P.set(xe,Ct),Nt||(h=!0)}}if(!h)if(F.data_.size!==P.size)F.keysAtom_.reportChanged();else for(var Kt=F.data_.keys(),di=P.keys(),Si=Kt.next(),St=di.next();!Si.done;){if(Si.value!==St.value){F.keysAtom_.reportChanged();break}Si=Kt.next(),St=di.next()}F.data_=P}),this},S.toString=function(){return"[object ObservableMap]"},S.toJSON=function(){return Array.from(this)},S.observe_=function(M,F){return rg(this,M)},S.intercept_=function(M){return ng(this,M)},kp(v,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])})(),sd=rd("ObservableMap",N0);function Cv(v){return v[Symbol.toStringTag]="MapIterator",Vy(v)}function j1(v){if(Bp(v)||sd(v))return v;if(Array.isArray(v))return new Map(v);if(Lc(v)){var S=new Map;for(var z in v)S.set(z,v[z]);return S}else return ji(21,v)}var N1={},V0=(function(){function v(z,M,F){var H=this;M===void 0&&(M=id),F===void 0&&(F="ObservableSet"),this.name_=void 0,this[Zt]=N1,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=F,Ol(Set)||ji(22),this.enhancer_=function(P,h){return M(P,h,F)},jh(function(){H.atom_=h0(H.name_),z&&H.replace(z)})}var S=v.prototype;return S.dehanceValue_=function(M){return this.dehancer!==void 0?this.dehancer(M):M},S.clear=function(){var M=this;Ic(function(){x0(function(){for(var F=Pp(M.data_.values()),H;!(H=F()).done;){var P=H.value;M.delete(P)}})})},S.forEach=function(M,F){for(var H=Pp(this),P;!(P=H()).done;){var h=P.value;M.call(F,h,h,this)}},S.add=function(M){var F=this;if(this.atom_,Fo(this)){var H=jo(this,{type:Bh,object:this,newValue:M});if(!H)return this;M=H.newValue}if(!this.has(M)){Ic(function(){F.data_.add(F.enhancer_(M,void 0)),F.atom_.reportChanged()});var P=!1,h=Il(this),ne=h||P?{observableKind:"set",debugObjectName:this.name_,type:Bh,object:this,newValue:M}:null;h&&Rl(this,ne)}return this},S.delete=function(M){var F=this;if(Fo(this)){var H=jo(this,{type:x_,object:this,oldValue:M});if(!H)return!1}if(this.has(M)){var P=!1,h=Il(this),ne=h||P?{observableKind:"set",debugObjectName:this.name_,type:x_,object:this,oldValue:M}:null;return Ic(function(){F.atom_.reportChanged(),F.data_.delete(M)}),h&&Rl(this,ne),!0}return!1},S.has=function(M){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(M))},S.entries=function(){var M=this.values();return Dv({next:function(){var H=M.next(),P=H.value,h=H.done;return h?{value:void 0,done:h}:{value:[P,P],done:h}}})},S.keys=function(){return this.values()},S.values=function(){this.atom_.reportObserved();var M=this,F=this.data_.values();return Dv({next:function(){var P=F.next(),h=P.value,ne=P.done;return ne?{value:void 0,done:ne}:{value:M.dehanceValue_(h),done:ne}}})},S.intersection=function(M){if(Pc(M)&&!Cu(M))return M.intersection(this);var F=new Set(this);return F.intersection(M)},S.union=function(M){if(Pc(M)&&!Cu(M))return M.union(this);var F=new Set(this);return F.union(M)},S.difference=function(M){return new Set(this).difference(M)},S.symmetricDifference=function(M){if(Pc(M)&&!Cu(M))return M.symmetricDifference(this);var F=new Set(this);return F.symmetricDifference(M)},S.isSubsetOf=function(M){return new Set(this).isSubsetOf(M)},S.isSupersetOf=function(M){return new Set(this).isSupersetOf(M)},S.isDisjointFrom=function(M){if(Pc(M)&&!Cu(M))return M.isDisjointFrom(this);var F=new Set(this);return F.isDisjointFrom(M)},S.replace=function(M){var F=this;return Cu(M)&&(M=new Set(M)),Ic(function(){Array.isArray(M)?(F.clear(),M.forEach(function(H){return F.add(H)})):Pc(M)?(F.clear(),M.forEach(function(H){return F.add(H)})):M!=null&&ji("Cannot initialize set from "+M)}),this},S.observe_=function(M,F){return rg(this,M)},S.intercept_=function(M){return ng(this,M)},S.toJSON=function(){return Array.from(this)},S.toString=function(){return"[object ObservableSet]"},S[Symbol.iterator]=function(){return this.values()},kp(v,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])})(),Cu=rd("ObservableSet",V0);function Dv(v){return v[Symbol.toStringTag]="SetIterator",Vy(v)}var zv=Object.create(null),Pv="remove",U0=(function(){function v(z,M,F,H){M===void 0&&(M=new Map),H===void 0&&(H=Bx),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=z,this.values_=M,this.name_=F,this.defaultAnnotation_=H,this.keysAtom_=new Fh("ObservableObject.keys"),this.isPlainObject_=Lc(this.target_)}var S=v.prototype;return S.getObservablePropValue_=function(M){return this.values_.get(M).get()},S.setObservablePropValue_=function(M,F){var H=this.values_.get(M);if(H instanceof Ll)return H.set(F),!0;if(Fo(this)){var P=jo(this,{type:Iu,object:this.proxy_||this.target_,name:M,newValue:F});if(!P)return null;F=P.newValue}if(F=H.prepareNewValue_(F),F!==gt.UNCHANGED){var h=Il(this),ne=!1,ge=h||ne?{type:Iu,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:H.value_,name:M,newValue:F}:null;H.setNewValue_(F),h&&Rl(this,ge)}return!0},S.get_=function(M){return gt.trackingDerivation&&!Rc(this.target_,M)&&this.has_(M),this.target_[M]},S.set_=function(M,F,H){return H===void 0&&(H=!1),Rc(this.target_,M)?this.values_.has(M)?this.setObservablePropValue_(M,F):H?Reflect.set(this.target_,M,F):(this.target_[M]=F,!0):this.extend_(M,{value:F,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,H)},S.has_=function(M){if(!gt.trackingDerivation)return M in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var F=this.pendingKeys_.get(M);return F||(F=new Wf(M in this.target_,A_,"ObservableObject.key?",!1),this.pendingKeys_.set(M,F)),F.get()},S.make_=function(M,F){if(F===!0&&(F=this.defaultAnnotation_),F!==!1){if(!(M in this.target_)){var H;if((H=this.target_[Du])!=null&&H[M])return;ji(1,F.annotationType_,this.name_+"."+M.toString())}for(var P=this.target_;P&&P!==E_;){var h=p_(P,M);if(h){var ne=F.make_(this,M,h,P);if(ne===0)return;if(ne===1)break}P=Object.getPrototypeOf(P)}Rv(this,F,M)}},S.extend_=function(M,F,H,P){if(P===void 0&&(P=!1),H===!0&&(H=this.defaultAnnotation_),H===!1)return this.defineProperty_(M,F,P);var h=H.extend_(this,M,F,P);return h&&Rv(this,H,M),h},S.defineProperty_=function(M,F,H){H===void 0&&(H=!1),this.keysAtom_;try{No();var P=this.delete_(M);if(!P)return P;if(Fo(this)){var h=jo(this,{object:this.proxy_||this.target_,name:M,type:Bh,newValue:F.value});if(!h)return null;var ne=h.newValue;F.value!==ne&&(F=td({},F,{value:ne}))}if(H){if(!Reflect.defineProperty(this.target_,M,F))return!1}else zu(this.target_,M,F);this.notifyPropertyAddition_(M,F.value)}finally{Vo()}return!0},S.defineObservableProperty_=function(M,F,H,P){P===void 0&&(P=!1),this.keysAtom_;try{No();var h=this.delete_(M);if(!h)return h;if(Fo(this)){var ne=jo(this,{object:this.proxy_||this.target_,name:M,type:Bh,newValue:F});if(!ne)return null;F=ne.newValue}var ge=Iv(M),Le={configurable:gt.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:ge.get,set:ge.set};if(P){if(!Reflect.defineProperty(this.target_,M,Le))return!1}else zu(this.target_,M,Le);var Xe=new Wf(F,H,"ObservableObject.key",!1);this.values_.set(M,Xe),this.notifyPropertyAddition_(M,Xe.value_)}finally{Vo()}return!0},S.defineComputedProperty_=function(M,F,H){H===void 0&&(H=!1),this.keysAtom_;try{No();var P=this.delete_(M);if(!P)return P;if(Fo(this)){var h=jo(this,{object:this.proxy_||this.target_,name:M,type:Bh,newValue:void 0});if(!h)return null}F.name||(F.name="ObservableObject.key"),F.context=this.proxy_||this.target_;var ne=Iv(M),ge={configurable:gt.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:ne.get,set:ne.set};if(H){if(!Reflect.defineProperty(this.target_,M,ge))return!1}else zu(this.target_,M,ge);this.values_.set(M,new Ll(F)),this.notifyPropertyAddition_(M,void 0)}finally{Vo()}return!0},S.delete_=function(M,F){if(F===void 0&&(F=!1),this.keysAtom_,!Rc(this.target_,M))return!0;if(Fo(this)){var H=jo(this,{object:this.proxy_||this.target_,name:M,type:Pv});if(!H)return null}try{var P;No();var h=Il(this),ne=!1,ge=this.values_.get(M),Le=void 0;if(!ge&&(h||ne)){var Xe;Le=(Xe=p_(this.target_,M))==null?void 0:Xe.value}if(F){if(!Reflect.deleteProperty(this.target_,M))return!1}else delete this.target_[M];if(ge&&(this.values_.delete(M),ge instanceof Wf&&(Le=ge.value_),A0(ge)),this.keysAtom_.reportChanged(),(P=this.pendingKeys_)==null||(P=P.get(M))==null||P.set(M in this.target_),h||ne){var Je={type:Pv,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:Le,name:M};h&&Rl(this,Je)}}finally{Vo()}return!0},S.observe_=function(M,F){return rg(this,M)},S.intercept_=function(M){return ng(this,M)},S.notifyPropertyAddition_=function(M,F){var H,P=Il(this),h=!1;if(P||h){var ne=P||h?{type:Bh,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:M,newValue:F}:null;P&&Rl(this,ne)}(H=this.pendingKeys_)==null||(H=H.get(M))==null||H.set(!0),this.keysAtom_.reportChanged()},S.ownKeys_=function(){return this.keysAtom_.reportObserved(),Rp(this.target_)},S.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},v})();function od(v,S){var z;if(Rc(v,Zt))return v;var M=(z=S?.name)!=null?z:"ObservableObject",F=new U0(v,new Map,String(M),$x(S));return Jm(v,Zt,F),v}var V1=rd("ObservableObjectAdministration",U0);function Iv(v){return zv[v]||(zv[v]={get:function(){return this[Zt].getObservablePropValue_(v)},set:function(z){return this[Zt].setObservablePropValue_(v,z)}})}function I_(v){return M_(v)?V1(v[Zt]):!1}function Rv(v,S,z){var M;(M=v.target_[Du])==null||delete M[z]}var U1=q0(0),G1=(function(){var v=!1,S={};return Object.defineProperty(S,"0",{set:function(){v=!0}}),Object.create(S)[0]=1,v===!1})(),ry=0,G0=function(){};function q1(v,S){Object.setPrototypeOf?Object.setPrototypeOf(v.prototype,S):v.prototype.__proto__!==void 0?v.prototype.__proto__=S:v.prototype=S}q1(G0,Array.prototype);var Ny=(function(v){function S(M,F,H,P){var h;return H===void 0&&(H="ObservableArray"),P===void 0&&(P=!1),h=v.call(this)||this,jh(function(){var ne=new jy(H,F,P,!0);ne.proxy_=h,o0(h,Zt,ne),M&&M.length&&h.spliceWithArray(0,0,M),G1&&Object.defineProperty(h,"0",U1)}),h}c0(S,v);var z=S.prototype;return z.concat=function(){this[Zt].atom_.reportObserved();for(var F=arguments.length,H=new Array(F),P=0;P<F;P++)H[P]=arguments[P];return Array.prototype.concat.apply(this.slice(),H.map(function(h){return P_(h)?h.slice():h}))},z[Symbol.iterator]=function(){var M=this,F=0;return Vy({next:function(){return F<M.length?{value:M[F++],done:!1}:{done:!0,value:void 0}}})},kp(S,[{key:"length",get:function(){return this[Zt].getArrayLength_()},set:function(F){this[Zt].setArrayLength_(F)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])})(G0);Object.entries(b_).forEach(function(v){var S=v[0],z=v[1];S!=="concat"&&Jm(Ny.prototype,S,z)});function q0(v){return{enumerable:!1,configurable:!0,get:function(){return this[Zt].get_(v)},set:function(z){this[Zt].set_(v,z)}}}function Z1(v){zu(Ny.prototype,""+v,q0(v))}function Z0(v){if(v>ry){for(var S=ry;S<v+100;S++)Z1(S);ry=v}}Z0(1e3);function H1(v,S,z){return new Ny(v,S,z)}function w_(v,S){if(typeof v=="object"&&v!==null){if(P_(v))return S!==void 0&&ji(23),v[Zt].atom_;if(Cu(v))return v.atom_;if(sd(v)){if(S===void 0)return v.keysAtom_;var z=v.data_.get(S)||v.hasMap_.get(S);return z||ji(25,S,My(v)),z}if(I_(v)){if(!S)return ji(26);var M=v[Zt].values_.get(S);return M||ji(27,S,My(v)),M}if(Oy(v)||z_(v)||v_(v))return v}else if(Ol(v)&&v_(v[Zt]))return v[Zt];ji(28)}function $1(v,S){if(v||ji(29),Oy(v)||z_(v)||v_(v)||sd(v)||Cu(v))return v;if(v[Zt])return v[Zt];ji(24,v)}function My(v,S){var z;if(S!==void 0)z=w_(v,S);else{if(Op(v))return v.name;I_(v)||sd(v)||Cu(v)?z=$1(v):z=w_(v)}return z.name_}function jh(v){var S=ad(),z=By(!0);No();try{return v()}finally{Vo(),ky(z),Oc(S)}}var Ov=E_.toString;function H0(v,S,z){return z===void 0&&(z=-1),Ay(v,S,z)}function Ay(v,S,z,M,F){if(v===S)return v!==0||1/v===1/S;if(v==null||S==null)return!1;if(v!==v)return S!==S;var H=typeof v;if(H!=="function"&&H!=="object"&&typeof S!="object")return!1;var P=Ov.call(v);if(P!==Ov.call(S))return!1;switch(P){case"[object RegExp]":case"[object String]":return""+v==""+S;case"[object Number]":return+v!=+v?+S!=+S:+v==0?1/+v===1/S:+v==+S;case"[object Date]":case"[object Boolean]":return+v==+S;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(v)===Symbol.valueOf.call(S);case"[object Map]":case"[object Set]":z>=0&&z++;break}v=Lv(v),S=Lv(S);var h=P==="[object Array]";if(!h){if(typeof v!="object"||typeof S!="object")return!1;var ne=v.constructor,ge=S.constructor;if(ne!==ge&&!(Ol(ne)&&ne instanceof ne&&Ol(ge)&&ge instanceof ge)&&"constructor"in v&&"constructor"in S)return!1}if(z===0)return!1;z<0&&(z=-1),M=M||[],F=F||[];for(var Le=M.length;Le--;)if(M[Le]===v)return F[Le]===S;if(M.push(v),F.push(S),h){if(Le=v.length,Le!==S.length)return!1;for(;Le--;)if(!Ay(v[Le],S[Le],z-1,M,F))return!1}else{var Xe=Object.keys(v),Je=Xe.length;if(Object.keys(S).length!==Je)return!1;for(var yt=0;yt<Je;yt++){var Et=Xe[yt];if(!(Rc(S,Et)&&Ay(v[Et],S[Et],z-1,M,F)))return!1}}return M.pop(),F.pop(),!0}function Lv(v){return P_(v)?v.slice():Bp(v)||sd(v)||Pc(v)||Cu(v)?Array.from(v.entries()):v}var Bv,X1=((Bv=S_().Iterator)==null?void 0:Bv.prototype)||{};function Vy(v){return v[Symbol.iterator]=Y1,Object.assign(Object.create(X1),v)}function Y1(){return this}["Symbol","Map","Set"].forEach(function(v){var S=S_();typeof S[v]>"u"&&ji("MobX requires global '"+v+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:h1,extras:{getDebugName:My},$mobx:Zt});if(!un.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!R1)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var Q1=qv();function K1(v){v()}function W1(v){v||(v=K1),E1({reactionScheduler:v})}function J1(v){return M1(v)}var ew=1e4,tw=1e4,iw=(function(){function v(S){var z=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:S}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(M){M===void 0&&(M=ew),clearTimeout(z.sweepTimeout),z.sweepTimeout=void 0;var F=Date.now();z.registrations.forEach(function(H,P){F-H.registeredAt>=M&&(z.finalize(H.value),z.registrations.delete(P))}),z.registrations.size>0&&z.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){z.sweep(0)}})}return Object.defineProperty(v.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(S,z,M){this.registrations.set(M,{value:z,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(v.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(S){this.registrations.delete(S)}}),Object.defineProperty(v.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,tw))}}),v})(),nw=typeof FinalizationRegistry<"u"?FinalizationRegistry:iw,Cy=new nw(function(v){var S;(S=v.reaction)===null||S===void 0||S.dispose(),v.reaction=null}),ay={exports:{}},sy={};var kv;function rw(){if(kv)return sy;kv=1;var v=T_();function S(Xe,Je){return Xe===Je&&(Xe!==0||1/Xe===1/Je)||Xe!==Xe&&Je!==Je}var z=typeof Object.is=="function"?Object.is:S,M=v.useState,F=v.useEffect,H=v.useLayoutEffect,P=v.useDebugValue;function h(Xe,Je){var yt=Je(),Et=M({inst:{value:yt,getSnapshot:Je}}),rt=Et[0].inst,xe=Et[1];return H(function(){rt.value=yt,rt.getSnapshot=Je,ne(rt)&&xe({inst:rt})},[Xe,yt,Je]),F(function(){return ne(rt)&&xe({inst:rt}),Xe(function(){ne(rt)&&xe({inst:rt})})},[Xe]),P(yt),yt}function ne(Xe){var Je=Xe.getSnapshot;Xe=Xe.value;try{var yt=Je();return!z(Xe,yt)}catch{return!0}}function ge(Xe,Je){return Je()}var Le=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ge:h;return sy.useSyncExternalStore=v.useSyncExternalStore!==void 0?v.useSyncExternalStore:Le,sy}var Fv;function aw(){return Fv||(Fv=1,ay.exports=rw()),ay.exports}var sw=aw();function jv(v){v.reaction=new Bc("observer".concat(v.name),function(){var S;v.stateVersion=Symbol(),(S=v.onStoreChange)===null||S===void 0||S.call(v)})}function ow(v,S){S===void 0&&(S="observed");var z=rv.useRef(null);if(!z.current){var M={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:S,subscribe:function(h){return Cy.unregister(M),M.onStoreChange=h,M.reaction||(jv(M),M.stateVersion=Symbol()),function(){var ne;M.onStoreChange=null,(ne=M.reaction)===null||ne===void 0||ne.dispose(),M.reaction=null}},getSnapshot:function(){return M.stateVersion}};z.current=M}var F=z.current;F.reaction||(jv(F),Cy.register(z,F,F)),rv.useDebugValue(F.reaction,J1),sw.useSyncExternalStore(F.subscribe,F.getSnapshot,F.getSnapshot);var H,P;if(F.reaction.track(function(){try{H=v()}catch(h){P=h}}),P)throw P;return H}var oy,ly,$0=typeof Symbol=="function"&&Symbol.for,lw=(ly=(oy=Object.getOwnPropertyDescriptor(function(){},"name"))===null||oy===void 0?void 0:oy.configurable)!==null&&ly!==void 0?ly:!1,Nv=$0?Symbol.for("react.forward_ref"):typeof un.forwardRef=="function"&&un.forwardRef(function(v){return null}).$$typeof,Vv=$0?Symbol.for("react.memo"):typeof un.memo=="function"&&un.memo(function(v){return null}).$$typeof;function uw(v,S){var z;if(Vv&&v.$$typeof===Vv)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var M=(z=void 0)!==null&&z!==void 0?z:!1,F=v,H=v.displayName||v.name;if(Nv&&v.$$typeof===Nv&&(M=!0,F=v.render,typeof F!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var P=function(h,ne){return ow(function(){return F(h,ne)},H)};return P.displayName=v.displayName,lw&&Object.defineProperty(P,"name",{value:v.name,writable:!0,configurable:!0}),v.contextTypes&&(P.contextTypes=v.contextTypes),M&&(P=un.forwardRef(P)),P=un.memo(P),hw(v,P),P}var cw={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function hw(v,S){Object.keys(v).forEach(function(z){cw[z]||Object.defineProperty(S,z,Object.getOwnPropertyDescriptor(v,z))})}var uy;W1(Q1.unstable_batchedUpdates);uy=Cy.finalizeAllImmediately;const fw="https://gis.kgp.kz/arcgis/rest/services/KPSSU/DTP/FeatureServer/0/query?where=area_code+%3D+%271971%27&objectIds=&time=&geometry=&geometryType=esriGeometryPoint&inSR=&spatialRel=esriSpatialRelIntersects&distance=&units=esriSRUnit_Foot&relationParam=&outFields=*&returnGeometry=true&maxAllowableOffset=&geometryPrecision=&outSR=4326&havingClause=&gdbVersion=&historicMoment=&returnDistinctValues=false&returnIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&returnZ=false&returnM=false&multipatchOption=xyFootprint&resultOffset=&resultRecordCount=&returnTrueCurves=false&returnExceededLimitFeatures=false&quantizationParameters=&returnCentroid=false&timeReferenceUnknownClient=false&sqlFormat=none&resultType=&featureEncoding=esriDefault&datumTransformation=&f=geojson",dw="https://services8.arcgis.com/GyR85gR88mMqIY4t/ArcGIS/rest/services/Open_dataset_of_administrative_boundaries_of_Kazakhstan_WFL1/FeatureServer/1/query?where=name_en%3D%27Astana%27&objectIds=&geometry=&geometryType=esriGeometryPolygon&inSR=&spatialRel=esriSpatialRelIntersects&resultType=none&distance=0.0&units=esriSRUnit_Meter&outDistance=&relationParam=&returnGeodetic=false&outFields=*&returnGeometry=true&returnCentroid=false&returnEnvelope=false&featureEncoding=esriDefault&multipatchOption=xyFootprint&maxAllowableOffset=&geometryPrecision=&outSR=4326&defaultSR=&datumTransformation=&applyVCSProjection=false&returnIdsOnly=false&returnUniqueIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&returnQueryGeometry=false&returnDistinctValues=false&cacheHint=false&collation=&orderByFields=&groupByFieldsForStatistics=&returnAggIds=false&outStatistics=&having=&resultOffset=&resultRecordCount=&returnZ=false&returnM=false&returnTrueCurves=false&returnExceededLimitFeatures=true&quantizationParameters=&sqlFormat=none&f=pgeojson&token=";async function pw(){return(await fetch(fw)).json()}async function mw(){return(await fetch(dw)).json()}function gw(){const{data:v,isLoading:S,error:z}=t0({queryKey:["cityBorders"],queryFn:mw,retry:2,staleTime:3e5});return{data:v,isLoading:S,error:z}}function _w({map:v,cityBorders:S,showBorders:z}){un.useEffect(()=>{!v||!S||(v.getSource("city-borders")?v.getSource("city-borders").setData(S):(v.addSource("city-borders",{type:"geojson",data:S}),v.addLayer({id:"city-borders-layer",type:"fill",source:"city-borders",paint:{"fill-color":"#000000","fill-opacity":.1}})),v.getLayer("city-borders-layer")&&v.setLayoutProperty("city-borders-layer","visibility",z?"visible":"none"))},[S,v,z])}function yw(){const{data:v,isLoading:S,error:z}=t0({queryKey:["dtpData"],queryFn:pw,retry:2,staleTime:3e5});return{data:v,isLoading:S,error:z}}var f_={exports:{}};var vw=f_.exports,Uv;function bw(){return Uv||(Uv=1,(function(v,S){(function(z,M){v.exports=M()})(vw,(function(){var z={},M={};function F(P,h,ne){if(M[P]=ne,P==="index"){var ge="var sharedModule = {}; ("+M.shared+")(sharedModule); ("+M.worker+")(sharedModule);",Le={};return M.shared(Le),M.index(z,Le),typeof window<"u"&&z.setWorkerUrl(window.URL.createObjectURL(new Blob([ge],{type:"text/javascript"}))),z}}F("shared",["exports"],(function(P){function h(n,e,i,o){return new(i||(i=Promise))((function(u,d){function p(E){try{x(o.next(E))}catch(D){d(D)}}function y(E){try{x(o.throw(E))}catch(D){d(D)}}function x(E){var D;E.done?u(E.value):(D=E.value,D instanceof i?D:new i((function(R){R(D)}))).then(p,y)}x((o=o.apply(n,e||[])).next())}))}function ne(n,e){this.x=n,this.y=e}function ge(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Le,Xe;typeof SuppressedError=="function"&&SuppressedError,ne.prototype={clone(){return new ne(this.x,this.y)},add(n){return this.clone()._add(n)},sub(n){return this.clone()._sub(n)},multByPoint(n){return this.clone()._multByPoint(n)},divByPoint(n){return this.clone()._divByPoint(n)},mult(n){return this.clone()._mult(n)},div(n){return this.clone()._div(n)},rotate(n){return this.clone()._rotate(n)},rotateAround(n,e){return this.clone()._rotateAround(n,e)},matMult(n){return this.clone()._matMult(n)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(n){return this.x===n.x&&this.y===n.y},dist(n){return Math.sqrt(this.distSqr(n))},distSqr(n){const e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith(n){return this.angleWithSep(n.x,n.y)},angleWithSep(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult(n){const e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add(n){return this.x+=n.x,this.y+=n.y,this},_sub(n){return this.x-=n.x,this.y-=n.y,this},_mult(n){return this.x*=n,this.y*=n,this},_div(n){return this.x/=n,this.y/=n,this},_multByPoint(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint(n){return this.x/=n.x,this.y/=n.y,this},_unit(){return this._div(this.mag()),this},_perp(){const n=this.y;return this.y=this.x,this.x=-n,this},_rotate(n){const e=Math.cos(n),i=Math.sin(n),o=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=o,this},_rotateAround(n,e){const i=Math.cos(n),o=Math.sin(n),u=e.y+o*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-o*(this.y-e.y),this.y=u,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:ne},ne.convert=function(n){if(n instanceof ne)return n;if(Array.isArray(n))return new ne(+n[0],+n[1]);if(n.x!==void 0&&n.y!==void 0)return new ne(+n.x,+n.y);throw new Error("Expected [x, y] or {x, y} point format")};var Je=(function(){if(Xe)return Le;function n(e,i,o,u){this.cx=3*e,this.bx=3*(o-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=o,this.p2y=u}return Xe=1,Le=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var o=e,u=0;u<8;u++){var d=this.sampleCurveX(o)-e;if(Math.abs(d)<i)return o;var p=this.sampleCurveDerivativeX(o);if(Math.abs(p)<1e-6)break;o-=d/p}var y=0,x=1;for(o=e,u=0;u<20&&(d=this.sampleCurveX(o),!(Math.abs(d-e)<i));u++)e>d?y=o:x=o,o=.5*(x-y)+y;return o},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Le})(),yt=ge(Je);let Et,rt;function xe(){return Et==null&&(Et=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Et}function Jt(){if(rt==null&&(rt=!1,xe())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let o=0;o<25;o++){const u=4*o;e.fillStyle=`rgb(${u},${u+1},${u+2})`,e.fillRect(o%5,Math.floor(o/5),1,1)}const i=e.getImageData(0,0,5,5).data;for(let o=0;o<100;o++)if(o%4!=3&&i[o]!==o){rt=!0;break}}}return rt||!1}var Nt=1e-6,Ct=typeof Float32Array<"u"?Float32Array:Array;function Kt(){var n=new Ct(9);return Ct!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function di(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Si(){var n=new Ct(3);return Ct!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function St(n){var e=n[0],i=n[1],o=n[2];return Math.sqrt(e*e+i*i+o*o)}function pi(n,e,i){var o=new Ct(3);return o[0]=n,o[1]=e,o[2]=i,o}function cn(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function Vn(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function Un(n,e,i){var o=e[0],u=e[1],d=e[2],p=i[0],y=i[1],x=i[2];return n[0]=u*x-d*y,n[1]=d*p-o*x,n[2]=o*y-u*p,n}var Ni,Cn=St;function $r(n,e,i){var o=e[0],u=e[1],d=e[2],p=e[3];return n[0]=i[0]*o+i[4]*u+i[8]*d+i[12]*p,n[1]=i[1]*o+i[5]*u+i[9]*d+i[13]*p,n[2]=i[2]*o+i[6]*u+i[10]*d+i[14]*p,n[3]=i[3]*o+i[7]*u+i[11]*d+i[15]*p,n}function lr(){var n=new Ct(4);return Ct!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function qe(n,e,i,o){var u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",d=Math.PI/360;e*=d,o*=d,i*=d;var p=Math.sin(e),y=Math.cos(e),x=Math.sin(i),E=Math.cos(i),D=Math.sin(o),R=Math.cos(o);switch(u){case"xyz":n[0]=p*E*R+y*x*D,n[1]=y*x*R-p*E*D,n[2]=y*E*D+p*x*R,n[3]=y*E*R-p*x*D;break;case"xzy":n[0]=p*E*R-y*x*D,n[1]=y*x*R-p*E*D,n[2]=y*E*D+p*x*R,n[3]=y*E*R+p*x*D;break;case"yxz":n[0]=p*E*R+y*x*D,n[1]=y*x*R-p*E*D,n[2]=y*E*D-p*x*R,n[3]=y*E*R+p*x*D;break;case"yzx":n[0]=p*E*R+y*x*D,n[1]=y*x*R+p*E*D,n[2]=y*E*D-p*x*R,n[3]=y*E*R-p*x*D;break;case"zxy":n[0]=p*E*R-y*x*D,n[1]=y*x*R+p*E*D,n[2]=y*E*D+p*x*R,n[3]=y*E*R-p*x*D;break;case"zyx":n[0]=p*E*R-y*x*D,n[1]=y*x*R+p*E*D,n[2]=y*E*D-p*x*R,n[3]=y*E*R+p*x*D;break;default:throw new Error("Unknown angle order "+u)}return n}function ot(){var n=new Ct(2);return Ct!=Float32Array&&(n[0]=0,n[1]=0),n}function Pt(n,e){var i=new Ct(2);return i[0]=n,i[1]=e,i}Si(),Ni=new Ct(4),Ct!=Float32Array&&(Ni[0]=0,Ni[1]=0,Ni[2]=0,Ni[3]=0),Si(),pi(1,0,0),pi(0,1,0),lr(),lr(),Kt(),ot();const Mt=8192;function mi(n,e,i){return e*(Mt/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}function be(n,e){return(n%e+e)%e}function Ke(n,e,i){return n*(1-i)+e*i}function pt(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function bt(n,e,i,o){const u=new yt(n,e,i,o);return d=>u.solve(d)}const At=bt(.25,.1,.25,1);function Vt(n,e,i){return Math.min(i,Math.max(e,n))}function ei(n,e,i){const o=i-e,u=((n-e)%o+o)%o+e;return u===e?i:u}function Pi(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}let qi=1;function Tr(n,e,i){const o={};for(const u in n)o[u]=e.call(this,n[u],u,n);return o}function ao(n,e,i){const o={};for(const u in n)e.call(this,n[u],u,n)&&(o[u]=n[u]);return o}function Xr(n){return Array.isArray(n)?n.map(Xr):typeof n=="object"&&n?Tr(n,Xr):n}const kl={};function rn(n){kl[n]||(typeof console<"u"&&console.warn(n),kl[n]=!0)}function Ir(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function pa(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let hn=null;function zs(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const Ps="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function so(n,e,i,o,u){return h(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const d=new VideoFrame(n,{timestamp:0});try{const p=d?.format;if(!p||!p.startsWith("BGR")&&!p.startsWith("RGB"))throw new Error(`Unrecognized format ${p}`);const y=p.startsWith("BGR"),x=new Uint8ClampedArray(o*u*4);if(yield d.copyTo(x,(function(E,D,R,L,B){const V=4*Math.max(-D,0),U=(Math.max(0,R)-R)*L*4+V,q=4*L,Y=Math.max(0,D),se=Math.max(0,R);return{rect:{x:Y,y:se,width:Math.min(E.width,D+L)-Y,height:Math.min(E.height,R+B)-se},layout:[{offset:U,stride:q}]}})(n,e,i,o,u)),y)for(let E=0;E<x.length;E+=4){const D=x[E];x[E]=x[E+2],x[E+2]=D}return x}finally{d.close()}}))}let es,La;function Fl(n,e,i,o){return n.addEventListener(e,i,o),{unsubscribe:()=>{n.removeEventListener(e,i,o)}}}function Yn(n){return n*Math.PI/180}function Rr(n){return n/Math.PI*180}const Se={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},$={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Z="AbortError";class W extends Error{constructor(e=Z){super(e instanceof Error?e.message:e),this.name=Z,e instanceof Error&&e.stack&&(this.stack=e.stack)}}function fe(n){return n.name===Z}const pe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Ce(n){return pe.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const we="global-dispatcher";class _e extends Error{constructor(e,i,o,u){super(`AJAXError: ${i} (${e}): ${o}`),this.status=e,this.statusText=i,this.url=o,this.body=u}}const De=()=>pa(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ue=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const o=Ce(n.url);if(o)return o(n,e);if(pa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:we},e)}if(!(/^file:/.test(i=n.url)||/^file:/.test(De())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(o,u){return h(this,void 0,void 0,(function*(){const d=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,cache:o.cache,referrer:De(),signal:u.signal});let p,y;o.type!=="json"||d.headers.has("Accept")||d.headers.set("Accept","application/json");try{p=yield fetch(d)}catch(E){throw fe(E)?E:new _e(0,E.message,o.url,new Blob)}if(!p.ok){const E=yield p.blob();throw new _e(p.status,p.statusText,o.url,E)}y=o.type==="arrayBuffer"||o.type==="image"?p.arrayBuffer():o.type==="json"?p.json():p.text();const x=yield y;return u.signal.throwIfAborted(),{data:x,cacheControl:p.headers.get("Cache-Control"),expires:p.headers.get("Expires")}}))})(n,e);if(pa(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:we},e)}var i;return(function(o,u){return new Promise(((d,p)=>{var y;const x=new XMLHttpRequest;x.open(o.method||"GET",o.url,!0),o.type!=="arrayBuffer"&&o.type!=="image"||(x.responseType="arraybuffer");for(const E in o.headers)x.setRequestHeader(E,o.headers[E]);o.type==="json"&&(x.responseType="text",!((y=o.headers)===null||y===void 0)&&y.Accept||x.setRequestHeader("Accept","application/json")),x.withCredentials=o.credentials==="include",x.onerror=()=>{p(new Error(x.statusText))},x.onload=()=>{if(!u.signal.aborted)if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let E=x.response;if(o.type==="json")try{E=JSON.parse(x.response)}catch(D){return void p(D)}d({data:E,cacheControl:x.getResponseHeader("Cache-Control"),expires:x.getResponseHeader("Expires")})}else{const E=new Blob([x.response],{type:x.getResponseHeader("Content-Type")});p(new _e(x.status,x.statusText,o.url,E))}},u.signal.addEventListener("abort",(()=>{x.abort(),p(new W(u.signal.reason))})),x.send(o.body)}))})(n,e)};function Ge(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),i=window.location;return e.protocol===i.protocol&&e.host===i.host}function ht(n,e,i){i[n]&&i[n].indexOf(e)!==-1||(i[n]=i[n]||[],i[n].push(e))}function vt(n,e,i){if(i&&i[n]){const o=i[n].indexOf(e);o!==-1&&i[n].splice(o,1)}}class Rt{constructor(e,i={}){Pi(this,i),this.type=e}}class gi extends Rt{constructor(e,i={}){super("error",Pi({error:e},i))}}class ii{on(e,i){return this._listeners=this._listeners||{},ht(e,i,this._listeners),{unsubscribe:()=>{this.off(e,i)}}}off(e,i){return vt(e,i,this._listeners),vt(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},ht(e,i,this._oneTimeListeners),this):new Promise((o=>this.once(e,o)))}fire(e,i){typeof e=="string"&&(e=new Rt(e,i||{}));const o=e.type;if(this.listens(o)){e.target=this;const u=this._listeners&&this._listeners[o]?this._listeners[o].slice():[];for(const y of u)y.call(this,e);const d=this._oneTimeListeners&&this._oneTimeListeners[o]?this._oneTimeListeners[o].slice():[];for(const y of d)vt(o,y,this._oneTimeListeners),y.call(this,e);const p=this._eventedParent;p&&(Pi(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(e))}else e instanceof gi&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Ee={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number",length:2},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},encoding:{type:"enum",values:{mvt:{},mlt:{}},default:"mvt"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"filter"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible",expression:{interpolated:!1,parameters:["global-state"]},"property-type":"data-constant"}},filter:{type:"boolean",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"expression_name",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}},interpolation:{type:"array",value:"interpolation_name",minimum:1},interpolation_name:{type:"enum",values:{linear:{syntax:{overloads:[{parameters:[],"output-type":"interpolation"}],parameters:[]}},exponential:{syntax:{overloads:[{parameters:["base"],"output-type":"interpolation"}],parameters:[{name:"base",type:"number literal"}]}},"cubic-bezier":{syntax:{overloads:[{parameters:["x1","y1","x2","y2"],"output-type":"interpolation"}],parameters:[{name:"x1",type:"number literal"},{name:"y1",type:"number literal"},{name:"x2",type:"number literal"},{name:"y2",type:"number literal"}]}}}}};const vi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Dn(n,e){const i={};for(const o in n)o!=="ref"&&(i[o]=n[o]);return vi.forEach((o=>{o in e&&(i[o]=e[o])})),i}function Bt(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!Bt(n[i],e[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const i in n)if(!Bt(n[i],e[i]))return!1;return!0}return n===e}function bi(n,e){n.push(e)}function Gn(n,e,i){bi(i,{command:"addSource",args:[n,e[n]]})}function Ei(n,e,i){bi(e,{command:"removeSource",args:[n]}),i[n]=!0}function fn(n,e,i,o){Ei(n,i,o),Gn(n,e,i)}function Ii(n,e,i){let o;for(o in n[i])if(Object.prototype.hasOwnProperty.call(n[i],o)&&o!=="data"&&!Bt(n[i][o],e[i][o]))return!1;for(o in e[i])if(Object.prototype.hasOwnProperty.call(e[i],o)&&o!=="data"&&!Bt(n[i][o],e[i][o]))return!1;return!0}function zn(n,e,i,o,u,d){n=n||{},e=e||{};for(const p in n)Object.prototype.hasOwnProperty.call(n,p)&&(Bt(n[p],e[p])||i.push({command:d,args:[o,p,e[p],u]}));for(const p in e)Object.prototype.hasOwnProperty.call(e,p)&&!Object.prototype.hasOwnProperty.call(n,p)&&(Bt(n[p],e[p])||i.push({command:d,args:[o,p,e[p],u]}))}function jl(n){return n.id}function Uo(n,e){return n[e.id]=e,n}class et{constructor(e,i,o,u){this.message=(e?`${e}: `:"")+o,u&&(this.identifier=u),i!=null&&i.__line__&&(this.line=i.__line__)}}function dr(n,...e){for(const i of e)for(const o in i)n[o]=i[o];return n}class pr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class Ba{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[o,u]of i)this.bindings[o]=u}concat(e){return new Ba(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Vi={kind:"null"},nt={kind:"number"},Ft={kind:"string"},qt={kind:"boolean"},Yr={kind:"color"},kc={kind:"projectionDefinition"},ts={kind:"object"},kt={kind:"value"},Go={kind:"collator"},is={kind:"formatted"},Is={kind:"padding"},ns={kind:"colorArray"},rs={kind:"numberArray"},dn={kind:"resolvedImage"},Nl={kind:"variableAnchorOffsetCollection"};function mr(n,e){return{kind:"array",itemType:n,N:e}}function ni(n){if(n.kind==="array"){const e=ni(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const Rs=[Vi,nt,Ft,qt,Yr,kc,is,ts,mr(kt),Is,rs,ns,dn,Nl];function Vl(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Vl(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const i of Rs)if(!Vl(i,e))return null}}return`Expected ${ni(n)} but found ${ni(e)} instead.`}function Ul(n,e){return e.some((i=>i.kind===n.kind))}function oo(n,e){return e.some((i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n))}function ka(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const Ru=.96422,as=.82521,ma=4/29,ui=6/29,Nh=3*ui*ui,ld=ui*ui*ui,qo=Math.PI/180,Vh=180/Math.PI;function Ou(n){return(n%=360)<0&&(n+=360),n}function ud([n,e,i,o]){let u,d;const p=Lu((.2225045*(n=Sr(n))+.7168786*(e=Sr(e))+.0606169*(i=Sr(i)))/1);n===e&&e===i?u=d=p:(u=Lu((.4360747*n+.3850649*e+.1430804*i)/Ru),d=Lu((.0139322*n+.0971045*e+.7141733*i)/as));const y=116*p-16;return[y<0?0:y,500*(u-p),200*(p-d),o]}function Sr(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Lu(n){return n>ld?Math.pow(n,1/3):n/Nh+ma}function Fc([n,e,i,o]){let u=(n+16)/116,d=isNaN(e)?u:u+e/500,p=isNaN(i)?u:u-i/200;return u=1*lo(u),d=Ru*lo(d),p=as*lo(p),[Bu(3.1338561*d-1.6168667*u-.4906146*p),Bu(-.9787684*d+1.9161415*u+.033454*p),Bu(.0719453*d-.2289914*u+1.4052427*p),o]}function Bu(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function lo(n){return n>ui?n*n*n:Nh*(n-ma)}const cd=Object.hasOwn||function(n,e){return Object.prototype.hasOwnProperty.call(n,e)};function Gl(n,e){return cd(n,e)?n[e]:void 0}function Os(n){return parseInt(n.padEnd(2,n),16)/255}function hd(n,e){return Zo(e?n/100:n,0,1)}function Zo(n,e,i){return Math.min(Math.max(e,n),i)}function jc(n){return!n.some(Number.isNaN)}const Ho={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function uo(n,e,i){return n+i*(e-n)}function ql(n,e,i){return n.map(((o,u)=>uo(o,e[u],i)))}class Gt{constructor(e,i,o,u=1,d=!0){this.r=e,this.g=i,this.b=o,this.a=u,d||(this.r*=u,this.g*=u,this.b*=u,u||this.overwriteGetter("rgb",[e,i,o,u]))}static parse(e){if(e instanceof Gt)return e;if(typeof e!="string")return;const i=(function(o){if((o=o.toLowerCase().trim())==="transparent")return[0,0,0,0];const u=Gl(Ho,o);if(u){const[p,y,x]=u;return[p/255,y/255,x/255,1]}if(o.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(o)){const p=o.length<6?1:2;let y=1;return[Os(o.slice(y,y+=p)),Os(o.slice(y,y+=p)),Os(o.slice(y,y+=p)),Os(o.slice(y,y+p)||"ff")]}if(o.startsWith("rgb")){const p=o.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(p){const[y,x,E,D,R,L,B,V,U,q,Y,se]=p,Q=[D||" ",B||" ",q].join("");if(Q==="  "||Q==="  /"||Q===",,"||Q===",,,"){const J=[E,L,U].join(""),le=J==="%%%"?100:J===""?255:0;if(le){const he=[Zo(+x/le,0,1),Zo(+R/le,0,1),Zo(+V/le,0,1),Y?hd(+Y,se):1];if(jc(he))return he}}return}}const d=o.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(d){const[p,y,x,E,D,R,L,B,V]=d,U=[x||" ",D||" ",L].join("");if(U==="  "||U==="  /"||U===",,"||U===",,,"){const q=[+y,Zo(+E,0,100),Zo(+R,0,100),B?hd(+B,V):1];if(jc(q))return(function([Y,se,Q,J]){function le(he){const Ae=(he+Y/30)%12,Ve=se*Math.min(Q,1-Q);return Q-Ve*Math.max(-1,Math.min(Ae-3,9-Ae,1))}return Y=Ou(Y),se/=100,Q/=100,[le(0),le(8),le(4),J]})(q)}}})(e);return i?new Gt(...i,!1):void 0}get rgb(){const{r:e,g:i,b:o,a:u}=this,d=u||1/0;return this.overwriteGetter("rgb",[e/d,i/d,o/d,u])}get hcl(){return this.overwriteGetter("hcl",(function(e){const[i,o,u,d]=ud(e),p=Math.sqrt(o*o+u*u);return[Math.round(1e4*p)?Ou(Math.atan2(u,o)*Vh):NaN,p,i,d]})(this.rgb))}get lab(){return this.overwriteGetter("lab",ud(this.rgb))}overwriteGetter(e,i){return Object.defineProperty(this,e,{value:i}),i}toString(){const[e,i,o,u]=this.rgb;return`rgba(${[e,i,o].map((d=>Math.round(255*d))).join(",")},${u})`}static interpolate(e,i,o,u="rgb"){switch(u){case"rgb":{const[d,p,y,x]=ql(e.rgb,i.rgb,o);return new Gt(d,p,y,x,!1)}case"hcl":{const[d,p,y,x]=e.hcl,[E,D,R,L]=i.hcl;let B,V;if(isNaN(d)||isNaN(E))isNaN(d)?isNaN(E)?B=NaN:(B=E,y!==1&&y!==0||(V=D)):(B=d,R!==1&&R!==0||(V=p));else{let Q=E-d;E>d&&Q>180?Q-=360:E<d&&d-E>180&&(Q+=360),B=d+o*Q}const[U,q,Y,se]=(function([Q,J,le,he]){return Q=isNaN(Q)?0:Q*qo,Fc([le,Math.cos(Q)*J,Math.sin(Q)*J,he])})([B,V??uo(p,D,o),uo(y,R,o),uo(x,L,o)]);return new Gt(U,q,Y,se,!1)}case"lab":{const[d,p,y,x]=Fc(ql(e.lab,i.lab,o));return new Gt(d,p,y,x,!1)}}}}Gt.black=new Gt(0,0,0,1),Gt.white=new Gt(1,1,1,1),Gt.transparent=new Gt(0,0,0,0),Gt.red=new Gt(1,0,0,1);class Fa{constructor(e,i,o){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=o,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Uh=["bottom","center","top"];class ku{constructor(e,i,o,u,d,p){this.text=e,this.image=i,this.scale=o,this.fontStack=u,this.textColor=d,this.verticalAlign=p}}class qn{constructor(e){this.sections=e}static fromString(e){return new qn([new ku(e,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof qn?e:qn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}}class Pn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Pn)return e;if(typeof e=="number")return new Pn([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const i of e)if(typeof i!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Pn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){return new Pn(ql(e.values,i.values,o))}}class Qi{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qi)return e;if(typeof e=="number")return new Qi([e]);if(Array.isArray(e)){for(const i of e)if(typeof i!="number")return;return new Qi(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){return new Qi(ql(e.values,i.values,o))}}class zt{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof zt)return e;if(typeof e=="string"){const o=Gt.parse(e);return o?new zt([o]):void 0}if(!Array.isArray(e))return;const i=[];for(const o of e){if(typeof o!="string")return;const u=Gt.parse(o);if(!u)return;i.push(u)}return new zt(i)}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o,u="rgb"){const d=[];if(e.values.length!=i.values.length)throw new Error(`colorArray: Arrays have mismatched length (${e.values.length} vs. ${i.values.length}), cannot interpolate.`);for(let p=0;p<e.values.length;p++)d.push(Gt.interpolate(e.values[p],i.values[p],o,u));return new zt(d)}}class Ri extends Error{constructor(e){super(e),this.name="RuntimeError"}toJSON(){return this.message}}const ga=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class pn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof pn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let i=0;i<e.length;i+=2){const o=e[i],u=e[i+1];if(typeof o!="string"||!ga.has(o)||!Array.isArray(u)||u.length!==2||typeof u[0]!="number"||typeof u[1]!="number")return}return new pn(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,i,o){const u=e.values,d=i.values;if(u.length!==d.length)throw new Ri(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${i.toString()}`);const p=[];for(let y=0;y<u.length;y+=2){if(u[y]!==d[y])throw new Ri(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${u[y]}, to[${y}]: ${d[y]}`);p.push(u[y]);const[x,E]=u[y+1],[D,R]=d[y+1];p.push([uo(x,D,o),uo(E,R,o)])}return new pn(p)}}class Er{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Er({name:e,available:!1}):null}}class Zn{constructor(e,i,o){this.from=e,this.to=i,this.transition=o}static interpolate(e,i,o){return new Zn(e,i,o)}static parse(e){return e instanceof Zn?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new Zn(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new Zn(e.from,e.to,e.transition):typeof e=="string"?new Zn(e,e,1):void 0}}function Qr(n,e,i,o){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?o===void 0||typeof o=="number"&&o>=0&&o<=1?null:`Invalid rgba value [${[n,e,i,o].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof o=="number"?[n,e,i,o]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ss(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Zn||n instanceof Gt||n instanceof Fa||n instanceof qn||n instanceof Pn||n instanceof Qi||n instanceof zt||n instanceof pn||n instanceof Er)return!0;if(Array.isArray(n)){for(const e of n)if(!ss(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!ss(n[e]))return!1;return!0}return!1}function Ki(n){if(n===null)return Vi;if(typeof n=="string")return Ft;if(typeof n=="boolean")return qt;if(typeof n=="number")return nt;if(n instanceof Gt)return Yr;if(n instanceof Zn)return kc;if(n instanceof Fa)return Go;if(n instanceof qn)return is;if(n instanceof Pn)return Is;if(n instanceof Qi)return rs;if(n instanceof zt)return ns;if(n instanceof pn)return Nl;if(n instanceof Er)return dn;if(Array.isArray(n)){const e=n.length;let i;for(const o of n){const u=Ki(o);if(i){if(i===u)continue;i=kt;break}i=u}return mr(i||kt,e)}return ts}function co(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Gt||n instanceof Zn||n instanceof qn||n instanceof Pn||n instanceof Qi||n instanceof zt||n instanceof pn||n instanceof Er?n.toString():JSON.stringify(n)}class Kr{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!ss(e[1]))return i.error("invalid value");const o=e[1];let u=Ki(o);const d=i.expectedType;return u.kind!=="array"||u.N!==0||!d||d.kind!=="array"||typeof d.N=="number"&&d.N!==0||(u=d),new Kr(u,o)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const $o={string:Ft,number:nt,boolean:qt,object:ts};class Mr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o,u=1;const d=e[0];if(d==="array"){let y,x;if(e.length>2){const E=e[1];if(typeof E!="string"||!(E in $o)||E==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=$o[E],u++}else y=kt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);x=e[2],u++}o=mr(y,x)}else{if(!$o[d])throw new Error(`Types doesn't contain name = ${d}`);o=$o[d]}const p=[];for(;u<e.length;u++){const y=i.parse(e[u],u,kt);if(!y)return null;p.push(y)}return new Mr(o,p)}evaluate(e){for(let i=0;i<this.args.length;i++){const o=this.args[i].evaluate(e);if(!Vl(this.type,Ki(o)))return o;if(i===this.args.length-1)throw new Ri(`Expected value to be of type ${ni(this.type)}, but found ${ni(Ki(o))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const kn={"to-boolean":qt,"to-color":Yr,"to-number":nt,"to-string":Ft};class Ar{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[0];if(!kn[o])throw new Error(`Can't parse ${o} as it is not part of the known types`);if((o==="to-boolean"||o==="to-string")&&e.length!==2)return i.error("Expected one argument.");const u=kn[o],d=[];for(let p=1;p<e.length;p++){const y=i.parse(e[p],p,kt);if(!y)return null;d.push(y)}return new Ar(u,d)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let i,o;for(const u of this.args){if(i=u.evaluate(e),o=null,i instanceof Gt)return i;if(typeof i=="string"){const d=e.parseColor(i);if(d)return d}else if(Array.isArray(i)&&(o=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Qr(i[0],i[1],i[2],i[3]),!o))return new Gt(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Ri(o||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const o of this.args){i=o.evaluate(e);const u=Pn.parse(i);if(u)return u}throw new Ri(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"numberArray":{let i;for(const o of this.args){i=o.evaluate(e);const u=Qi.parse(i);if(u)return u}throw new Ri(`Could not parse numberArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"colorArray":{let i;for(const o of this.args){i=o.evaluate(e);const u=zt.parse(i);if(u)return u}throw new Ri(`Could not parse colorArray from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const o of this.args){i=o.evaluate(e);const u=pn.parse(i);if(u)return u}throw new Ri(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const o of this.args){if(i=o.evaluate(e),i===null)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Ri(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return qn.fromString(co(this.args[0].evaluate(e)));case"resolvedImage":return Er.fromString(co(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return co(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}const Fu=["Unknown","Point","LineString","Polygon"];class Xo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Fu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let i=this._parseColorCache.get(e);return i||(i=Gt.parse(e),this._parseColorCache.set(e,i)),i}}class Yo{constructor(e,i,o=[],u,d=new Ba,p=[]){this.registry=e,this.path=o,this.key=o.map((y=>`[${y}]`)).join(""),this.scope=d,this.errors=p,this.expectedType=u,this._isConstant=i}parse(e,i,o,u,d={}){return i?this.concat(i,o,u)._parse(e,d):this._parse(e,d)}_parse(e,i){function o(u,d,p){return p==="assert"?new Mr(d,[u]):p==="coerce"?new Ar(d,[u]):u}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if(typeof u!="string")return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const d=this.registry[u];if(d){let p=d.parse(e,this);if(!p)return null;if(this.expectedType){const y=this.expectedType,x=p.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||x.kind!=="value"){if(y.kind==="projectionDefinition"&&["string","array"].includes(x.kind)||["color","formatted","resolvedImage"].includes(y.kind)&&["value","string"].includes(x.kind)||["padding","numberArray"].includes(y.kind)&&["value","number","array"].includes(x.kind)||y.kind==="colorArray"&&["value","string","array"].includes(x.kind)||y.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(x.kind))p=o(p,y,i.typeAnnotation||"coerce");else if(this.checkSubtype(y,x))return null}else p=o(p,y,i.typeAnnotation||"assert")}if(!(p instanceof Kr)&&p.type.kind!=="resolvedImage"&&this._isConstant(p)){const y=new Xo;try{p=new Kr(p.type,p.evaluate(y))}catch(x){return this.error(x.message),null}}return p}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,o){const u=typeof e=="number"?this.path.concat(e):this.path,d=o?this.scope.concat(o):this.scope;return new Yo(this.registry,this._isConstant,u,i||null,d,this.errors)}error(e,...i){const o=`${this.key}${i.map((u=>`[${u}]`)).join("")}`;this.errors.push(new pr(o,e))}checkSubtype(e,i){const o=Vl(e,i);return o&&this.error(o),o}}class Mi{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const o=[];for(let d=1;d<e.length-1;d+=2){const p=e[d];if(typeof p!="string")return i.error(`Expected string, but found ${typeof p} instead.`,d);if(/[^a-zA-Z0-9_]/.test(p))return i.error("Variable names must contain only alphanumeric characters or '_'.",d);const y=i.parse(e[d+1],d+1);if(!y)return null;o.push([p,y])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,o);return u?new Mi(o,u):null}outputDefined(){return this.result.outputDefined()}}class ho{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const o=e[1];return i.scope.has(o)?new ho(o,i.scope.get(o)):i.error(`Unknown variable "${o}". Make sure "${o}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Xt{constructor(e,i,o){this.type=e,this.index=i,this.input=o}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,nt),u=i.parse(e[2],2,mr(i.expectedType||kt));return o&&u?new Xt(u.type.itemType,o,u):null}evaluate(e){const i=this.index.evaluate(e),o=this.input.evaluate(e);if(i<0)throw new Ri(`Array index out of bounds: ${i} < 0.`);if(i>=o.length)throw new Ri(`Array index out of bounds: ${i} > ${o.length-1}.`);if(i!==Math.floor(i))throw new Ri(`Array index must be an integer, but found ${i} instead.`);return o[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class jt{constructor(e,i){this.type=qt,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,kt),u=i.parse(e[2],2,kt);return o&&u?Ul(o.type,[qt,Ft,nt,Vi,kt])?new jt(o,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ni(o.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!o)return!1;if(!oo(i,["boolean","string","number","null"]))throw new Ri(`Expected first argument to be of type boolean, string, number or null, but found ${ni(Ki(i))} instead.`);if(!oo(o,["string","array"]))throw new Ri(`Expected second argument to be of type array or string, but found ${ni(Ki(o))} instead.`);return o.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Qo{constructor(e,i,o){this.type=nt,this.needle=e,this.haystack=i,this.fromIndex=o}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,kt),u=i.parse(e[2],2,kt);if(!o||!u)return null;if(!Ul(o.type,[qt,Ft,nt,Vi,kt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${ni(o.type)} instead`);if(e.length===4){const d=i.parse(e[3],3,nt);return d?new Qo(o,u,d):null}return new Qo(o,u)}evaluate(e){const i=this.needle.evaluate(e),o=this.haystack.evaluate(e);if(!oo(i,["boolean","string","number","null"]))throw new Ri(`Expected first argument to be of type boolean, string, number or null, but found ${ni(Ki(i))} instead.`);let u;if(this.fromIndex&&(u=this.fromIndex.evaluate(e)),oo(o,["string"])){const d=o.indexOf(i,u);return d===-1?-1:[...o.slice(0,d)].length}if(oo(o,["array"]))return o.indexOf(i,u);throw new Ri(`Expected second argument to be of type array or string, but found ${ni(Ki(o))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class ri{constructor(e,i,o,u,d,p){this.inputType=e,this.type=i,this.input=o,this.cases=u,this.outputs=d,this.otherwise=p}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let o,u;i.expectedType&&i.expectedType.kind!=="value"&&(u=i.expectedType);const d={},p=[];for(let E=2;E<e.length-1;E+=2){let D=e[E];const R=e[E+1];Array.isArray(D)||(D=[D]);const L=i.concat(E);if(D.length===0)return L.error("Expected at least one branch label.");for(const V of D){if(typeof V!="number"&&typeof V!="string")return L.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return L.error("Numeric branch labels must be integer values.");if(o){if(L.checkSubtype(o,Ki(V)))return null}else o=Ki(V);if(d[String(V)]!==void 0)return L.error("Branch labels must be unique.");d[String(V)]=p.length}const B=i.parse(R,E,u);if(!B)return null;u=u||B.type,p.push(B)}const y=i.parse(e[1],1,kt);if(!y)return null;const x=i.parse(e[e.length-1],e.length-1,u);return x?y.type.kind!=="value"&&i.concat(1).checkSubtype(o,y.type)?null:new ri(o,u,y,d,p,x):null}evaluate(e){const i=this.input.evaluate(e);return(Ki(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}}class ju{constructor(e,i,o){this.type=e,this.branches=i,this.otherwise=o}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let o;i.expectedType&&i.expectedType.kind!=="value"&&(o=i.expectedType);const u=[];for(let p=1;p<e.length-1;p+=2){const y=i.parse(e[p],p,qt);if(!y)return null;const x=i.parse(e[p+1],p+1,o);if(!x)return null;u.push([y,x]),o=o||x.type}const d=i.parse(e[e.length-1],e.length-1,o);if(!d)return null;if(!o)throw new Error("Can't infer output type");return new ju(o,u,d)}evaluate(e){for(const[i,o]of this.branches)if(i.evaluate(e))return o.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,o]of this.branches)e(i),e(o);e(this.otherwise)}outputDefined(){return this.branches.every((([e,i])=>i.outputDefined()))&&this.otherwise.outputDefined()}}class _a{constructor(e,i,o,u){this.type=e,this.input=i,this.beginIndex=o,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 2 or 3 arguments, but found ${e.length-1} instead.`);const o=i.parse(e[1],1,kt),u=i.parse(e[2],2,nt);if(!o||!u)return null;if(!Ul(o.type,[mr(kt),Ft,kt]))return i.error(`Expected first argument to be of type array or string, but found ${ni(o.type)} instead`);if(e.length===4){const d=i.parse(e[3],3,nt);return d?new _a(o.type,o,u,d):null}return new _a(o.type,o,u)}evaluate(e){const i=this.input.evaluate(e),o=this.beginIndex.evaluate(e);let u;if(this.endIndex&&(u=this.endIndex.evaluate(e)),oo(i,["string"]))return[...i].slice(o,u).join("");if(oo(i,["array"]))return i.slice(o,u);throw new Ri(`Expected first argument to be of type array or string, but found ${ni(Ki(i))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function fo(n,e){const i=n.length-1;let o,u,d=0,p=i,y=0;for(;d<=p;)if(y=Math.floor((d+p)/2),o=n[y],u=n[y+1],o<=e){if(y===i||e<u)return y;d=y+1}else{if(!(o>e))throw new Ri("Input is not a number.");p=y-1}return 0}class po{constructor(e,i,o){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,d]of o)this.labels.push(u),this.outputs.push(d)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const o=i.parse(e[1],1,nt);if(!o)return null;const u=[];let d=null;i.expectedType&&i.expectedType.kind!=="value"&&(d=i.expectedType);for(let p=1;p<e.length;p+=2){const y=p===1?-1/0:e[p],x=e[p+1],E=p,D=p+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(u.length&&u[u.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const R=i.parse(x,D,d);if(!R)return null;d=d||R.type,u.push([y,R])}return new po(d,o,u)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return o[0].evaluate(e);const d=i.length;return u>=i[d-1]?o[d-1].evaluate(e):o[fo(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function fd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Nu,Gh,Fp=(function(){if(Gh)return Nu;function n(e,i,o,u){this.cx=3*e,this.bx=3*(o-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(u-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=o,this.p2y=u}return Gh=1,Nu=n,n.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var o=e,u=0;u<8;u++){var d=this.sampleCurveX(o)-e;if(Math.abs(d)<i)return o;var p=this.sampleCurveDerivativeX(o);if(Math.abs(p)<1e-6)break;o-=d/p}var y=0,x=1;for(o=e,u=0;u<20&&(d=this.sampleCurveX(o),!(Math.abs(d-e)<i));u++)e>d?y=o:x=o,o=.5*(x-y)+y;return o},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Nu})(),qh=fd(Fp);class Cr{constructor(e,i,o,u,d){this.type=e,this.operator=i,this.interpolation=o,this.input=u,this.labels=[],this.outputs=[];for(const[p,y]of d)this.labels.push(p),this.outputs.push(y)}static interpolationFactor(e,i,o,u){let d=0;if(e.name==="exponential")d=os(i,e.base,o,u);else if(e.name==="linear")d=os(i,1,o,u);else if(e.name==="cubic-bezier"){const p=e.controlPoints;d=new qh(p[0],p[1],p[2],p[3]).solve(os(i,1,o,u))}return d}static parse(e,i){let[o,u,d,...p]=e;if(!Array.isArray(u)||u.length===0)return i.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const E=u[1];if(typeof E!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:E}}else{if(u[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const E=u.slice(1);if(E.length!==4||E.some((D=>typeof D!="number"||D<0||D>1)))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:E}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(d=i.parse(d,2,nt),!d)return null;const y=[];let x=null;o!=="interpolate-hcl"&&o!=="interpolate-lab"||i.expectedType==ns?i.expectedType&&i.expectedType.kind!=="value"&&(x=i.expectedType):x=Yr;for(let E=0;E<p.length;E+=2){const D=p[E],R=p[E+1],L=E+3,B=E+4;if(typeof D!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(y.length&&y[y.length-1][0]>=D)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const V=i.parse(R,B,x);if(!V)return null;x=x||V.type,y.push([D,V])}return ka(x,nt)||ka(x,kc)||ka(x,Yr)||ka(x,Is)||ka(x,rs)||ka(x,ns)||ka(x,Nl)||ka(x,mr(nt))?new Cr(x,o,u,d,y):i.error(`Type ${ni(x)} is not interpolatable.`)}evaluate(e){const i=this.labels,o=this.outputs;if(i.length===1)return o[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return o[0].evaluate(e);const d=i.length;if(u>=i[d-1])return o[d-1].evaluate(e);const p=fo(i,u),y=Cr.interpolationFactor(this.interpolation,u,i[p],i[p+1]),x=o[p].evaluate(e),E=o[p+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return uo(x,E,y);case"color":return Gt.interpolate(x,E,y);case"padding":return Pn.interpolate(x,E,y);case"colorArray":return zt.interpolate(x,E,y);case"numberArray":return Qi.interpolate(x,E,y);case"variableAnchorOffsetCollection":return pn.interpolate(x,E,y);case"array":return ql(x,E,y);case"projectionDefinition":return Zn.interpolate(x,E,y)}case"interpolate-hcl":switch(this.type.kind){case"color":return Gt.interpolate(x,E,y,"hcl");case"colorArray":return zt.interpolate(x,E,y,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Gt.interpolate(x,E,y,"lab");case"colorArray":return zt.interpolate(x,E,y,"lab")}}}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}}function os(n,e,i,o){const u=o-i,d=n-i;return u===0?0:e===1?d/u:(Math.pow(e,d)-1)/(Math.pow(e,u)-1)}const Wi={color:Gt.interpolate,number:uo,padding:Pn.interpolate,numberArray:Qi.interpolate,colorArray:zt.interpolate,variableAnchorOffsetCollection:pn.interpolate,array:ql};class Ko{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let o=null;const u=i.expectedType;u&&u.kind!=="value"&&(o=u);const d=[];for(const y of e.slice(1)){const x=i.parse(y,1+d.length,o,void 0,{typeAnnotation:"omit"});if(!x)return null;o=o||x.type,d.push(x)}if(!o)throw new Error("No output type");const p=u&&d.some((y=>Vl(u,y.type)));return new Ko(p?kt:o,d)}evaluate(e){let i,o=null,u=0;for(const d of this.args)if(u++,o=d.evaluate(e),o&&o instanceof Er&&!o.available&&(i||(i=o.name),o=null,u===this.args.length&&(o=i)),o!==null)break;return o}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}}function Vu(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Uu(n,e,i,o){return o.compare(e,i)===0}function mn(n,e,i){const o=n!=="=="&&n!=="!=";return class X0{constructor(d,p,y){this.type=qt,this.lhs=d,this.rhs=p,this.collator=y,this.hasUntypedArgument=d.type.kind==="value"||p.type.kind==="value"}static parse(d,p){if(d.length!==3&&d.length!==4)return p.error("Expected two or three arguments.");const y=d[0];let x=p.parse(d[1],1,kt);if(!x)return null;if(!Vu(y,x.type))return p.concat(1).error(`"${y}" comparisons are not supported for type '${ni(x.type)}'.`);let E=p.parse(d[2],2,kt);if(!E)return null;if(!Vu(y,E.type))return p.concat(2).error(`"${y}" comparisons are not supported for type '${ni(E.type)}'.`);if(x.type.kind!==E.type.kind&&x.type.kind!=="value"&&E.type.kind!=="value")return p.error(`Cannot compare types '${ni(x.type)}' and '${ni(E.type)}'.`);o&&(x.type.kind==="value"&&E.type.kind!=="value"?x=new Mr(E.type,[x]):x.type.kind!=="value"&&E.type.kind==="value"&&(E=new Mr(x.type,[E])));let D=null;if(d.length===4){if(x.type.kind!=="string"&&E.type.kind!=="string"&&x.type.kind!=="value"&&E.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(D=p.parse(d[3],3,Go),!D)return null}return new X0(x,E,D)}evaluate(d){const p=this.lhs.evaluate(d),y=this.rhs.evaluate(d);if(o&&this.hasUntypedArgument){const x=Ki(p),E=Ki(y);if(x.kind!==E.kind||x.kind!=="string"&&x.kind!=="number")throw new Ri(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${x.kind}, ${E.kind}) instead.`)}if(this.collator&&!o&&this.hasUntypedArgument){const x=Ki(p),E=Ki(y);if(x.kind!=="string"||E.kind!=="string")return e(d,p,y)}return this.collator?i(d,p,y,this.collator.evaluate(d)):e(d,p,y)}eachChild(d){d(this.lhs),d(this.rhs),this.collator&&d(this.collator)}outputDefined(){return!0}}}const dd=mn("==",(function(n,e,i){return e===i}),Uu),Nc=mn("!=",(function(n,e,i){return e!==i}),(function(n,e,i,o){return!Uu(0,e,i,o)})),pd=mn("<",(function(n,e,i){return e<i}),(function(n,e,i,o){return o.compare(e,i)<0})),jp=mn(">",(function(n,e,i){return e>i}),(function(n,e,i,o){return o.compare(e,i)>0})),Zl=mn("<=",(function(n,e,i){return e<=i}),(function(n,e,i,o){return o.compare(e,i)<=0})),Vc=mn(">=",(function(n,e,i){return e>=i}),(function(n,e,i,o){return o.compare(e,i)>=0}));class Hl{constructor(e,i,o){this.type=Go,this.locale=o,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const o=e[1];if(typeof o!="object"||Array.isArray(o))return i.error("Collator options argument must be an object.");const u=i.parse(o["case-sensitive"]!==void 0&&o["case-sensitive"],1,qt);if(!u)return null;const d=i.parse(o["diacritic-sensitive"]!==void 0&&o["diacritic-sensitive"],1,qt);if(!d)return null;let p=null;return o.locale&&(p=i.parse(o.locale,1,Ft),!p)?null:new Hl(u,d,p)}evaluate(e){return new Fa(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Zh{constructor(e,i,o,u,d){this.type=Ft,this.number=e,this.locale=i,this.currency=o,this.minFractionDigits=u,this.maxFractionDigits=d}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const o=i.parse(e[1],1,nt);if(!o)return null;const u=e[2];if(typeof u!="object"||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let d=null;if(u.locale&&(d=i.parse(u.locale,1,Ft),!d))return null;let p=null;if(u.currency&&(p=i.parse(u.currency,1,Ft),!p))return null;let y=null;if(u["min-fraction-digits"]&&(y=i.parse(u["min-fraction-digits"],1,nt),!y))return null;let x=null;return u["max-fraction-digits"]&&(x=i.parse(u["max-fraction-digits"],1,nt),!x)?null:new Zh(o,d,p,y,x)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Gu{constructor(e){this.type=is,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const o=e[1];if(!Array.isArray(o)&&typeof o=="object")return i.error("First argument must be an image or text section.");const u=[];let d=!1;for(let p=1;p<=e.length-1;++p){const y=e[p];if(d&&typeof y=="object"&&!Array.isArray(y)){d=!1;let x=null;if(y["font-scale"]&&(x=i.parse(y["font-scale"],1,nt),!x))return null;let E=null;if(y["text-font"]&&(E=i.parse(y["text-font"],1,mr(Ft)),!E))return null;let D=null;if(y["text-color"]&&(D=i.parse(y["text-color"],1,Yr),!D))return null;let R=null;if(y["vertical-align"]){if(typeof y["vertical-align"]=="string"&&!Uh.includes(y["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${y["vertical-align"]}' instead.`);if(R=i.parse(y["vertical-align"],1,Ft),!R)return null}const L=u[u.length-1];L.scale=x,L.font=E,L.textColor=D,L.verticalAlign=R}else{const x=i.parse(e[p],1,kt);if(!x)return null;const E=x.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,u.push({content:x,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Gu(u)}evaluate(e){return new qn(this.sections.map((i=>{const o=i.content.evaluate(e);return Ki(o)===dn?new ku("",o,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(e):null):new ku(co(o),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null,i.verticalAlign?i.verticalAlign.evaluate(e):null)})))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor),i.verticalAlign&&e(i.verticalAlign)}outputDefined(){return!1}}class $l{constructor(e){this.type=dn,this.input=e}static parse(e,i){if(e.length!==2)return i.error("Expected two arguments.");const o=i.parse(e[1],1,Ft);return o?new $l(o):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),o=Er.fromString(i);return o&&e.availableImages&&(o.available=e.availableImages.indexOf(i)>-1),o}eachChild(e){e(this.input)}outputDefined(){return!1}}class Xl{constructor(e){this.type=nt,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=i.parse(e[1],1);return o?o.type.kind!=="array"&&o.type.kind!=="string"&&o.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${ni(o.type)} instead.`):new Xl(o):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Ri(`Expected value to be of type string or array, but found ${ni(Ki(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const wn=8192;function Yl(n,e){const i=(180+n[0])/360,o=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*wn),Math.round(o*u*wn)]}function Ql(n,e){const i=Math.pow(2,e.z);return[(u=(n[0]/wn+e.x)/i,360*u-180),(o=(n[1]/wn+e.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90)];var o,u}function Kl(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function mo(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function md(n,e,i){const o=n[0]-e[0],u=n[1]-e[1],d=n[0]-i[0],p=n[1]-i[1];return o*p-d*u==0&&o*d<=0&&u*p<=0}function qu(n,e,i,o){return(u=[o[0]-i[0],o[1]-i[1]])[0]*(d=[e[0]-n[0],e[1]-n[1]])[1]-u[1]*d[0]!=0&&!(!Gc(n,e,i,o)||!Gc(i,o,n,e));var u,d}function gd(n,e,i){for(const o of i)for(let u=0;u<o.length-1;++u)if(qu(n,e,o[u],o[u+1]))return!0;return!1}function ja(n,e,i=!1){let o=!1;for(const y of e)for(let x=0;x<y.length-1;x++){if(md(n,y[x],y[x+1]))return i;(d=y[x])[1]>(u=n)[1]!=(p=y[x+1])[1]>u[1]&&u[0]<(p[0]-d[0])*(u[1]-d[1])/(p[1]-d[1])+d[0]&&(o=!o)}var u,d,p;return o}function Uc(n,e){for(const i of e)if(ja(n,i))return!0;return!1}function _d(n,e){for(const i of n)if(!ja(i,e))return!1;for(let i=0;i<n.length-1;++i)if(gd(n[i],n[i+1],e))return!1;return!0}function yd(n,e){for(const i of e)if(_d(n,i))return!0;return!1}function Gc(n,e,i,o){const u=o[0]-i[0],d=o[1]-i[1],p=(n[0]-i[0])*d-u*(n[1]-i[1]),y=(e[0]-i[0])*d-u*(e[1]-i[1]);return p>0&&y<0||p<0&&y>0}function qc(n,e,i){const o=[];for(let u=0;u<n.length;u++){const d=[];for(let p=0;p<n[u].length;p++){const y=Yl(n[u][p],i);Kl(e,y),d.push(y)}o.push(d)}return o}function Wo(n,e,i){const o=[];for(let u=0;u<n.length;u++){const d=qc(n[u],e,i);o.push(d)}return o}function Wl(n,e,i,o){if(n[0]<i[0]||n[0]>i[2]){const u=.5*o;let d=n[0]-i[0]>u?-o:i[0]-n[0]>u?o:0;d===0&&(d=n[0]-i[2]>u?-o:i[2]-n[0]>u?o:0),n[0]+=d}Kl(e,n)}function vd(n,e,i,o){const u=Math.pow(2,o.z)*wn,d=[o.x*wn,o.y*wn],p=[];for(const y of n)for(const x of y){const E=[x.x+d[0],x.y+d[1]];Wl(E,e,i,u),p.push(E)}return p}function Zu(n,e,i,o){const u=Math.pow(2,o.z)*wn,d=[o.x*wn,o.y*wn],p=[];for(const x of n){const E=[];for(const D of x){const R=[D.x+d[0],D.y+d[1]];Kl(e,R),E.push(R)}p.push(E)}if(e[2]-e[0]<=u/2){(y=e)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const x of p)for(const E of x)Wl(E,e,i,u)}var y;return p}class go{constructor(e,i){this.type=qt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ss(e[1])){const o=e[1];if(o.type==="FeatureCollection"){const u=[];for(const d of o.features){const{type:p,coordinates:y}=d.geometry;p==="Polygon"&&u.push(y),p==="MultiPolygon"&&u.push(...y)}if(u.length)return new go(o,{type:"MultiPolygon",coordinates:u})}else if(o.type==="Feature"){const u=o.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new go(o,o.geometry)}else if(o.type==="Polygon"||o.type==="MultiPolygon")return new go(o,o)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,o){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=i.canonicalID();if(o.type==="Polygon"){const y=qc(o.coordinates,d,p),x=vd(i.geometry(),u,d,p);if(!mo(u,d))return!1;for(const E of x)if(!ja(E,y))return!1}if(o.type==="MultiPolygon"){const y=Wo(o.coordinates,d,p),x=vd(i.geometry(),u,d,p);if(!mo(u,d))return!1;for(const E of x)if(!Uc(E,y))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,o){const u=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],p=i.canonicalID();if(o.type==="Polygon"){const y=qc(o.coordinates,d,p),x=Zu(i.geometry(),u,d,p);if(!mo(u,d))return!1;for(const E of x)if(!_d(E,y))return!1}if(o.type==="MultiPolygon"){const y=Wo(o.coordinates,d,p),x=Zu(i.geometry(),u,d,p);if(!mo(u,d))return!1;for(const E of x)if(!yd(E,y))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Hh=class{constructor(n=[],e=(i,o)=>i<o?-1:i>o?1:0){if(this.data=n,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:e,compare:i}=this,o=e[n];for(;n>0;){const u=n-1>>1,d=e[u];if(i(o,d)>=0)break;e[n]=d,n=u}e[n]=o}_down(n){const{data:e,compare:i}=this,o=this.length>>1,u=e[n];for(;n<o;){let d=1+(n<<1);const p=d+1;if(p<this.length&&i(e[p],e[d])<0&&(d=p),i(e[d],u)>=0)break;e[n]=e[d],n=d}e[n]=u}};function Hu(n,e,i=0,o=n.length-1,u=$h){for(;o>i;){if(o-i>600){const x=o-i+1,E=e-i+1,D=Math.log(x),R=.5*Math.exp(2*D/3),L=.5*Math.sqrt(D*R*(x-R)/x)*(E-x/2<0?-1:1);Hu(n,e,Math.max(i,Math.floor(e-E*R/x+L)),Math.min(o,Math.floor(e+(x-E)*R/x+L)),u)}const d=n[e];let p=i,y=o;for(_o(n,i,e),u(n[o],d)>0&&_o(n,i,o);p<y;){for(_o(n,p,y),p++,y--;u(n[p],d)<0;)p++;for(;u(n[y],d)>0;)y--}u(n[i],d)===0?_o(n,i,y):(y++,_o(n,y,o)),y<=e&&(i=y+1),e<=y&&(o=y-1)}}function _o(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}function $h(n,e){return n<e?-1:n>e?1:0}function $u(n,e){if(n.length<=1)return[n];const i=[];let o,u;for(const d of n){const p=Np(d);p!==0&&(d.area=Math.abs(p),u===void 0&&(u=p<0),u===p<0?(o&&i.push(o),o=[d]):o.push(d))}if(o&&i.push(o),e>1)for(let d=0;d<i.length;d++)i[d].length<=e||(Hu(i[d],e,1,i[d].length-1,bd),i[d]=i[d].slice(0,e));return i}function bd(n,e){return e.area-n.area}function Np(n){let e=0;for(let i,o,u=0,d=n.length,p=d-1;u<d;p=u++)i=n[u],o=n[p],e+=(o.x-i.x)*(i.y+o.y);return e}const xd=1/298.257223563,Xu=xd*(2-xd),wd=Math.PI/180;class Xh{constructor(e){const i=6378.137*wd*1e3,o=Math.cos(e*wd),u=1/(1-Xu*(1-o*o)),d=Math.sqrt(u);this.kx=i*d*o,this.ky=i*d*u*(1-Xu)}distance(e,i){const o=this.wrap(e[0]-i[0])*this.kx,u=(e[1]-i[1])*this.ky;return Math.sqrt(o*o+u*u)}pointOnLine(e,i){let o,u,d,p,y=1/0;for(let x=0;x<e.length-1;x++){let E=e[x][0],D=e[x][1],R=this.wrap(e[x+1][0]-E)*this.kx,L=(e[x+1][1]-D)*this.ky,B=0;R===0&&L===0||(B=(this.wrap(i[0]-E)*this.kx*R+(i[1]-D)*this.ky*L)/(R*R+L*L),B>1?(E=e[x+1][0],D=e[x+1][1]):B>0&&(E+=R/this.kx*B,D+=L/this.ky*B)),R=this.wrap(i[0]-E)*this.kx,L=(i[1]-D)*this.ky;const V=R*R+L*L;V<y&&(y=V,o=E,u=D,d=x,p=B)}return{point:[o,u],index:d,t:Math.max(0,Math.min(1,p))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Or(n,e){return e[0]-n[0]}function yo(n){return n[1]-n[0]+1}function ya(n,e){return n[1]>=n[0]&&n[1]<e}function Yu(n,e){if(n[0]>n[1])return[null,null];const i=yo(n);if(e){if(i===2)return[n,null];const u=Math.floor(i/2);return[[n[0],n[0]+u],[n[0]+u,n[1]]]}if(i===1)return[n,null];const o=Math.floor(i/2)-1;return[[n[0],n[0]+o],[n[0]+o+1,n[1]]]}function Zc(n,e){if(!ya(e,n.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let o=e[0];o<=e[1];++o)Kl(i,n[o]);return i}function Hc(n){const e=[1/0,1/0,-1/0,-1/0];for(const i of n)for(const o of i)Kl(e,o);return e}function Qu(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function $c(n,e,i){if(!Qu(n)||!Qu(e))return NaN;let o=0,u=0;return n[2]<e[0]&&(o=e[0]-n[2]),n[0]>e[2]&&(o=n[0]-e[2]),n[1]>e[3]&&(u=n[1]-e[3]),n[3]<e[1]&&(u=e[1]-n[3]),i.distance([0,0],[o,u])}function va(n,e,i){const o=i.pointOnLine(e,n);return i.distance(n,o.point)}function Ku(n,e,i,o,u){const d=Math.min(va(n,[i,o],u),va(e,[i,o],u)),p=Math.min(va(i,[n,e],u),va(o,[n,e],u));return Math.min(d,p)}function Wu(n,e,i,o,u){if(!ya(e,n.length)||!ya(o,i.length))return 1/0;let d=1/0;for(let p=e[0];p<e[1];++p){const y=n[p],x=n[p+1];for(let E=o[0];E<o[1];++E){const D=i[E],R=i[E+1];if(qu(y,x,D,R))return 0;d=Math.min(d,Ku(y,x,D,R,u))}}return d}function Xc(n,e,i,o,u){if(!ya(e,n.length)||!ya(o,i.length))return NaN;let d=1/0;for(let p=e[0];p<=e[1];++p)for(let y=o[0];y<=o[1];++y)if(d=Math.min(d,u.distance(n[p],i[y])),d===0)return d;return d}function Td(n,e,i){if(ja(n,e,!0))return 0;let o=1/0;for(const u of e){const d=u[0],p=u[u.length-1];if(d!==p&&(o=Math.min(o,va(n,[p,d],i)),o===0))return o;const y=i.pointOnLine(u,n);if(o=Math.min(o,i.distance(n,y.point)),o===0)return o}return o}function Jo(n,e,i,o){if(!ya(e,n.length))return NaN;for(let d=e[0];d<=e[1];++d)if(ja(n[d],i,!0))return 0;let u=1/0;for(let d=e[0];d<e[1];++d){const p=n[d],y=n[d+1];for(const x of i)for(let E=0,D=x.length,R=D-1;E<D;R=E++){const L=x[R],B=x[E];if(qu(p,y,L,B))return 0;u=Math.min(u,Ku(p,y,L,B,o))}}return u}function el(n,e){for(const i of n)for(const o of i)if(ja(o,e,!0))return!0;return!1}function Yh(n,e,i,o=1/0){const u=Hc(n),d=Hc(e);if(o!==1/0&&$c(u,d,i)>=o)return o;if(mo(u,d)){if(el(n,e))return 0}else if(el(e,n))return 0;let p=1/0;for(const y of n)for(let x=0,E=y.length,D=E-1;x<E;D=x++){const R=y[D],L=y[x];for(const B of e)for(let V=0,U=B.length,q=U-1;V<U;q=V++){const Y=B[q],se=B[V];if(qu(R,L,Y,se))return 0;p=Math.min(p,Ku(R,L,Y,se,i))}}return p}function ci(n,e,i,o,u,d){if(!d)return;const p=$c(Zc(o,d),u,i);p<e&&n.push([p,d,[0,0]])}function ls(n,e,i,o,u,d,p){if(!d||!p)return;const y=$c(Zc(o,d),Zc(u,p),i);y<e&&n.push([y,d,p])}function Ju(n,e,i,o,u=1/0){let d=Math.min(o.distance(n[0],i[0][0]),u);if(d===0)return d;const p=new Hh([[0,[0,n.length-1],[0,0]]],Or),y=Hc(i);for(;p.length>0;){const x=p.pop();if(x[0]>=d)continue;const E=x[1],D=e?50:100;if(yo(E)<=D){if(!ya(E,n.length))return NaN;if(e){const R=Jo(n,E,i,o);if(isNaN(R)||R===0)return R;d=Math.min(d,R)}else for(let R=E[0];R<=E[1];++R){const L=Td(n[R],i,o);if(d=Math.min(d,L),d===0)return 0}}else{const R=Yu(E,e);ci(p,d,o,n,y,R[0]),ci(p,d,o,n,y,R[1])}}return d}function ec(n,e,i,o,u,d=1/0){let p=Math.min(d,u.distance(n[0],i[0]));if(p===0)return p;const y=new Hh([[0,[0,n.length-1],[0,i.length-1]]],Or);for(;y.length>0;){const x=y.pop();if(x[0]>=p)continue;const E=x[1],D=x[2],R=e?50:100,L=o?50:100;if(yo(E)<=R&&yo(D)<=L){if(!ya(E,n.length)&&ya(D,i.length))return NaN;let B;if(e&&o)B=Wu(n,E,i,D,u),p=Math.min(p,B);else if(e&&!o){const V=n.slice(E[0],E[1]+1);for(let U=D[0];U<=D[1];++U)if(B=va(i[U],V,u),p=Math.min(p,B),p===0)return p}else if(!e&&o){const V=i.slice(D[0],D[1]+1);for(let U=E[0];U<=E[1];++U)if(B=va(n[U],V,u),p=Math.min(p,B),p===0)return p}else B=Xc(n,E,i,D,u),p=Math.min(p,B)}else{const B=Yu(E,e),V=Yu(D,o);ls(y,p,u,n,i,B[0],V[0]),ls(y,p,u,n,i,B[0],V[1]),ls(y,p,u,n,i,B[1],V[0]),ls(y,p,u,n,i,B[1],V[1])}}return p}function Yc(n){return n.type==="MultiPolygon"?n.coordinates.map((e=>({type:"Polygon",coordinates:e}))):n.type==="MultiLineString"?n.coordinates.map((e=>({type:"LineString",coordinates:e}))):n.type==="MultiPoint"?n.coordinates.map((e=>({type:"Point",coordinates:e}))):[n]}class tl{constructor(e,i){this.type=nt,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(ss(e[1])){const o=e[1];if(o.type==="FeatureCollection")return new tl(o,o.features.map((u=>Yc(u.geometry))).flat());if(o.type==="Feature")return new tl(o,Yc(o.geometry));if("type"in o&&"coordinates"in o)return new tl(o,Yc(o))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,o){const u=i.geometry(),d=u.flat().map((x=>Ql([x.x,x.y],i.canonical)));if(u.length===0)return NaN;const p=new Xh(d[0][1]);let y=1/0;for(const x of o){switch(x.type){case"Point":y=Math.min(y,ec(d,!1,[x.coordinates],!1,p,y));break;case"LineString":y=Math.min(y,ec(d,!1,x.coordinates,!0,p,y));break;case"Polygon":y=Math.min(y,Ju(d,!1,x.coordinates,p,y))}if(y===0)return y}return y})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,o){const u=i.geometry(),d=u.flat().map((x=>Ql([x.x,x.y],i.canonical)));if(u.length===0)return NaN;const p=new Xh(d[0][1]);let y=1/0;for(const x of o){switch(x.type){case"Point":y=Math.min(y,ec(d,!0,[x.coordinates],!1,p,y));break;case"LineString":y=Math.min(y,ec(d,!0,x.coordinates,!0,p,y));break;case"Polygon":y=Math.min(y,Ju(d,!0,x.coordinates,p,y))}if(y===0)return y}return y})(e,this.geometries);if(e.geometryType()==="Polygon")return(function(i,o){const u=i.geometry();if(u.length===0||u[0].length===0)return NaN;const d=$u(u,0).map((x=>x.map((E=>E.map((D=>Ql([D.x,D.y],i.canonical))))))),p=new Xh(d[0][0][0][1]);let y=1/0;for(const x of o)for(const E of d){switch(x.type){case"Point":y=Math.min(y,Ju([x.coordinates],!1,E,p,y));break;case"LineString":y=Math.min(y,Ju(x.coordinates,!0,E,p,y));break;case"Polygon":y=Math.min(y,Yh(E,x.coordinates,p,y))}if(y===0)return y}return y})(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class tc{constructor(e){this.type=kt,this.key=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const o=e[1];return o==null?i.error("Global state property must be defined."):typeof o!="string"?i.error(`Global state property must be string, but found ${typeof e[1]} instead.`):new tc(o)}evaluate(e){var i;const o=(i=e.globals)===null||i===void 0?void 0:i.globalState;return o&&Object.keys(o).length!==0?Gl(o,this.key):null}eachChild(){}outputDefined(){return!1}}const Jl={"==":dd,"!=":Nc,">":jp,"<":pd,">=":Vc,"<=":Zl,array:Mr,at:Xt,boolean:Mr,case:ju,coalesce:Ko,collator:Hl,format:Gu,image:$l,in:jt,"index-of":Qo,interpolate:Cr,"interpolate-hcl":Cr,"interpolate-lab":Cr,length:Xl,let:Mi,literal:Kr,match:ri,number:Mr,"number-format":Zh,object:Mr,slice:_a,step:po,string:Mr,"to-boolean":Ar,"to-color":Ar,"to-number":Ar,"to-string":Ar,var:ho,within:go,distance:tl,"global-state":tc};class Wr{constructor(e,i,o,u){this.name=e,this.type=i,this._evaluate=o,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,i){const o=e[0],u=Wr.definitions[o];if(!u)return i.error(`Unknown expression "${o}". If you wanted a literal array, use ["literal", [...]].`,0);const d=Array.isArray(u)?u[0]:u.type,p=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,y=p.filter((([E])=>!Array.isArray(E)||E.length===e.length-1));let x=null;for(const[E,D]of y){x=new Yo(i.registry,Dr,i.path,null,i.scope);const R=[];let L=!1;for(let B=1;B<e.length;B++){const V=e[B],U=Array.isArray(E)?E[B-1]:E.type,q=x.parse(V,1+R.length,U);if(!q){L=!0;break}R.push(q)}if(!L)if(Array.isArray(E)&&E.length!==R.length)x.error(`Expected ${E.length} arguments, but found ${R.length} instead.`);else{for(let B=0;B<R.length;B++){const V=Array.isArray(E)?E[B]:E.type,U=R[B];x.concat(B+1).checkSubtype(V,U.type)}if(x.errors.length===0)return new Wr(o,d,D,R)}}if(y.length===1)i.errors.push(...x.errors);else{const E=(y.length?y:p).map((([R])=>{return L=R,Array.isArray(L)?`(${L.map(ni).join(", ")})`:`(${ni(L.type)}...)`;var L})).join(" | "),D=[];for(let R=1;R<e.length;R++){const L=i.parse(e[R],1+D.length);if(!L)return null;D.push(ni(L.type))}i.error(`Expected arguments of type ${E}, but found (${D.join(", ")}) instead.`)}return null}static register(e,i){Wr.definitions=i;for(const o in i)e[o]=Wr}}function Qh(n,[e,i,o,u]){e=e.evaluate(n),i=i.evaluate(n),o=o.evaluate(n);const d=u?u.evaluate(n):1,p=Qr(e,i,o,d);if(p)throw new Ri(p);return new Gt(e/255,i/255,o/255,d,!1)}function Qc(n,e){return n in e}function Jr(n,e){const i=e[n];return i===void 0?null:i}function us(n){return{type:n}}function Dr(n){if(n instanceof ho)return Dr(n.boundExpression);if(n instanceof Wr&&n.name==="error"||n instanceof Hl||n instanceof go||n instanceof tl||n instanceof tc)return!1;const e=n instanceof Ar||n instanceof Mr;let i=!0;return n.eachChild((o=>{i=e?i&&Dr(o):i&&o instanceof Kr})),!!i&&Ls(n)&&nl(n,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Ls(n){if(n instanceof Wr&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof go||n instanceof tl)return!1;let e=!0;return n.eachChild((i=>{e&&!Ls(i)&&(e=!1)})),e}function il(n){if(n instanceof Wr&&n.name==="feature-state")return!1;let e=!0;return n.eachChild((i=>{e&&!il(i)&&(e=!1)})),e}function nl(n,e){if(n instanceof Wr&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild((o=>{i&&!nl(o,e)&&(i=!1)})),i}function ic(n){return{result:"success",value:n}}function vo(n){return{result:"error",value:n}}function ba(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function Kh(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function eu(n){return!!n.expression&&n.expression.interpolated}function Ut(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Kc(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)&&Ki(n)===ts}function ea(n){return n}function Wc(n,e){const i=n.stops&&typeof n.stops[0][0]=="object",o=i||!(i||n.property!==void 0),u=n.type||(eu(e)?"exponential":"interval"),d=(function(D){switch(D.type){case"color":return Gt.parse;case"padding":return Pn.parse;case"numberArray":return Qi.parse;case"colorArray":return zt.parse;default:return null}})(e);if(d&&((n=dr({},n)).stops&&(n.stops=n.stops.map((D=>[D[0],d(D[1])]))),n.default=d(n.default?n.default:e.default)),n.colorSpace&&(p=n.colorSpace)!=="rgb"&&p!=="hcl"&&p!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var p;const y=(function(D){switch(D){case"exponential":return bo;case"interval":return Jc;case"categorical":return Sd;case"identity":return Wh;default:throw new Error(`Unknown function type "${D}"`)}})(u);let x,E;if(u==="categorical"){x=Object.create(null);for(const D of n.stops)x[D[0]]=D[1];E=typeof n.stops[0][0]}if(i){const D={},R=[];for(let V=0;V<n.stops.length;V++){const U=n.stops[V],q=U[0].zoom;D[q]===void 0&&(D[q]={zoom:q,type:n.type,property:n.property,default:n.default,stops:[]},R.push(q)),D[q].stops.push([U[0].value,U[1]])}const L=[];for(const V of R)L.push([D[V].zoom,Wc(D[V],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Cr.interpolationFactor.bind(void 0,B),zoomStops:L.map((V=>V[0])),evaluate:({zoom:V},U)=>bo({stops:L,base:n.base},e,V).evaluate(V,U)}}if(o){const D=u==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:Cr.interpolationFactor.bind(void 0,D),zoomStops:n.stops.map((R=>R[0])),evaluate:({zoom:R})=>y(n,e,R,x,E)}}return{kind:"source",evaluate(D,R){const L=R&&R.properties?R.properties[n.property]:void 0;return L===void 0?ta(n.default,e.default):y(n,e,L,x,E)}}}function ta(n,e,i){return n!==void 0?n:e!==void 0?e:i!==void 0?i:void 0}function Sd(n,e,i,o,u){return ta(typeof i===u?o[i]:void 0,n.default,e.default)}function Jc(n,e,i){if(Ut(i)!=="number")return ta(n.default,e.default);const o=n.stops.length;if(o===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[o-1][0])return n.stops[o-1][1];const u=fo(n.stops.map((d=>d[0])),i);return n.stops[u][1]}function bo(n,e,i){const o=n.base!==void 0?n.base:1;if(Ut(i)!=="number")return ta(n.default,e.default);const u=n.stops.length;if(u===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[u-1][0])return n.stops[u-1][1];const d=fo(n.stops.map((D=>D[0])),i),p=(function(D,R,L,B){const V=B-L,U=D-L;return V===0?0:R===1?U/V:(Math.pow(R,U)-1)/(Math.pow(R,V)-1)})(i,o,n.stops[d][0],n.stops[d+1][0]),y=n.stops[d][1],x=n.stops[d+1][1],E=Wi[e.type]||ea;return typeof y.evaluate=="function"?{evaluate(...D){const R=y.evaluate.apply(void 0,D),L=x.evaluate.apply(void 0,D);if(R!==void 0&&L!==void 0)return E(R,L,p,n.colorSpace)}}:E(y,x,p,n.colorSpace)}function Wh(n,e,i){switch(e.type){case"color":i=Gt.parse(i);break;case"formatted":i=qn.fromString(i.toString());break;case"resolvedImage":i=Er.fromString(i.toString());break;case"padding":i=Pn.parse(i);break;case"colorArray":i=zt.parse(i);break;case"numberArray":i=Qi.parse(i);break;default:Ut(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0)}return ta(i,n.default,e.default)}Wr.register(Jl,{error:[{kind:"error"},[Ft],(n,[e])=>{throw new Ri(e.evaluate(n))}],typeof:[Ft,[kt],(n,[e])=>ni(Ki(e.evaluate(n)))],"to-rgba":[mr(nt,4),[Yr],(n,[e])=>{const[i,o,u,d]=e.evaluate(n).rgb;return[255*i,255*o,255*u,d]}],rgb:[Yr,[nt,nt,nt],Qh],rgba:[Yr,[nt,nt,nt,nt],Qh],has:{type:qt,overloads:[[[Ft],(n,[e])=>Qc(e.evaluate(n),n.properties())],[[Ft,ts],(n,[e,i])=>Qc(e.evaluate(n),i.evaluate(n))]]},get:{type:kt,overloads:[[[Ft],(n,[e])=>Jr(e.evaluate(n),n.properties())],[[Ft,ts],(n,[e,i])=>Jr(e.evaluate(n),i.evaluate(n))]]},"feature-state":[kt,[Ft],(n,[e])=>Jr(e.evaluate(n),n.featureState||{})],properties:[ts,[],n=>n.properties()],"geometry-type":[Ft,[],n=>n.geometryType()],id:[kt,[],n=>n.id()],zoom:[nt,[],n=>n.globals.zoom],"heatmap-density":[nt,[],n=>n.globals.heatmapDensity||0],elevation:[nt,[],n=>n.globals.elevation||0],"line-progress":[nt,[],n=>n.globals.lineProgress||0],accumulated:[kt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[nt,us(nt),(n,e)=>{let i=0;for(const o of e)i+=o.evaluate(n);return i}],"*":[nt,us(nt),(n,e)=>{let i=1;for(const o of e)i*=o.evaluate(n);return i}],"-":{type:nt,overloads:[[[nt,nt],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[nt],(n,[e])=>-e.evaluate(n)]]},"/":[nt,[nt,nt],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[nt,[nt,nt],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[nt,[nt],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[nt,[nt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[nt,[nt],(n,[e])=>Math.log(e.evaluate(n))],log2:[nt,[nt],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[nt,[nt],(n,[e])=>Math.sin(e.evaluate(n))],cos:[nt,[nt],(n,[e])=>Math.cos(e.evaluate(n))],tan:[nt,[nt],(n,[e])=>Math.tan(e.evaluate(n))],asin:[nt,[nt],(n,[e])=>Math.asin(e.evaluate(n))],acos:[nt,[nt],(n,[e])=>Math.acos(e.evaluate(n))],atan:[nt,[nt],(n,[e])=>Math.atan(e.evaluate(n))],min:[nt,us(nt),(n,e)=>Math.min(...e.map((i=>i.evaluate(n))))],max:[nt,us(nt),(n,e)=>Math.max(...e.map((i=>i.evaluate(n))))],abs:[nt,[nt],(n,[e])=>Math.abs(e.evaluate(n))],round:[nt,[nt],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[nt,[nt],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[nt,[nt],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[qt,[Ft,kt],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[qt,[kt],(n,[e])=>n.id()===e.value],"filter-type-==":[qt,[Ft],(n,[e])=>n.geometryType()===e.value],"filter-<":[qt,[Ft,kt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o<u}],"filter-id-<":[qt,[kt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<o}],"filter->":[qt,[Ft,kt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o>u}],"filter-id->":[qt,[kt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>o}],"filter-<=":[qt,[Ft,kt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o<=u}],"filter-id-<=":[qt,[kt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i<=o}],"filter->=":[qt,[Ft,kt],(n,[e,i])=>{const o=n.properties()[e.value],u=i.value;return typeof o==typeof u&&o>=u}],"filter-id->=":[qt,[kt],(n,[e])=>{const i=n.id(),o=e.value;return typeof i==typeof o&&i>=o}],"filter-has":[qt,[kt],(n,[e])=>e.value in n.properties()],"filter-has-id":[qt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[qt,[mr(Ft)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[qt,[mr(kt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[qt,[Ft,mr(kt)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[qt,[Ft,mr(kt)],(n,[e,i])=>(function(o,u,d,p){for(;d<=p;){const y=d+p>>1;if(u[y]===o)return!0;u[y]>o?p=y-1:d=y+1}return!1})(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:qt,overloads:[[[qt,qt],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[us(qt),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:qt,overloads:[[[qt,qt],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[us(qt),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[qt,[qt],(n,[e])=>!e.evaluate(n)],"is-supported-script":[qt,[Ft],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[Ft,[Ft],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[Ft,[Ft],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[Ft,us(kt),(n,e)=>e.map((i=>co(i.evaluate(n)))).join("")],"resolved-locale":[Ft,[Go],(n,[e])=>e.evaluate(n).resolvedLocale()]});class eh{constructor(e,i,o){this.expression=e,this._warningHistory={},this._evaluator=new Xo,this._defaultValue=i?(function(u){if(u.type==="color"&&Kc(u.default))return new Gt(0,0,0,0);switch(u.type){case"color":return Gt.parse(u.default)||null;case"padding":return Pn.parse(u.default)||null;case"numberArray":return Qi.parse(u.default)||null;case"colorArray":return zt.parse(u.default)||null;case"variableAnchorOffsetCollection":return pn.parse(u.default)||null;case"projectionDefinition":return Zn.parse(u.default)||null;default:return u.default===void 0?null:u.default}})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this._globalState=o}evaluateWithoutErrorHandling(e,i,o,u,d,p){return this._globalState&&(e=Qn(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=o,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)}evaluate(e,i,o,u,d,p){this._globalState&&(e=Qn(e,this._globalState)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=o||null,this._evaluator.canonical=u,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=p||null;try{const y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new Ri(`Expected value to be one of ${Object.keys(this._enumValues).map((x=>JSON.stringify(x))).join(", ")}, but found ${JSON.stringify(y)} instead.`);return y}catch(y){return this._warningHistory[y.message]||(this._warningHistory[y.message]=!0,typeof console<"u"&&console.warn(y.message)),this._defaultValue}}}function xo(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in Jl}function tu(n,e,i){const o=new Yo(Jl,Dr,[],e?(function(d){const p={color:Yr,string:Ft,number:nt,enum:Ft,boolean:qt,formatted:is,padding:Is,numberArray:rs,colorArray:ns,projectionDefinition:kc,resolvedImage:dn,variableAnchorOffsetCollection:Nl};return d.type==="array"?mr(p[d.value]||kt,d.length):p[d.type]})(e):void 0),u=o.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?ic(new eh(u,e,i)):vo(o.errors)}class zr{constructor(e,i,o){this.kind=e,this._styleExpression=i,this.isStateDependent=e!=="constant"&&!il(i.expression),this.globalStateRefs=Hn(i.expression),this._globalState=o}evaluateWithoutErrorHandling(e,i,o,u,d,p){return this._globalState&&(e=Qn(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,o,u,d,p)}evaluate(e,i,o,u,d,p){return this._globalState&&(e=Qn(e,this._globalState)),this._styleExpression.evaluate(e,i,o,u,d,p)}}class wo{constructor(e,i,o,u,d){this.kind=e,this.zoomStops=o,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!il(i.expression),this.globalStateRefs=Hn(i.expression),this.interpolationType=u,this._globalState=d}evaluateWithoutErrorHandling(e,i,o,u,d,p){return this._globalState&&(e=Qn(e,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(e,i,o,u,d,p)}evaluate(e,i,o,u,d,p){return this._globalState&&(e=Qn(e,this._globalState)),this._styleExpression.evaluate(e,i,o,u,d,p)}interpolationFactor(e,i,o){return this.interpolationType?Cr.interpolationFactor(this.interpolationType,e,i,o):0}}function To(n,e,i){const o=tu(n,e,i);if(o.result==="error")return o;const u=o.value.expression,d=Ls(u);if(!d&&!ba(e))return vo([new pr("","data expressions not supported")]);const p=nl(u,["zoom"]);if(!p&&!Kh(e))return vo([new pr("","zoom expressions not supported")]);const y=So(u);return y||p?y instanceof pr?vo([y]):y instanceof Cr&&!eu(e)?vo([new pr("",'"interpolate" expressions cannot be used with this property')]):ic(y?new wo(d?"camera":"composite",o.value,y.labels,y instanceof Cr?y.interpolation:void 0,i):new zr(d?"constant":"source",o.value,i)):vo([new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class rl{constructor(e,i){this._parameters=e,this._specification=i,dr(this,Wc(this._parameters,this._specification))}static deserialize(e){return new rl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function So(n){let e=null;if(n instanceof Mi)e=So(n.result);else if(n instanceof Ko){for(const i of n.args)if(e=So(i),e)break}else(n instanceof po||n instanceof Cr)&&n.input instanceof Wr&&n.input.name==="zoom"&&(e=n);return e instanceof pr||n.eachChild((i=>{const o=So(i);o instanceof pr?e=o:!e&&o?e=new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&o&&e!==o&&(e=new pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}function Hn(n,e=new Set){return n instanceof tc&&e.add(n.key),n.eachChild((i=>{Hn(i,e)})),e}function Qn(n,e){const{zoom:i,heatmapDensity:o,elevation:u,lineProgress:d,isSupportedScript:p,accumulated:y}=n??{};return{zoom:i,heatmapDensity:o,elevation:u,lineProgress:d,isSupportedScript:p,accumulated:y,globalState:e}}function cs(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!cs(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const hs={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Lr(n,e){if(n==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};cs(n)||(n=al(n));const i=tu(n,hs,e);if(i.result==="error")throw new Error(i.value.map((o=>`${o.key}: ${o.message}`)).join(", "));return{filter:(o,u,d)=>i.value.evaluate(o,u,{},d),needGeometry:Jh(n),getGlobalStateRefs:()=>Hn(i.value.expression)}}function Bs(n,e){return n<e?-1:n>e?1:0}function Jh(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let e=1;e<n.length;e++)if(Jh(n[e]))return!0;return!1}function al(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?iu(n[1],n[2],"=="):e==="!="?Oi(iu(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?iu(n[1],n[2],e):e==="any"?(i=n.slice(1),["any"].concat(i.map(al))):e==="all"?["all"].concat(n.slice(1).map(al)):e==="none"?["all"].concat(n.slice(1).map(al).map(Oi)):e==="in"?ef(n[1],n.slice(2)):e==="!in"?Oi(ef(n[1],n.slice(2))):e==="has"?Kn(n[1]):e!=="!has"||Oi(Kn(n[1]));var i}function iu(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function ef(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((i=>typeof i!=typeof e[0]))?["filter-in-large",n,["literal",e.sort(Bs)]]:["filter-in-small",n,["literal",e]]}}function Kn(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Oi(n){return["!",n]}function ti(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let u="[";for(const d of n)u+=`${ti(d)},`;return`${u}]`}const i=Object.keys(n).sort();let o="{";for(let u=0;u<i.length;u++)o+=`${JSON.stringify(i[u])}:${ti(n[i[u]])},`;return`${o}}`}function ks(n){let e="";for(const i of vi)e+=`/${ti(n[i])}`;return e}function ia(n){const e=n.value;return e?[new et(n.key,e,"constants have been deprecated as of v8")]:[]}function an(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Br(n){if(Array.isArray(n))return n.map(Br);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=Br(n[i]);return e}return an(n)}function kr(n){const e=n.key,i=n.value,o=n.valueSpec||{},u=n.objectElementValidators||{},d=n.style,p=n.styleSpec,y=n.validateSpec;let x=[];const E=Ut(i);if(E!=="object")return[new et(e,i,`object expected, ${E} found`)];for(const D in i){const R=D.split(".")[0],L=Gl(o,R)||o["*"];let B;if(Gl(u,R))B=u[R];else if(Gl(o,R)){if(i[D]===void 0)continue;B=y}else if(u["*"])B=u["*"];else{if(!o["*"]){x.push(new et(e,i[D],`unknown property "${D}"`));continue}B=y}x=x.concat(B({key:(e&&`${e}.`)+D,value:i[D],valueSpec:L,style:d,styleSpec:p,object:i,objectKey:D,validateSpec:y},i))}for(const D in o)u[D]||o[D].required&&o[D].default===void 0&&i[D]===void 0&&x.push(new et(e,i,`missing required property "${D}"`));return x}function nc(n){const e=n.value,i=n.valueSpec,o=n.style,u=n.styleSpec,d=n.key,p=n.arrayElementValidator||n.validateSpec;if(Ut(e)!=="array")return[new et(d,e,`array expected, ${Ut(e)} found`)];if(i.length&&e.length!==i.length)return[new et(d,e,`array length ${i.length} expected, length ${e.length} found`)];let y={type:i.value,values:i.values};u.$version<7&&(y.function=i.function),Ut(i.value)==="object"&&(y=i.value);let x=[];for(let E=0;E<e.length;E++)x=x.concat(p({array:e,arrayIndex:E,value:e[E],valueSpec:y,validateSpec:n.validateSpec,style:o,styleSpec:u,key:`${d}[${E}]`}));return x}function fs(n){const e=n.key,i=n.value,o=n.valueSpec;let u=Ut(i);return u==="number"&&i!=i&&(u="NaN"),u!=="number"?[new et(e,i,`number expected, ${u} found`)]:"minimum"in o&&i<o.minimum?[new et(e,i,`${i} is less than the minimum value ${o.minimum}`)]:"maximum"in o&&i>o.maximum?[new et(e,i,`${i} is greater than the maximum value ${o.maximum}`)]:[]}function ds(n){const e=n.valueSpec,i=an(n.value.type);let o,u,d,p={};const y=i!=="categorical"&&n.value.property===void 0,x=!y,E=Ut(n.value.stops)==="array"&&Ut(n.value.stops[0])==="array"&&Ut(n.value.stops[0][0])==="object",D=kr({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(B){if(i==="identity")return[new et(B.key,B.value,'identity function may not have a "stops" property')];let V=[];const U=B.value;return V=V.concat(nc({key:B.key,value:U,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:R})),Ut(U)==="array"&&U.length===0&&V.push(new et(B.key,U,"array must have at least one stop")),V},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return i==="identity"&&y&&D.push(new et(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||D.push(new et(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!eu(n.valueSpec)&&D.push(new et(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(x&&!ba(n.valueSpec)?D.push(new et(n.key,n.value,"property functions not supported")):y&&!Kh(n.valueSpec)&&D.push(new et(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!E||n.value.property!==void 0||D.push(new et(n.key,n.value,'"property" property is required')),D;function R(B){let V=[];const U=B.value,q=B.key;if(Ut(U)!=="array")return[new et(q,U,`array expected, ${Ut(U)} found`)];if(U.length!==2)return[new et(q,U,`array length 2 expected, length ${U.length} found`)];if(E){if(Ut(U[0])!=="object")return[new et(q,U,`object expected, ${Ut(U[0])} found`)];if(U[0].zoom===void 0)return[new et(q,U,"object stop key must have zoom")];if(U[0].value===void 0)return[new et(q,U,"object stop key must have value")];if(d&&d>an(U[0].zoom))return[new et(q,U[0].zoom,"stop zoom values must appear in ascending order")];an(U[0].zoom)!==d&&(d=an(U[0].zoom),u=void 0,p={}),V=V.concat(kr({key:`${q}[0]`,value:U[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:fs,value:L}}))}else V=V.concat(L({key:`${q}[0]`,value:U[0],validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},U));return xo(Br(U[1]))?V.concat([new et(`${q}[1]`,U[1],"expressions are not allowed in function stops.")]):V.concat(B.validateSpec({key:`${q}[1]`,value:U[1],valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function L(B,V){const U=Ut(B.value),q=an(B.value),Y=B.value!==null?B.value:V;if(o){if(U!==o)return[new et(B.key,Y,`${U} stop domain type must match previous stop domain type ${o}`)]}else o=U;if(U!=="number"&&U!=="string"&&U!=="boolean")return[new et(B.key,Y,"stop domain value must be a number, string, or boolean")];if(U!=="number"&&i!=="categorical"){let se=`number expected, ${U} found`;return ba(e)&&i===void 0&&(se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new et(B.key,Y,se)]}return i!=="categorical"||U!=="number"||isFinite(q)&&Math.floor(q)===q?i!=="categorical"&&U==="number"&&u!==void 0&&q<u?[new et(B.key,Y,"stop domain values must appear in ascending order")]:(u=q,i==="categorical"&&q in p?[new et(B.key,Y,"stop domain values must be unique")]:(p[q]=!0,[])):[new et(B.key,Y,`integer expected, found ${q}`)]}}function ps(n){const e=(n.expressionContext==="property"?To:tu)(Br(n.value),n.valueSpec);if(e.result==="error")return e.value.map((o=>new et(`${n.key}${o.key}`,n.value,o.message)));const i=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new et(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!il(i))return[new et(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!il(i))return[new et(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!nl(i,["zoom","feature-state"]))return[new et(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Ls(i))return[new et(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fs(n){const e=n.key,i=n.value,o=Ut(i);return o!=="string"?[new et(e,i,`color expected, ${o} found`)]:Gt.parse(String(i))?[]:[new et(e,i,`color expected, "${i}" found`)]}function js(n){const e=n.key,i=n.value,o=n.valueSpec,u=[];return Array.isArray(o.values)?o.values.indexOf(an(i))===-1&&u.push(new et(e,i,`expected one of [${o.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(o.values).indexOf(an(i))===-1&&u.push(new et(e,i,`expected one of [${Object.keys(o.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function xa(n){return cs(Br(n.value))?ps(dr({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ms(n)}function ms(n){const e=n.value,i=n.key;if(Ut(e)!=="array")return[new et(i,e,`array expected, ${Ut(e)} found`)];const o=n.styleSpec;let u,d=[];if(e.length<1)return[new et(i,e,"filter array must have at least 1 element")];switch(d=d.concat(js({key:`${i}[0]`,value:e[0],valueSpec:o.filter_operator,style:n.style,styleSpec:n.styleSpec})),an(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&an(e[1])==="$type"&&d.push(new et(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&d.push(new et(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Ut(e[1]),u!=="string"&&d.push(new et(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let p=2;p<e.length;p++)u=Ut(e[p]),an(e[1])==="$type"?d=d.concat(js({key:`${i}[${p}]`,value:e[p],valueSpec:o.geometry_type,style:n.style,styleSpec:n.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&d.push(new et(`${i}[${p}]`,e[p],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let p=1;p<e.length;p++)d=d.concat(ms({key:`${i}[${p}]`,value:e[p],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":u=Ut(e[1]),e.length!==2?d.push(new et(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):u!=="string"&&d.push(new et(`${i}[1]`,e[1],`string expected, ${u} found`))}return d}function Ns(n,e){const i=n.key,o=n.validateSpec,u=n.style,d=n.styleSpec,p=n.value,y=n.objectKey,x=d[`${e}_${n.layerType}`];if(!x)return[];const E=y.match(/^(.*)-transition$/);if(e==="paint"&&E&&x[E[1]]&&x[E[1]].transition)return o({key:i,value:p,valueSpec:d.transition,style:u,styleSpec:d});const D=n.valueSpec||x[y];if(!D)return[new et(i,p,`unknown property "${y}"`)];let R;if(Ut(p)==="string"&&ba(D)&&!D.tokens&&(R=/^{([^}]+)}$/.exec(p)))return[new et(i,p,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const L=[];return n.layerType==="symbol"&&y==="text-font"&&Kc(Br(p))&&an(p.type)==="identity"&&L.push(new et(i,p,'"text-font" does not support identity functions')),L.concat(o({key:n.key,value:p,valueSpec:D,style:u,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:y}))}function gs(n){return Ns(n,"paint")}function th(n){return Ns(n,"layout")}function ih(n){let e=[];const i=n.value,o=n.key,u=n.style,d=n.styleSpec;if(Ut(i)!=="object")return[new et(o,i,`object expected, ${Ut(i)} found`)];i.type||i.ref||e.push(new et(o,i,'either "type" or "ref" is required'));let p=an(i.type);const y=an(i.ref);if(i.id){const x=an(i.id);for(let E=0;E<n.arrayIndex;E++){const D=u.layers[E];an(D.id)===x&&e.push(new et(o,i.id,`duplicate layer id "${i.id}", previously used at line ${D.id.__line__}`))}}if("ref"in i){let x;["type","source","source-layer","filter","layout"].forEach((E=>{E in i&&e.push(new et(o,i[E],`"${E}" is prohibited for ref layers`))})),u.layers.forEach((E=>{an(E.id)===y&&(x=E)})),x?x.ref?e.push(new et(o,i.ref,"ref cannot reference another ref layer")):p=an(x.type):e.push(new et(o,i.ref,`ref layer "${y}" not found`))}else if(p!=="background")if(i.source){const x=u.sources&&u.sources[i.source],E=x&&an(x.type);x?E==="vector"&&p==="raster"?e.push(new et(o,i.source,`layer "${i.id}" requires a raster source`)):E!=="raster-dem"&&p==="hillshade"||E!=="raster-dem"&&p==="color-relief"?e.push(new et(o,i.source,`layer "${i.id}" requires a raster-dem source`)):E==="raster"&&p!=="raster"?e.push(new et(o,i.source,`layer "${i.id}" requires a vector source`)):E!=="vector"||i["source-layer"]?E==="raster-dem"&&p!=="hillshade"&&p!=="color-relief"?e.push(new et(o,i.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):p!=="line"||!i.paint||!i.paint["line-gradient"]||E==="geojson"&&x.lineMetrics||e.push(new et(o,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new et(o,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new et(o,i.source,`source "${i.source}" not found`))}else e.push(new et(o,i,'missing required property "source"'));return e=e.concat(kr({key:o,value:i,valueSpec:d.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${o}.type`,value:i.type,valueSpec:d.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:i,objectKey:"type"}),filter:xa,layout:x=>kr({layer:i,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,validateSpec:x.validateSpec,objectElementValidators:{"*":E=>th(dr({layerType:p},E))}}),paint:x=>kr({layer:i,key:x.key,value:x.value,style:x.style,styleSpec:x.styleSpec,validateSpec:x.validateSpec,objectElementValidators:{"*":E=>gs(dr({layerType:p},E))}})}})),e}function na(n){const e=n.value,i=n.key,o=Ut(e);return o!=="string"?[new et(i,e,`string expected, ${o} found`)]:[]}const nu={promoteId:function({key:n,value:e}){if(Ut(e)==="string")return na({key:n,value:e});{const i=[];for(const o in e)i.push(...na({key:`${n}.${o}`,value:e[o]}));return i}}};function Vs(n){const e=n.value,i=n.key,o=n.styleSpec,u=n.style,d=n.validateSpec;if(!e.type)return[new et(i,e,'"type" is required')];const p=an(e.type);let y;switch(p){case"vector":case"raster":return y=kr({key:i,value:e,valueSpec:o[`source_${p.replace("-","_")}`],style:n.style,styleSpec:o,objectElementValidators:nu,validateSpec:d}),y;case"raster-dem":return y=(function(x){var E;const D=(E=x.sourceName)!==null&&E!==void 0?E:"",R=x.value,L=x.styleSpec,B=L.source_raster_dem,V=x.style;let U=[];const q=Ut(R);if(R===void 0)return U;if(q!=="object")return U.push(new et("source_raster_dem",R,`object expected, ${q} found`)),U;const Y=an(R.encoding)==="custom",se=["redFactor","greenFactor","blueFactor","baseShift"],Q=x.value.encoding?`"${x.value.encoding}"`:"Default";for(const J in R)!Y&&se.includes(J)?U.push(new et(J,R[J],`In "${D}": "${J}" is only valid when "encoding" is set to "custom". ${Q} encoding found`)):B[J]?U=U.concat(x.validateSpec({key:J,value:R[J],valueSpec:B[J],validateSpec:x.validateSpec,style:V,styleSpec:L})):U.push(new et(J,R[J],`unknown property "${J}"`));return U})({sourceName:i,value:e,style:n.style,styleSpec:o,validateSpec:d}),y;case"geojson":if(y=kr({key:i,value:e,valueSpec:o.source_geojson,style:u,styleSpec:o,validateSpec:d,objectElementValidators:nu}),e.cluster)for(const x in e.clusterProperties){const[E,D]=e.clusterProperties[x],R=typeof E=="string"?[E,["accumulated"],["get",x]]:E;y.push(...ps({key:`${i}.${x}.map`,value:D,expressionContext:"cluster-map"})),y.push(...ps({key:`${i}.${x}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return y;case"video":return kr({key:i,value:e,valueSpec:o.source_video,style:u,validateSpec:d,styleSpec:o});case"image":return kr({key:i,value:e,valueSpec:o.source_image,style:u,validateSpec:d,styleSpec:o});case"canvas":return[new et(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return js({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function In(n){const e=n.value,i=n.styleSpec,o=i.light,u=n.style;let d=[];const p=Ut(e);if(e===void 0)return d;if(p!=="object")return d=d.concat([new et("light",e,`object expected, ${p} found`)]),d;for(const y in e){const x=y.match(/^(.*)-transition$/);d=d.concat(x&&o[x[1]]&&o[x[1]].transition?n.validateSpec({key:y,value:e[y],valueSpec:i.transition,validateSpec:n.validateSpec,style:u,styleSpec:i}):o[y]?n.validateSpec({key:y,value:e[y],valueSpec:o[y],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new et(y,e[y],`unknown property "${y}"`)])}return d}function rc(n){const e=n.value,i=n.styleSpec,o=i.sky,u=n.style,d=Ut(e);if(e===void 0)return[];if(d!=="object")return[new et("sky",e,`object expected, ${d} found`)];let p=[];for(const y in e)p=p.concat(o[y]?n.validateSpec({key:y,value:e[y],valueSpec:o[y],style:u,styleSpec:i}):[new et(y,e[y],`unknown property "${y}"`)]);return p}function nh(n){const e=n.value,i=n.styleSpec,o=i.terrain,u=n.style;let d=[];const p=Ut(e);if(e===void 0)return d;if(p!=="object")return d=d.concat([new et("terrain",e,`object expected, ${p} found`)]),d;for(const y in e)d=d.concat(o[y]?n.validateSpec({key:y,value:e[y],valueSpec:o[y],validateSpec:n.validateSpec,style:u,styleSpec:i}):[new et(y,e[y],`unknown property "${y}"`)]);return d}function tf(n){let e=[];const i=n.value,o=n.key;if(Array.isArray(i)){const u=[],d=[];for(const p in i)i[p].id&&u.includes(i[p].id)&&e.push(new et(o,i,`all the sprites' ids must be unique, but ${i[p].id} is duplicated`)),u.push(i[p].id),i[p].url&&d.includes(i[p].url)&&e.push(new et(o,i,`all the sprites' URLs must be unique, but ${i[p].url} is duplicated`)),d.push(i[p].url),e=e.concat(kr({key:`${o}[${p}]`,value:i[p],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return na({key:o,value:i})}function Ed(n){return!!n&&n.constructor===Object}function nf(n){return Ed(n.value)?[]:[new et(n.key,n.value,`object expected, ${Ut(n.value)} found`)]}const Tn={"*":()=>[],array:nc,boolean:function(n){const e=n.value,i=n.key,o=Ut(e);return o!=="boolean"?[new et(i,e,`boolean expected, ${o} found`)]:[]},number:fs,color:Fs,constants:ia,enum:js,filter:xa,function:ds,layer:ih,object:kr,source:Vs,light:In,sky:rc,terrain:nh,projection:function(n){const e=n.value,i=n.styleSpec,o=i.projection,u=n.style,d=Ut(e);if(e===void 0)return[];if(d!=="object")return[new et("projection",e,`object expected, ${d} found`)];let p=[];for(const y in e)p=p.concat(o[y]?n.validateSpec({key:y,value:e[y],valueSpec:o[y],style:u,styleSpec:i}):[new et(y,e[y],`unknown property "${y}"`)]);return p},projectionDefinition:function(n){const e=n.key;let i=n.value;i=i instanceof String?i.valueOf():i;const o=Ut(i);return o!=="array"||(function(u){return Array.isArray(u)&&u.length===3&&typeof u[0]=="string"&&typeof u[1]=="string"&&typeof u[2]=="number"})(i)||(function(u){return!!["interpolate","step","literal"].includes(u[0])})(i)?["array","string"].includes(o)?[]:[new et(e,i,`projection expected, invalid type "${o}" found`)]:[new et(e,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:na,formatted:function(n){return na(n).length===0?[]:ps(n)},resolvedImage:function(n){return na(n).length===0?[]:ps(n)},padding:function(n){const e=n.key,i=n.value;if(Ut(i)==="array"){if(i.length<1||i.length>4)return[new et(e,i,`padding requires 1 to 4 values; ${i.length} values found`)];const o={type:"number"};let u=[];for(let d=0;d<i.length;d++)u=u.concat(n.validateSpec({key:`${e}[${d}]`,value:i[d],validateSpec:n.validateSpec,valueSpec:o}));return u}return fs({key:e,value:i,valueSpec:{}})},numberArray:function(n){const e=n.key,i=n.value;if(Ut(i)==="array"){const o={type:"number"};if(i.length<1)return[new et(e,i,"array length at least 1 expected, length 0 found")];let u=[];for(let d=0;d<i.length;d++)u=u.concat(n.validateSpec({key:`${e}[${d}]`,value:i[d],validateSpec:n.validateSpec,valueSpec:o}));return u}return fs({key:e,value:i,valueSpec:{}})},colorArray:function(n){const e=n.key,i=n.value;if(Ut(i)==="array"){if(i.length<1)return[new et(e,i,"array length at least 1 expected, length 0 found")];let o=[];for(let u=0;u<i.length;u++)o=o.concat(Fs({key:`${e}[${u}]`,value:i[u]}));return o}return Fs({key:e,value:i})},variableAnchorOffsetCollection:function(n){const e=n.key,i=n.value,o=Ut(i),u=n.styleSpec;if(o!=="array"||i.length<1||i.length%2!=0)return[new et(e,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let d=[];for(let p=0;p<i.length;p+=2)d=d.concat(js({key:`${e}[${p}]`,value:i[p],valueSpec:u.layout_symbol["text-anchor"]})),d=d.concat(nc({key:`${e}[${p+1}]`,value:i[p+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:u}));return d},sprite:tf,state:nf,fontFaces:function(n){const e=n.key,i=n.value,o=n.validateSpec,u=n.styleSpec,d=n.style;if(!Ed(i))return[new et(e,i,`object expected, ${Ut(i)} found`)];const p=[];for(const y in i){const x=i[y],E=Ut(x);if(E==="string")p.push(...na({key:`${e}.${y}`,value:x}));else if(E==="array"){const D={url:{type:"string",required:!0},"unicode-range":{type:"array",value:"string"}};for(const[R,L]of x.entries())p.push(...kr({key:`${e}.${y}[${R}]`,value:L,valueSpec:D,styleSpec:u,style:d,validateSpec:o}))}else p.push(new et(`${e}.${y}`,x,`string or array expected, ${E} found`))}return p}};function _s(n){const e=n.value,i=n.valueSpec,o=n.styleSpec;return n.validateSpec=_s,i.expression&&Kc(an(e))?ds(n):i.expression&&xo(Br(e))?ps(n):i.type&&Tn[i.type]?Tn[i.type](n):kr(dr({},n,{valueSpec:i.type?o[i.type]:i}))}function ru(n){const e=n.value,i=n.key,o=na(n);return o.length||(e.indexOf("{fontstack}")===-1&&o.push(new et(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&o.push(new et(i,e,'"glyphs" url must include a "{range}" token'))),o}function gr(n,e=Ee){let i=[];return i=i.concat(_s({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:_s,objectElementValidators:{glyphs:ru,"*":()=>[]}})),n.constants&&(i=i.concat(ia({key:"constants",value:n.constants}))),sl(i)}function ra(n){return function(e){return n(Object.assign({},e,{validateSpec:_s}))}}function sl(n){return[].concat(n).sort(((e,i)=>e.line-i.line))}function _r(n){return function(...e){return sl(n.apply(this,e))}}gr.source=_r(ra(Vs)),gr.sprite=_r(ra(tf)),gr.glyphs=_r(ra(ru)),gr.light=_r(ra(In)),gr.sky=_r(ra(rc)),gr.terrain=_r(ra(nh)),gr.state=_r(ra(nf)),gr.layer=_r(ra(ih)),gr.filter=_r(ra(xa)),gr.paintProperty=_r(ra(gs)),gr.layoutProperty=_r(ra(th));const Vp={type:"enum","property-type":"data-constant",expression:{interpolated:!1,parameters:["global-state"]},values:{visible:{},none:{}},transition:!1,default:"visible"};class au{constructor(e,i){this._globalState=i,this.setValue(e)}evaluate(){var e;return(e=this._literalValue)!==null&&e!==void 0?e:this._compiledValue.evaluate({})}setValue(e){if(e==null||e==="visible"||e==="none")return this._literalValue=e==="none"?"none":"visible",this._compiledValue=void 0,void(this._globalStateRefs=new Set);const i=tu(e,Vp,this._globalState);if(i.result==="error")throw this._literalValue="visible",this._compiledValue=void 0,new Error(i.value.map((o=>`${o.key}: ${o.message}`)).join(", "));this._literalValue=void 0,this._compiledValue=i.value,this._globalStateRefs=Hn(i.value.expression)}getGlobalStateRefs(){return this._globalStateRefs}}const ac=Ee,$n=gr,Na=$n.light,rh=$n.sky,ah=$n.paintProperty,Md=$n.layoutProperty;function Va(n,e){let i=!1;if(e&&e.length)for(const o of e)n.fire(new gi(new Error(o.message))),i=!0;return i}class Eo{constructor(e,i,o){const u=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const p=new Int32Array(this.arrayBuffer);e=p[0],this.d=(i=p[1])+2*(o=p[2]);for(let x=0;x<this.d*this.d;x++){const E=p[3+x],D=p[3+x+1];u.push(E===D?null:p.subarray(E,D))}const y=p[3+u.length+1];this.keys=p.subarray(p[3+u.length],y),this.bboxes=p.subarray(y),this.insert=this._insertReadonly}else{this.d=i+2*o;for(let p=0;p<this.d*this.d;p++)u.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=e,this.padding=o,this.scale=i/e,this.uid=0;const d=o/i*e;this.min=-d,this.max=e+d}insert(e,i,o,u,d){this._forEachCell(i,o,u,d,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(i),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(d)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,i,o,u,d,p){this.cells[d].push(p)}query(e,i,o,u,d){const p=this.min,y=this.max;if(e<=p&&i<=p&&y<=o&&y<=u&&!d)return Array.prototype.slice.call(this.keys);{const x=[];return this._forEachCell(e,i,o,u,this._queryCell,x,{},d),x}}_queryCell(e,i,o,u,d,p,y,x){const E=this.cells[d];if(E!==null){const D=this.keys,R=this.bboxes;for(let L=0;L<E.length;L++){const B=E[L];if(y[B]===void 0){const V=4*B;(x?x(R[V+0],R[V+1],R[V+2],R[V+3]):e<=R[V+2]&&i<=R[V+3]&&o>=R[V+0]&&u>=R[V+1])?(y[B]=!0,p.push(D[B])):y[B]=!1}}}}_forEachCell(e,i,o,u,d,p,y,x){const E=this._convertToCellCoord(e),D=this._convertToCellCoord(i),R=this._convertToCellCoord(o),L=this._convertToCellCoord(u);for(let B=E;B<=R;B++)for(let V=D;V<=L;V++){const U=this.d*V+B;if((!x||x(this._convertFromCellCoord(B),this._convertFromCellCoord(V),this._convertFromCellCoord(B+1),this._convertFromCellCoord(V+1)))&&d.call(this,e,i,o,u,U,p,y,x))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,i=3+this.cells.length+1+1;let o=0;for(let p=0;p<this.cells.length;p++)o+=this.cells[p].length;const u=new Int32Array(i+o+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;let d=i;for(let p=0;p<e.length;p++){const y=e[p];u[3+p]=d,u.set(y,d),d+=y.length}return u[3+e.length]=d,u.set(this.keys,d),d+=this.keys.length,u[3+e.length+1]=d,u.set(this.bboxes,d),d+=this.bboxes.length,u.buffer}static serialize(e,i){const o=e.toArrayBuffer();return i&&i.push(o),{buffer:o}}static deserialize(e){return new Eo(e.buffer)}}const Fr={};function ut(n,e,i={}){if(Fr[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),Fr[n]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}ut("Object",Object),ut("Set",Set),ut("TransferableGridIndex",Eo),ut("Color",Gt),ut("Error",Error),ut("AJAXError",_e),ut("ResolvedImage",Er),ut("StylePropertyFunction",rl),ut("StyleExpression",eh,{omit:["_evaluator"]}),ut("ZoomDependentExpression",wo),ut("ZoomConstantExpression",zr),ut("CompoundExpression",Wr,{omit:["_evaluate"]});for(const n in Jl)Jl[n]._classRegistryKey||ut(`Expression_${n}`,Jl[n]);function sc(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function sh(n){return n.$name||n.constructor._classRegistryKey}function wa(n){return!(function(e){if(e===null||typeof e!="object")return!1;const i=sh(e);return!(!i||i==="Object")})(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||sc(n)||zs(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function Ua(n,e){if(wa(n))return(sc(n)||zs(n))&&e&&e.push(n),ArrayBuffer.isView(n)&&e&&e.push(n.buffer),n instanceof ImageData&&e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const d=[];for(const p of n)d.push(Ua(p,e));return d}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const i=sh(n);if(!i)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!Fr[i])throw new Error(`${i} is not registered.`);const{klass:o}=Fr[i],u=o.serialize?o.serialize(n,e):{};if(o.serialize){if(e&&u===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const d in n){if(!n.hasOwnProperty(d)||Fr[i].omit.indexOf(d)>=0)continue;const p=n[d];u[d]=Fr[i].shallow.indexOf(d)>=0?p:Ua(p,e)}n instanceof Error&&(u.message=n.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(u.$name=i),u}function su(n){if(wa(n))return n;if(Array.isArray(n))return n.map(su);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const e=sh(n)||"Object";if(!Fr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:i}=Fr[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const o=Object.create(i.prototype);for(const u of Object.keys(n)){if(u==="$name")continue;const d=n[u];o[u]=Fr[e].shallow.indexOf(u)>=0?d:su(d)}return o}class oh{constructor(){this.first=!0}update(e,i){const o=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=o,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=o,!0):(this.lastFloorZoom>o?(this.lastIntegerZoom=o+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<o&&(this.lastIntegerZoom=o,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=o,!0))}}function ys(n){return/[\u02EA\u02EB\u2E80-\u2FDF\u2FF0-\u303F\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FD-\u30FF\u3105-\u312F\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function ol(n){return/[\u02EA\u02EB\u1100-\u11FF\u1400-\u167F\u18B0-\u18F5\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u3007\u3012\u3013\u3020-\u302F\u3031-\u303F\u3041-\u3096\u309D-\u30FB\u30FD-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE48\uFE50-\uFE57\uFE5F-\uFE62\uFE67-\uFE6F\uFF00-\uFF07\uFF0A-\uFF0C\uFF0E-\uFF19\uFF1F-\uFF3A\uFF3C\uFF3E\uFF40-\uFF5A\uFFE0-\uFFE2\uFFE4-\uFFE7]|\uD802[\uDD80-\uDD9F]|\uD805[\uDD80-\uDDFF]|\uD806[\uDE00-\uDEBF]|\uD811[\uDC00-\uDE7F]|\uD81B[\uDFE0-\uDFE4\uDFF0-\uDFF6]|[\uD81C-\uD822\uD83D\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD30-\uDEFB]|\uD833[\uDEC0-\uDFCF]|\uD834[\uDC00-\uDDFF\uDEE0-\uDF7F]|\uD836[\uDC00-\uDEAF]|\uD83C[\uDC00-\uDE00\uDF00-\uDFFF]|\uD83E[\uDD00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))}function oc(n){return/\s/u.test(String.fromCodePoint(n))}function vs(n){for(const e of n)if(ol(e.codePointAt(0)))return!0;return!1}function lh(n){for(const e of n)if(!rf(e.codePointAt(0)))return!1;return!0}function lc(n){const e=n.map((i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}})).filter((i=>i));return new RegExp(e.join("|"),"u")}const bs=lc(["Arab","Dupl","Mong","Ougr","Syrc"]);function rf(n){return!bs.test(String.fromCodePoint(n))}function xs(n){return!(ol(n)||(e=n,/[\xA7\xA9\xAE\xB1\xBC-\xBE\xD7\xF7\u2016\u2020\u2021\u2030\u2031\u203B\u203C\u2042\u2047-\u2049\u2051\u2100-\u218F\u221E\u2234\u2235\u2300-\u2307\u230C-\u231F\u2324-\u2328\u232B\u237D-\u239A\u23BE-\u23CD\u23CF\u23D1-\u23DB\u23E2-\u2422\u2424-\u24FF\u25A0-\u2619\u2620-\u2767\u2776-\u2793\u2B12-\u2B2F\u2B50-\u2B59\u2BB8-\u2BEB\u3000-\u303F\u30A0-\u30FF\uE000-\uF8FF\uFE30-\uFE6F\uFF00-\uFFEF\uFFFC\uFFFD]|[\uDB80-\uDBFF][\uDC00-\uDFFF]/gim.test(String.fromCodePoint(e))));var e}const uh=lc(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function uc(n){return uh.test(String.fromCodePoint(n))}function ws(n,e){return!(!e&&uc(n)||/[\u0900-\u0DFF\u0F00-\u109F\u1780-\u17FF]/gim.test(String.fromCodePoint(n)))}function Us(n){for(const e of n)if(uc(e.codePointAt(0)))return!0;return!1}const Ta=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(Ta.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,e){return h(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const i=n.pluginURL,o=new Promise((d=>{this.loadScriptResolve=d}));e(i);const u=new Promise((d=>setTimeout((()=>d()),this.TIMEOUT)));if(yield Promise.race([o,u]),this.isParsed()){const d={pluginStatus:"loaded",pluginURL:i};return this.setState(d),d}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)}))}};class xi{constructor(e,i){this.isSupportedScript=af,this.zoom=e,i?(this.now=i.now||0,this.fadeDuration=i.fadeDuration||0,this.zoomHistory=i.zoomHistory||new oh,this.transition=i.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new oh,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),o=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*o}:{fromScale:.5,toScale:1,t:1-(1-o)*i}}}function af(n){return(function(e,i){for(const o of e)if(!ws(o.codePointAt(0),i))return!1;return!0})(n,Ta.getRTLTextPluginStatus()==="loaded")}const Gs="-transition";class Mo{constructor(e,i,o){this.property=e,this.value=i,this.expression=(function(u,d,p){if(Kc(u))return new rl(u,d);if(xo(u)){const y=To(u,d,p);if(y.result==="error")throw new Error(y.value.map((x=>`${x.key}: ${x.message}`)).join(", "));return y.value}{let y=u;return d.type==="color"&&typeof u=="string"?y=Gt.parse(u):d.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?d.type!=="numberArray"||typeof u!="number"&&!Array.isArray(u)?d.type!=="colorArray"||typeof u!="string"&&!Array.isArray(u)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?y=pn.parse(u):d.type==="projectionDefinition"&&typeof u=="string"&&(y=Zn.parse(u)):y=zt.parse(u):y=Qi.parse(u):y=Pn.parse(u),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>y}}})(i===void 0?e.specification.default:i,e.specification,o)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(e,i,o){return this.property.possiblyEvaluate(this,e,i,o)}}class cc{constructor(e,i){this.property=e,this.value=new Mo(e,void 0,i)}transitioned(e,i){return new ll(this.property,this.value,i,Pi({},e.transition,this.transition),e.now)}untransitioned(){return new ll(this.property,this.value,null,{},0)}}class ch{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._globalState=i}getValue(e){return Xr(this._values[e].value.value)}setValue(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new cc(this._values[e].property,this._globalState)),this._values[e].value=new Mo(this._values[e].property,i===null?void 0:Xr(i),this._globalState)}getTransition(e){return Xr(this._values[e].transition)}setTransition(e,i){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new cc(this._values[e].property,this._globalState)),this._values[e].transition=Xr(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o);const u=this.getTransition(i);u!==void 0&&(e[`${i}${Gs}`]=u)}return e}transitioned(e,i){const o=new hc(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].transitioned(e,i._values[u]);return o}untransitioned(){const e=new hc(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class ll{constructor(e,i,o,u,d){this.property=e,this.value=i,this.begin=d+u.delay||0,this.end=this.begin+u.duration||0,e.specification.transition&&(u.delay||u.duration)&&(this.prior=o)}possiblyEvaluate(e,i,o){const u=e.now||0,d=this.value.possiblyEvaluate(e,i,o),p=this.prior;if(p){if(u>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(u<this.begin)return p.possiblyEvaluate(e,i,o);{const y=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(e,i,o),d,pt(y))}}return d}}class hc{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,o){const u=new ul(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,i,o);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class sf{constructor(e,i){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._globalState=i}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Xr(this._values[e].value)}setValue(e,i){this._values[e]=new Mo(this._values[e].property,i===null?void 0:Xr(i),this._globalState)}serialize(){const e={};for(const i of Object.keys(this._values)){const o=this.getValue(i);o!==void 0&&(e[i]=o)}return e}possiblyEvaluate(e,i,o){const u=new ul(this._properties);for(const d of Object.keys(this._values))u._values[d]=this._values[d].possiblyEvaluate(e,i,o);return u}}class aa{constructor(e,i,o){this.property=e,this.value=i,this.parameters=o}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,o,u){return this.property.evaluate(this.value,this.parameters,e,i,o,u)}}class ul{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ft{constructor(e){this.specification=e}possiblyEvaluate(e,i){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(i)}interpolate(e,i,o){const u=Wi[this.specification.type];return u?u(e,i,o):e}}class _t{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,o,u){return new aa(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(i,null,{},o,u)}:e.expression,i)}interpolate(e,i,o){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new aa(this,{kind:"constant",value:void 0},e.parameters);const u=Wi[this.specification.type];if(u){const d=u(e.value.value,i.value.value,o);return new aa(this,{kind:"constant",value:d},e.parameters)}return e}evaluate(e,i,o,u,d,p){return e.kind==="constant"?e.value:e.evaluate(i,o,u,d,p)}}class Sa extends _t{possiblyEvaluate(e,i,o,u){if(e.value===void 0)return new aa(this,{kind:"constant",value:void 0},i);if(e.expression.kind==="constant"){const d=e.expression.evaluate(i,null,{},o,u),p=e.property.specification.type==="resolvedImage"&&typeof d!="string"?d.name:d,y=this._calculate(p,p,p,i);return new aa(this,{kind:"constant",value:y},i)}if(e.expression.kind==="camera"){const d=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new aa(this,{kind:"constant",value:d},i)}return new aa(this,e.expression,i)}evaluate(e,i,o,u,d,p){if(e.kind==="source"){const y=e.evaluate(i,o,u,d,p);return this._calculate(y,y,y,i)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},o,u),e.evaluate({zoom:Math.floor(i.zoom)},o,u),e.evaluate({zoom:Math.floor(i.zoom)+1},o,u),i):e.value}_calculate(e,i,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:o,to:i}}interpolate(e){return e}}class ou{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,u){if(e.value!==void 0){if(e.expression.kind==="constant"){const d=e.expression.evaluate(i,null,{},o,u);return this._calculate(d,d,d,i)}return this._calculate(e.expression.evaluate(new xi(Math.floor(i.zoom-1),i)),e.expression.evaluate(new xi(Math.floor(i.zoom),i)),e.expression.evaluate(new xi(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,o,u){return u.zoom>u.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:o,to:i}}interpolate(e){return e}}class fc{constructor(e){this.specification=e}possiblyEvaluate(e,i,o,u){return!!e.expression.evaluate(i,null,{},o,u)}interpolate(){return!1}}class Sn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const o=e[i];o.specification.overridable&&this.overridableProperties.push(i);const u=this.defaultPropertyValues[i]=new Mo(o,void 0,void 0),d=this.defaultTransitionablePropertyValues[i]=new cc(o,void 0);this.defaultTransitioningPropertyValues[i]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=u.possiblyEvaluate({})}}}ut("DataDrivenProperty",_t),ut("DataConstantProperty",ft),ut("CrossFadedDataDrivenProperty",Sa),ut("CrossFadedProperty",ou),ut("ColorRampProperty",fc);class sn extends ii{constructor(e,i,o){if(super(),this.id=e.id,this.type=e.type,this._globalState=o,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},this._visibilityExpression=(function(u,d){return new au(u,d)})(this.visibility,o),e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter,this._featureFilter=Lr(e.filter,o)),i.layout&&(this._unevaluatedLayout=new sf(i.layout,o)),i.paint)){this._transitionablePaint=new ch(i.paint,o);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ul(i.paint)}}setFilter(e){this.filter=e,this._featureFilter=Lr(e,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}getLayoutAffectingGlobalStateRefs(){const e=new Set;for(const i of this._visibilityExpression.getGlobalStateRefs())e.add(i);if(this._unevaluatedLayout)for(const i in this._unevaluatedLayout._values){const o=this._unevaluatedLayout._values[i];for(const u of o.getGlobalStateRefs())e.add(u)}for(const i of this._featureFilter.getGlobalStateRefs())e.add(i);return e}getPaintAffectingGlobalStateRefs(){var e;const i=new globalThis.Map;if(this._transitionablePaint)for(const o in this._transitionablePaint._values){const u=this._transitionablePaint._values[o].value;for(const d of u.getGlobalStateRefs()){const p=(e=i.get(d))!==null&&e!==void 0?e:[];p.push({name:o,value:u.value}),i.set(d,p)}}return i}getVisibilityAffectingGlobalStateRefs(){return this._visibilityExpression.getGlobalStateRefs()}setLayoutProperty(e,i,o={}){if(i==null||!this._validate(Md,`layers.${this.id}.layout.${e}`,e,i,o))return e==="visibility"?(this.visibility=i,this._visibilityExpression.setValue(i),void this.recalculateVisibility()):void this._unevaluatedLayout.setValue(e,i)}getPaintProperty(e){return e.endsWith(Gs)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,o={}){if(i!=null&&this._validate(ah,`layers.${this.id}.paint.${e}`,e,i,o))return!1;if(e.endsWith(Gs))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],d=u.property.specification["property-type"]==="cross-faded-data-driven",p=u.value.isDataDriven(),y=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const x=this._transitionablePaint._values[e].value;return x.isDataDriven()||p||d||this._handleOverridablePaintPropertyUpdate(e,y,x)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,i,o){return!1}isHidden(e=this.minzoom,i=!1){return!!(this.minzoom&&e<(i?Math.floor(this.minzoom):this.minzoom))||!!(this.maxzoom&&e>=this.maxzoom)||this._evaluatedVisibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculateVisibility(){this._evaluatedVisibility=this._visibilityExpression.evaluate()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),ao(e,((i,o)=>!(i===void 0||o==="layout"&&!Object.keys(i).length||o==="paint"&&!Object.keys(i).length)))}_validate(e,i,o,u,d={}){return(!d||d.validate!==!1)&&Va(this,e.call($n,{key:i,layerType:this.type,objectKey:o,value:u,styleSpec:Ee,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof aa&&ba(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}let gn;var dc={get paint(){return gn=gn||new Sn({"raster-opacity":new ft(Ee.paint_raster["raster-opacity"]),"raster-hue-rotate":new ft(Ee.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ft(Ee.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ft(Ee.paint_raster["raster-brightness-max"]),"raster-saturation":new ft(Ee.paint_raster["raster-saturation"]),"raster-contrast":new ft(Ee.paint_raster["raster-contrast"]),"raster-resampling":new ft(Ee.paint_raster["raster-resampling"]),"raster-fade-duration":new ft(Ee.paint_raster["raster-fade-duration"])})}};class qs extends sn{constructor(e,i){super(e,dc,i)}}const $t={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class _i{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ht{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Ji(n,e=1){let i=0,o=0;return{members:n.map((u=>{const d=$t[u.type].BYTES_PER_ELEMENT,p=i=Ea(i,Math.max(e,d)),y=u.components||1;return o=Math.max(o,d),i+=d*y,{name:u.name,type:u.type,components:y,offset:p}})),size:Ea(i,Math.max(o,e)),alignment:e}}function Ea(n,e){return Math.ceil(n/e)*e}class Ga extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=o,e}}Ga.prototype.bytesPerElement=4,ut("StructArrayLayout2i4",Ga);class cl extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const d=3*e;return this.int16[d+0]=i,this.int16[d+1]=o,this.int16[d+2]=u,e}}cl.prototype.bytesPerElement=6,ut("StructArrayLayout3i6",cl);class hl extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,u)}emplace(e,i,o,u,d){const p=4*e;return this.int16[p+0]=i,this.int16[p+1]=o,this.int16[p+2]=u,this.int16[p+3]=d,e}}hl.prototype.bytesPerElement=8,ut("StructArrayLayout4i8",hl);class Zs extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,o,u,d,p)}emplace(e,i,o,u,d,p,y){const x=6*e;return this.int16[x+0]=i,this.int16[x+1]=o,this.int16[x+2]=u,this.int16[x+3]=d,this.int16[x+4]=p,this.int16[x+5]=y,e}}Zs.prototype.bytesPerElement=12,ut("StructArrayLayout2i4i12",Zs);class of extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,o,u,d,p)}emplace(e,i,o,u,d,p,y){const x=4*e,E=8*e;return this.int16[x+0]=i,this.int16[x+1]=o,this.uint8[E+4]=u,this.uint8[E+5]=d,this.uint8[E+6]=p,this.uint8[E+7]=y,e}}of.prototype.bytesPerElement=8,ut("StructArrayLayout2i4ub8",of);class $i extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=o,e}}$i.prototype.bytesPerElement=8,ut("StructArrayLayout2f8",$i);class qa extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x,E,D){const R=this.length;return this.resize(R+1),this.emplace(R,e,i,o,u,d,p,y,x,E,D)}emplace(e,i,o,u,d,p,y,x,E,D,R){const L=10*e;return this.uint16[L+0]=i,this.uint16[L+1]=o,this.uint16[L+2]=u,this.uint16[L+3]=d,this.uint16[L+4]=p,this.uint16[L+5]=y,this.uint16[L+6]=x,this.uint16[L+7]=E,this.uint16[L+8]=D,this.uint16[L+9]=R,e}}qa.prototype.bytesPerElement=20,ut("StructArrayLayout10ui20",qa);class lu extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,o,u,d,p,y,x)}emplace(e,i,o,u,d,p,y,x,E){const D=8*e;return this.uint16[D+0]=i,this.uint16[D+1]=o,this.uint16[D+2]=u,this.uint16[D+3]=d,this.uint16[D+4]=p,this.uint16[D+5]=y,this.uint16[D+6]=x,this.uint16[D+7]=E,e}}lu.prototype.bytesPerElement=16,ut("StructArrayLayout8ui16",lu);class uu extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x,E,D,R,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,o,u,d,p,y,x,E,D,R,L)}emplace(e,i,o,u,d,p,y,x,E,D,R,L,B){const V=12*e;return this.int16[V+0]=i,this.int16[V+1]=o,this.int16[V+2]=u,this.int16[V+3]=d,this.uint16[V+4]=p,this.uint16[V+5]=y,this.uint16[V+6]=x,this.uint16[V+7]=E,this.int16[V+8]=D,this.int16[V+9]=R,this.int16[V+10]=L,this.int16[V+11]=B,e}}uu.prototype.bytesPerElement=24,ut("StructArrayLayout4i4ui4i24",uu);class pc extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const d=3*e;return this.float32[d+0]=i,this.float32[d+1]=o,this.float32[d+2]=u,e}}pc.prototype.bytesPerElement=12,ut("StructArrayLayout3f12",pc);class mc extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}mc.prototype.bytesPerElement=4,ut("StructArrayLayout1ul4",mc);class gc extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x,E){const D=this.length;return this.resize(D+1),this.emplace(D,e,i,o,u,d,p,y,x,E)}emplace(e,i,o,u,d,p,y,x,E,D){const R=10*e,L=5*e;return this.int16[R+0]=i,this.int16[R+1]=o,this.int16[R+2]=u,this.int16[R+3]=d,this.int16[R+4]=p,this.int16[R+5]=y,this.uint32[L+3]=x,this.uint16[R+8]=E,this.uint16[R+9]=D,e}}gc.prototype.bytesPerElement=20,ut("StructArrayLayout6i1ul2ui20",gc);class Ao extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,o,u,d,p)}emplace(e,i,o,u,d,p,y){const x=6*e;return this.int16[x+0]=i,this.int16[x+1]=o,this.int16[x+2]=u,this.int16[x+3]=d,this.int16[x+4]=p,this.int16[x+5]=y,e}}Ao.prototype.bytesPerElement=12,ut("StructArrayLayout2i2i2i12",Ao);class Hs extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d){const p=this.length;return this.resize(p+1),this.emplace(p,e,i,o,u,d)}emplace(e,i,o,u,d,p){const y=4*e,x=8*e;return this.float32[y+0]=i,this.float32[y+1]=o,this.float32[y+2]=u,this.int16[x+6]=d,this.int16[x+7]=p,e}}Hs.prototype.bytesPerElement=16,ut("StructArrayLayout2f1f2i16",Hs);class ur extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,o,u,d,p)}emplace(e,i,o,u,d,p,y){const x=16*e,E=4*e,D=8*e;return this.uint8[x+0]=i,this.uint8[x+1]=o,this.float32[E+1]=u,this.float32[E+2]=d,this.int16[D+6]=p,this.int16[D+7]=y,e}}ur.prototype.bytesPerElement=16,ut("StructArrayLayout2ub2f2i16",ur);class en extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const d=3*e;return this.uint16[d+0]=i,this.uint16[d+1]=o,this.uint16[d+2]=u,e}}en.prototype.bytesPerElement=6,ut("StructArrayLayout3ui6",en);class Ts extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y){const se=this.length;return this.resize(se+1),this.emplace(se,e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y)}emplace(e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y,se){const Q=24*e,J=12*e,le=48*e;return this.int16[Q+0]=i,this.int16[Q+1]=o,this.uint16[Q+2]=u,this.uint16[Q+3]=d,this.uint32[J+2]=p,this.uint32[J+3]=y,this.uint32[J+4]=x,this.uint16[Q+10]=E,this.uint16[Q+11]=D,this.uint16[Q+12]=R,this.float32[J+7]=L,this.float32[J+8]=B,this.uint8[le+36]=V,this.uint8[le+37]=U,this.uint8[le+38]=q,this.uint32[J+10]=Y,this.int16[Q+22]=se,e}}Ts.prototype.bytesPerElement=48,ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ts);class fl extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y,se,Q,J,le,he,Ae,Ve,Fe,$e,st,Qe){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y,se,Q,J,le,he,Ae,Ve,Fe,$e,st,Qe)}emplace(e,i,o,u,d,p,y,x,E,D,R,L,B,V,U,q,Y,se,Q,J,le,he,Ae,Ve,Fe,$e,st,Qe,Ne){const Oe=32*e,dt=16*e;return this.int16[Oe+0]=i,this.int16[Oe+1]=o,this.int16[Oe+2]=u,this.int16[Oe+3]=d,this.int16[Oe+4]=p,this.int16[Oe+5]=y,this.int16[Oe+6]=x,this.int16[Oe+7]=E,this.uint16[Oe+8]=D,this.uint16[Oe+9]=R,this.uint16[Oe+10]=L,this.uint16[Oe+11]=B,this.uint16[Oe+12]=V,this.uint16[Oe+13]=U,this.uint16[Oe+14]=q,this.uint16[Oe+15]=Y,this.uint16[Oe+16]=se,this.uint16[Oe+17]=Q,this.uint16[Oe+18]=J,this.uint16[Oe+19]=le,this.uint16[Oe+20]=he,this.uint16[Oe+21]=Ae,this.uint16[Oe+22]=Ve,this.uint32[dt+12]=Fe,this.float32[dt+13]=$e,this.float32[dt+14]=st,this.uint16[Oe+30]=Qe,this.uint16[Oe+31]=Ne,e}}fl.prototype.bytesPerElement=64,ut("StructArrayLayout8i15ui1ul2f2ui64",fl);class dl extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}dl.prototype.bytesPerElement=4,ut("StructArrayLayout1f4",dl);class cu extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const d=3*e;return this.uint16[6*e+0]=i,this.float32[d+1]=o,this.float32[d+2]=u,e}}cu.prototype.bytesPerElement=12,ut("StructArrayLayout1ui2f12",cu);class Za extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,o){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,o)}emplace(e,i,o,u){const d=4*e;return this.uint32[2*e+0]=i,this.uint16[d+2]=o,this.uint16[d+3]=u,e}}Za.prototype.bytesPerElement=8,ut("StructArrayLayout1ul2ui8",Za);class m extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,i)}emplace(e,i,o){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=o,e}}m.prototype.bytesPerElement=4,ut("StructArrayLayout2ui4",m);class t extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}t.prototype.bytesPerElement=2,ut("StructArrayLayout1ui2",t);class a extends Ht{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,o,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,o,u)}emplace(e,i,o,u,d){const p=4*e;return this.float32[p+0]=i,this.float32[p+1]=o,this.float32[p+2]=u,this.float32[p+3]=d,e}}a.prototype.bytesPerElement=16,ut("StructArrayLayout4f16",a);class l extends _i{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ne(this.anchorPointX,this.anchorPointY)}}l.prototype.size=20;class f extends gc{get(e){return new l(this,e)}}ut("CollisionBoxArray",f);class _ extends _i{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}_.prototype.size=48;class b extends Ts{get(e){return new _(this,e)}}ut("PlacedSymbolArray",b);class w extends _i{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}w.prototype.size=64;class A extends fl{get(e){return new w(this,e)}}ut("SymbolInstanceArray",A);class I extends dl{getoffsetX(e){return this.float32[1*e+0]}}ut("GlyphOffsetArray",I);class O extends cl{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}ut("SymbolLineVertexArray",O);class j extends _i{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}j.prototype.size=12;class k extends cu{get(e){return new j(this,e)}}ut("TextAnchorOffsetArray",k);class G extends _i{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}G.prototype.size=8;class X extends Za{get(e){return new G(this,e)}}ut("FeatureIndexArray",X);class ee extends Ga{}class ie extends Ga{}class te extends Ga{}class ae extends Zs{}class ce extends of{}class re extends $i{}class ue extends qa{}class de extends lu{}class oe extends uu{}class ye extends pc{}class Ie extends mc{}class Me extends Ao{}class ze extends ur{}class Pe extends en{}class tt extends m{}const it=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:He}=it;class at{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,i,o,u){const d=this.segments[this.segments.length-1];return e>at.MAX_VERTEX_ARRAY_LENGTH&&rn(`Max vertices per segment is ${at.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${at.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!d||d.vertexLength+e>at.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==u?this.createNewSegment(i,o,u):d}createNewSegment(e,i,o){const u={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return o!==void 0&&(u.sortKey=o),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(u),u}getOrCreateLatestSegment(e,i,o){return this.prepareSegment(0,e,i,o)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,o,u){return new at([{vertexOffset:e,primitiveOffset:i,vertexLength:o,primitiveLength:u,vaos:{},sortKey:0}])}}function Lt(n,e){return 256*(n=Vt(Math.floor(n),0,255))+Vt(Math.floor(e),0,255)}at.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ut("SegmentVector",at);const yi=Ji([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Ui=Ji([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Li,Xi,Ai,on={exports:{}},Yi={exports:{}},Wn={exports:{}},_n=(function(){if(Ai)return on.exports;Ai=1;var n=(Li||(Li=1,Yi.exports=function(i,o){var u,d,p,y,x,E,D,R;for(d=i.length-(u=3&i.length),p=o,x=3432918353,E=461845907,R=0;R<d;)D=255&i.charCodeAt(R)|(255&i.charCodeAt(++R))<<8|(255&i.charCodeAt(++R))<<16|(255&i.charCodeAt(++R))<<24,++R,p=27492+(65535&(y=5*(65535&(p=(p^=D=(65535&(D=(D=(65535&D)*x+(((D>>>16)*x&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(D=0,u){case 3:D^=(255&i.charCodeAt(R+2))<<16;case 2:D^=(255&i.charCodeAt(R+1))<<8;case 1:p^=D=(65535&(D=(D=(65535&(D^=255&i.charCodeAt(R)))*x+(((D>>>16)*x&65535)<<16)&4294967295)<<15|D>>>17))*E+(((D>>>16)*E&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}),Yi.exports),e=(Xi||(Xi=1,Wn.exports=function(i,o){for(var u,d=i.length,p=o^d,y=0;d>=4;)u=1540483477*(65535&(u=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(u>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),d-=4,++y;switch(d){case 3:p^=(255&i.charCodeAt(y+2))<<16;case 2:p^=(255&i.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}),Wn.exports);return on.exports=n,on.exports.murmur3=n,on.exports.murmur2=e,on.exports})(),yn=ge(_n);class Jn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,o,u){this.ids.push(Ss(e)),this.positions.push(i,o,u)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=Ss(e);let o=0,u=this.ids.length-1;for(;o<u;){const p=o+u>>1;this.ids[p]>=i?u=p:o=p+1}const d=[];for(;this.ids[o]===i;)d.push({index:this.positions[3*o],start:this.positions[3*o+1],end:this.positions[3*o+2]}),o++;return d}static serialize(e,i){const o=new Float64Array(e.ids),u=new Uint32Array(e.positions);return Es(o,u,0,o.length-1),i&&i.push(o.buffer,u.buffer),{ids:o,positions:u}}static deserialize(e){const i=new Jn;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Ss(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:yn(String(n))}function Es(n,e,i,o){for(;i<o;){const u=n[i+o>>1];let d=i-1,p=o+1;for(;;){do d++;while(n[d]<u);do p--;while(n[p]>u);if(d>=p)break;Ha(n,d,p),Ha(e,3*d,3*p),Ha(e,3*d+1,3*p+1),Ha(e,3*d+2,3*p+2)}p-i<o-p?(Es(n,e,i,p),i=p+1):(Es(n,e,p+1,o),o=p)}}function Ha(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}ut("FeaturePositionMap",Jn);class jr{constructor(e,i){this.gl=e.gl,this.location=i}}class pl extends jr{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class hu extends jr{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class $a extends jr{constructor(e,i){super(e,i),this.current=Gt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Nr=new Float32Array(16);function sa(n){return[Lt(255*n.r,255*n.g),Lt(255*n.b,255*n.a)]}class Ma{constructor(e,i,o){this.value=e,this.uniformNames=i.map((u=>`u_${u}`)),this.type=o}setUniform(e,i,o){e.set(o.constantOr(this.value))}getBinding(e,i,o){return this.type==="color"?new $a(e,i):new pl(e,i)}}class Aa{constructor(e,i){this.uniformNames=i.map((o=>`u_${o}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=e.tlbr}setConstantDashPositions(e,i){this.dashTo=[0,e.y,e.height,e.width],this.dashFrom=[0,i.y,i.height,i.width]}setUniform(e,i,o,u){let d=null;u==="u_pattern_to"?d=this.patternTo:u==="u_pattern_from"?d=this.patternFrom:u==="u_dasharray_to"?d=this.dashTo:u==="u_dasharray_from"?d=this.dashFrom:u==="u_pixel_ratio_to"?d=this.pixelRatioTo:u==="u_pixel_ratio_from"&&(d=this.pixelRatioFrom),d!==null&&e.set(d)}getBinding(e,i,o){return o.substr(0,9)==="u_pattern"||o.substr(0,12)==="u_dasharray_"?new hu(e,i):new pl(e,i)}}class wi{constructor(e,i,o,u){this.expression=e,this.type=o,this.maxValue=0,this.paintVertexAttributes=i.map((d=>({name:`a_${d}`,type:"Float32",components:o==="color"?2:1,offset:0}))),this.paintVertexArray=new u}populatePaintArray(e,i,o){const u=this.paintVertexArray.length,d=this.expression.evaluate(new xi(0,o),i,{},o.canonical,[],o.formattedSection);this.paintVertexArray.resize(e),this._setPaintValue(u,e,d)}updatePaintArray(e,i,o,u,d){const p=this.expression.evaluate(new xi(0,d),o,u);this._setPaintValue(e,i,p)}_setPaintValue(e,i,o){if(this.type==="color"){const u=sa(o);for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,o);this.maxValue=Math.max(this.maxValue,Math.abs(o))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bi{constructor(e,i,o,u,d,p){this.expression=e,this.uniformNames=i.map((y=>`u_${y}_t`)),this.type=o,this.useIntegerZoom=u,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=i.map((y=>({name:`a_${y}`,type:"Float32",components:o==="color"?4:2,offset:0}))),this.paintVertexArray=new p}populatePaintArray(e,i,o){const u=this.expression.evaluate(new xi(this.zoom,o),i,{},o.canonical,[],o.formattedSection),d=this.expression.evaluate(new xi(this.zoom+1,o),i,{},o.canonical,[],o.formattedSection),p=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(p,e,u,d)}updatePaintArray(e,i,o,u,d){const p=this.expression.evaluate(new xi(this.zoom,d),o,u),y=this.expression.evaluate(new xi(this.zoom+1,d),o,u);this._setPaintValue(e,i,p,y)}_setPaintValue(e,i,o,u){if(this.type==="color"){const d=sa(o),p=sa(u);for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,d[0],d[1],p[0],p[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,o,u);this.maxValue=Math.max(this.maxValue,Math.abs(o),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const o=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,u=Vt(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);e.set(u)}getBinding(e,i,o){return new pl(e,i)}}class Rn{constructor(e,i,o,u,d,p){this.expression=e,this.type=i,this.useIntegerZoom=o,this.zoom=u,this.layerId=p,this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d}populatePaintArray(e,i,o){const u=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(u,e,this.getPositionIds(i),o)}updatePaintArray(e,i,o,u,d){this._setPaintValues(e,i,this.getPositionIds(o),d)}_setPaintValues(e,i,o,u){const d=this.getPositions(u);if(!d||!o)return;const p=d[o.min],y=d[o.mid],x=d[o.max];if(p&&y&&x)for(let E=e;E<i;E++)this.emplace(this.zoomInPaintVertexArray,E,y,p),this.emplace(this.zoomOutPaintVertexArray,E,y,x)}upload(e){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const i=this.getVertexAttributes();this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,i,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,i,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fn extends Rn{getPositions(e){return e.imagePositions}getPositionIds(e){return e.patterns&&e.patterns[this.layerId]}getVertexAttributes(){return yi.members}emplace(e,i,o,u){e.emplace(i,o.tlbr[0],o.tlbr[1],o.tlbr[2],o.tlbr[3],u.tlbr[0],u.tlbr[1],u.tlbr[2],u.tlbr[3],o.pixelRatio,u.pixelRatio)}}class hh extends Rn{getPositions(e){return e.dashPositions}getPositionIds(e){return e.dashes&&e.dashes[this.layerId]}getVertexAttributes(){return Ui.members}emplace(e,i,o,u){e.emplace(i,0,o.y,o.height,o.width,0,u.y,u.height,u.width)}}class fh{constructor(e,i,o){this.binders={},this._buffers=[];const u=[];for(const d in e.paint._values){if(!o(d))continue;const p=e.paint.get(d);if(!(p instanceof aa&&ba(p.property.specification)))continue;const y=Ad(d,e.type),x=p.value,E=p.property.specification.type,D=p.property.useIntegerZoom,R=p.property.specification["property-type"],L=R==="cross-faded"||R==="cross-faded-data-driven";if(x.kind==="constant")this.binders[d]=L?new Aa(x.value,y):new Ma(x.value,y,E),u.push(`/u_${d}`);else if(x.kind==="source"||L){const B=Do(d,E,"source");this.binders[d]=L?d==="line-dasharray"?new hh(x,E,D,i,B,e.id):new Fn(x,E,D,i,B,e.id):new wi(x,y,E,B),u.push(`/a_${d}`)}else{const B=Do(d,E,"composite");this.binders[d]=new Bi(x,y,E,D,i,B),u.push(`/z_${d}`)}}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof wi||i instanceof Bi?i.maxValue:0}populatePaintArrays(e,i,o){for(const u in this.binders){const d=this.binders[u];(d instanceof wi||d instanceof Bi||d instanceof Rn)&&d.populatePaintArray(e,i,o)}}setConstantPatternPositions(e,i){for(const o in this.binders){const u=this.binders[o];u instanceof Aa&&u.setConstantPatternPositions(e,i)}}setConstantDashPositions(e,i){for(const o in this.binders){const u=this.binders[o];u instanceof Aa&&u.setConstantDashPositions(e,i)}}updatePaintArrays(e,i,o,u,d){let p=!1;for(const y in e){const x=i.getPositions(y);for(const E of x){const D=o.feature(E.index);for(const R in this.binders){const L=this.binders[R];if((L instanceof wi||L instanceof Bi||L instanceof Rn)&&L.expression.isStateDependent===!0){const B=u.paint.get(R);L.expression=B.value,L.updatePaintArray(E.start,E.end,D,e[y],d),p=!0}}}}return p}defines(){const e=[];for(const i in this.binders){const o=this.binders[i];(o instanceof Ma||o instanceof Aa)&&e.push(...o.uniformNames.map((u=>`#define HAS_UNIFORM_${u}`)))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof wi||o instanceof Bi)for(let u=0;u<o.paintVertexAttributes.length;u++)e.push(o.paintVertexAttributes[u].name);else if(o instanceof Rn){const u=o.getVertexAttributes();for(const d of u)e.push(d.name)}}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const o=this.binders[i];if(o instanceof Ma||o instanceof Aa||o instanceof Bi)for(const u of o.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const o=[];for(const u in this.binders){const d=this.binders[u];if(d instanceof Ma||d instanceof Aa||d instanceof Bi){for(const p of d.uniformNames)if(i[p]){const y=d.getBinding(e,i[p],p);o.push({name:p,property:u,binding:y})}}}return o}setUniforms(e,i,o,u){for(const{name:d,property:p,binding:y}of i)this.binders[p].setUniform(y,u,o.get(p),d)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const o=this.binders[i];if(e&&o instanceof Rn){const u=e.fromScale===2?o.zoomInPaintVertexBuffer:o.zoomOutPaintVertexBuffer;u&&this._buffers.push(u)}else(o instanceof wi||o instanceof Bi)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const i in this.binders){const o=this.binders[i];(o instanceof wi||o instanceof Bi||o instanceof Rn)&&o.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof wi||i instanceof Bi||i instanceof Rn)&&i.destroy()}}}class Co{constructor(e,i,o=()=>!0){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new fh(u,i,o);this.needsUpload=!1,this._featureMap=new Jn,this._bufferOffset=0}populatePaintArrays(e,i,o,u){for(const d in this.programConfigurations)this.programConfigurations[d].populatePaintArrays(e,i,u);i.id!==void 0&&this._featureMap.add(i.id,o,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,o,u){for(const d of o)this.needsUpload=this.programConfigurations[d.id].updatePaintArrays(e,this._featureMap,i,d,u)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Ad(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function Do(n,e,i){const o={color:{source:$i,composite:a},number:{source:dl,composite:$i}},u=(function(d){return{"line-pattern":{source:ue,composite:ue},"fill-pattern":{source:ue,composite:ue},"fill-extrusion-pattern":{source:ue,composite:ue},"line-dasharray":{source:de,composite:de}}[d]})(n);return u&&u[i]||o[e][i]}ut("ConstantBinder",Ma),ut("CrossFadedConstantBinder",Aa),ut("SourceExpressionBinder",wi),ut("CrossFadedPatternBinder",Fn),ut("CrossFadedDasharrayBinder",hh),ut("CompositeExpressionBinder",Bi),ut("ProgramConfiguration",fh,{omit:["_buffers"]}),ut("ProgramConfigurationSet",Co);const dh=Math.pow(2,14)-1,$s=-dh-1;function Xs(n){const e=Mt/n.extent,i=n.loadGeometry();for(let o=0;o<i.length;o++){const u=i[o];for(let d=0;d<u.length;d++){const p=u[d],y=Math.round(p.x*e),x=Math.round(p.y*e);p.x=Vt(y,$s,dh),p.y=Vt(x,$s,dh),(y<p.x||y>p.x+1||x<p.y||x>p.y+1)&&rn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Xa(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Xs(n):[]}}const ph=-32768;function _c(n,e,i,o,u){n.emplaceBack(ph+8*e+o,ph+8*i+u)}class yc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new ie,this.indexArray=new Pe,this.segments=new at,this.programConfigurations=new Co(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){const u=this.layers[0],d=[];let p=null,y=!1,x=u.type==="heatmap";if(u.type==="circle"){const D=u;p=D.layout.get("circle-sort-key"),y=!p.isConstant(),x=x||D.paint.get("circle-pitch-alignment")==="map"}const E=x?i.subdivisionGranularity.circle:1;for(const{feature:D,id:R,index:L,sourceLayerIndex:B}of e){const V=this.layers[0]._featureFilter.needGeometry,U=Xa(D,V);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),U,o))continue;const q=y?p.evaluate(U,{},o):void 0,Y={id:R,properties:D.properties,type:D.type,sourceLayerIndex:B,index:L,geometry:V?U.geometry:Xs(D),patterns:{},sortKey:q};d.push(Y)}y&&d.sort(((D,R)=>D.sortKey-R.sortKey));for(const D of d){const{geometry:R,index:L,sourceLayerIndex:B}=D,V=e[L].feature;this.addFeature(D,R,L,o,E),i.featureIndex.insert(V,R,L,B,this.index)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,He),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,o,u,d=1){let p;switch(d){case 1:p=[0,7];break;case 3:p=[0,2,5,7];break;case 5:p=[0,1,3,4,6,7];break;case 7:p=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${d}; valid values are 1, 3, 5, 7.`)}const y=p.length;for(const x of i)for(const E of x){const D=E.x,R=E.y;if(D<0||D>=Mt||R<0||R>=Mt)continue;const L=this.segments.prepareSegment(y*y,this.layoutVertexArray,this.indexArray,e.sortKey),B=L.vertexLength;for(let V=0;V<y;V++)for(let U=0;U<y;U++)_c(this.layoutVertexArray,D,R,p[U],p[V]);for(let V=0;V<y-1;V++)for(let U=0;U<y-1;U++){const q=B+V*y+U,Y=B+(V+1)*y+U;this.indexArray.emplaceBack(q,Y+1,q+1),this.indexArray.emplaceBack(q,Y,Y+1)}L.vertexLength+=y*y,L.primitiveLength+=(y-1)*(y-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:{},canonical:u})}}function vc(n,e){for(let i=0;i<n.length;i++)if(zo(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(zo(n,e[i]))return!0;return!!cr(n,e)}function Cd(n,e,i){return!!zo(n,e)||!!zd(e,n,i)}function Dd(n,e){if(n.length===1)return Gp(e,n[0]);for(let i=0;i<e.length;i++){const o=e[i];for(let u=0;u<o.length;u++)if(zo(n,o[u]))return!0}for(let i=0;i<n.length;i++)if(Gp(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(cr(n,e[i]))return!0;return!1}function er(n,e,i){if(n.length>1){if(cr(n,e))return!0;for(let o=0;o<e.length;o++)if(zd(e[o],n,i))return!0}for(let o=0;o<n.length;o++)if(zd(n[o],e,i))return!0;return!1}function cr(n,e){if(n.length===0||e.length===0)return!1;for(let i=0;i<n.length-1;i++){const o=n[i],u=n[i+1];for(let d=0;d<e.length-1;d++)if(ag(o,u,e[d],e[d+1]))return!0}return!1}function ag(n,e,i,o){return Ir(n,i,o)!==Ir(e,i,o)&&Ir(n,e,i)!==Ir(n,e,o)}function zd(n,e,i){const o=i*i;if(e.length===1)return n.distSqr(e[0])<o;for(let u=1;u<e.length;u++)if(Up(n,e[u-1],e[u])<o)return!0;return!1}function Up(n,e,i){const o=e.distSqr(i);if(o===0)return n.distSqr(e);const u=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/o;return n.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function Gp(n,e){let i,o,u,d=!1;for(let p=0;p<n.length;p++){i=n[p];for(let y=0,x=i.length-1;y<i.length;x=y++)o=i[y],u=i[x],o.y>e.y!=u.y>e.y&&e.x<(u.x-o.x)*(e.y-o.y)/(u.y-o.y)+o.x&&(d=!d)}return d}function zo(n,e){let i=!1;for(let o=0,u=n.length-1;o<n.length;u=o++){const d=n[o],p=n[u];d.y>e.y!=p.y>e.y&&e.x<(p.x-d.x)*(e.y-d.y)/(p.y-d.y)+d.x&&(i=!i)}return i}function sg(n,e,i){const o=i[0],u=i[2];if(n.x<o.x&&e.x<o.x||n.x>u.x&&e.x>u.x||n.y<o.y&&e.y<o.y||n.y>u.y&&e.y>u.y)return!1;const d=Ir(n,e,i[0]);return d!==Ir(n,e,i[1])||d!==Ir(n,e,i[2])||d!==Ir(n,e,i[3])}function ml(n,e,i){const o=e.paint.get(n).value;return o.kind==="constant"?o.value:i.programConfigurations.get(e.id).getMaxValue(n)}function lf(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Pd(n,e,i,o,u){if(!e[0]&&!e[1])return n;const d=ne.convert(e)._mult(u);i==="viewport"&&d._rotate(-o);const p=[];for(let y=0;y<n.length;y++)p.push(n[y].sub(d));return p}function Id(n){const e=[];for(let i=0;i<n.length;i++){const o=n[i],u=e.at(-1);(i===0||u&&!o.equals(u))&&e.push(o)}return e}function qp({queryGeometry:n,size:e},i){return Cd(n,i,e)}function og({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},d){return Cd(n,d,e*(i.projectTileCoordinates(d.x,d.y,o,u).signedDistanceFromCamera/i.cameraToCenterDistance))}function lg({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},d){const p=i.projectTileCoordinates(d.x,d.y,o,u).signedDistanceFromCamera,y=e*(i.cameraToCenterDistance/p);return Cd(n,uf(d,i,o,u),y)}function ug({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u},d){return Cd(n,uf(d,i,o,u),e)}function Rd({queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u,pitchAlignment:d="map",pitchScale:p="map"},y){const x=d==="map"?p==="map"?qp:og:p==="map"?lg:ug,E={queryGeometry:n,size:e,transform:i,unwrappedTileID:o,getElevation:u};for(const D of y)for(const R of D)if(x(E,R))return!0;return!1}function uf(n,e,i,o){const u=e.projectTileCoordinates(n.x,n.y,i,o).point;return new ne((.5*u.x+.5)*e.width,(.5*-u.y+.5)*e.height)}let Od,Zp;ut("CircleBucket",yc,{omit:["layers"]});var Hp={get paint(){return Zp=Zp||new Sn({"circle-radius":new _t(Ee.paint_circle["circle-radius"]),"circle-color":new _t(Ee.paint_circle["circle-color"]),"circle-blur":new _t(Ee.paint_circle["circle-blur"]),"circle-opacity":new _t(Ee.paint_circle["circle-opacity"]),"circle-translate":new ft(Ee.paint_circle["circle-translate"]),"circle-translate-anchor":new ft(Ee.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ft(Ee.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ft(Ee.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _t(Ee.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _t(Ee.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _t(Ee.paint_circle["circle-stroke-opacity"])})},get layout(){return Od=Od||new Sn({"circle-sort-key":new _t(Ee.layout_circle["circle-sort-key"])})}};class Ld extends sn{constructor(e,i){super(e,Hp,i)}createBucket(e){return new yc(e)}queryRadius(e){const i=e;return ml("circle-radius",this,i)+ml("circle-stroke-width",this,i)+lf(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:d,pixelsToTileUnits:p,unwrappedTileID:y,getElevation:x}){const E=Pd(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-d.bearingInRadians,p),D=this.paint.get("circle-radius").evaluate(i,o)+this.paint.get("circle-stroke-width").evaluate(i,o),R=this.paint.get("circle-pitch-scale"),L=this.paint.get("circle-pitch-alignment");let B,V;return L==="map"?(B=E,V=D*p):(B=(function(U,q,Y,se){return U.map((Q=>uf(Q,q,Y,se)))})(E,d,y,x),V=D),Rd({queryGeometry:B,size:V,transform:d,unwrappedTileID:y,getElevation:x,pitchAlignment:L,pitchScale:R},u)}}class Bd extends yc{}let $p;ut("HeatmapBucket",Bd,{omit:["layers"]});var Xp={get paint(){return $p=$p||new Sn({"heatmap-radius":new _t(Ee.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _t(Ee.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ft(Ee.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fc(Ee.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ft(Ee.paint_heatmap["heatmap-opacity"])})}};function kd(n,{width:e,height:i},o,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*o)throw new RangeError(`mismatched image size. expected: ${u.length} but got: ${e*i*o}`)}else u=new Uint8Array(e*i*o);return n.width=e,n.height=i,n.data=u,n}function Po(n,{width:e,height:i},o){if(e===n.width&&i===n.height)return;const u=kd({},{width:e,height:i},o);cf(n,u,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,i)},o),n.width=e,n.height=i,n.data=u.data}function cf(n,e,i,o,u,d){if(u.width===0||u.height===0)return e;if(u.width>n.width||u.height>n.height||i.x>n.width-u.width||i.y>n.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||o.x>e.width-u.width||o.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const p=n.data,y=e.data;if(p===y)throw new Error("srcData equals dstData, so image is already copied");for(let x=0;x<u.height;x++){const E=((i.y+x)*n.width+i.x)*d,D=((o.y+x)*e.width+o.x)*d;for(let R=0;R<u.width*d;R++)y[D+R]=p[E+R]}return e}class hf{constructor(e,i){kd(this,e,1,i)}resize(e){Po(this,e,1)}clone(){return new hf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,u,d){cf(e,i,o,u,d,1)}}class Vr{constructor(e,i){kd(this,e,4,i)}resize(e){Po(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Vr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,o,u,d){cf(e,i,o,u,d,4)}setPixel(e,i,o){const u=4*(e*this.width+i);this.data[u+0]=Math.round(255*o.r/o.a),this.data[u+1]=Math.round(255*o.g/o.a),this.data[u+2]=Math.round(255*o.b/o.a),this.data[u+3]=Math.round(255*o.a)}}function Io(n){const e={},i=n.resolution||256,o=n.clips?n.clips.length:1,u=n.image||new Vr({width:i,height:o});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const d=(p,y,x)=>{e[n.evaluationKey]=x;const E=n.expression.evaluate(e);u.setPixel(p/4/i,y/4,E)};if(n.clips)for(let p=0,y=0;p<o;++p,y+=4*i)for(let x=0,E=0;x<i;x++,E+=4){const D=x/(i-1),{start:R,end:L}=n.clips[p];d(y,E,R*(1-D)+L*D)}else for(let p=0,y=0;p<i;p++,y+=4)d(0,y,p/(i-1));return u}ut("AlphaImage",hf),ut("RGBAImage",Vr);const ff="big-fb";class cg extends sn{createBucket(e){return new Bd(e)}constructor(e,i){super(e,Xp,i),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Io({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ff)&&this.heatmapFbos.delete(ff)}queryRadius(e){return ml("heatmap-radius",this,e)}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:d,pixelsToTileUnits:p,unwrappedTileID:y,getElevation:x}){return Rd({queryGeometry:e,size:this.paint.get("heatmap-radius").evaluate(i,o)*p,transform:d,unwrappedTileID:y,getElevation:x},u)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&!this.isHidden()}}let df;var pf={get paint(){return df=df||new Sn({"hillshade-illumination-direction":new ft(Ee.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new ft(Ee.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new ft(Ee.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ft(Ee.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ft(Ee.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ft(Ee.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ft(Ee.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new ft(Ee.paint_hillshade["hillshade-method"])})}};class vn extends sn{constructor(e,i){super(e,pf,i),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let e=this.paint.get("hillshade-illumination-direction").values,i=this.paint.get("hillshade-illumination-altitude").values,o=this.paint.get("hillshade-highlight-color").values,u=this.paint.get("hillshade-shadow-color").values;const d=Math.max(e.length,i.length,o.length,u.length);e=e.concat(Array(d-e.length).fill(e.at(-1))),i=i.concat(Array(d-i.length).fill(i.at(-1))),o=o.concat(Array(d-o.length).fill(o.at(-1))),u=u.concat(Array(d-u.length).fill(u.at(-1)));const p=i.map(Yn);return{directionRadians:e.map(Yn),altitudeRadians:p,shadowColor:u,highlightColor:o}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&!this.isHidden()}}let hg;var R_={get paint(){return hg=hg||new Sn({"color-relief-opacity":new ft(Ee["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new fc(Ee["paint_color-relief"]["color-relief-color"])})}};class Fd{constructor(e,i,o,u){this.context=e,this.format=o,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,o){const{width:u,height:d}=e,p=!(this.size&&this.size[0]===u&&this.size[1]===d||o),{context:y}=this,{gl:x}=y;if(this.useMipmap=!!(i&&i.useMipmap),x.bindTexture(x.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!i||i.premultiply!==!1)),p)this.size=[u,d],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||zs(e)?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,e):x.texImage2D(x.TEXTURE_2D,0,this.format,u,d,0,this.format,x.UNSIGNED_BYTE,e.data);else{const{x:E,y:D}=o||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||zs(e)?x.texSubImage2D(x.TEXTURE_2D,0,E,D,x.RGBA,x.UNSIGNED_BYTE,e):x.texSubImage2D(x.TEXTURE_2D,0,E,D,u,d,x.RGBA,x.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&x.generateMipmap(x.TEXTURE_2D),y.pixelStoreUnpackFlipY.setDefault(),y.pixelStoreUnpack.setDefault(),y.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(e,i,o){const{context:u}=this,{gl:d}=u;d.bindTexture(d.TEXTURE_2D,this.texture),o!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(o=d.LINEAR),e!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,o||e),this.filter=e),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class mh{constructor(e,i,o,u=1,d=1,p=1,y=0){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(o&&!["mapbox","terrarium","custom"].includes(o))return void rn(`"${o}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const x=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),o){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=u,this.greenFactor=d,this.blueFactor=p,this.baseShift=y;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let E=0;E<x;E++)this.data[this._idx(-1,E)]=this.data[this._idx(0,E)],this.data[this._idx(x,E)]=this.data[this._idx(x-1,E)],this.data[this._idx(E,-1)]=this.data[this._idx(E,0)],this.data[this._idx(E,x)]=this.data[this._idx(E,x-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(x,-1)]=this.data[this._idx(x-1,0)],this.data[this._idx(-1,x)]=this.data[this._idx(0,x-1)],this.data[this._idx(x,x)]=this.data[this._idx(x-1,x-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let E=0;E<x;E++)for(let D=0;D<x;D++){const R=this.get(E,D);R>this.max&&(this.max=R),R<this.min&&(this.min=R)}}get(e,i){const o=new Uint8Array(this.data.buffer),u=4*this._idx(e,i);return this.unpack(o[u],o[u+1],o[u+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError(`Out of range source coordinates for DEM data. x: ${e}, y: ${i}, dim: ${this.dim}`);return(i+1)*this.stride+(e+1)}unpack(e,i,o){return e*this.redFactor+i*this.greenFactor+o*this.blueFactor-this.baseShift}pack(e){return gl(e,this.getUnpackVector())}getPixels(){return new Vr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,o){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,d=i*this.dim+this.dim,p=o*this.dim,y=o*this.dim+this.dim;switch(i){case-1:u=d-1;break;case 1:d=u+1}switch(o){case-1:p=y-1;break;case 1:y=p+1}const x=-i*this.dim,E=-o*this.dim;for(let D=p;D<y;D++)for(let R=u;R<d;R++)this.data[this._idx(R,D)]=e.data[this._idx(R+x,D+E)]}}function gl(n,e){const i=e[0],o=e[1],u=e[2],d=e[3],p=Math.min(i,o,u),y=Math.round((n+d)/p);return{r:Math.floor(y*p/i)%256,g:Math.floor(y*p/o)%256,b:Math.floor(y*p/u)%256}}ut("DEMData",mh);class fg extends sn{constructor(e,i){super(e,R_,i)}_createColorRamp(e){const i={elevationStops:[],colorStops:[]},o=this._transitionablePaint._values["color-relief-color"].value.expression;if(o instanceof zr&&o._styleExpression.expression instanceof Cr){this.colorRampExpression=o;const p=o._styleExpression.expression;i.elevationStops=p.labels,i.colorStops=[];for(const y of i.elevationStops)i.colorStops.push(p.evaluate({globals:{elevation:y}}))}if(i.elevationStops.length<1&&(i.elevationStops=[0],i.colorStops=[Gt.transparent]),i.elevationStops.length<2&&(i.elevationStops.push(i.elevationStops[0]+1),i.colorStops.push(i.colorStops[0])),i.elevationStops.length<=e)return i;const u={elevationStops:[],colorStops:[]},d=(i.elevationStops.length-1)/(e-1);for(let p=0;p<i.elevationStops.length-.5;p+=d)u.elevationStops.push(i.elevationStops[Math.round(p)]),u.colorStops.push(i.colorStops[Math.round(p)]);return rn(`Too many colors in specification of ${this.id} color-relief layer, may not render properly. Max possible colors: ${e}, provided: ${i.elevationStops.length}`),u}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(e,i,o){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const u=this._createColorRamp(i),d=new Vr({width:u.colorStops.length,height:1}),p=new Vr({width:u.colorStops.length,height:1});for(let y=0;y<u.elevationStops.length;y++){const x=gl(u.elevationStops[y],o);p.setPixel(0,y,new Gt(x.r/255,x.g/255,x.b/255,1)),d.setPixel(0,y,u.colorStops[y])}return this.colorRampTextures={elevationTexture:new Fd(e,p,e.gl.RGBA),colorTexture:new Fd(e,d,e.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return!this.isHidden()&&!!this.colorRampTextures}}const dg=Ji([{name:"a_pos",components:2,type:"Int16"}],4),{members:mf}=dg;function Ya(n,e,i){const o=i.patternDependencies;let u=!1;for(const d of e){const p=d.paint.get(`${n}-pattern`);p.isConstant()||(u=!0);const y=p.constantOr(null);y&&(u=!0,o[y.to]=!0,o[y.from]=!0)}return u}function jd(n,e,i,o,u){const{zoom:d}=o,p=u.patternDependencies;for(const y of e){const x=y.paint.get(`${n}-pattern`).value;if(x.kind!=="constant"){let E=x.evaluate({zoom:d-1},i,{},u.availableImages),D=x.evaluate({zoom:d},i,{},u.availableImages),R=x.evaluate({zoom:d+1},i,{},u.availableImages);E=E&&E.name?E.name:E,D=D&&D.name?D.name:D,R=R&&R.name?R.name:R,p[E]=!0,p[D]=!0,p[R]=!0,i.patterns[y.id]={min:E,mid:D,max:R}}}return i}function Nd(n,e,i,o,u){let d;if(u===(function(p,y,x,E){let D=0;for(let R=y,L=x-E;R<x;R+=E)D+=(p[L]-p[R])*(p[R+1]+p[L+1]),L=R;return D})(n,e,i,o)>0)for(let p=e;p<i;p+=o)d=oa(p/o|0,n[p],n[p+1],d);else for(let p=i-o;p>=e;p-=o)d=oa(p/o|0,n[p],n[p+1],d);return d&&Ca(d,d.next)&&(la(d),d=d.next),d}function fu(n,e){if(!n)return n;e||(e=n);let i,o=n;do if(i=!1,o.steiner||!Ca(o,o.next)&&hi(o.prev,o,o.next)!==0)o=o.next;else{if(la(o),o=e=o.prev,o===o.next)break;i=!0}while(i||o!==e);return e}function bc(n,e,i,o,u,d,p){if(!n)return;!p&&d&&(function(x,E,D,R){let L=x;do L.z===0&&(L.z=ir(L.x,L.y,E,D,R)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==x);L.prevZ.nextZ=null,L.prevZ=null,(function(B){let V,U=1;do{let q,Y=B;B=null;let se=null;for(V=0;Y;){V++;let Q=Y,J=0;for(let he=0;he<U&&(J++,Q=Q.nextZ,Q);he++);let le=U;for(;J>0||le>0&&Q;)J!==0&&(le===0||!Q||Y.z<=Q.z)?(q=Y,Y=Y.nextZ,J--):(q=Q,Q=Q.nextZ,le--),se?se.nextZ=q:B=q,q.prevZ=se,se=q;Y=Q}se.nextZ=null,U*=2}while(V>1)})(L)})(n,o,u,d);let y=n;for(;n.prev!==n.next;){const x=n.prev,E=n.next;if(d?Vd(n,o,u,d):Yp(n))e.push(x.i,n.i,E.i),la(n),n=E.next,y=E.next;else if((n=E)===y){p?p===1?bc(n=pg(fu(n),e),e,i,o,u,d,2):p===2&&_l(n,e,i,o,u,d):bc(fu(n),e,i,o,u,d,1);break}}}function Yp(n){const e=n.prev,i=n,o=n.next;if(hi(e,i,o)>=0)return!1;const u=e.x,d=i.x,p=o.x,y=e.y,x=i.y,E=o.y,D=Math.min(u,d,p),R=Math.min(y,x,E),L=Math.max(u,d,p),B=Math.max(y,x,E);let V=o.next;for(;V!==e;){if(V.x>=D&&V.x<=L&&V.y>=R&&V.y<=B&&gh(u,y,d,x,p,E,V.x,V.y)&&hi(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function Vd(n,e,i,o){const u=n.prev,d=n,p=n.next;if(hi(u,d,p)>=0)return!1;const y=u.x,x=d.x,E=p.x,D=u.y,R=d.y,L=p.y,B=Math.min(y,x,E),V=Math.min(D,R,L),U=Math.max(y,x,E),q=Math.max(D,R,L),Y=ir(B,V,e,i,o),se=ir(U,q,e,i,o);let Q=n.prevZ,J=n.nextZ;for(;Q&&Q.z>=Y&&J&&J.z<=se;){if(Q.x>=B&&Q.x<=U&&Q.y>=V&&Q.y<=q&&Q!==u&&Q!==p&&gh(y,D,x,R,E,L,Q.x,Q.y)&&hi(Q.prev,Q,Q.next)>=0||(Q=Q.prevZ,J.x>=B&&J.x<=U&&J.y>=V&&J.y<=q&&J!==u&&J!==p&&gh(y,D,x,R,E,L,J.x,J.y)&&hi(J.prev,J,J.next)>=0))return!1;J=J.nextZ}for(;Q&&Q.z>=Y;){if(Q.x>=B&&Q.x<=U&&Q.y>=V&&Q.y<=q&&Q!==u&&Q!==p&&gh(y,D,x,R,E,L,Q.x,Q.y)&&hi(Q.prev,Q,Q.next)>=0)return!1;Q=Q.prevZ}for(;J&&J.z<=se;){if(J.x>=B&&J.x<=U&&J.y>=V&&J.y<=q&&J!==u&&J!==p&&gh(y,D,x,R,E,L,J.x,J.y)&&hi(J.prev,J,J.next)>=0)return!1;J=J.nextZ}return!0}function pg(n,e){let i=n;do{const o=i.prev,u=i.next.next;!Ca(o,u)&&Wp(o,i,i.next,u)&&yf(o,u)&&yf(u,o)&&(e.push(o.i,i.i,u.i),la(i),la(i.next),i=n=u),i=i.next}while(i!==n);return fu(i)}function _l(n,e,i,o,u,d){let p=n;do{let y=p.next.next;for(;y!==p.prev;){if(p.i!==y.i&&En(p,y)){let x=vf(p,y);return p=fu(p,p.next),x=fu(x,x.next),bc(p,e,i,o,u,d,0),void bc(x,e,i,o,u,d,0)}y=y.next}p=p.next}while(p!==n)}function tr(n,e){let i=n.x-e.x;return i===0&&(i=n.y-e.y,i===0)&&(i=(n.next.y-n.y)/(n.next.x-n.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function Qp(n,e){const i=(function(u,d){let p=d;const y=u.x,x=u.y;let E,D=-1/0;if(Ca(u,p))return p;do{if(Ca(u,p.next))return p.next;if(x<=p.y&&x>=p.next.y&&p.next.y!==p.y){const U=p.x+(x-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(U<=y&&U>D&&(D=U,E=p.x<p.next.x?p:p.next,U===y))return E}p=p.next}while(p!==d);if(!E)return null;const R=E,L=E.x,B=E.y;let V=1/0;p=E;do{if(y>=p.x&&p.x>=L&&y!==p.x&&Kp(x<B?y:D,x,L,B,x<B?D:y,x,p.x,p.y)){const U=Math.abs(x-p.y)/(y-p.x);yf(p,u)&&(U<V||U===V&&(p.x>E.x||p.x===E.x&&mg(E,p)))&&(E=p,V=U)}p=p.next}while(p!==R);return E})(n,e);if(!i)return e;const o=vf(i,n);return fu(o,o.next),fu(i,i.next)}function mg(n,e){return hi(n.prev,n,e.prev)<0&&hi(e.next,n,n.next)<0}function ir(n,e,i,o,u){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*u|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-o)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function O_(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function Kp(n,e,i,o,u,d,p,y){return(u-p)*(e-y)>=(n-p)*(d-y)&&(n-p)*(o-y)>=(i-p)*(e-y)&&(i-p)*(d-y)>=(u-p)*(o-y)}function gh(n,e,i,o,u,d,p,y){return!(n===p&&e===y)&&Kp(n,e,i,o,u,d,p,y)}function En(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!(function(i,o){let u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==o.i&&u.next.i!==o.i&&Wp(u,u.next,i,o))return!0;u=u.next}while(u!==i);return!1})(n,e)&&(yf(n,e)&&yf(e,n)&&(function(i,o){let u=i,d=!1;const p=(i.x+o.x)/2,y=(i.y+o.y)/2;do u.y>y!=u.next.y>y&&u.next.y!==u.y&&p<(u.next.x-u.x)*(y-u.y)/(u.next.y-u.y)+u.x&&(d=!d),u=u.next;while(u!==i);return d})(n,e)&&(hi(n.prev,n,e.prev)||hi(n,e.prev,e))||Ca(n,e)&&hi(n.prev,n,n.next)>0&&hi(e.prev,e,e.next)>0)}function hi(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function Ca(n,e){return n.x===e.x&&n.y===e.y}function Wp(n,e,i,o){const u=_f(hi(n,e,i)),d=_f(hi(n,e,o)),p=_f(hi(i,o,n)),y=_f(hi(i,o,e));return u!==d&&p!==y||!(u!==0||!gf(n,i,e))||!(d!==0||!gf(n,o,e))||!(p!==0||!gf(i,n,o))||!(y!==0||!gf(i,e,o))}function gf(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function _f(n){return n>0?1:n<0?-1:0}function yf(n,e){return hi(n.prev,n,n.next)<0?hi(n,e,n.next)>=0&&hi(n,n.prev,e)>=0:hi(n,e,n.prev)<0||hi(n,n.next,e)<0}function vf(n,e){const i=Ud(n.i,n.x,n.y),o=Ud(e.i,e.x,e.y),u=n.next,d=e.prev;return n.next=e,e.prev=n,i.next=u,u.prev=i,o.next=i,i.prev=o,d.next=o,o.prev=d,o}function oa(n,e,i,o){const u=Ud(n,e,i);return o?(u.next=o.next,u.prev=o,o.next.prev=u,o.next=u):(u.prev=u,u.next=u),u}function la(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Ud(n,e,i){return{i:n,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class hr{constructor(e,i){if(i>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=i}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class bf{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}bf.noSubdivision=new bf({fill:new hr(0,0),line:new hr(0,0),tile:new hr(0,0),stencil:new hr(0,0),circle:1}),ut("SubdivisionGranularityExpression",hr),ut("SubdivisionGranularitySetting",bf);const Da=-32768,Ys=32767;class yl{constructor(e,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=Mt/e,this._canonical=i}_getKey(e,i){return(e+=32768)<<16|i+32768}_vertexToIndex(e,i){if(e<-32768||i<-32768||e>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const o=0|Math.round(e),u=0|Math.round(i),d=this._getKey(o,u);if(this._vertexDictionary.has(d))return this._vertexDictionary.get(d);const p=this._vertexBuffer.length/2;return this._vertexDictionary.set(d,p),this._vertexBuffer.push(o,u),p}_subdivideTrianglesScanline(e){if(this._granularity<2)return(function(u,d){const p=[];for(let y=0;y<d.length;y+=3){const x=d[y],E=d[y+1],D=d[y+2],R=u[2*x],L=u[2*x+1];(u[2*E]-R)*(u[2*D+1]-L)-(u[2*E+1]-L)*(u[2*D]-R)>0?(p.push(x),p.push(D),p.push(E)):(p.push(x),p.push(E),p.push(D))}return p})(this._vertexBuffer,e);const i=[],o=e.length;for(let u=0;u<o;u+=3){const d=[e[u+0],e[u+1],e[u+2]],p=[this._vertexBuffer[2*e[u+0]+0],this._vertexBuffer[2*e[u+0]+1],this._vertexBuffer[2*e[u+1]+0],this._vertexBuffer[2*e[u+1]+1],this._vertexBuffer[2*e[u+2]+0],this._vertexBuffer[2*e[u+2]+1]];let y=1/0,x=1/0,E=-1/0,D=-1/0;for(let U=0;U<3;U++){const q=p[2*U],Y=p[2*U+1];y=Math.min(y,q),E=Math.max(E,q),x=Math.min(x,Y),D=Math.max(D,Y)}if(y===E||x===D)continue;const R=Math.floor(y/this._granularityCellSize),L=Math.ceil(E/this._granularityCellSize),B=Math.floor(x/this._granularityCellSize),V=Math.ceil(D/this._granularityCellSize);if(R!==L||B!==V)for(let U=B;U<V;U++){const q=this._scanlineGenerateVertexRingForCellRow(U,p,d);Qs(this._vertexBuffer,q,i)}else i.push(...d)}return i}_scanlineGenerateVertexRingForCellRow(e,i,o){const u=e*this._granularityCellSize,d=u+this._granularityCellSize,p=[];for(let y=0;y<3;y++){const x=i[2*y],E=i[2*y+1],D=i[2*(y+1)%6],R=i[(2*(y+1)+1)%6],L=i[2*(y+2)%6],B=i[(2*(y+2)+1)%6],V=D-x,U=R-E,q=V===0,Y=U===0,se=(u-E)/U,Q=(d-E)/U,J=Math.min(se,Q),le=Math.max(se,Q);if(!Y&&(J>=1||le<=0)||Y&&(E<u||E>d)){R>=u&&R<=d&&p.push(o[(y+1)%3]);continue}!Y&&J>0&&p.push(this._vertexToIndex(x+V*J,E+U*J));const he=x+V*Math.max(J,0),Ae=x+V*Math.min(le,1);q||this._generateIntraEdgeVertices(p,x,E,D,R,he,Ae),!Y&&le<1&&p.push(this._vertexToIndex(x+V*le,E+U*le)),(Y||R>=u&&R<=d)&&p.push(o[(y+1)%3]),!Y&&(R<=u||R>=d)&&this._generateInterEdgeVertices(p,x,E,D,R,L,B,Ae,u,d)}return p}_generateIntraEdgeVertices(e,i,o,u,d,p,y){const x=u-i,E=d-o,D=E===0,R=D?Math.min(i,u):Math.min(p,y),L=D?Math.max(i,u):Math.max(p,y),B=Math.floor(R/this._granularityCellSize)+1,V=Math.ceil(L/this._granularityCellSize)-1;if(D?i<u:p<y)for(let U=B;U<=V;U++){const q=U*this._granularityCellSize;e.push(this._vertexToIndex(q,o+E*(q-i)/x))}else for(let U=V;U>=B;U--){const q=U*this._granularityCellSize;e.push(this._vertexToIndex(q,o+E*(q-i)/x))}}_generateInterEdgeVertices(e,i,o,u,d,p,y,x,E,D){const R=d-o,L=p-u,B=y-d,V=(E-d)/B,U=(D-d)/B,q=Math.min(V,U),Y=Math.max(V,U),se=u+L*q;let Q=Math.floor(Math.min(se,x)/this._granularityCellSize)+1,J=Math.ceil(Math.max(se,x)/this._granularityCellSize)-1,le=x<se;const he=B===0;if(he&&(y===E||y===D))return;if(he||q>=1||Y<=0){const Ve=o-y,Fe=p+(i-p)*Math.min((E-y)/Ve,(D-y)/Ve);Q=Math.floor(Math.min(Fe,x)/this._granularityCellSize)+1,J=Math.ceil(Math.max(Fe,x)/this._granularityCellSize)-1,le=x<Fe}const Ae=R>0?D:E;if(le)for(let Ve=Q;Ve<=J;Ve++)e.push(this._vertexToIndex(Ve*this._granularityCellSize,Ae));else for(let Ve=J;Ve>=Q;Ve--)e.push(this._vertexToIndex(Ve*this._granularityCellSize,Ae))}_generateOutline(e){const i=[];for(const o of e){const u=vl(o,this._granularity,!0),d=this._pointArrayToIndices(u),p=[];for(let y=1;y<d.length;y++)p.push(d[y-1]),p.push(d[y]);i.push(p)}return i}_handlePoles(e){let i=!1,o=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(o=!0)),(i||o)&&this._fillPoles(e,i,o)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let i=0;i<e.length;i+=2){const o=e[i+1];o===Da&&(e[i+1]=-32767),o===Ys&&(e[i+1]=32766)}}_generatePoleQuad(e,i,o,u,d,p){u>d!=(p===Da)?(e.push(i),e.push(o),e.push(this._vertexToIndex(u,p)),e.push(o),e.push(this._vertexToIndex(d,p)),e.push(this._vertexToIndex(u,p))):(e.push(o),e.push(i),e.push(this._vertexToIndex(u,p)),e.push(this._vertexToIndex(d,p)),e.push(o),e.push(this._vertexToIndex(u,p)))}_fillPoles(e,i,o){const u=this._vertexBuffer,d=Mt,p=e.length;for(let y=2;y<p;y+=3){const x=e[y-2],E=e[y-1],D=e[y],R=u[2*x],L=u[2*x+1],B=u[2*E],V=u[2*E+1],U=u[2*D],q=u[2*D+1];i&&(L===0&&V===0&&this._generatePoleQuad(e,x,E,R,B,Da),V===0&&q===0&&this._generatePoleQuad(e,E,D,B,U,Da),q===0&&L===0&&this._generatePoleQuad(e,D,x,U,R,Da)),o&&(L===d&&V===d&&this._generatePoleQuad(e,x,E,R,B,Ys),V===d&&q===d&&this._generatePoleQuad(e,E,D,B,U,Ys),q===d&&L===d&&this._generatePoleQuad(e,D,x,U,R,Ys))}}_initializeVertices(e){for(let i=0;i<e.length;i+=2)this._vertexToIndex(e[i],e[i+1])}subdividePolygonInternal(e,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:o,holeIndices:u}=(function(y){const x=[],E=[];for(const D of y)if(D.length!==0){D!==y[0]&&x.push(E.length/2);for(let R=0;R<D.length;R++)E.push(D[R].x),E.push(D[R].y)}return{flattened:E,holeIndices:x}})(e);let d;this._initializeVertices(o);try{const y=(function(E,D,R=2){const L=D&&D.length,B=L?D[0]*R:E.length;let V=Nd(E,0,B,R,!0);const U=[];if(!V||V.next===V.prev)return U;let q,Y,se;if(L&&(V=(function(Q,J,le,he){const Ae=[];for(let Ve=0,Fe=J.length;Ve<Fe;Ve++){const $e=Nd(Q,J[Ve]*he,Ve<Fe-1?J[Ve+1]*he:Q.length,he,!1);$e===$e.next&&($e.steiner=!0),Ae.push(O_($e))}Ae.sort(tr);for(let Ve=0;Ve<Ae.length;Ve++)le=Qp(Ae[Ve],le);return le})(E,D,V,R)),E.length>80*R){q=E[0],Y=E[1];let Q=q,J=Y;for(let le=R;le<B;le+=R){const he=E[le],Ae=E[le+1];he<q&&(q=he),Ae<Y&&(Y=Ae),he>Q&&(Q=he),Ae>J&&(J=Ae)}se=Math.max(Q-q,J-Y),se=se!==0?32767/se:0}return bc(V,U,R,q,Y,se,0),U})(o,u),x=this._convertIndices(o,y);d=this._subdivideTrianglesScanline(x)}catch(y){console.error(y)}let p=[];return i&&(p=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(d),{verticesFlattened:this._vertexBuffer,indicesTriangles:d,indicesLineList:p}}_convertIndices(e,i){const o=[];for(let u=0;u<i.length;u++)o.push(this._vertexToIndex(e[2*i[u]],e[2*i[u]+1]));return o}_pointArrayToIndices(e){const i=[];for(let o=0;o<e.length;o++){const u=e[o];i.push(this._vertexToIndex(u.x,u.y))}return i}}function Gd(n,e,i,o=!0){return new yl(i,e).subdividePolygonInternal(n,o)}function vl(n,e,i=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const o=n[0],u=n[n.length-1],d=i&&(o.x!==u.x||o.y!==u.y);if(e<2)return d?[...n,n[0]]:[...n];const p=Math.floor(Mt/e),y=[];y.push(new ne(n[0].x,n[0].y));const x=n.length,E=d?x:x-1;for(let D=0;D<E;D++){const R=n[D],L=D<x-1?n[D+1]:n[0],B=R.x,V=R.y,U=L.x,q=L.y,Y=B!==U,se=V!==q;if(!Y&&!se)continue;const Q=U-B,J=q-V,le=Math.abs(Q),he=Math.abs(J);let Ae=B,Ve=V;for(;;){const $e=Q>0?(Math.floor(Ae/p)+1)*p:(Math.ceil(Ae/p)-1)*p,st=J>0?(Math.floor(Ve/p)+1)*p:(Math.ceil(Ve/p)-1)*p,Qe=Math.abs(Ae-$e),Ne=Math.abs(Ve-st),Oe=Math.abs(Ae-U),dt=Math.abs(Ve-q),ct=Y?Qe/le:Number.POSITIVE_INFINITY,mt=se?Ne/he:Number.POSITIVE_INFINITY;if((Oe<=Qe||!Y)&&(dt<=Ne||!se))break;if(ct<mt&&Y||!se){Ae=$e,Ve+=J*ct;const lt=new ne(Ae,Math.round(Ve));y[y.length-1].x===lt.x&&y[y.length-1].y===lt.y||y.push(lt)}else{Ae+=Q*mt,Ve=st;const lt=new ne(Math.round(Ae),Ve);y[y.length-1].x===lt.x&&y[y.length-1].y===lt.y||y.push(lt)}}const Fe=new ne(U,q);y[y.length-1].x===Fe.x&&y[y.length-1].y===Fe.y||y.push(Fe)}return y}function Qs(n,e,i){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let o=0,u=n[2*e[0]];for(let x=1;x<e.length;x++){const E=n[2*e[x]];E<u&&(u=E,o=x)}const d=e.length;let p=o,y=(p+1)%d;for(;;){const x=p-1>=0?p-1:d-1,E=(y+1)%d,D=n[2*e[x]],R=n[2*e[E]],L=n[2*e[p]],B=n[2*e[p]+1],V=n[2*e[y]+1];let U=!1;if(D<R)U=!0;else if(D>R)U=!1;else{const q=V-B,Y=-(n[2*e[y]]-L),se=B<V?1:-1;((D-L)*q+(n[2*e[x]+1]-B)*Y)*se>((R-L)*q+(n[2*e[E]+1]-B)*Y)*se&&(U=!0)}if(U){const q=e[x],Y=e[p],se=e[y];q!==Y&&q!==se&&Y!==se&&i.push(se,Y,q),p--,p<0&&(p=d-1)}else{const q=e[E],Y=e[p],se=e[y];q!==Y&&q!==se&&Y!==se&&i.push(se,Y,q),y++,y>=d&&(y=0)}if(x===E)break}}function Jp(n,e,i,o,u,d,p,y,x){const E=u.length/2,D=p&&y&&x;if(E<at.MAX_VERTEX_ARRAY_LENGTH){const R=e.prepareSegment(E,i,o),L=R.vertexLength;for(let U=0;U<d.length;U+=3)o.emplaceBack(L+d[U],L+d[U+1],L+d[U+2]);let B,V;R.vertexLength+=E,R.primitiveLength+=d.length/3,D&&(V=p.prepareSegment(E,i,y),B=V.vertexLength,V.vertexLength+=E);for(let U=0;U<u.length;U+=2)n(u[U],u[U+1]);if(D)for(let U=0;U<x.length;U++){const q=x[U];for(let Y=1;Y<q.length;Y+=2)y.emplaceBack(B+q[Y-1],B+q[Y]);V.primitiveLength+=q.length/2}}else(function(R,L,B,V,U,q){const Y=[];for(let he=0;he<V.length/2;he++)Y.push(-1);const se={count:0};let Q=0,J=R.getOrCreateLatestSegment(L,B),le=J.vertexLength;for(let he=2;he<U.length;he+=3){const Ae=U[he-2],Ve=U[he-1],Fe=U[he];let $e=Y[Ae]<Q,st=Y[Ve]<Q,Qe=Y[Fe]<Q;J.vertexLength+(($e?1:0)+(st?1:0)+(Qe?1:0))>at.MAX_VERTEX_ARRAY_LENGTH&&(J=R.createNewSegment(L,B),Q=se.count,$e=!0,st=!0,Qe=!0,le=0);const Ne=Ro(Y,V,q,se,Ae,$e,J),Oe=Ro(Y,V,q,se,Ve,st,J),dt=Ro(Y,V,q,se,Fe,Qe,J);B.emplaceBack(le+Ne-Q,le+Oe-Q,le+dt-Q),J.primitiveLength++}})(e,i,o,u,d,n),D&&(function(R,L,B,V,U,q){const Y=[];for(let he=0;he<V.length/2;he++)Y.push(-1);const se={count:0};let Q=0,J=R.getOrCreateLatestSegment(L,B),le=J.vertexLength;for(let he=0;he<U.length;he++){const Ae=U[he];for(let Ve=1;Ve<U[he].length;Ve+=2){const Fe=Ae[Ve-1],$e=Ae[Ve];let st=Y[Fe]<Q,Qe=Y[$e]<Q;J.vertexLength+((st?1:0)+(Qe?1:0))>at.MAX_VERTEX_ARRAY_LENGTH&&(J=R.createNewSegment(L,B),Q=se.count,st=!0,Qe=!0,le=0);const Ne=Ro(Y,V,q,se,Fe,st,J),Oe=Ro(Y,V,q,se,$e,Qe,J);B.emplaceBack(le+Ne-Q,le+Oe-Q),J.primitiveLength++}}})(p,i,y,u,x,n),e.forceNewSegmentOnNextPrepare(),p?.forceNewSegmentOnNextPrepare()}function Ro(n,e,i,o,u,d,p){if(d){const y=o.count;return i(e[2*u],e[2*u+1]),n[u]=o.count,o.count++,p.vertexLength++,y}return n[u]}class xc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new te,this.indexArray=new Pe,this.indexArray2=new tt,this.programConfigurations=new Co(e.layers,e.zoom),this.segments=new at,this.segments2=new at,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.hasDependencies=Ya("fill",this.layers,i);const u=this.layers[0].layout.get("fill-sort-key"),d=!u.isConstant(),p=[];for(const{feature:y,id:x,index:E,sourceLayerIndex:D}of e){const R=this.layers[0]._featureFilter.needGeometry,L=Xa(y,R);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),L,o))continue;const B=d?u.evaluate(L,{},o,i.availableImages):void 0,V={id:x,properties:y.properties,type:y.type,sourceLayerIndex:D,index:E,geometry:R?L.geometry:Xs(y),patterns:{},sortKey:B};p.push(V)}d&&p.sort(((y,x)=>y.sortKey-x.sortKey));for(const y of p){const{geometry:x,index:E,sourceLayerIndex:D}=y;if(this.hasDependencies){const R=jd("fill",this.layers,y,{zoom:this.zoom},i);this.patternFeatures.push(R)}else this.addFeature(y,x,E,o,{},i.subdivisionGranularity);i.featureIndex.insert(e[E].feature,x,E,D,this.index)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}addFeatures(e,i,o){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,i,o,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,o,u,d,p){for(const y of $u(i,500)){const x=Gd(y,u,p.fill.getGranularityForZoomLevel(u.z)),E=this.layoutVertexArray;Jp(((D,R)=>{E.emplaceBack(D,R)}),this.segments,this.layoutVertexArray,this.indexArray,x.verticesFlattened,x.indicesTriangles,this.segments2,this.indexArray2,x.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:d,canonical:u})}}let _h,wc;ut("FillBucket",xc,{omit:["layers","patternFeatures"]});var gg={get paint(){return wc=wc||new Sn({"fill-antialias":new ft(Ee.paint_fill["fill-antialias"]),"fill-opacity":new _t(Ee.paint_fill["fill-opacity"]),"fill-color":new _t(Ee.paint_fill["fill-color"]),"fill-outline-color":new _t(Ee.paint_fill["fill-outline-color"]),"fill-translate":new ft(Ee.paint_fill["fill-translate"]),"fill-translate-anchor":new ft(Ee.paint_fill["fill-translate-anchor"]),"fill-pattern":new Sa(Ee.paint_fill["fill-pattern"])})},get layout(){return _h=_h||new Sn({"fill-sort-key":new _t(Ee.layout_fill["fill-sort-key"])})}};class _g extends sn{constructor(e,i){super(e,gg,i)}recalculate(e,i){super.recalculate(e,i);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new xc(e)}queryRadius(){return lf(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:i,transform:o,pixelsToTileUnits:u}){return Dd(Pd(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-o.bearingInRadians,u),i)}isTileClipped(){return!0}}const xf=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yg=Ji([{name:"a_centroid",components:2,type:"Int16"}],4),{members:qd}=xf;class yh{constructor(e,i,o,u,d){this.properties={},this.extent=o,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=u,this._values=d,e.readFields(L_,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,o=[];let u,d=1,p=0,y=0,x=0;for(;e.pos<i;){if(p<=0){const E=e.readVarint();d=7&E,p=E>>3}if(p--,d===1||d===2)y+=e.readSVarint(),x+=e.readSVarint(),d===1&&(u&&o.push(u),u=[]),u&&u.push(new ne(y,x));else{if(d!==7)throw new Error(`unknown command ${d}`);u&&u.push(u[0].clone())}}return u&&o.push(u),o}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let o=1,u=0,d=0,p=0,y=1/0,x=-1/0,E=1/0,D=-1/0;for(;e.pos<i;){if(u<=0){const R=e.readVarint();o=7&R,u=R>>3}if(u--,o===1||o===2)d+=e.readSVarint(),p+=e.readSVarint(),d<y&&(y=d),d>x&&(x=d),p<E&&(E=p),p>D&&(D=p);else if(o!==7)throw new Error(`unknown command ${o}`)}return[y,E,x,D]}toGeoJSON(e,i,o){const u=this.extent*Math.pow(2,o),d=this.extent*e,p=this.extent*i,y=this.loadGeometry();function x(L){return[360*(L.x+d)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(L.y+p)/u)*Math.PI))-90]}function E(L){return L.map(x)}let D;if(this.type===1){const L=[];for(const V of y)L.push(V[0]);const B=E(L);D=L.length===1?{type:"Point",coordinates:B[0]}:{type:"MultiPoint",coordinates:B}}else if(this.type===2){const L=y.map(E);D=L.length===1?{type:"LineString",coordinates:L[0]}:{type:"MultiLineString",coordinates:L}}else{if(this.type!==3)throw new Error("unknown feature type");{const L=vg(y),B=[];for(const V of L)B.push(V.map(E));D=B.length===1?{type:"Polygon",coordinates:B[0]}:{type:"MultiPolygon",coordinates:B}}}const R={type:"Feature",geometry:D,properties:this.properties};return this.id!=null&&(R.id=this.id),R}}function L_(n,e,i){n===1?e.id=i.readVarint():n===2?(function(o,u){const d=o.readVarint()+o.pos;for(;o.pos<d;){const p=u._keys[o.readVarint()],y=u._values[o.readVarint()];u.properties[p]=y}})(i,e):n===3?e.type=i.readVarint():n===4&&(e._geometry=i.pos)}function vg(n){const e=n.length;if(e<=1)return[n];const i=[];let o,u;for(let d=0;d<e;d++){const p=ki(n[d]);p!==0&&(u===void 0&&(u=p<0),u===p<0?(o&&i.push(o),o=[n[d]]):o&&o.push(n[d]))}return o&&i.push(o),i}function ki(n){let e=0;for(let i,o,u=0,d=n.length,p=d-1;u<d;p=u++)i=n[u],o=n[p],e+=(o.x-i.x)*(i.y+o.y);return e}yh.types=["Unknown","Point","LineString","Polygon"];class tn{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(si,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new yh(this._pbf,i,this.extent,this._keys,this._values)}}function si(n,e,i){n===15?e.version=i.readVarint():n===1?e.name=i.readString():n===5?e.extent=i.readVarint():n===2?e._features.push(i.pos):n===3?e._keys.push(i.readString()):n===4&&e._values.push((function(o){let u=null;const d=o.readVarint()+o.pos;for(;o.pos<d;){const p=o.readVarint()>>3;u=p===1?o.readString():p===2?o.readFloat():p===3?o.readDouble():p===4?o.readVarint64():p===5?o.readVarint():p===6?o.readSVarint():p===7?o.readBoolean():null}if(u==null)throw new Error("unknown feature value");return u})(i))}class oi{constructor(e,i){this.layers=e.readFields(Zi,{},i)}}function Zi(n,e,i){if(n===3){const o=new tn(i,i.readVarint()+i.pos);o.length&&(e[o.name]=o)}}const ua=Math.pow(2,13);function Ms(n,e,i,o,u,d,p,y){n.emplaceBack(e,i,2*Math.floor(o*ua)+p,u*ua*2,d*ua*2,Math.round(y))}class du{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.layoutVertexArray=new ae,this.centroidVertexArray=new ee,this.indexArray=new Pe,this.programConfigurations=new Co(e.layers,e.zoom),this.segments=new at,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.features=[],this.hasDependencies=Ya("fill-extrusion",this.layers,i);for(const{feature:u,id:d,index:p,sourceLayerIndex:y}of e){const x=this.layers[0]._featureFilter.needGeometry,E=Xa(u,x);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),E,o))continue;const D={id:d,sourceLayerIndex:y,index:p,geometry:x?E.geometry:Xs(u),properties:u.properties,type:u.type,patterns:{}};this.hasDependencies?this.features.push(jd("fill-extrusion",this.layers,D,{zoom:this.zoom},i)):this.addFeature(D,D.geometry,p,o,{},i.subdivisionGranularity),i.featureIndex.insert(u,D.geometry,p,y,this.index,!0)}}addFeatures(e,i,o){for(const u of this.features){const{geometry:d}=u;this.addFeature(u,d,u.index,i,o,e.subdivisionGranularity)}}update(e,i,o){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,qd),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,yg.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,i,o,u,d,p){for(const y of $u(i,500)){const x={x:0,y:0,sampleCount:0},E=this.layoutVertexArray.length;this.processPolygon(x,u,e,y,p);const D=this.layoutVertexArray.length-E,R=Math.floor(x.x/x.sampleCount),L=Math.floor(x.y/x.sampleCount);for(let B=0;B<D;B++)this.centroidVertexArray.emplaceBack(R,L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:d,canonical:u})}processPolygon(e,i,o,u,d){if(u.length<1||On(u[0]))return;for(const R of u)R.length!==0&&em(e,R);const p={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},y=d.fill.getGranularityForZoomLevel(i.z),x=yh.types[o.type]==="Polygon";for(const R of u){if(R.length===0||On(R))continue;const L=vl(R,y,x);this._generateSideFaces(L,p)}if(!x)return;const E=Gd(u,i,y,!1),D=this.layoutVertexArray;Jp(((R,L)=>{Ms(D,R,L,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,E.verticesFlattened,E.indicesTriangles)}_generateSideFaces(e,i){let o=0;for(let u=1;u<e.length;u++){const d=e[u],p=e[u-1];if(bl(d,p))continue;i.segment.vertexLength+4>at.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const y=d.sub(p)._perp()._unit(),x=p.dist(d);o+x>32768&&(o=0),Ms(this.layoutVertexArray,d.x,d.y,y.x,y.y,0,0,o),Ms(this.layoutVertexArray,d.x,d.y,y.x,y.y,0,1,o),o+=x,Ms(this.layoutVertexArray,p.x,p.y,y.x,y.y,0,0,o),Ms(this.layoutVertexArray,p.x,p.y,y.x,y.y,0,1,o);const E=i.segment.vertexLength;this.indexArray.emplaceBack(E,E+2,E+1),this.indexArray.emplaceBack(E+1,E+2,E+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function em(n,e){for(let i=0;i<e.length;i++){const o=e[i];i===e.length-1&&e[0].x===o.x&&e[0].y===o.y||(n.x+=o.x,n.y+=o.y,n.sampleCount++)}}function bl(n,e){return n.x===e.x&&(n.x<0||n.x>Mt)||n.y===e.y&&(n.y<0||n.y>Mt)}function On(n){return n.every((e=>e.x<0))||n.every((e=>e.x>Mt))||n.every((e=>e.y<0))||n.every((e=>e.y>Mt))}let xl;ut("FillExtrusionBucket",du,{omit:["layers","features"]});var Tc={get paint(){return xl=xl||new Sn({"fill-extrusion-opacity":new ft(Ee["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _t(Ee["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ft(Ee["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ft(Ee["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Sa(Ee["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _t(Ee["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _t(Ee["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ft(Ee["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class tm extends sn{constructor(e,i){super(e,Tc,i)}createBucket(e){return new du(e)}queryRadius(){return lf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:d,pixelsToTileUnits:p,pixelPosMatrix:y}){const x=Pd(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-d.bearingInRadians,p),E=this.paint.get("fill-extrusion-height").evaluate(i,o),D=this.paint.get("fill-extrusion-base").evaluate(i,o),R=(function(B,V){const U=[];for(const q of B){const Y=[q.x,q.y,0,1];$r(Y,Y,V),U.push(new ne(Y[0]/Y[3],Y[1]/Y[3]))}return U})(x,y),L=(function(B,V,U,q){const Y=[],se=[],Q=q[8]*V,J=q[9]*V,le=q[10]*V,he=q[11]*V,Ae=q[8]*U,Ve=q[9]*U,Fe=q[10]*U,$e=q[11]*U;for(const st of B){const Qe=[],Ne=[];for(const Oe of st){const dt=Oe.x,ct=Oe.y,mt=q[0]*dt+q[4]*ct+q[12],lt=q[1]*dt+q[5]*ct+q[13],Tt=q[2]*dt+q[6]*ct+q[14],fi=q[3]*dt+q[7]*ct+q[15],Wt=Tt+le,bn=fi+he,Zr=mt+Ae,sr=lt+Ve,xn=Tt+Fe,ln=fi+$e,zi=new ne((mt+Q)/bn,(lt+J)/bn);zi.z=Wt/bn,Qe.push(zi);const Ln=new ne(Zr/ln,sr/ln);Ln.z=xn/ln,Ne.push(Ln)}Y.push(Qe),se.push(Ne)}return[Y,se]})(u,D,E,y);return(function(B,V,U){let q=1/0;Dd(U,V)&&(q=Sc(U,V[0]));for(let Y=0;Y<V.length;Y++){const se=V[Y],Q=B[Y];for(let J=0;J<se.length-1;J++){const le=se[J],he=[le,se[J+1],Q[J+1],Q[J],le];vc(U,he)&&(q=Math.min(q,Sc(U,he)))}}return q!==1/0&&q})(L[0],L[1],R)}}function Pr(n,e){return n.x*e.x+n.y*e.y}function Sc(n,e){if(n.length===1){let i=0;const o=e[i++];let u;for(;!u||o.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const d=e[i],p=n[0],y=u.sub(o),x=d.sub(o),E=p.sub(o),D=Pr(y,y),R=Pr(y,x),L=Pr(x,x),B=Pr(E,y),V=Pr(E,x),U=D*L-R*R,q=(L*B-R*V)/U,Y=(D*V-R*B)/U,se=o.z*(1-q-Y)+u.z*q+d.z*Y;if(isFinite(se))return se}return 1/0}{let i=1/0;for(const o of e)i=Math.min(i,o.z);return i}}const wf=Ji([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:za}=wf,im=Ji([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Zd}=im,bg=Math.cos(Math.PI/180*37.5),Tf=Math.pow(2,14)/.5;class vh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((i=>i.id)),this.index=e.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((i=>{this.gradients[i.id]={}})),this.layoutVertexArray=new ce,this.layoutVertexArray2=new re,this.indexArray=new Pe,this.programConfigurations=new Co(e.layers,e.zoom),this.segments=new at,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((i=>i.isStateDependent())).map((i=>i.id))}populate(e,i,o){this.hasDependencies=Ya("line",this.layers,i)||this.hasLineDasharray(this.layers);const u=this.layers[0].layout.get("line-sort-key"),d=!u.isConstant(),p=[];for(const{feature:y,id:x,index:E,sourceLayerIndex:D}of e){const R=this.layers[0]._featureFilter.needGeometry,L=Xa(y,R);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),L,o))continue;const B=d?u.evaluate(L,{},o):void 0,V={id:x,properties:y.properties,type:y.type,sourceLayerIndex:D,index:E,geometry:R?L.geometry:Xs(y),patterns:{},dashes:{},sortKey:B};p.push(V)}d&&p.sort(((y,x)=>y.sortKey-x.sortKey));for(const y of p){const{geometry:x,index:E,sourceLayerIndex:D}=y;this.hasDependencies?(Ya("line",this.layers,i)?jd("line",this.layers,y,{zoom:this.zoom},i):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,y,this.zoom,i),this.patternFeatures.push(y)):this.addFeature(y,x,E,o,{},{},i.subdivisionGranularity),i.featureIndex.insert(e[E].feature,x,E,D,this.index)}}update(e,i,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,{imagePositions:o,dashPositions:u})}addFeatures(e,i,o,u){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,i,o,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Zd)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,za),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,o,u,d,p,y){const x=this.layers[0].layout,E=x.get("line-join").evaluate(e,{}),D=x.get("line-cap"),R=x.get("line-miter-limit"),L=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const B of i)this.addLine(B,e,E,D,R,L,u,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,o,{imagePositions:d,dashPositions:p,canonical:u})}addLine(e,i,o,u,d,p,y,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=vl(e,y?x.line.getGranularityForZoomLevel(y.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=yh.types[i.type]==="Polygon";let D=e.length;for(;D>=2&&e[D-1].equals(e[D-2]);)D--;let R=0;for(;R<D-1&&e[R].equals(e[R+1]);)R++;if(D<(E?3:2))return;o==="bevel"&&(d=1.05);const L=this.overscaling<=16?122880/(512*this.overscaling):0,B=this.segments.prepareSegment(10*D,this.layoutVertexArray,this.indexArray);let V,U,q,Y,se;this.e1=this.e2=-1,E&&(V=e[D-2],se=e[R].sub(V)._unit()._perp());for(let Q=R;Q<D;Q++){if(q=Q===D-1?E?e[R+1]:void 0:e[Q+1],q&&e[Q].equals(q))continue;se&&(Y=se),V&&(U=V),V=e[Q],se=q?q.sub(V)._unit()._perp():Y,Y=Y||se;let J=Y.add(se);J.x===0&&J.y===0||J._unit();const le=Y.x*se.x+Y.y*se.y,he=J.x*se.x+J.y*se.y,Ae=he!==0?1/he:1/0,Ve=2*Math.sqrt(2-2*he),Fe=he<bg&&U&&q,$e=Y.x*se.y-Y.y*se.x>0;if(Fe&&Q>R){const Ne=V.dist(U);if(Ne>2*L){const Oe=V.sub(V.sub(U)._mult(L/Ne)._round());this.updateDistance(U,Oe),this.addCurrentVertex(Oe,Y,0,0,B),U=Oe}}const st=U&&q;let Qe=st?o:E?"butt":u;if(st&&Qe==="round"&&(Ae<p?Qe="miter":Ae<=2&&(Qe="fakeround")),Qe==="miter"&&Ae>d&&(Qe="bevel"),Qe==="bevel"&&(Ae>2&&(Qe="flipbevel"),Ae<d&&(Qe="miter")),U&&this.updateDistance(U,V),Qe==="miter")J._mult(Ae),this.addCurrentVertex(V,J,0,0,B);else if(Qe==="flipbevel"){if(Ae>100)J=se.mult(-1);else{const Ne=Ae*Y.add(se).mag()/Y.sub(se).mag();J._perp()._mult(Ne*($e?-1:1))}this.addCurrentVertex(V,J,0,0,B),this.addCurrentVertex(V,J.mult(-1),0,0,B)}else if(Qe==="bevel"||Qe==="fakeround"){const Ne=-Math.sqrt(Ae*Ae-1),Oe=$e?Ne:0,dt=$e?0:Ne;if(U&&this.addCurrentVertex(V,Y,Oe,dt,B),Qe==="fakeround"){const ct=Math.round(180*Ve/Math.PI/20);for(let mt=1;mt<ct;mt++){let lt=mt/ct;if(lt!==.5){const fi=lt-.5;lt+=lt*fi*(lt-1)*((1.0904+le*(le*(3.55645-1.43519*le)-3.2452))*fi*fi+(.848013+le*(.215638*le-1.06021)))}const Tt=se.sub(Y)._mult(lt)._add(Y)._unit()._mult($e?-1:1);this.addHalfVertex(V,Tt.x,Tt.y,!1,$e,0,B)}}q&&this.addCurrentVertex(V,se,-Oe,-dt,B)}else if(Qe==="butt")this.addCurrentVertex(V,J,0,0,B);else if(Qe==="square"){const Ne=U?1:-1;this.addCurrentVertex(V,J,Ne,Ne,B)}else Qe==="round"&&(U&&(this.addCurrentVertex(V,Y,0,0,B),this.addCurrentVertex(V,Y,1,1,B,!0)),q&&(this.addCurrentVertex(V,se,-1,-1,B,!0),this.addCurrentVertex(V,se,0,0,B)));if(Fe&&Q<D-1){const Ne=V.dist(q);if(Ne>2*L){const Oe=V.add(q.sub(V)._mult(L/Ne)._round());this.updateDistance(V,Oe),this.addCurrentVertex(Oe,se,0,0,B),V=Oe}}}}addCurrentVertex(e,i,o,u,d,p=!1){const y=i.y*u-i.x,x=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*o,i.y-i.x*o,p,!1,o,d),this.addHalfVertex(e,y,x,p,!0,-u,d),this.distance>Tf/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,i,o,u,d,p))}addHalfVertex({x:e,y:i},o,u,d,p,y,x){const E=.5*(this.lineClips?this.scaledDistance*(Tf-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(d?1:0),(i<<1)+(p?1:0),Math.round(63*o)+128,Math.round(63*u)+128,1+(y===0?0:y<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const D=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,D,this.e2),x.primitiveLength++),p?this.e2=D:this.e1=D}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}hasLineDasharray(e){for(const i of e){const o=i.paint.get("line-dasharray");if(o&&!o.isConstant())return!0}return!1}addLineDashDependencies(e,i,o,u){for(const d of e){const p=d.paint.get("line-dasharray");if(!p||p.value.kind==="constant")continue;const y=d.layout.get("line-cap")==="round",x={dasharray:p.value.evaluate({zoom:o-1},i,{}),round:y},E={dasharray:p.value.evaluate({zoom:o},i,{}),round:y},D={dasharray:p.value.evaluate({zoom:o+1},i,{}),round:y},R=`${x.dasharray.join(",")},${x.round}`,L=`${E.dasharray.join(",")},${E.round}`,B=`${D.dasharray.join(",")},${D.round}`;u.dashDependencies[R]=x,u.dashDependencies[L]=E,u.dashDependencies[B]=D,i.dashes[d.id]={min:R,mid:L,max:B}}}}let wl,nr;ut("LineBucket",vh,{omit:["layers","patternFeatures"]});var Tl={get paint(){return nr=nr||new Sn({"line-opacity":new _t(Ee.paint_line["line-opacity"]),"line-color":new _t(Ee.paint_line["line-color"]),"line-translate":new ft(Ee.paint_line["line-translate"]),"line-translate-anchor":new ft(Ee.paint_line["line-translate-anchor"]),"line-width":new _t(Ee.paint_line["line-width"]),"line-gap-width":new _t(Ee.paint_line["line-gap-width"]),"line-offset":new _t(Ee.paint_line["line-offset"]),"line-blur":new _t(Ee.paint_line["line-blur"]),"line-dasharray":new Sa(Ee.paint_line["line-dasharray"]),"line-pattern":new Sa(Ee.paint_line["line-pattern"]),"line-gradient":new fc(Ee.paint_line["line-gradient"])})},get layout(){return wl=wl||new Sn({"line-cap":new ft(Ee.layout_line["line-cap"]),"line-join":new _t(Ee.layout_line["line-join"]),"line-miter-limit":new ft(Ee.layout_line["line-miter-limit"]),"line-round-limit":new ft(Ee.layout_line["line-round-limit"]),"line-sort-key":new _t(Ee.layout_line["line-sort-key"])})}};class bh extends _t{possiblyEvaluate(e,i){return i=new xi(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(e,i)}evaluate(e,i,o,u){return i=Pi({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,o,u)}}let As;class nm extends sn{constructor(e,i){super(e,Tl,i),this.gradientVersion=0,As||(As=new bh(Tl.paint.properties["line-width"].specification),As.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!(function(o){return o._styleExpression!==void 0})(i)&&i._styleExpression.expression instanceof po,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,i){super.recalculate(e,i),this.paint._values["line-floorwidth"]=As.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new vh(e)}queryRadius(e){const i=e,o=Hd(ml("line-width",this,i),ml("line-gap-width",this,i)),u=ml("line-offset",this,i);return o/2+Math.abs(u)+lf(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:i,featureState:o,geometry:u,transform:d,pixelsToTileUnits:p}){const y=Pd(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-d.bearingInRadians,p),x=p/2*Hd(this.paint.get("line-width").evaluate(i,o),this.paint.get("line-gap-width").evaluate(i,o)),E=this.paint.get("line-offset").evaluate(i,o);return E&&(u=(function(D,R){const L=[];for(let B=0;B<D.length;B++){const V=Id(D[B]),U=[];for(let q=0;q<V.length;q++){const Y=V[q],se=V[q-1],Q=V[q+1],J=q===0?new ne(0,0):Y.sub(se)._unit()._perp(),le=q===V.length-1?new ne(0,0):Q.sub(Y)._unit()._perp(),he=J._add(le)._unit(),Ae=he.x*le.x+he.y*le.y;Ae!==0&&he._mult(1/Ae),U.push(he._mult(R)._add(Y))}L.push(U)}return L})(u,E*p)),(function(D,R,L){for(let B=0;B<R.length;B++){const V=R[B];if(D.length>=3){for(let U=0;U<V.length;U++)if(zo(D,V[U]))return!0}if(er(D,V,L))return!0}return!1})(y,u,x)}isTileClipped(){return!0}}function Hd(n,e){return e>0?e+2*n:n}const xg=Ji([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Sf=Ji([{name:"a_projected_pos",components:3,type:"Float32"}],4);Ji([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const rm=Ji([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Ji([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Pa=Ji([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),wg=Ji([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Ia(n,e,i){return n.sections.forEach((o=>{o.text=(function(u,d,p){const y=d.layout.get("text-transform").evaluate(p,{});return y==="uppercase"?u=u.toLocaleUpperCase():y==="lowercase"&&(u=u.toLocaleLowerCase()),Ta.applyArabicShaping&&(u=Ta.applyArabicShaping(u)),u})(o.text,e,i)})),n}Ji([{name:"triangle",components:3,type:"Uint16"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ji([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Ji([{type:"Float32",name:"offsetX"}]),Ji([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Ji([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var Xn=24;const xh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},B_={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},pu={40:!0};function Ef(n,e,i,o,u,d){if("fontStack"in e){const p=i[e.fontStack],y=p&&p[n];return y?y.metrics.advance*e.scale+u:0}{const p=o[e.imageName];return p?p.displaySize[0]*e.scale*Xn/d+u:0}}function $d(n,e,i,o){const u=Math.pow(n-e,2);return o?n<e?u/2:2*u:u+Math.abs(i)*i}function wh(n,e,i){let o=0;return n===10&&(o-=1e4),i&&(o+=150),n!==40&&n!==65288||(o+=50),e!==41&&e!==65289||(o+=50),o}function am(n,e,i,o,u,d){let p=null,y=$d(e,i,u,d);for(const x of o){const E=$d(e-x.x,i,u,d)+x.badness;E<=y&&(p=x,y=E)}return{index:n,x:e,priorBreak:p,badness:y}}function sm(n){return n?sm(n.priorBreak).concat(n.index):[]}class Ec{constructor(e="",i=[],o=[]){this.text=e,this.sections=i,this.sectionIndex=o,this.imageSectionID=null}static fromFeature(e,i){const o=new Ec;for(let u=0;u<e.sections.length;u++){const d=e.sections[u];d.image?o.addImageSection(d):o.addTextSection(d,i)}return o}length(){return[...this.text].length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}verticalizePunctuation(){this.text=(function(e){let i="",o={premature:!0,value:void 0};const u=e[Symbol.iterator]();let d=u.next();const p=e[Symbol.iterator]();p.next();let y=p.next();for(;!d.done;)i+=!y.done&&xs(y.value.codePointAt(0))&&!xh[y.value]||!o.premature&&xs(o.value.codePointAt(0))&&!xh[o.value]||!xh[d.value]?d.value:xh[d.value],o={value:d.value,premature:!1},d=u.next(),y=p.next();return i})(this.text)}hasZeroWidthSpaces(){return this.text.includes("")}trim(){const e=this.text.match(/^\s*/),i=e?e[0].length:0,o=this.text.match(/\S\s*$/),u=o?o[0].length-1:0;this.text=this.text.substring(i,this.text.length-u),this.sectionIndex=this.sectionIndex.slice(i,this.sectionIndex.length-u)}substring(e,i){const o=[...this.text].slice(e,i).join(""),u=this.sectionIndex.slice(e,i);return new Ec(o,this.sections,u)}toCodeUnitIndex(e){return[...this.text].slice(0,e).join("").length}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,i)=>Math.max(e,this.sections[i].scale)),0)}getMaxImageSize(e){let i=0,o=0;for(let u=0;u<this.length();u++){const d=this.getSection(u);if("imageName"in d){const p=e[d.imageName];if(!p)continue;const y=p.displaySize;i=Math.max(i,y[0]),o=Math.max(o,y[1])}}return{maxImageWidth:i,maxImageHeight:o}}addTextSection(e,i){this.text+=e.text,this.sections.push({scale:e.scale||1,verticalAlign:e.verticalAlign||"bottom",fontStack:e.fontStack||i});const o=this.sections.length-1;this.sectionIndex.push(...[...e.text].map((()=>o)))}addImageSection(e){const i=e.image?e.image.name:"";if(i.length===0)return void rn("Can't add FormattedSection with an empty image.");const o=this.getNextImageSectionCharCode();o?(this.text+=String.fromCharCode(o),this.sections.push({scale:1,verticalAlign:e.verticalAlign||"bottom",imageName:i}),this.sectionIndex.push(this.sections.length-1)):rn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}determineLineBreaks(e,i,o,u,d){const p=[],y=this.determineAverageLineWidth(e,i,o,u,d),x=this.hasZeroWidthSpaces();let E=0,D=0;const R=this.text[Symbol.iterator]();let L=R.next();const B=this.text[Symbol.iterator]();B.next();let V=B.next();const U=this.text[Symbol.iterator]();U.next(),U.next();let q=U.next();for(;!L.done;){const Y=this.getSection(D),se=L.value.codePointAt(0);if(oc(se)||(E+=Ef(se,Y,o,u,e,d)),!V.done){const Q=ys(se),J=V.value.codePointAt(0);(B_[se]||Q||"imageName"in Y||!q.done&&pu[J])&&p.push(am(D+1,E,y,p,wh(se,J,Q&&x),!1))}D++,L=R.next(),V=B.next(),q=U.next()}return sm(am(this.length(),E,y,p,0,!0))}determineAverageLineWidth(e,i,o,u,d){let p=0,y=0;for(const x of this.text){const E=this.getSection(y);p+=Ef(x.codePointAt(0),E,o,u,e,d),y++}return p/Math.max(1,Math.ceil(p/i))}}const Xd=4294967296,Mf=1/Xd,Yd=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Qd{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,i,o=this.length){for(;this.pos<o;){const u=this.readVarint(),d=u>>3,p=this.pos;this.type=7&u,e(d,i,this),this.pos===p&&this.skip(u)}return i}readMessage(e,i){return this.readFields(e,i,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Xd;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Xd;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const i=this.buf;let o,u;return u=i[this.pos++],o=127&u,u<128?o:(u=i[this.pos++],o|=(127&u)<<7,u<128?o:(u=i[this.pos++],o|=(127&u)<<14,u<128?o:(u=i[this.pos++],o|=(127&u)<<21,u<128?o:(u=i[this.pos],o|=(15&u)<<28,(function(d,p,y){const x=y.buf;let E,D;if(D=x[y.pos++],E=(112&D)>>4,D<128||(D=x[y.pos++],E|=(127&D)<<3,D<128)||(D=x[y.pos++],E|=(127&D)<<10,D<128)||(D=x[y.pos++],E|=(127&D)<<17,D<128)||(D=x[y.pos++],E|=(127&D)<<24,D<128)||(D=x[y.pos++],E|=(1&D)<<31,D<128))return Th(d,E,p);throw new Error("Expected varint not more than 10 bytes")})(o,e,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2==1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,i=this.pos;return this.pos=e,e-i>=12&&Yd?Yd.decode(this.buf.subarray(i,e)):(function(o,u,d){let p="",y=u;for(;y<d;){const x=o[y];let E,D,R,L=null,B=x>239?4:x>223?3:x>191?2:1;if(y+B>d)break;B===1?x<128&&(L=x):B===2?(E=o[y+1],(192&E)==128&&(L=(31&x)<<6|63&E,L<=127&&(L=null))):B===3?(E=o[y+1],D=o[y+2],(192&E)==128&&(192&D)==128&&(L=(15&x)<<12|(63&E)<<6|63&D,(L<=2047||L>=55296&&L<=57343)&&(L=null))):B===4&&(E=o[y+1],D=o[y+2],R=o[y+3],(192&E)==128&&(192&D)==128&&(192&R)==128&&(L=(15&x)<<18|(63&E)<<12|(63&D)<<6|63&R,(L<=65535||L>=1114112)&&(L=null))),L===null?(L=65533,B=1):L>65535&&(L-=65536,p+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),p+=String.fromCharCode(L),y+=B}return p})(this.buf,i,e)}readBytes(){const e=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,e);return this.pos=e,i}readPackedVarint(e=[],i){const o=this.readPackedEnd();for(;this.pos<o;)e.push(this.readVarint(i));return e}readPackedSVarint(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const i=this.readPackedEnd();for(;this.pos<i;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(e){const i=7&e;if(i===0)for(;this.buf[this.pos++]>127;);else if(i===2)this.pos=this.readVarint()+this.pos;else if(i===5)this.pos+=4;else{if(i!==1)throw new Error(`Unimplemented type: ${i}`);this.pos+=8}}writeTag(e,i){this.writeVarint(e<<3|i)}realloc(e){let i=this.length||16;for(;i<this.pos+e;)i*=2;if(i!==this.length){const o=new Uint8Array(i);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=i}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Mf),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,-1&e,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*Mf),!0),this.pos+=8}writeVarint(e){(e=+e||0)>268435455||e<0?(function(i,o){let u,d;if(i>=0?(u=i%4294967296|0,d=i/4294967296|0):(u=~(-i%4294967296),d=~(-i/4294967296),4294967295^u?u=u+1|0:(u=0,d=d+1|0)),i>=18446744073709552e3||i<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(p,y,x){x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,p>>>=7,x.buf[x.pos++]=127&p|128,x.buf[x.pos]=127&(p>>>=7)})(u,0,o),(function(p,y){const x=(7&p)<<4;y.buf[y.pos++]|=x|((p>>>=3)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p|((p>>>=7)?128:0),p&&(y.buf[y.pos++]=127&p)))))})(d,o)})(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))}writeSVarint(e){this.writeVarint(e<0?2*-e-1:2*e)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(4*e.length),this.pos++;const i=this.pos;this.pos=(function(u,d,p){for(let y,x,E=0;E<d.length;E++){if(y=d.charCodeAt(E),y>55295&&y<57344){if(!x){y>56319||E+1===d.length?(u[p++]=239,u[p++]=191,u[p++]=189):x=y;continue}if(y<56320){u[p++]=239,u[p++]=191,u[p++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(u[p++]=239,u[p++]=191,u[p++]=189,x=null);y<128?u[p++]=y:(y<2048?u[p++]=y>>6|192:(y<65536?u[p++]=y>>12|224:(u[p++]=y>>18|240,u[p++]=y>>12&63|128),u[p++]=y>>6&63|128),u[p++]=63&y|128)}return p})(this.buf,e,this.pos);const o=this.pos-i;o>=128&&Tg(i,o,this),this.pos=i-1,this.writeVarint(o),this.pos+=o}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const i=e.length;this.writeVarint(i),this.realloc(i);for(let o=0;o<i;o++)this.buf[this.pos++]=e[o]}writeRawMessage(e,i){this.pos++;const o=this.pos;e(i,this);const u=this.pos-o;u>=128&&Tg(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u}writeMessage(e,i,o){this.writeTag(e,2),this.writeRawMessage(i,o)}writePackedVarint(e,i){i.length&&this.writeMessage(e,Sg,i)}writePackedSVarint(e,i){i.length&&this.writeMessage(e,Eg,i)}writePackedBoolean(e,i){i.length&&this.writeMessage(e,Mg,i)}writePackedFloat(e,i){i.length&&this.writeMessage(e,Sh,i)}writePackedDouble(e,i){i.length&&this.writeMessage(e,Kd,i)}writePackedFixed32(e,i){i.length&&this.writeMessage(e,Ag,i)}writePackedSFixed32(e,i){i.length&&this.writeMessage(e,Cg,i)}writePackedFixed64(e,i){i.length&&this.writeMessage(e,Dg,i)}writePackedSFixed64(e,i){i.length&&this.writeMessage(e,zg,i)}writeBytesField(e,i){this.writeTag(e,2),this.writeBytes(i)}writeFixed32Field(e,i){this.writeTag(e,5),this.writeFixed32(i)}writeSFixed32Field(e,i){this.writeTag(e,5),this.writeSFixed32(i)}writeFixed64Field(e,i){this.writeTag(e,1),this.writeFixed64(i)}writeSFixed64Field(e,i){this.writeTag(e,1),this.writeSFixed64(i)}writeVarintField(e,i){this.writeTag(e,0),this.writeVarint(i)}writeSVarintField(e,i){this.writeTag(e,0),this.writeSVarint(i)}writeStringField(e,i){this.writeTag(e,2),this.writeString(i)}writeFloatField(e,i){this.writeTag(e,5),this.writeFloat(i)}writeDoubleField(e,i){this.writeTag(e,1),this.writeDouble(i)}writeBooleanField(e,i){this.writeVarintField(e,+i)}}function Th(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function Tg(n,e,i){const o=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(o);for(let u=i.pos-1;u>=n;u--)i.buf[u+o]=i.buf[u]}function Sg(n,e){for(let i=0;i<n.length;i++)e.writeVarint(n[i])}function Eg(n,e){for(let i=0;i<n.length;i++)e.writeSVarint(n[i])}function Sh(n,e){for(let i=0;i<n.length;i++)e.writeFloat(n[i])}function Kd(n,e){for(let i=0;i<n.length;i++)e.writeDouble(n[i])}function Mg(n,e){for(let i=0;i<n.length;i++)e.writeBoolean(n[i])}function Ag(n,e){for(let i=0;i<n.length;i++)e.writeFixed32(n[i])}function Cg(n,e){for(let i=0;i<n.length;i++)e.writeSFixed32(n[i])}function Dg(n,e){for(let i=0;i<n.length;i++)e.writeFixed64(n[i])}function zg(n,e){for(let i=0;i<n.length;i++)e.writeSFixed64(n[i])}function Pg(n,e,i){n===1&&i.readMessage(Wd,e)}function Wd(n,e,i){if(n===3){const{id:o,bitmap:u,width:d,height:p,left:y,top:x,advance:E}=i.readMessage(Ig,{});e.push({id:o,bitmap:new hf({width:d+6,height:p+6},u),metrics:{width:d,height:p,left:y,top:x,advance:E}})}}function Ig(n,e,i){n===1?e.id=i.readVarint():n===2?e.bitmap=i.readBytes():n===3?e.width=i.readVarint():n===4?e.height=i.readVarint():n===5?e.left=i.readSVarint():n===6?e.top=i.readSVarint():n===7&&(e.advance=i.readVarint())}function om(n){let e=0,i=0;for(const p of n)e+=p.w*p.h,i=Math.max(i,p.w);n.sort(((p,y)=>y.h-p.h));const o=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,d=0;for(const p of n)for(let y=o.length-1;y>=0;y--){const x=o[y];if(!(p.w>x.w||p.h>x.h)){if(p.x=x.x,p.y=x.y,d=Math.max(d,p.y+p.h),u=Math.max(u,p.x+p.w),p.w===x.w&&p.h===x.h){const E=o.pop();E&&y<o.length&&(o[y]=E)}else p.h===x.h?(x.x+=p.w,x.w-=p.w):p.w===x.w?(x.y+=p.h,x.h-=p.h):(o.push({x:x.x+p.w,y:x.y,w:x.w-p.w,h:p.h}),x.y+=p.h,x.h-=p.h);break}}return{w:u,h:d,fill:e/(u*d)||0}}class Fi{constructor(e,{pixelRatio:i,version:o,stretchX:u,stretchY:d,content:p,textFitWidth:y,textFitHeight:x}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=d,this.content=p,this.version=o,this.textFitWidth=y,this.textFitHeight=x}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Jd{constructor(e,i){const o={},u={};this.haveRenderCallbacks=[];const d=[];this.addImages(e,o,d),this.addImages(i,u,d);const{w:p,h:y}=om(d),x=new Vr({width:p||1,height:y||1});for(const E in e){const D=e[E],R=o[E].paddedRect;Vr.copy(D.data,x,{x:0,y:0},{x:R.x+1,y:R.y+1},D.data)}for(const E in i){const D=i[E],R=u[E].paddedRect,L=R.x+1,B=R.y+1,V=D.data.width,U=D.data.height;Vr.copy(D.data,x,{x:0,y:0},{x:L,y:B},D.data),Vr.copy(D.data,x,{x:0,y:U-1},{x:L,y:B-1},{width:V,height:1}),Vr.copy(D.data,x,{x:0,y:0},{x:L,y:B+U},{width:V,height:1}),Vr.copy(D.data,x,{x:V-1,y:0},{x:L-1,y:B},{width:1,height:U}),Vr.copy(D.data,x,{x:0,y:0},{x:L+V,y:B},{width:1,height:U})}this.image=x,this.iconPositions=o,this.patternPositions=u}addImages(e,i,o){for(const u in e){const d=e[u],p={x:0,y:0,w:d.data.width+2,h:d.data.height+2};o.push(p),i[u]=new Fi(p,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const o in e.updatedImages)this.patchUpdatedImage(this.iconPositions[o],e.getImage(o),i),this.patchUpdatedImage(this.patternPositions[o],e.getImage(o),i)}patchUpdatedImage(e,i,o){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,d]=e.tl;o.update(i.data,void 0,{x:u,y:d})}}var mu;function Af(n,e,i,o,u,d,p,y,x,E,D,R,L,B,V){const U=Ec.fromFeature(n,u);let q;R===P.az.vertical&&U.verticalizePunctuation();let Y=U.determineLineBreaks(E,d,e,o,B);const{processBidirectionalText:se,processStyledBidirectionalText:Q}=Ta;if(se&&U.sections.length===1){q=[],Y=Y.map((Ae=>U.toCodeUnitIndex(Ae)));const he=se(U.toString(),Y);for(const Ae of he){const Ve=[...Ae].map((()=>0));q.push(new Ec(Ae,U.sections,Ve))}}else if(Q){q=[],Y=Y.map((Fe=>U.toCodeUnitIndex(Fe)));let he=0;const Ae=[];for(const Fe of U.text)Ae.push(...Array(Fe.length).fill(U.sectionIndex[he])),he++;const Ve=Q(U.text,Ae,Y);for(const Fe of Ve){const $e=[];let st="";for(const Qe of Fe[0])$e.push(Fe[1][st.length]),st+=Qe;q.push(new Ec(Fe[0],U.sections,$e))}}else q=(function(he,Ae){const Ve=[];let Fe=0;for(const $e of Ae)Ve.push(he.substring(Fe,$e)),Fe=$e;return Fe<he.length()&&Ve.push(he.substring(Fe,he.length())),Ve})(U,Y);const J=[],le={positionedLines:J,text:U.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:R,iconsInText:!1,verticalizable:!1};return(function(he,Ae,Ve,Fe,$e,st,Qe,Ne,Oe,dt,ct,mt){let lt=0,Tt=0,fi=0,Wt=0;const bn=Ne==="right"?1:Ne==="left"?0:.5,Zr=Xn/mt;let sr=0;for(const zi of $e){zi.trim();const Ln=zi.getMaxScale(),Nn={positionedGlyphs:[],lineOffset:0};he.positionedLines[sr]=Nn;const nn=Nn.positionedGlyphs;let Wa=0;if(!zi.length()){Tt+=st,++sr;continue}const Hr=k_(Fe,zi,Zr);let Ja=0;for(const br of zi.text){const Mn=zi.getSection(Ja),or=br.codePointAt(0),Bn=ep(Oe,ct,or),xr={glyph:or,imageName:null,x:lt,y:Tt+-17,vertical:Bn,scale:1,fontStack:"",sectionIndex:zi.getSectionIndex(Ja),metrics:null,rect:null};let Dc;if("fontStack"in Mn){if(Dc=Eh(Mn,or,Bn,Hr,Ae,Ve),!Dc)continue;xr.fontStack=Mn.fontStack}else{if(he.iconsInText=!0,Mn.scale*=Zr,Dc=um(Mn,Bn,Ln,Hr,Fe),!Dc)continue;Wa=Math.max(Wa,Dc.imageOffset),xr.imageName=Mn.imageName}const{rect:Dl,metrics:Gm,baselineOffset:Lh}=Dc;xr.y+=Lh,xr.scale=Mn.scale,xr.metrics=Gm,xr.rect=Dl,nn.push(xr),Bn?(he.verticalizable=!0,lt+=("imageName"in Mn?Gm.advance:Xn)*Mn.scale+dt):lt+=Gm.advance*Mn.scale+dt,Ja++}nn.length!==0&&(fi=Math.max(lt-dt,fi),tp(nn,0,nn.length-1,bn)),lt=0,Nn.lineOffset=Math.max(Wa,(Ln-1)*Xn);const Bo=st*Ln+Wa;Tt+=Bo,Wt=Math.max(Bo,Wt),++sr}const{horizontalAlign:xn,verticalAlign:ln}=lm(Qe);(function(zi,Ln,Nn,nn,Wa,Hr,Ja,Bo,br){const Mn=(Ln-Nn)*Wa;let or=0;or=Hr!==Ja?-Bo*nn- -17:-nn*br*Ja+.5*Ja;for(const Bn of zi)for(const xr of Bn.positionedGlyphs)xr.x+=Mn,xr.y+=or})(he.positionedLines,bn,xn,ln,fi,Wt,st,Tt,$e.length),he.top+=-ln*Tt,he.bottom=he.top+Tt,he.left+=-xn*fi,he.right=he.left+fi})(le,e,i,o,q,p,y,x,R,E,L,V),!(function(he){for(const Ae of he)if(Ae.positionedGlyphs.length!==0)return!1;return!0})(J)&&le}function lm(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function k_(n,e,i){const o=e.getMaxScale()*Xn,{maxImageWidth:u,maxImageHeight:d}=e.getMaxImageSize(n),p=Math.max(o,d*i);return{verticalLineContentWidth:Math.max(o,u*i),horizontalLineContentHeight:p}}function Rg(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function ep(n,e,i){return!(n===P.az.horizontal||!e&&!ol(i)||e&&(oc(i)||(o=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(o)))));var o}function Eh(n,e,i,o,u,d){const p=d[n.fontStack],y=(function(E,D,R,L){if(E&&E.rect)return E;const B=D[R.fontStack],V=B&&B[L];return V?{rect:null,metrics:V.metrics}:null})(p&&p[e],u,n,e);if(y===null)return null;let x;if(i)x=o.verticalLineContentWidth-n.scale*Xn;else{const E=Rg(n.verticalAlign);x=(o.horizontalLineContentHeight-n.scale*Xn)*E}return{rect:y.rect,metrics:y.metrics,baselineOffset:x}}function um(n,e,i,o,u){const d=u[n.imageName];if(!d)return null;const p=d.paddedRect,y=d.displaySize,x={width:y[0],height:y[1],left:1,top:-3,advance:e?y[1]:y[0]};let E;if(e)E=o.verticalLineContentWidth-y[1]*n.scale;else{const D=Rg(n.verticalAlign);E=(o.horizontalLineContentHeight-y[1]*n.scale)*D}return{rect:p,metrics:x,baselineOffset:E,imageOffset:(e?y[0]:y[1])*n.scale-Xn*i}}function tp(n,e,i,o){if(o===0)return;const u=n[i],d=(n[i].x+u.metrics.advance*u.scale)*o;for(let p=e;p<=i;p++)n[p].x-=d}function cm(n,e,i){const{horizontalAlign:o,verticalAlign:u}=lm(i),d=e[0]-n.displaySize[0]*o,p=e[1]-n.displaySize[1]*u;return{image:n,top:p,bottom:p+n.displaySize[1],left:d,right:d+n.displaySize[0]}}function Sl(n){var e,i;let o=n.left,u=n.top,d=n.right-o,p=n.bottom-u;const y=(e=n.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",x=(i=n.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",E=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(x==="proportional"){if(y==="stretchOnly"&&d/p<E||y==="proportional"){const D=Math.ceil(p*E);o*=D/d,d=D}}else if(y==="proportional"&&x==="stretchOnly"&&E!==0&&d/p>E){const D=Math.ceil(d/E);u*=D/p,p=D}return{x1:o,y1:u,x2:o+d,y2:u+p}}function Ks(n,e,i,o,u,d){const p=n.image;let y;if(p.content){const q=p.content,Y=p.pixelRatio||1;y=[q[0]/Y,q[1]/Y,p.displaySize[0]-q[2]/Y,p.displaySize[1]-q[3]/Y]}const x=e.left*d,E=e.right*d;let D,R,L,B;i==="width"||i==="both"?(B=u[0]+x-o[3],R=u[0]+E+o[1]):(B=u[0]+(x+E-p.displaySize[0])/2,R=B+p.displaySize[0]);const V=e.top*d,U=e.bottom*d;return i==="height"||i==="both"?(D=u[1]+V-o[0],L=u[1]+U+o[2]):(D=u[1]+(V+U-p.displaySize[1])/2,L=D+p.displaySize[1]),{image:p,top:D,right:R,bottom:L,left:B,collisionPadding:y}}ut("ImagePosition",Fi),ut("ImageAtlas",Jd),P.az=void 0,(mu=P.az||(P.az={}))[mu.none=0]="none",mu[mu.horizontal=1]="horizontal",mu[mu.vertical=2]="vertical",mu[mu.horizontalOnly=3]="horizontalOnly";const Qa=128,gu=32640;function hm(n,e){const{expression:i}=e;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new xi(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:o,interpolationType:u}=i;let d=0;for(;d<o.length&&o[d]<=n;)d++;d=Math.max(0,d-1);let p=d;for(;p<o.length&&o[p]<n+1;)p++;p=Math.min(o.length-1,p);const y=o[d],x=o[p];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:x,interpolationType:u}:{kind:"camera",minZoom:y,maxZoom:x,minSize:i.evaluate(new xi(y)),maxSize:i.evaluate(new xi(x)),interpolationType:u}}}function ip(n,e,i){let o="never";const u=n.get(e);return u?o=u:n.get(i)&&(o="always"),o}const Og=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cf(n,e,i,o,u,d,p,y,x,E,D,R,L){const B=y?Math.min(gu,Math.round(y[0])):0,V=y?Math.min(gu,Math.round(y[1])):0;n.emplaceBack(e,i,Math.round(32*o),Math.round(32*u),d,p,(B<<1)+(x?1:0),V,16*E,16*D,256*R,256*L)}function fm(n,e,i){n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i),n.emplaceBack(e.x,e.y,i)}function dm(n){for(const e of n.sections)if(Us(e.text))return!0;return!1}class np{constructor(e){this.layoutVertexArray=new oe,this.indexArray=new Pe,this.programConfigurations=e,this.segments=new at,this.dynamicLayoutVertexArray=new ye,this.opacityVertexArray=new Ie,this.hasVisibleVertices=!1,this.placedSymbolArray=new b}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,i,o,u){this.isEmpty()||(o&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Sf.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Og,!0),this.opacityVertexBuffer.itemSize=1),(o||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ut("SymbolBuffers",np);class rp{constructor(e,i,o){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new o,this.segments=new at,this.collisionVertexArray=new ze}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,rm.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ut("CollisionBuffers",rp);class Mh{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((p=>p.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hm(this.zoom,i["text-size"]),this.iconSizeData=hm(this.zoom,i["icon-size"]);const o=this.layers[0].layout,u=o.get("symbol-sort-key"),d=o.get("symbol-z-order");this.canOverlap=ip(o,"text-overlap","text-allow-overlap")!=="never"||ip(o,"icon-overlap","icon-allow-overlap")!=="never"||o.get("text-ignore-placement")||o.get("icon-ignore-placement"),this.sortFeaturesByKey=d!=="viewport-y"&&!u.isConstant(),this.sortFeaturesByY=(d==="viewport-y"||d==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,o.get("symbol-placement")==="point"&&(this.writingModes=o.get("text-writing-mode").map((p=>P.az[p]))),this.stateDependentLayerIds=this.layers.filter((p=>p.isStateDependent())).map((p=>p.id)),this.sourceID=e.sourceID}createArrays(){this.text=new np(new Co(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new np(new Co(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new I,this.lineVertexArray=new O,this.symbolInstances=new A,this.textAnchorOffsets=new k}calculateGlyphDependencies(e,i,o,u,d){for(const p of e)if(i[p.codePointAt(0)]=!0,(o||u)&&d){const y=xh[p];y&&(i[y.codePointAt(0)]=!0)}}populate(e,i,o){const u=this.layers[0],d=u.layout,p=d.get("text-font"),y=d.get("text-field"),x=d.get("icon-image"),E=(y.value.kind!=="constant"||y.value.value instanceof qn&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),D=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,R=d.get("symbol-sort-key");if(this.features=[],!E&&!D)return;const L=i.iconDependencies,B=i.glyphDependencies,V=i.availableImages,U=new xi(this.zoom);for(const{feature:q,id:Y,index:se,sourceLayerIndex:Q}of e){const J=u._featureFilter.needGeometry,le=Xa(q,J);if(!u._featureFilter.filter(U,le,o))continue;let he,Ae;if(J||(le.geometry=Xs(q)),E){const Fe=u.getValueAndResolveTokens("text-field",le,o,V),$e=qn.factory(Fe),st=this.hasRTLText=this.hasRTLText||dm($e);(!st||Ta.getRTLTextPluginStatus()==="unavailable"||st&&Ta.isParsed())&&(he=Ia($e,u,le))}if(D){const Fe=u.getValueAndResolveTokens("icon-image",le,o,V);Ae=Fe instanceof Er?Fe:Er.fromString(Fe)}if(!he&&!Ae)continue;const Ve=this.sortFeaturesByKey?R.evaluate(le,{},o):void 0;if(this.features.push({id:Y,text:he,icon:Ae,index:se,sourceLayerIndex:Q,geometry:le.geometry,properties:q.properties,type:yh.types[q.type],sortKey:Ve}),Ae&&(L[Ae.name]=!0),he){const Fe=p.evaluate(le,{},o).join(","),$e=d.get("text-rotation-alignment")!=="viewport"&&d.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(P.az.vertical)>=0;for(const st of he.sections)if(st.image)L[st.image.name]=!0;else{const Qe=vs(he.toString()),Ne=st.fontStack||Fe,Oe=B[Ne]=B[Ne]||{};this.calculateGlyphDependencies(st.text,Oe,$e,this.allowVerticalPlacement,Qe)}}}d.get("symbol-placement")==="line"&&(this.features=(function(q){const Y={},se={},Q=[];let J=0;function le(Fe){Q.push(q[Fe]),J++}function he(Fe,$e,st){const Qe=se[Fe];return delete se[Fe],se[$e]=Qe,Q[Qe].geometry[0].pop(),Q[Qe].geometry[0]=Q[Qe].geometry[0].concat(st[0]),Qe}function Ae(Fe,$e,st){const Qe=Y[$e];return delete Y[$e],Y[Fe]=Qe,Q[Qe].geometry[0].shift(),Q[Qe].geometry[0]=st[0].concat(Q[Qe].geometry[0]),Qe}function Ve(Fe,$e,st){const Qe=st?$e[0][$e[0].length-1]:$e[0][0];return`${Fe}:${Qe.x}:${Qe.y}`}for(let Fe=0;Fe<q.length;Fe++){const $e=q[Fe],st=$e.geometry,Qe=$e.text?$e.text.toString():null;if(!Qe){le(Fe);continue}const Ne=Ve(Qe,st),Oe=Ve(Qe,st,!0);if(Ne in se&&Oe in Y&&se[Ne]!==Y[Oe]){const dt=Ae(Ne,Oe,st),ct=he(Ne,Oe,Q[dt].geometry);delete Y[Ne],delete se[Oe],se[Ve(Qe,Q[ct].geometry,!0)]=ct,Q[dt].geometry=null}else Ne in se?he(Ne,Oe,st):Oe in Y?Ae(Ne,Oe,st):(le(Fe),Y[Ne]=J-1,se[Oe]=J-1)}return Q.filter((Fe=>Fe.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((q,Y)=>q.sortKey-Y.sortKey))}update(e,i,o){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:o}),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,{imagePositions:o}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const o=this.lineVertexArray.length;if(e.segment!==void 0){let u=e.dist(i[e.segment+1]),d=e.dist(i[e.segment]);const p={};for(let y=e.segment+1;y<i.length;y++)p[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:u},y<i.length-1&&(u+=i[y+1].dist(i[y]));for(let y=e.segment||0;y>=0;y--)p[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:d},y>0&&(d+=i[y-1].dist(i[y]));for(let y=0;y<i.length;y++){const x=p[y];this.lineVertexArray.emplaceBack(x.x,x.y,x.tileUnitDistanceFromAnchor)}}return{lineStartIndex:o,lineLength:this.lineVertexArray.length-o}}addSymbols(e,i,o,u,d,p,y,x,E,D,R,L){const B=e.indexArray,V=e.layoutVertexArray,U=e.segments.prepareSegment(4*i.length,V,B,this.canOverlap?p.sortKey:void 0),q=this.glyphOffsetArray.length,Y=U.vertexLength,se=this.allowVerticalPlacement&&y===P.az.vertical?Math.PI/2:0,Q=p.text&&p.text.sections;for(let J=0;J<i.length;J++){const{tl:le,tr:he,bl:Ae,br:Ve,tex:Fe,pixelOffsetTL:$e,pixelOffsetBR:st,minFontScaleX:Qe,minFontScaleY:Ne,glyphOffset:Oe,isSDF:dt,sectionIndex:ct}=i[J],mt=U.vertexLength,lt=Oe[1];Cf(V,x.x,x.y,le.x,lt+le.y,Fe.x,Fe.y,o,dt,$e.x,$e.y,Qe,Ne),Cf(V,x.x,x.y,he.x,lt+he.y,Fe.x+Fe.w,Fe.y,o,dt,st.x,$e.y,Qe,Ne),Cf(V,x.x,x.y,Ae.x,lt+Ae.y,Fe.x,Fe.y+Fe.h,o,dt,$e.x,st.y,Qe,Ne),Cf(V,x.x,x.y,Ve.x,lt+Ve.y,Fe.x+Fe.w,Fe.y+Fe.h,o,dt,st.x,st.y,Qe,Ne),fm(e.dynamicLayoutVertexArray,x,se),B.emplaceBack(mt,mt+2,mt+1),B.emplaceBack(mt+1,mt+2,mt+3),U.vertexLength+=4,U.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Oe[0]),J!==i.length-1&&ct===i[J+1].sectionIndex||e.programConfigurations.populatePaintArrays(V.length,p,p.index,{imagePositions:{},canonical:L,formattedSection:Q&&Q[ct]})}e.placedSymbolArray.emplaceBack(x.x,x.y,q,this.glyphOffsetArray.length-q,Y,E,D,x.segment,o?o[0]:0,o?o[1]:0,u[0],u[1],y,0,!1,0,R)}_addCollisionDebugVertex(e,i,o,u,d,p){return i.emplaceBack(0,0),e.emplaceBack(o.x,o.y,u,d,Math.round(p.x),Math.round(p.y))}addCollisionDebugVertices(e,i,o,u,d,p,y){const x=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),E=x.vertexLength,D=d.layoutVertexArray,R=d.collisionVertexArray,L=y.anchorX,B=y.anchorY;this._addCollisionDebugVertex(D,R,p,L,B,new ne(e,i)),this._addCollisionDebugVertex(D,R,p,L,B,new ne(o,i)),this._addCollisionDebugVertex(D,R,p,L,B,new ne(o,u)),this._addCollisionDebugVertex(D,R,p,L,B,new ne(e,u)),x.vertexLength+=4;const V=d.indexArray;V.emplaceBack(E,E+1),V.emplaceBack(E+1,E+2),V.emplaceBack(E+2,E+3),V.emplaceBack(E+3,E),x.primitiveLength+=4}addDebugCollisionBoxes(e,i,o,u){for(let d=e;d<i;d++){const p=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,u?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,o)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rp(Me,Pa.members,tt),this.iconCollisionBox=new rp(Me,Pa.members,tt);for(let e=0;e<this.symbolInstances.length;e++){const i=this.symbolInstances.get(e);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(e,i,o,u,d,p,y,x,E){const D={};for(let R=i;R<o;R++){const L=e.get(R);D.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},D.textFeatureIndex=L.featureIndex;break}for(let R=u;R<d;R++){const L=e.get(R);D.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},D.verticalTextFeatureIndex=L.featureIndex;break}for(let R=p;R<y;R++){const L=e.get(R);D.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},D.iconFeatureIndex=L.featureIndex;break}for(let R=x;R<E;R++){const L=e.get(R);D.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},D.verticalIconFeatureIndex=L.featureIndex;break}return D}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,o.textBoxStartIndex,o.textBoxEndIndex,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o.iconBoxStartIndex,o.iconBoxEndIndex,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const o=e.placedSymbolArray.get(i),u=o.vertexStartIndex+4*o.numGlyphs;for(let d=o.vertexStartIndex;d<u;d+=4)e.indexArray.emplaceBack(d,d+2,d+1),e.indexArray.emplaceBack(d+1,d+2,d+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),o=Math.cos(e),u=[],d=[],p=[];for(let y=0;y<this.symbolInstances.length;++y){p.push(y);const x=this.symbolInstances.get(y);u.push(0|Math.round(i*x.anchorX+o*x.anchorY)),d.push(x.featureIndex)}return p.sort(((y,x)=>u[y]-u[x]||d[x]-d[y])),p}addToSortKeyRanges(e,i){const o=this.sortKeyRanges[this.sortKeyRanges.length-1];o&&o.sortKey===i?o.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const o=this.symbolInstances.get(i);this.featureSortOrder.push(o.featureIndex),[o.rightJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.leftJustifiedTextSymbolIndex].forEach(((u,d,p)=>{u>=0&&p.indexOf(u)===d&&this.addIndicesForPlacedSymbol(this.text,u)})),o.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,o.verticalPlacedTextSymbolIndex),o.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.placedIconSymbolIndex),o.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,o.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ap,sp;ut("SymbolBucket",Mh,{omit:["layers","collisionBoxArray","features","compareText"]}),Mh.MAX_GLYPHS=65535,Mh.addDynamicAttributes=fm;var pm={get paint(){return sp=sp||new Sn({"icon-opacity":new _t(Ee.paint_symbol["icon-opacity"]),"icon-color":new _t(Ee.paint_symbol["icon-color"]),"icon-halo-color":new _t(Ee.paint_symbol["icon-halo-color"]),"icon-halo-width":new _t(Ee.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _t(Ee.paint_symbol["icon-halo-blur"]),"icon-translate":new ft(Ee.paint_symbol["icon-translate"]),"icon-translate-anchor":new ft(Ee.paint_symbol["icon-translate-anchor"]),"text-opacity":new _t(Ee.paint_symbol["text-opacity"]),"text-color":new _t(Ee.paint_symbol["text-color"],{runtimeType:Yr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new _t(Ee.paint_symbol["text-halo-color"]),"text-halo-width":new _t(Ee.paint_symbol["text-halo-width"]),"text-halo-blur":new _t(Ee.paint_symbol["text-halo-blur"]),"text-translate":new ft(Ee.paint_symbol["text-translate"]),"text-translate-anchor":new ft(Ee.paint_symbol["text-translate-anchor"])})},get layout(){return ap=ap||new Sn({"symbol-placement":new ft(Ee.layout_symbol["symbol-placement"]),"symbol-spacing":new ft(Ee.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ft(Ee.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _t(Ee.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ft(Ee.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ft(Ee.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ft(Ee.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ft(Ee.layout_symbol["icon-ignore-placement"]),"icon-optional":new ft(Ee.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ft(Ee.layout_symbol["icon-rotation-alignment"]),"icon-size":new _t(Ee.layout_symbol["icon-size"]),"icon-text-fit":new ft(Ee.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ft(Ee.layout_symbol["icon-text-fit-padding"]),"icon-image":new _t(Ee.layout_symbol["icon-image"]),"icon-rotate":new _t(Ee.layout_symbol["icon-rotate"]),"icon-padding":new _t(Ee.layout_symbol["icon-padding"]),"icon-keep-upright":new ft(Ee.layout_symbol["icon-keep-upright"]),"icon-offset":new _t(Ee.layout_symbol["icon-offset"]),"icon-anchor":new _t(Ee.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ft(Ee.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ft(Ee.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ft(Ee.layout_symbol["text-rotation-alignment"]),"text-field":new _t(Ee.layout_symbol["text-field"]),"text-font":new _t(Ee.layout_symbol["text-font"]),"text-size":new _t(Ee.layout_symbol["text-size"]),"text-max-width":new _t(Ee.layout_symbol["text-max-width"]),"text-line-height":new ft(Ee.layout_symbol["text-line-height"]),"text-letter-spacing":new _t(Ee.layout_symbol["text-letter-spacing"]),"text-justify":new _t(Ee.layout_symbol["text-justify"]),"text-radial-offset":new _t(Ee.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ft(Ee.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new _t(Ee.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new _t(Ee.layout_symbol["text-anchor"]),"text-max-angle":new ft(Ee.layout_symbol["text-max-angle"]),"text-writing-mode":new ft(Ee.layout_symbol["text-writing-mode"]),"text-rotate":new _t(Ee.layout_symbol["text-rotate"]),"text-padding":new ft(Ee.layout_symbol["text-padding"]),"text-keep-upright":new ft(Ee.layout_symbol["text-keep-upright"]),"text-transform":new _t(Ee.layout_symbol["text-transform"]),"text-offset":new _t(Ee.layout_symbol["text-offset"]),"text-allow-overlap":new ft(Ee.layout_symbol["text-allow-overlap"]),"text-overlap":new ft(Ee.layout_symbol["text-overlap"]),"text-ignore-placement":new ft(Ee.layout_symbol["text-ignore-placement"]),"text-optional":new ft(Ee.layout_symbol["text-optional"])})}};class Lg{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Vi,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ut("FormatSectionOverride",Lg,{omit:["defaultValue"]});class _u extends sn{constructor(e,i){super(e,pm,i)}recalculate(e,i){if(super.recalculate(e,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const o=this.layout.get("text-writing-mode");if(o){const u=[];for(const d of o)u.indexOf(d)<0&&u.push(d);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,i,o,u){const d=this.layout.get(e).evaluate(i,{},o,u),p=this._unevaluatedLayout._values[e];return p.isDataDriven()||xo(p.value)||!d?d:(function(y,x){return x.replace(/{([^{}]+)}/g,((E,D)=>y&&D in y?String(y[D]):""))})(i.properties,d)}createBucket(e){return new Mh(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of pm.paint.overridableProperties){if(!_u.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),o=new Lg(i),u=new eh(o,i.property.specification);let d=null;d=i.value.kind==="constant"||i.value.kind==="source"?new zr("source",u):new wo("composite",u,i.value.zoomStops),this.paint._values[e]=new aa(i.property,d,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,o){return!(!this.layout||i.isDataDriven()||o.isDataDriven())&&_u.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const o=e.get("text-field"),u=pm.paint.properties[i];let d=!1;const p=y=>{for(const x of y)if(u.overrides&&u.overrides.hasOverride(x))return void(d=!0)};if(o.value.kind==="constant"&&o.value.value instanceof qn)p(o.value.value.sections);else if(o.value.kind==="source"||o.value.kind==="composite"){const y=E=>{d||(E instanceof Kr&&Ki(E.value)===is?p(E.value.sections):E instanceof Gu?p(E.sections):E.eachChild(y))},x=o.value;x._styleExpression&&y(x._styleExpression.expression)}return d}}let Bg;var kg={get paint(){return Bg=Bg||new Sn({"background-color":new ft(Ee.paint_background["background-color"]),"background-pattern":new ou(Ee.paint_background["background-pattern"]),"background-opacity":new ft(Ee.paint_background["background-opacity"])})}};class li extends sn{constructor(e,i){super(e,kg,i)}}class mm extends sn{constructor(e,i){super(e,{},i),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class op{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const gm={once:!0},lp=63710088e-1;class Oo{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Oo(ei(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,o=this.lat*i,u=e.lat*i,d=Math.sin(o)*Math.sin(u)+Math.cos(o)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return lp*Math.acos(Math.min(d,1))}static convert(e){if(e instanceof Oo)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Oo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Oo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ah=2*Math.PI*lp;function Df(n){return Ah*Math.cos(n*Math.PI/180)}function Fg(n){return(180+n)/360}function _m(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function jg(n,e){return n/Df(e)}function Ng(n){return 360*n-180}function zf(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function ym(n,e){return n*Df(zf(e))}class Ci{constructor(e,i,o=0){this.x=+e,this.y=+i,this.z=+o}static fromLngLat(e,i=0){const o=Oo.convert(e);return new Ci(Fg(o.lng),_m(o.lat),jg(i,o.lat))}toLngLat(){return new Oo(Ng(this.x),zf(this.y))}toAltitude(){return ym(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ah*(e=zf(this.y),1/Math.cos(e*Math.PI/180));var e}}function up(n,e,i){var o=2*Math.PI*6378137/256/Math.pow(2,i);return[n*o-2*Math.PI*6378137/2,e*o-2*Math.PI*6378137/2]}class fr{constructor(e,i,o){if(!(function(u,d,p){return!(u<0||u>25||p<0||p>=Math.pow(2,u)||d<0||d>=Math.pow(2,u))})(e,i,o))throw new Error(`x=${i}, y=${o}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=i,this.y=o,this.key=Ch(0,e,e,i,o)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i,o){const u=(function(p,y,x){var E=up(256*p,256*(y=Math.pow(2,x)-y-1),x),D=up(256*(p+1),256*(y+1),x);return E[0]+","+E[1]+","+D[0]+","+D[1]})(this.x,this.y,this.z),d=(function(p,y,x){let E,D="";for(let R=p;R>0;R--)E=1<<R-1,D+=(y&E?1:0)+(x&E?2:0);return D})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,d).replace(/{bbox-epsg-3857}/g,u)}isChildOf(e){const i=this.z-e.z;return i>0&&e.x===this.x>>i&&e.y===this.y>>i}getTilePoint(e){const i=Math.pow(2,this.z);return new ne((e.x*i-this.x)*Mt,(e.y*i-this.y)*Mt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vg{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Ch(e,i.z,i.z,i.x,i.y)}}class Ra{constructor(e,i,o,u,d){if(this.terrainRttPosMatrix32f=null,e<o)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${o}`);this.overscaledZ=e,this.wrap=i,this.canonical=new fr(o,+u,+d),this.key=Ch(i,e,o,u,d)}clone(){return new Ra(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-e;return e>this.canonical.z?new Ra(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ra(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(e,i){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-e;return e>this.canonical.z?Ch(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y):Ch(this.wrap*+i,e,e,this.canonical.x>>o,this.canonical.y>>o)}isChildOf(e){if(e.wrap!==this.wrap||this.overscaledZ-e.overscaledZ<=0)return!1;if(e.overscaledZ===0)return this.overscaledZ>0;const i=this.canonical.z-e.canonical.z;return!(i<0)&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ra(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,o=2*this.canonical.x,u=2*this.canonical.y;return[new Ra(i,this.wrap,i,o,u),new Ra(i,this.wrap,i,o+1,u),new Ra(i,this.wrap,i,o,u+1),new Ra(i,this.wrap,i,o+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ra(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ra(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Ci(e.x-this.wrap,e.y))}}function Ch(n,e,i,o,u){(n*=2)<0&&(n=-1*n-1);const d=1<<i;return(d*d*n+d*u+o).toString(36)+i.toString(36)+e.toString(36)}function Pf(n,e){return e?n.properties[e]:n.id}function vm(n,e){const i={id:n.id};if(e.removeAllProperties&&(delete n.removeProperties,delete n.addOrUpdateProperties,delete e.removeProperties),e.removeProperties)for(const o of e.removeProperties){const u=n.addOrUpdateProperties.findIndex((d=>d.key===o));u>-1&&n.addOrUpdateProperties.splice(u,1)}return(n.removeAllProperties||e.removeAllProperties)&&(i.removeAllProperties=!0),(n.removeProperties||e.removeProperties)&&(i.removeProperties=[...n.removeProperties||[],...e.removeProperties||[]]),(n.addOrUpdateProperties||e.addOrUpdateProperties)&&(i.addOrUpdateProperties=[...n.addOrUpdateProperties||[],...e.addOrUpdateProperties||[]]),(n.newGeometry||e.newGeometry)&&(i.newGeometry=e.newGeometry||n.newGeometry),i}function If(n){var e,i;if(!n)return{};const o={};return o.removeAll=n.removeAll,o.remove=new Set(n.remove||[]),o.add=new Map((e=n.add)===null||e===void 0?void 0:e.map((u=>[u.id,u]))),o.update=new Map((i=n.update)===null||i===void 0?void 0:i.map((u=>[u.id,u]))),o}ut("CanonicalTileID",fr),ut("OverscaledTileID",Ra,{omit:["terrainRttPosMatrix32f"]});class yu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(e){return this.minX=Math.min(this.minX,e.x),this.minY=Math.min(this.minY,e.y),this.maxX=Math.max(this.maxX,e.x),this.maxY=Math.max(this.maxY,e.y),this}expandBy(e){return this.minX-=e,this.minY-=e,this.maxX+=e,this.maxY+=e,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(e){return this.expandBy(-e)}map(e){const i=new yu;return i.extend(e(new ne(this.minX,this.minY))),i.extend(e(new ne(this.maxX,this.minY))),i.extend(e(new ne(this.minX,this.maxY))),i.extend(e(new ne(this.maxX,this.maxY))),i}static fromPoints(e){const i=new yu;for(const o of e)i.extend(o);return i}contains(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(e){return!this.empty()&&!e.empty()&&e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY}intersects(e){return!this.empty()&&!e.empty()&&e.minX<=this.maxX&&e.maxX>=this.minX&&e.minY<=this.maxY&&e.maxY>=this.minY}}class bm{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const o=e[i];this._stringToNumber[o]=i,this._numberToString[i]=o}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class cp{constructor(e,i,o,u,d){this.type="Feature",this._vectorTileFeature=e,this._x=o,this._y=u,this._z=i,this.properties=e.properties,this.id=d}projectPoint(e,i,o,u){return[360*(e.x+i)/u-180,360/Math.PI*Math.atan(Math.exp((1-2*(e.y+o)/u)*Math.PI))-90]}projectLine(e,i,o,u){return e.map((d=>this.projectPoint(d,i,o,u)))}get geometry(){if(this._geometry)return this._geometry;const e=this._vectorTileFeature,i=e.extent*Math.pow(2,this._z),o=e.extent*this._x,u=e.extent*this._y,d=e.loadGeometry();switch(e.type){case 1:{const p=[];for(const x of d)p.push(x[0]);const y=this.projectLine(p,o,u,i);this._geometry=p.length===1?{type:"Point",coordinates:y[0]}:{type:"MultiPoint",coordinates:y};break}case 2:{const p=d.map((y=>this.projectLine(y,o,u,i)));this._geometry=p.length===1?{type:"LineString",coordinates:p[0]}:{type:"MultiLineString",coordinates:p};break}case 3:{const p=vg(d),y=[];for(const x of p)y.push(x.map((E=>this.projectLine(E,o,u,i))));this._geometry=y.length===1?{type:"Polygon",coordinates:y[0]}:{type:"MultiPolygon",coordinates:y};break}default:throw new Error(`unknown feature type: ${e.type}`)}return this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&i!=="_x"&&i!=="_y"&&i!=="_z"&&(e[i]=this[i]);return e}}class vu{_name;dataBuffer;nullabilityBuffer;_size;constructor(e,i,o){this._name=e,this.dataBuffer=i,typeof o=="number"?this._size=o:(this.nullabilityBuffer=o,this._size=o.size())}getValue(e){return this.nullabilityBuffer&&!this.nullabilityBuffer.get(e)?null:this.getValueFromBuffer(e)}has(e){return this.nullabilityBuffer&&this.nullabilityBuffer.get(e)||!this.nullabilityBuffer}get name(){return this._name}get size(){return this._size}}class hp extends vu{}class fp extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class xm extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class wm extends vu{delta;constructor(e,i,o,u){super(e,i,u),this.delta=o}}class Tm extends wm{constructor(e,i,o,u){super(e,Int32Array.of(i),o,u)}getValueFromBuffer(e){return this.dataBuffer[0]+e*this.delta}}class Sm extends vu{constructor(e,i,o){super(e,Int32Array.of(i),o)}getValueFromBuffer(e){return this.dataBuffer[0]}}class bu{_name;_geometryVector;_idVector;_propertyVectors;_extent;propertyVectorsMap;constructor(e,i,o,u,d=4096){this._name=e,this._geometryVector=i,this._idVector=o,this._propertyVectors=u,this._extent=d}get name(){return this._name}get idVector(){return this._idVector}get geometryVector(){return this._geometryVector}get propertyVectors(){return this._propertyVectors}getPropertyVector(e){return this.propertyVectorsMap||(this.propertyVectorsMap=new Map(this._propertyVectors.map((i=>[i.name,i])))),this.propertyVectorsMap.get(e)}*[Symbol.iterator](){const e=this.geometryVector[Symbol.iterator]();let i=0;for(;i<this.numFeatures;){let o;this.idVector&&(o=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(i)):this.idVector.getValue(i));const u=e?.next().value,d={};for(const p of this.propertyVectors){if(!p)continue;const y=p.name,x=p.getValue(i);x!==null&&(d[y]=x)}i++,yield{id:o,geometry:u,properties:d}}}get numFeatures(){return this.geometryVector.numGeometries}get extent(){return this._extent}getFeatures(){const e=[],i=this.geometryVector.getGeometries();for(let o=0;o<this.numFeatures;o++){let u;this.idVector&&(u=this.containsMaxSaveIntegerValues(this.idVector)?Number(this.idVector.getValue(o)):this.idVector.getValue(o));const d={coordinates:i[o],type:this.geometryVector.geometryType(o)},p={};for(const y of this.propertyVectors){if(!y)continue;const x=y.name,E=y.getValue(o);E!==null&&(p[x]=E)}e.push({id:u,geometry:d,properties:p})}return e}containsMaxSaveIntegerValues(e){return e instanceof fp||e instanceof Sm&&e instanceof Tm||e instanceof xm}}class Ug{value;constructor(e){this.value=e}get(){return this.value}set(e){this.value=e}increment(){return this.value++}add(e){this.value+=e}}var Yt,Ws,yr,Js,xu,Ur,jn,rr,Ka,ca;function ar(n,e,i){const o=new Int32Array(i);let u=0,d=e.get();for(let p=0;p<o.length;p++){let y=n[d++],x=127&y;y<128||(y=n[d++],x|=(127&y)<<7,y<128||(y=n[d++],x|=(127&y)<<14,y<128||(y=n[d++],x|=(127&y)<<21,y<128||(y=n[d++],x|=(15&y)<<28)))),o[u++]=x}return e.set(d),o}function Rf(n,e,i){const o=new BigInt64Array(i);for(let u=0;u<o.length;u++)o[u]=dp(n,e);return o}function Gg(n,e){let i,o;return o=n[e.get()],e.increment(),i=127&o,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<7,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<14,o<128?i:(o=n[e.get()],e.increment(),i|=(127&o)<<21,o<128?i:(o=n[e.get()],i|=(15&o)<<28,(function(u,d,p){let y,x;if(x=d[p.get()],p.increment(),y=(112&x)>>4,x<128||(x=d[p.get()],p.increment(),y|=(127&x)<<3,x<128)||(x=d[p.get()],p.increment(),y|=(127&x)<<10,x<128)||(x=d[p.get()],p.increment(),y|=(127&x)<<17,x<128)||(x=d[p.get()],p.increment(),y|=(127&x)<<24,x<128)||(x=d[p.get()],p.increment(),y|=(1&x)<<31,x<128))return 4294967296*y+(u>>>0);throw new Error("Expected varint not more than 10 bytes")})(i,n,e)))))}function Dh(n,e,i,o){throw new Error("FastPFor is not implemented yet.")}function vr(n){return n>>>1^-(1&n)}function Mc(n){return n>>1n^-(1n&n)}function dp(n,e){let i=0n,o=0,u=e.get();for(;u<n.length;){const d=n[u++];if(i|=BigInt(127&d)<<BigInt(o),!(128&d))break;if(o+=7,o>=64)throw new Error("Varint too long")}return e.set(u),i}function Lo(n,e,i){const o=new Int32Array(i);let u=0;for(let d=0;d<e;d++){const p=n[d];o.fill(n[d+e],u,u+p),u+=p}return o}function qg(n,e,i){const o=new BigInt64Array(i);let u=0;for(let d=0;d<e;d++){const p=Number(n[d]);o.fill(n[d+e],u,u+p),u+=p}return o}function Zg(n,e,i){const o=new Float64Array(i);let u=0;for(let d=0;d<e;d++){const p=n[d];o.fill(n[d+e],u,u+p),u+=p}return o}function wu(n){const e=n.length/4*4;let i=1;if(e>=4)for(let o=n[0];i<e-4;i+=4)o=n[i]+=o,o=n[i+1]+=o,o=n[i+2]+=o,o=n[i+3]+=o;for(;i!=n.length;)n[i]+=n[i-1],++i}function Em(n){n[0]=n[0]>>>1^-(1&n[0]),n[1]=n[1]>>>1^-(1&n[1]);const e=n.length/4*4;let i=2;if(e>=4)for(;i<e-4;i+=4){const o=n[i],u=n[i+1],d=n[i+2],p=n[i+3];n[i]=(o>>>1^-(1&o))+n[i-2],n[i+1]=(u>>>1^-(1&u))+n[i-1],n[i+2]=(d>>>1^-(1&d))+n[i],n[i+3]=(p>>>1^-(1&p))+n[i+1]}for(;i!=n.length;i+=2)n[i]=(n[i]>>>1^-(1&n[i]))+n[i-2],n[i+1]=(n[i+1]>>>1^-(1&n[i+1]))+n[i-1]}(function(n){n.NONE="NONE",n.DELTA="DELTA",n.COMPONENTWISE_DELTA="COMPONENTWISE_DELTA",n.RLE="RLE",n.MORTON="MORTON",n.PDE="PDE"})(Yt||(Yt={})),(function(n){n.NONE="NONE",n.FAST_PFOR="FAST_PFOR",n.VARINT="VARINT",n.ALP="ALP"})(Ws||(Ws={})),(function(n){n.PRESENT="PRESENT",n.DATA="DATA",n.OFFSET="OFFSET",n.LENGTH="LENGTH"})(yr||(yr={}));class Mm{_dictionaryType;_offsetType;_lengthType;constructor(e,i,o){this._dictionaryType=e,this._offsetType=i,this._lengthType=o}get dictionaryType(){return this._dictionaryType}get offsetType(){return this._offsetType}get lengthType(){return this._lengthType}}function Gr(n,e){const i=(function(o,u){const d=o[u.get()],p=Object.values(yr)[d>>4];let y=null;switch(p){case yr.DATA:y=new Mm(Object.values(Js)[15&d]);break;case yr.OFFSET:y=new Mm(null,Object.values(xu)[15&d]);break;case yr.LENGTH:y=new Mm(null,null,Object.values(Ur)[15&d])}u.increment();const x=o[u.get()],E=Object.values(Yt)[x>>5],D=Object.values(Yt)[x>>2&7],R=Object.values(Ws)[3&x];u.increment();const L=ar(o,u,2),B=L[0];return{physicalStreamType:p,logicalStreamType:y,logicalLevelTechnique1:E,logicalLevelTechnique2:D,physicalLevelTechnique:R,numValues:B,byteLength:L[1],decompressedCount:B}})(n,e);return i.logicalLevelTechnique1===Yt.MORTON?(function(o,u,d){const p=ar(u,d,2);return{physicalStreamType:o.physicalStreamType,logicalStreamType:o.logicalStreamType,logicalLevelTechnique1:o.logicalLevelTechnique1,logicalLevelTechnique2:o.logicalLevelTechnique2,physicalLevelTechnique:o.physicalLevelTechnique,numValues:o.numValues,byteLength:o.byteLength,decompressedCount:o.decompressedCount,numBits:p[0],coordinateShift:p[1]}})(i,n,e):Yt.RLE!==i.logicalLevelTechnique1&&Yt.RLE!==i.logicalLevelTechnique2||Ws.NONE===i.physicalLevelTechnique?i:(function(o,u,d){const p=ar(u,d,2);return{physicalStreamType:o.physicalStreamType,logicalStreamType:o.logicalStreamType,logicalLevelTechnique1:o.logicalLevelTechnique1,logicalLevelTechnique2:o.logicalLevelTechnique2,physicalLevelTechnique:o.physicalLevelTechnique,numValues:o.numValues,byteLength:o.byteLength,decompressedCount:p[1],runs:p[0],numRleValues:p[1]}})(i,n,e)}(function(n){n.NONE="NONE",n.SINGLE="SINGLE",n.SHARED="SHARED",n.VERTEX="VERTEX",n.MORTON="MORTON",n.FSST="FSST"})(Js||(Js={})),(function(n){n.VERTEX="VERTEX",n.INDEX="INDEX",n.STRING="STRING",n.KEY="KEY"})(xu||(xu={})),(function(n){n.VAR_BINARY="VAR_BINARY",n.GEOMETRIES="GEOMETRIES",n.PARTS="PARTS",n.RINGS="RINGS",n.TRIANGLES="TRIANGLES",n.SYMBOL="SYMBOL",n.DICTIONARY="DICTIONARY"})(Ur||(Ur={})),(function(n){n[n.FLAT=0]="FLAT",n[n.CONST=1]="CONST",n[n.SEQUENCE=2]="SEQUENCE",n[n.DICTIONARY=3]="DICTIONARY",n[n.FSST_DICTIONARY=4]="FSST_DICTIONARY"})(jn||(jn={}));class eo{values;_size;constructor(e,i){this.values=e,this._size=i}get(e){const i=Math.floor(e/8);return(this.values[i]>>e%8&1)==1}set(e,i){const o=Math.floor(e/8);this.values[o]=this.values[o]|(i?1:0)<<e%8}getInt(e){const i=Math.floor(e/8);return this.values[i]>>e%8&1}size(){return this._size}getBuffer(){return this.values}}function qr(n,e,i,o,u){return(function(d,p,y){switch(p.logicalLevelTechnique1){case Yt.DELTA:return p.logicalLevelTechnique2===Yt.RLE?(function(x,E,D){const R=new Int32Array(D);let L=0,B=0;for(let V=0;V<E;V++){const U=x[V],q=vr(x[V+E]);for(let Y=0;Y<U;Y++)B+=q,R[L++]=B}return R})(d,p.runs,p.numRleValues):((function(x){x[0]=x[0]>>>1^-(1&x[0]);const E=x.length/4*4;let D=1;if(E>=4)for(;D<E-4;D+=4){const R=x[D],L=x[D+1],B=x[D+2],V=x[D+3];x[D]=(R>>>1^-(1&R))+x[D-1],x[D+1]=(L>>>1^-(1&L))+x[D],x[D+2]=(B>>>1^-(1&B))+x[D+1],x[D+3]=(V>>>1^-(1&V))+x[D+2]}for(;D!=x.length;++D)x[D]=(x[D]>>>1^-(1&x[D]))+x[D-1]})(d),d);case Yt.RLE:return(function(x,E,D){return D?(function(R,L,B){const V=new Int32Array(B);let U=0;for(let q=0;q<L;q++){const Y=R[q];let se=R[q+L];se=se>>>1^-(1&se),V.fill(se,U,U+Y),U+=Y}return V})(x,E.runs,E.numRleValues):Lo(x,E.runs,E.numRleValues)})(d,p,y);case Yt.MORTON:return wu(d),d;case Yt.COMPONENTWISE_DELTA:return Em(d),d;case Yt.NONE:return y&&(function(x){for(let E=0;E<x.length;E++){const D=x[E];x[E]=D>>>1^-(1&D)}})(d),d;default:throw new Error(`The specified Logical level technique is not supported: ${p.logicalLevelTechnique1}`)}})(pp(n,e,i),i,o)}function Tu(n,e,i){return(function(o,u){if(u.logicalLevelTechnique1===Yt.DELTA&&u.logicalLevelTechnique2===Yt.NONE)return(function(p){const y=new Int32Array(p.length+1);y[0]=0,y[1]=vr(p[0]);let x=y[1],E=2;for(;E!=y.length;++E){const D=p[E-1];x+=D>>>1^-(1&D),y[E]=y[E-1]+x}return y})(o);if(u.logicalLevelTechnique1===Yt.RLE&&u.logicalLevelTechnique2===Yt.NONE)return(function(p,y,x){const E=new Int32Array(x+1);E[0]=0;let D=1,R=E[0];for(let L=0;L<y;L++){const B=p[L],V=p[L+y];for(let U=D;U<D+B;U++)E[U]=V+R,R=E[U];D+=B}return E})(o,u.runs,u.numRleValues);if(u.logicalLevelTechnique1===Yt.NONE&&u.logicalLevelTechnique2===Yt.NONE){(function(p){let y=0;for(let x=0;x<p.length;x++)p[x]+=y,y=p[x]})(o);const d=new Int32Array(u.numValues+1);return d[0]=0,d.set(o,1),d}if(u.logicalLevelTechnique1===Yt.DELTA&&u.logicalLevelTechnique2===Yt.RLE){const d=(function(p,y,x){const E=new Int32Array(x+1);E[0]=0;let D=1,R=E[0];for(let L=0;L<y;L++){const B=p[L];let V=p[L+y];V=V>>>1^-(1&V);for(let U=D;U<D+B;U++)E[U]=V+R,R=E[U];D+=B}return E})(o,u.runs,u.numRleValues);return wu(d),d}throw new Error("Only delta encoding is supported for transforming length to offset streams yet.")})(pp(n,e,i),i)}function pp(n,e,i){const o=i.physicalLevelTechnique;if(o===Ws.FAST_PFOR)return Dh();if(o===Ws.VARINT)return ar(n,e,i.numValues);if(o===Ws.NONE){const u=e.get();e.add(i.byteLength);const d=n.subarray(u,e.get());return new Int32Array(d)}throw new Error("Specified physicalLevelTechnique is not supported (yet).")}function Am(n,e,i,o){const u=pp(n,e,i);if(u.length===1){const d=u[0];return o?vr(d):d}return o?(function(d){return vr(d[1])})(u):(function(d){return d[1]})(u)}function Cm(n,e,i){return(function(o){if(o.length==2){const u=vr(o[1]);return[u,u]}return[vr(o[2]),vr(o[3])]})(pp(n,e,i))}function Ac(n,e,i){return(function(o){if(o.length==2){const u=Mc(o[1]);return[u,u]}return[Mc(o[2]),Mc(o[3])]})(Rf(n,e,i.numValues))}function zh(n,e,i,o){return(function(u,d,p){switch(d.logicalLevelTechnique1){case Yt.DELTA:return d.logicalLevelTechnique2===Yt.RLE?(function(y,x,E){const D=new BigInt64Array(E);let R=0,L=0n;for(let B=0;B<x;B++){const V=Number(y[B]),U=Mc(y[B+x]);for(let q=0;q<V;q++)L+=U,D[R++]=L}return D})(u,d.runs,d.numRleValues):((function(y){y[0]=y[0]>>1n^-(1n&y[0]);const x=y.length/4*4;let E=1;if(x>=4)for(;E<x-4;E+=4){const D=y[E],R=y[E+1],L=y[E+2],B=y[E+3];y[E]=(D>>1n^-(1n&D))+y[E-1],y[E+1]=(R>>1n^-(1n&R))+y[E],y[E+2]=(L>>1n^-(1n&L))+y[E+1],y[E+3]=(B>>1n^-(1n&B))+y[E+2]}for(;E!=y.length;++E)y[E]=(y[E]>>1n^-(1n&y[E]))+y[E-1]})(u),u);case Yt.RLE:return(function(y,x,E){return E?(function(D,R,L){const B=new BigInt64Array(L);let V=0;for(let U=0;U<R;U++){const q=Number(D[U]);let Y=D[U+R];Y=Y>>1n^-(1n&Y),B.fill(Y,V,V+q),V+=q}return B})(y,x.runs,x.numRleValues):qg(y,x.runs,x.numRleValues)})(u,d,p);case Yt.NONE:return p&&(function(y){for(let x=0;x<y.length;x++){const E=y[x];y[x]=E>>1n^-(1n&E)}})(u),u;default:throw new Error(`The specified Logical level technique is not supported: ${d.logicalLevelTechnique1}`)}})(Rf(n,e,i.numValues),i,o)}function Dm(n,e,i,o){const u=Rf(n,e,i.numValues);if(u.length===1){const d=u[0];return o?Mc(d):d}return o?(function(d){return Mc(d[1])})(u):(function(d){return d[1]})(u)}function zm(n,e,i,o,u){return(function(d,p,y,x){switch(p.logicalLevelTechnique1){case Yt.DELTA:return p.logicalLevelTechnique2===Yt.RLE&&(d=Lo(d,p.runs,p.numRleValues)),(function(E,D){const R=new Int32Array(E.size());let L=0;E.get(0)?(R[0]=E.get(0)?D[0]>>>1^-(1&D[0]):0,L=1):R[0]=0;let B=1;for(;B!=R.length;++B)R[B]=E.get(B)?R[B-1]+(D[L]>>>1^-(1&D[L++])):R[B-1];return R})(x,d);case Yt.RLE:return(function(E,D,R,L){const B=D;return R?(function(V,U,q){const Y=new Int32Array(V.size());let se=0;for(let Q=0;Q<q;Q++){const J=U[Q];let le=U[Q+q];le=le>>>1^-(1&le);for(let he=se;he<se+J;he++)V.get(he)?Y[he]=le:(Y[he]=0,se++);se+=J}return Y})(L,E,B.runs):(function(V,U,q){const Y=new Int32Array(V.size());let se=0;for(let Q=0;Q<q;Q++){const J=U[Q],le=U[Q+q];for(let he=se;he<se+J;he++)V.get(he)?Y[he]=le:(Y[he]=0,se++);se+=J}return Y})(L,E,B.runs)})(d,p,y,x);case Yt.MORTON:return wu(d),d;case Yt.COMPONENTWISE_DELTA:return Em(d),d;case Yt.NONE:return d=y?(function(E,D){const R=new Int32Array(E.size());let L=0,B=0;for(;B!=R.length;++B)if(E.get(B)){const V=D[L++];R[B]=V>>>1^-(1&V)}else R[B]=0;return R})(x,d):(function(E,D){const R=new Int32Array(E.size());let L=0,B=0;for(;B!=R.length;++B)R[B]=E.get(B)?D[L++]:0;return R})(x,d),d;default:throw new Error("The specified Logical level technique is not supported")}})(i.physicalLevelTechnique===Ws.FAST_PFOR?Dh():ar(n,e,i.numValues),i,o,u)}function El(n,e,i,o){const u=n.logicalLevelTechnique1;if(u===Yt.RLE)return n.runs===1?jn.CONST:jn.FLAT;const d=e instanceof eo?e.size():e;if(u===Yt.DELTA&&n.logicalLevelTechnique2===Yt.RLE){const p=n.runs,y=2;if(n.numRleValues!==d)return jn.FLAT;if(p===1)return jn.SEQUENCE;if(p===2){const x=o.get();let E;if(n.physicalLevelTechnique===Ws.VARINT)E=ar(i,o,4);else{const D=o.get();E=new Int32Array(i.buffer,i.byteOffset+D,4)}if(o.set(x),E[2]===y&&E[3]===y)return jn.SEQUENCE}}return n.numValues===1?jn.CONST:jn.FLAT}class Ph extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Pm extends wm{constructor(e,i,o,u){super(e,BigInt64Array.of(i),o,u)}getValueFromBuffer(e){return this.dataBuffer[0]+BigInt(e)*this.delta}}class Ml{_geometryOffsets;_partOffsets;_ringOffsets;constructor(e,i,o){this._geometryOffsets=e,this._partOffsets=i,this._ringOffsets=o}get geometryOffsets(){return this._geometryOffsets}get partOffsets(){return this._partOffsets}get ringOffsets(){return this._ringOffsets}}function Of(n,e,i){return{x:mp(n,e)-i,y:mp(n>>1,e)-i}}function mp(n,e){let i=0;for(let o=0;o<e;o++)i|=(n&1<<2*o)>>o;return i}(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON",n[n.MULTIPOINT=3]="MULTIPOINT",n[n.MULTILINESTRING=4]="MULTILINESTRING",n[n.MULTIPOLYGON=5]="MULTIPOLYGON"})(rr||(rr={})),(function(n){n[n.POINT=0]="POINT",n[n.LINESTRING=1]="LINESTRING",n[n.POLYGON=2]="POLYGON"})(Ka||(Ka={})),(function(n){n[n.MORTON=0]="MORTON",n[n.VEC_2=1]="VEC_2",n[n.VEC_3=2]="VEC_3"})(ca||(ca={}));class gp{createPoint(e){return[[e]]}createMultiPoint(e){return e.map((i=>[i]))}createLineString(e){return[e]}createMultiLineString(e){return e}createPolygon(e,i){return[e].concat(i)}createMultiPolygon(e){return e.flat()}}function Im(n){const e=new Array(n.numGeometries);let i=1,o=1,u=1,d=0;const p=new gp;let y=0,x=0;const E=n.mortonSettings,D=n.topologyVector,R=D.geometryOffsets,L=D.partOffsets,B=D.ringOffsets,V=n.vertexOffsets,U=n.containsPolygonGeometry(),q=n.vertexBuffer;for(let Y=0;Y<n.numGeometries;Y++){const se=n.geometryType(Y);if(se===rr.POINT){if(V&&V.length!==0)if(n.vertexBufferType===ca.VEC_2){const Q=2*V[x++],J=new ne(q[Q],q[Q+1]);e[d++]=p.createPoint(J)}else{const Q=Of(q[V[x++]],E.numBits,E.coordinateShift),J=new ne(Q.x,Q.y);e[d++]=p.createPoint(J)}else{const Q=new ne(q[y++],q[y++]);e[d++]=p.createPoint(Q)}R&&u++,L&&i++,B&&o++}else if(se===rr.MULTIPOINT){const Q=R[u]-R[u-1];u++;const J=new Array(Q);if(V&&V.length!==0){for(let le=0;le<Q;le++){const he=2*V[x++];J[le]=new ne(q[he],q[he+1])}e[d++]=p.createMultiPoint(J)}else{for(let le=0;le<Q;le++){const he=q[y++],Ae=q[y++];J[le]=new ne(he,Ae)}e[d++]=p.createMultiPoint(J)}}else if(se===rr.LINESTRING){let Q,J=0;U?(J=B[o]-B[o-1],o++):J=L[i]-L[i-1],i++,V&&V.length!==0?(Q=n.vertexBufferType===ca.VEC_2?kf(q,V,x,J,!1):Om(q,V,x,J,!1,E),x+=J):(Q=Rm(q,y,J,!1),y+=2*J),e[d++]=p.createLineString(Q),R&&u++}else if(se===rr.POLYGON){const Q=L[i]-L[i-1];i++;const J=new Array(Q-1);let le=B[o]-B[o-1];if(o++,V&&V.length!==0){const he=n.vertexBufferType===ca.VEC_2?_p(q,V,x,le):Bf(q,V,x,le,0,E);x+=le;for(let Ae=0;Ae<J.length;Ae++)le=B[o]-B[o-1],o++,J[Ae]=n.vertexBufferType===ca.VEC_2?_p(q,V,x,le):Bf(q,V,x,le,0,E),x+=le;e[d++]=p.createPolygon(he,J)}else{const he=Lf(q,y,le);y+=2*le;for(let Ae=0;Ae<J.length;Ae++)le=B[o]-B[o-1],o++,J[Ae]=Lf(q,y,le),y+=2*le;e[d++]=p.createPolygon(he,J)}R&&u++}else if(se===rr.MULTILINESTRING){const Q=R[u]-R[u-1];u++;const J=new Array(Q);if(V&&V.length!==0){for(let le=0;le<Q;le++){let he=0;U?(he=B[o]-B[o-1],o++):he=L[i]-L[i-1],i++;const Ae=n.vertexBufferType===ca.VEC_2?kf(q,V,x,he,!1):Om(q,V,x,he,!1,E);J[le]=Ae,x+=he}e[d++]=p.createMultiLineString(J)}else{for(let le=0;le<Q;le++){let he=0;U?(he=B[o]-B[o-1],o++):he=L[i]-L[i-1],i++,J[le]=Rm(q,y,he,!1),y+=2*he}e[d++]=p.createMultiLineString(J)}}else{if(se!==rr.MULTIPOLYGON)throw new Error("The specified geometry type is currently not supported.");{const Q=R[u]-R[u-1];u++;const J=new Array(Q);let le=0;if(V&&V.length!==0){for(let he=0;he<Q;he++){const Ae=L[i]-L[i-1];i++;const Ve=new Array(Ae-1);le=B[o]-B[o-1],o++;const Fe=n.vertexBufferType===ca.VEC_2?_p(q,V,x,le):Bf(q,V,x,le,0,E);x+=le;for(let $e=0;$e<Ve.length;$e++)le=B[o]-B[o-1],o++,Ve[$e]=n.vertexBufferType===ca.VEC_2?_p(q,V,x,le):Bf(q,V,x,le,0,E),x+=le;J[he]=p.createPolygon(Fe,Ve)}e[d++]=p.createMultiPolygon(J)}else{for(let he=0;he<Q;he++){const Ae=L[i]-L[i-1];i++;const Ve=new Array(Ae-1);le=B[o]-B[o-1],o++;const Fe=Lf(q,y,le);y+=2*le;for(let $e=0;$e<Ve.length;$e++){const st=B[o]-B[o-1];o++,Ve[$e]=Lf(q,y,st),y+=2*st}J[he]=p.createPolygon(Fe,Ve)}e[d++]=p.createMultiPolygon(J)}}}}return e}function Lf(n,e,i){return Rm(n,e,i,!0)}function _p(n,e,i,o){return kf(n,e,i,o,!0)}function Bf(n,e,i,o,u,d){return Om(n,e,i,o,!0,d)}function Rm(n,e,i,o){const u=new Array(o?i+1:i);for(let d=0;d<2*i;d+=2)u[d/2]=new ne(n[e+d],n[e+d+1]);return o&&(u[u.length-1]=u[0]),u}function kf(n,e,i,o,u){const d=new Array(u?o+1:o);for(let p=0;p<2*o;p+=2){const y=2*e[i+p/2];d[p/2]=new ne(n[y],n[y+1])}return u&&(d[d.length-1]=d[0]),d}function Om(n,e,i,o,u,d){const p=new Array(u?o+1:o);for(let y=0;y<o;y++){const x=Of(n[e[i+y]],d.numBits,d.coordinateShift);p[y]=new ne(x.x,x.y)}return u&&(p[p.length-1]=p[0]),p}class Ff{_vertexBufferType;_topologyVector;_vertexOffsets;_vertexBuffer;_mortonSettings;constructor(e,i,o,u,d){this._vertexBufferType=e,this._topologyVector=i,this._vertexOffsets=o,this._vertexBuffer=u,this._mortonSettings=d}get vertexBufferType(){return this._vertexBufferType}get topologyVector(){return this._topologyVector}get vertexOffsets(){return this._vertexOffsets}get vertexBuffer(){return this._vertexBuffer}*[Symbol.iterator](){const e=Im(this);let i=0;for(;i<this.numGeometries;)yield{coordinates:e[i],type:this.geometryType(i)},i++}getSimpleEncodedVertex(e){const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getVertex(e){if(this.vertexOffsets&&this.mortonSettings){const o=Of(this.vertexBuffer[this.vertexOffsets[e]],this.mortonSettings.numBits,this.mortonSettings.coordinateShift);return[o.x,o.y]}const i=this.vertexOffsets?2*this.vertexOffsets[e]:2*e;return[this.vertexBuffer[i],this.vertexBuffer[i+1]]}getGeometries(){return Im(this)}get mortonSettings(){return this._mortonSettings}}class jf extends Ff{_numGeometries;_geometryType;constructor(e,i,o,u,d,p,y){super(o,u,d,p,y),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsPolygonGeometry(){return this._geometryType===rr.POLYGON||this._geometryType===rr.MULTIPOLYGON}containsSingleGeometryType(){return!0}}class Nf extends Ff{_geometryTypes;constructor(e,i,o,u,d,p){super(e,o,u,d,p),this._geometryTypes=i}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsPolygonGeometry(){for(let e=0;e<this.numGeometries;e++)if(this.geometryType(e)===rr.POLYGON||this.geometryType(e)===rr.MULTIPOLYGON)return!0;return!1}containsSingleGeometryType(){return!1}}class Hg{_triangleOffsets;_indexBuffer;_vertexBuffer;_topologyVector;constructor(e,i,o,u){this._triangleOffsets=e,this._indexBuffer=i,this._vertexBuffer=o,this._topologyVector=u}get triangleOffsets(){return this._triangleOffsets}get indexBuffer(){return this._indexBuffer}get vertexBuffer(){return this._vertexBuffer}get topologyVector(){return this._topologyVector}getGeometries(){if(!this._topologyVector)throw new Error("Cannot convert GpuVector to coordinates without topology information");const e=new Array(this.numGeometries),i=this._topologyVector,o=i.partOffsets,u=i.ringOffsets,d=i.geometryOffsets;let p=0,y=1,x=1,E=1;for(let D=0;D<this.numGeometries;D++)switch(this.geometryType(D)){case rr.POLYGON:{const R=o[y]-o[y-1];y++;const L=[];for(let B=0;B<R;B++){const V=u[x]-u[x-1];x++;const U=[];for(let q=0;q<V;q++){const Y=this._vertexBuffer[p++],se=this._vertexBuffer[p++];U.push(new ne(Y,se))}U.length>0&&U.push(U[0]),L.push(U)}e[D]=L,d&&E++}break;case rr.MULTIPOLYGON:{const R=d[E]-d[E-1];E++;const L=[];for(let B=0;B<R;B++){const V=o[y]-o[y-1];y++;for(let U=0;U<V;U++){const q=u[x]-u[x-1];x++;const Y=[];for(let se=0;se<q;se++){const Q=this._vertexBuffer[p++],J=this._vertexBuffer[p++];Y.push(new ne(Q,J))}Y.length>0&&Y.push(Y[0]),L.push(Y)}}e[D]=L}}return e}[Symbol.iterator](){return null}}function Ih(n,e,i,o,u,d){return new F_(n,e,i,o,u,d)}class F_ extends Hg{_numGeometries;_geometryType;constructor(e,i,o,u,d,p){super(o,u,d,p),this._numGeometries=e,this._geometryType=i}geometryType(e){return this._geometryType}get numGeometries(){return this._numGeometries}containsSingleGeometryType(){return!0}}function Lm(n,e,i,o,u){return new $g(n,e,i,o,u)}class $g extends Hg{_geometryTypes;constructor(e,i,o,u,d){super(i,o,u,d),this._geometryTypes=e}geometryType(e){return this._geometryTypes[e]}get numGeometries(){return this._geometryTypes.length}containsSingleGeometryType(){return!1}}function Xg(n,e,i,o,u){const d=Gr(n,i);let p=null,y=null,x=null,E=null,D=null,R=null,L=null,B=null;if(El(d,o,n,i)===jn.CONST){const U=Am(n,i,d,!1);for(let q=0;q<e-1;q++){const Y=Gr(n,i);switch(Y.physicalStreamType){case yr.LENGTH:switch(Y.logicalStreamType.lengthType){case Ur.GEOMETRIES:p=Tu(n,i,Y);break;case Ur.PARTS:y=Tu(n,i,Y);break;case Ur.RINGS:x=Tu(n,i,Y);break;case Ur.TRIANGLES:L=Tu(n,i,Y)}break;case yr.OFFSET:switch(Y.logicalStreamType.offsetType){case xu.VERTEX:E=qr(n,i,Y,!1);break;case xu.INDEX:B=qr(n,i,Y,!1)}break;case yr.DATA:Js.VERTEX===Y.logicalStreamType.dictionaryType?D=qr(n,i,Y,!0):(R={numBits:Y.numBits,coordinateShift:Y.coordinateShift},D=qr(n,i,Y,!1))}}return B!==null?p!=null||y!=null?Ih(o,U,L,B,D,new Ml(p,y,x)):Ih(o,U,L,B,D):R===null?(function(q,Y,se,Q,J){return new jf(q,Y,ca.VEC_2,se,Q,J)})(o,U,new Ml(p,y,x),E,D):(function(q,Y,se,Q,J,le){return new jf(q,Y,ca.MORTON,se,Q,J,le)})(o,U,new Ml(p,y,x),E,D,R)}const V=qr(n,i,d,!1);for(let U=0;U<e-1;U++){const q=Gr(n,i);switch(q.physicalStreamType){case yr.LENGTH:switch(q.logicalStreamType.lengthType){case Ur.GEOMETRIES:p=qr(n,i,q,!1);break;case Ur.PARTS:y=qr(n,i,q,!1);break;case Ur.RINGS:x=qr(n,i,q,!1);break;case Ur.TRIANGLES:L=Tu(n,i,q)}break;case yr.OFFSET:switch(q.logicalStreamType.offsetType){case xu.VERTEX:E=qr(n,i,q,!1);break;case xu.INDEX:B=qr(n,i,q,!1)}break;case yr.DATA:Js.VERTEX===q.logicalStreamType.dictionaryType?D=qr(n,i,q,!0):(R={numBits:q.numBits,coordinateShift:q.coordinateShift},D=qr(n,i,q,!1))}}return B!==null&&y===null?Lm(V,L,B,D):(p!==null?(p=yp(V,p,2),y!==null&&x!==null?(y=vp(V,p,y,!1),x=(function(U,q,Y,se){const Q=new Int32Array(Y[Y.length-1]+1);let J=0;Q[0]=J;let le=1,he=1,Ae=0;for(let Ve=0;Ve<U.length;Ve++){const Fe=U[Ve],$e=q[Ve+1]-q[Ve];if(Fe!==0&&Fe!==3)for(let st=0;st<$e;st++){const Qe=Y[le]-Y[le-1];le++;for(let Ne=0;Ne<Qe;Ne++)J=Q[he++]=J+se[Ae++]}else for(let st=0;st<$e;st++)Q[he++]=++J,le++}return Q})(V,p,y,x)):y!==null&&(y=(function(U,q,Y){const se=new Int32Array(q[q.length-1]+1);let Q=0;se[0]=Q;let J=1,le=0;for(let he=0;he<U.length;he++){const Ae=U[he],Ve=q[he+1]-q[he];if(Ae===4||Ae===1)for(let Fe=0;Fe<Ve;Fe++)Q=se[J++]=Q+Y[le++];else for(let Fe=0;Fe<Ve;Fe++)se[J++]=++Q}return se})(V,p,y))):y!==null&&x!==null?(y=yp(V,y,1),x=vp(V,y,x,!0)):y!==null&&(y=yp(V,y,0)),B!==null?Lm(V,L,B,D,new Ml(p,y,x)):R===null?(function(U,q,Y,se){return new Nf(ca.VEC_2,U,q,Y,se)})(V,new Ml(p,y,x),E,D):(function(U,q,Y,se,Q){return new Nf(ca.MORTON,U,q,Y,se,Q)})(V,new Ml(p,y,x),E,D,R))}function yp(n,e,i){const o=new Int32Array(n.length+1);let u=0;o[0]=u;let d=0;for(let p=0;p<n.length;p++)u=o[p+1]=u+(n[p]>i?e[d++]:1);return o}function vp(n,e,i,o){const u=new Int32Array(e[e.length-1]+1);let d=0;u[0]=d;let p=1,y=0;for(let x=0;x<n.length;x++){const E=n[x],D=e[x+1]-e[x];if(E===5||E===2||o&&(E===4||E===1))for(let R=0;R<D;R++)d=u[p++]=d+i[y++];else for(let R=0;R<D;R++)u[p++]=++d}return u}class Yg extends vu{dataVector;constructor(e,i,o){super(e,i.getBuffer(),o),this.dataVector=i}getValueFromBuffer(e){return this.dataVector.get(e)}}class Qg extends hp{getValueFromBuffer(e){return this.dataBuffer[e]}}class Vf extends vu{constructor(e,i,o){super(e,BigInt64Array.of(i),o)}getValueFromBuffer(e){return this.dataBuffer[0]}}function Uf(n,e,i){return Kg(n,Math.ceil(e/8),i)}function Kg(n,e,i){const o=new Uint8Array(e);let u=0;for(;u<e;){const d=n[i.increment()];if(d<=127){const p=d+3,y=n[i.increment()],x=u+p;o.fill(y,u,x),u=x}else{const p=256-d;for(let y=0;y<p;y++)o[u++]=n[i.increment()]}}return o}const Bm=new TextDecoder;function Gf(n,e,i){return i-e>=12?Bm.decode(n.subarray(e,i)):(function(o,u,d){let p="",y=u;for(;y<d;){const x=o[y];let E,D,R,L=null,B=x>239?4:x>223?3:x>191?2:1;if(y+B>d)break;B===1?x<128&&(L=x):B===2?(E=o[y+1],(192&E)==128&&(L=(31&x)<<6|63&E,L<=127&&(L=null))):B===3?(E=o[y+1],D=o[y+2],(192&E)==128&&(192&D)==128&&(L=(15&x)<<12|(63&E)<<6|63&D,(L<=2047||L>=55296&&L<=57343)&&(L=null))):B===4&&(E=o[y+1],D=o[y+2],R=o[y+3],(192&E)==128&&(192&D)==128&&(192&R)==128&&(L=(15&x)<<18|(63&E)<<12|(63&D)<<6|63&R,(L<=65535||L>=1114112)&&(L=null))),L===null?(L=65533,B=1):L>65535&&(L-=65536,p+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),p+=String.fromCharCode(L),y+=B}return p})(n,e,i)}class Rh extends vu{offsetBuffer;constructor(e,i,o,u){super(e,o,u),this.offsetBuffer=i}}class bp extends Rh{textEncoder;constructor(e,i,o,u){super(e,i,o,u??i.length-1),this.textEncoder=new TextEncoder}getValueFromBuffer(e){return Gf(this.dataBuffer,this.offsetBuffer[e],this.offsetBuffer[e+1])}}class Cc extends Rh{indexBuffer;textEncoder;constructor(e,i,o,u,d){super(e,o,u,d??i.length),this.indexBuffer=i,this.indexBuffer=i,this.textEncoder=new TextEncoder}getValueFromBuffer(e){const i=this.indexBuffer[e];return Gf(this.dataBuffer,this.offsetBuffer[i],this.offsetBuffer[i+1])}}class xp extends Rh{indexBuffer;symbolOffsetBuffer;symbolTableBuffer;textEncoder;symbolLengthBuffer;lengthBuffer;decodedDictionary;constructor(e,i,o,u,d,p,y){super(e,o,u,y),this.indexBuffer=i,this.symbolOffsetBuffer=d,this.symbolTableBuffer=p,this.textEncoder=new TextEncoder}getValueFromBuffer(e){this.decodedDictionary==null&&(this.symbolLengthBuffer==null&&(this.symbolLengthBuffer=this.offsetToLengthBuffer(this.symbolOffsetBuffer),this.lengthBuffer=this.offsetToLengthBuffer(this.offsetBuffer)),this.decodedDictionary=(function(o,u,d){const p=[],y=new Array(u.length).fill(0);for(let x=1;x<u.length;x++)y[x]=y[x-1]+u[x-1];for(let x=0;x<d.length;x++)if(d[x]===255)p.push(d[++x]);else{const E=u[d[x]],D=y[d[x]];for(let R=0;R<E;R++)p.push(o[D+R])}return new Uint8Array(p)})(this.symbolTableBuffer,this.symbolLengthBuffer,this.dataBuffer));const i=this.indexBuffer[e];return Gf(this.decodedDictionary,this.offsetBuffer[i],this.offsetBuffer[i+1])}offsetToLengthBuffer(e){const i=new Uint32Array(e.length-1);let o=e[0];for(let u=1;u<e.length;u++){const d=e[u];i[u-1]=d-o,o=d}return i}}function Su(n,e,i,o,u,d){return i.type==="scalarType"?(function(p,y,x,E,D,R){let L=null,B=0;if(p===0)return null;if(R.nullable){const U=Gr(y,x);B=U.numValues;const q=x.get(),Y=Uf(y,B,x);x.set(q+U.byteLength),L=new eo(Y,U.numValues)}const V=L??E;switch(D.physicalType){case 4:case 3:return(function(U,q,Y,se,Q){const J=Gr(U,q),le=El(J,Q,U,q),he=se.physicalType===3;if(le===jn.FLAT){const Ae=Cs(Q)?zm(U,q,J,he,Q):qr(U,q,J,he);return new fp(Y.name,Ae,Q)}if(le===jn.SEQUENCE){const Ae=Cm(U,q,J);return new Tm(Y.name,Ae[0],Ae[1],J.numRleValues)}{const Ae=Am(U,q,J,he);return new Sm(Y.name,Ae,Q)}})(y,x,R,D,V);case 9:return(function(U,q,Y,se,Q){let J=null,le=null,he=null,Ae=null,Ve=null,Fe=null,$e=null,st=null;for(let Qe=0;Qe<se;Qe++){const Ne=Gr(q,Y);if(Ne.byteLength!==0)switch(Ne.physicalStreamType){case yr.PRESENT:{const Oe=Uf(q,Ne.numValues,Y);Fe=new eo(Oe,Ne.numValues);break}case yr.OFFSET:le=Q!=null||Fe!=null?zm(q,Y,Ne,!1,Q??Fe):qr(q,Y,Ne,!1);break;case yr.LENGTH:{const Oe=Tu(q,Y,Ne);Ur.DICTIONARY===Ne.logicalStreamType.lengthType?J=Oe:Ur.SYMBOL===Ne.logicalStreamType.lengthType?Ae=Oe:$e=Oe;break}case yr.DATA:{const Oe=q.subarray(Y.get(),Y.get()+Ne.byteLength);Y.add(Ne.byteLength);const dt=Ne.logicalStreamType.dictionaryType;Js.FSST===dt?Ve=Oe:Js.SINGLE===dt||Js.SHARED===dt?he=Oe:Js.NONE===dt&&(st=Oe);break}}}return(function(Qe,Ne,Oe,dt,ct,mt,lt){return Ne?new xp(Qe,Oe,dt,ct,mt,Ne,lt):null})(U,Ve,le,J,he,Ae,Q??Fe)??(function(Qe,Ne,Oe,dt,ct){return Ne?ct?new Cc(Qe,Oe,dt,Ne,ct):new Cc(Qe,Oe,dt,Ne):null})(U,he,le,J,Q??Fe)??(function(Qe,Ne,Oe,dt,ct){if(!Ne||!Oe)return null;if(dt)return ct?new Cc(Qe,dt,Ne,Oe,ct):new Cc(Qe,dt,Ne,Oe);if(ct&&ct.size()!==Ne.length-1){const mt=new Int32Array(ct.size());let lt=0;for(let Tt=0;Tt<ct.size();Tt++)mt[Tt]=ct.get(Tt)?lt++:0;return new Cc(Qe,mt,Ne,Oe,ct)}return ct?new bp(Qe,Ne,Oe,ct):new bp(Qe,Ne,Oe)})(U,$e,st,le,Q??Fe)})(R.name,y,x,R.nullable?p-1:p,L);case 0:return(function(U,q,Y,se,Q){const J=Gr(U,q),le=J.numValues,he=q.get(),Ae=Cs(Q)?(function(Fe,$e,st,Qe){const Ne=Kg(Fe,Math.ceil($e/8),st),Oe=new eo(Ne,$e),dt=Qe.size(),ct=new eo(new Uint8Array(dt),dt);let mt=0;for(let lt=0;lt<Qe.size();lt++){const Tt=!!Qe.get(lt)&&Oe.get(mt++);ct.set(lt,Tt)}return ct.getBuffer()})(U,le,q,Q):Uf(U,le,q);q.set(he+J.byteLength);const Ve=new eo(Ae,le);return new Yg(Y.name,Ve,Q)})(y,x,R,0,V);case 6:case 5:return(function(U,q,Y,se,Q){const J=Gr(U,q),le=El(J,se,U,q),he=Q.physicalType===5;if(le===jn.FLAT){const Ae=Cs(se)?(function(Ve,Fe,$e,st,Qe){return(function(Ne,Oe,dt,ct){switch(Oe.logicalLevelTechnique1){case Yt.DELTA:return Oe.logicalLevelTechnique2===Yt.RLE&&(Ne=qg(Ne,Oe.runs,Oe.numRleValues)),(function(mt,lt){const Tt=new BigInt64Array(mt.size());let fi=0;mt.get(0)?(Tt[0]=mt.get(0)?lt[0]>>1n^-(1n&lt[0]):0n,fi=1):Tt[0]=0n;let Wt=1;for(;Wt!=Tt.length;++Wt)Tt[Wt]=mt.get(Wt)?Tt[Wt-1]+(lt[fi]>>1n^-(1n&lt[fi++])):Tt[Wt-1];return Tt})(ct,Ne);case Yt.RLE:return(function(mt,lt,Tt,fi){const Wt=lt;return Tt?(function(bn,Zr,sr){const xn=new BigInt64Array(bn.size());let ln=0;for(let zi=0;zi<sr;zi++){const Ln=Number(Zr[zi]);let Nn=Zr[zi+sr];Nn=Nn>>1n^-(1n&Nn);for(let nn=ln;nn<ln+Ln;nn++)bn.get(nn)?xn[nn]=Nn:(xn[nn]=0n,ln++);ln+=Ln}return xn})(fi,mt,Wt.runs):(function(bn,Zr,sr){const xn=new BigInt64Array(bn.size());let ln=0;for(let zi=0;zi<sr;zi++){const Ln=Number(Zr[zi]),Nn=Zr[zi+sr];for(let nn=ln;nn<ln+Ln;nn++)bn.get(nn)?xn[nn]=Nn:(xn[nn]=0n,ln++);ln+=Ln}return xn})(fi,mt,Wt.runs)})(Ne,Oe,dt,ct);case Yt.NONE:return Ne=dt?(function(mt,lt){const Tt=new BigInt64Array(mt.size());let fi=0,Wt=0;for(;Wt!=Tt.length;++Wt)if(mt.get(Wt)){const bn=lt[fi++];Tt[Wt]=bn>>1n^-(1n&bn)}else Tt[Wt]=0n;return Tt})(ct,Ne):(function(mt,lt){const Tt=new BigInt64Array(mt.size());let fi=0,Wt=0;for(;Wt!=Tt.length;++Wt)Tt[Wt]=mt.get(Wt)?lt[fi++]:0n;return Tt})(ct,Ne),Ne;default:throw new Error("The specified Logical level technique is not supported")}})(Rf(Ve,Fe,$e.numValues),$e,st,Qe)})(U,q,J,he,se):zh(U,q,J,he);return new Ph(Y.name,Ae,se)}if(le===jn.SEQUENCE){const Ae=Ac(U,q,J);return new Pm(Y.name,Ae[0],Ae[1],J.numRleValues)}{const Ae=Dm(U,q,J,he);return new Vf(Y.name,Ae,se)}})(y,x,R,V,D);case 7:return(function(U,q,Y,se){const Q=Gr(U,q),J=Cs(se)?(function(le,he,Ae,Ve){const Fe=he.get(),$e=Fe+Ve*Float32Array.BYTES_PER_ELEMENT,st=new Uint8Array(le.subarray(Fe,$e)).buffer,Qe=new Float32Array(st);he.set($e);const Ne=Ae.size(),Oe=new Float32Array(Ne);let dt=0;for(let ct=0;ct<Ne;ct++)Oe[ct]=Ae.get(ct)?Qe[dt++]:0;return Oe})(U,q,se,Q.numValues):(function(le,he,Ae){const Ve=he.get(),Fe=Ve+Ae*Float32Array.BYTES_PER_ELEMENT,$e=new Uint8Array(le.subarray(Ve,Fe)).buffer,st=new Float32Array($e);return he.set(Fe),st})(U,q,Q.numValues);return new Qg(Y.name,J,se)})(y,x,R,V);case 8:return(function(U,q,Y,se){const Q=Gr(U,q),J=Cs(se)?(function(le,he,Ae,Ve){const Fe=he.get(),$e=Fe+Ve*Float64Array.BYTES_PER_ELEMENT,st=new Uint8Array(le.subarray(Fe,$e)).buffer,Qe=new Float64Array(st);he.set($e);const Ne=Ae.size(),Oe=new Float64Array(Ne);let dt=0;for(let ct=0;ct<Ne;ct++)Oe[ct]=Ae.get(ct)?Qe[dt++]:0;return Oe})(U,q,se,Q.numValues):(function(le,he,Ae){const Ve=he.get(),Fe=Ve+Ae*Float64Array.BYTES_PER_ELEMENT,$e=new Uint8Array(le.subarray(Ve,Fe)).buffer,st=new Float64Array($e);return he.set(Fe),st})(U,q,Q.numValues);return new xm(Y.name,J,se)})(y,x,R,V);default:throw new Error(`The specified data type for the field is currently not supported: ${D}`)}})(o,n,e,u,i.scalarType,i):o!=1?null:(function(p,y,x,E){let D=null,R=null,L=null,B=null,V=!1;for(;!V;){const se=Gr(p,y);switch(se.physicalStreamType){case yr.LENGTH:Ur.DICTIONARY===se.logicalStreamType.lengthType?D=Tu(p,y,se):L=Tu(p,y,se);break;case yr.DATA:Js.SINGLE===se.logicalStreamType.dictionaryType||Js.SHARED===se.logicalStreamType.dictionaryType?(R=p.subarray(y.get(),y.get()+se.byteLength),V=!0):B=p.subarray(y.get(),y.get()+se.byteLength),y.add(se.byteLength)}}const U=x.complexType.children,q=[];let Y=0;for(const se of U){const Q=ar(p,y,1)[0];if(Q==0)continue;const J=`${x.name}${se.name==="default"?"":":"+se.name}`;if(Q!==2||se.type!=="scalarField"||se.scalarField.physicalType!==9)throw new Error("Currently only optional string fields are implemented for a struct.");const le=Gr(p,y),he=Uf(p,le.numValues,y),Ae=Gr(p,y),Ve=Ae.decompressedCount!==E?zm(p,y,Ae,!1,new eo(he,le.numValues)):qr(p,y,Ae,!1);q[Y++]=B?new xp(J,Ve,D,R,L,B,new eo(he,le.numValues)):new Cc(J,Ve,D,R,new eo(he,le.numValues))}return q})(n,e,i,u)}function Cs(n){return n instanceof eo}function Eu(n){if(n.name==="id")return!1;if(n.type==="scalarType"){const e=n.scalarType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:default:return!1;case 9:return!0}else if(e.type==="logicalType")return!1}else if(n.type==="complexType"){const e=n.complexType;if(e.type==="physicalType")switch(e.physicalType){case 0:case 1:return!0;default:return!1}}return console.warn("Unexpected column type in hasStreamCount",n),!1}const qf=new TextDecoder;function Oh(n,e){const i=ar(n,e,1)[0];if(i===0)return"";const o=e.get(),u=n.subarray(o,o+i);return e.add(i),qf.decode(u)}function Al(n,e){const i=ar(n,e,1)[0]>>>0,o=!!(4&i),u=!!(2&i),d=ar(n,e,1)[0]>>>0,p={};if(1&i&&(p.nullable=!0),u){const y={};if(o?(y.type="logicalType",y.logicalType=d):(y.type="physicalType",y.physicalType=d),8&i){const x=ar(n,e,1)[0]>>>0;y.children=new Array(x);for(let E=0;E<x;E++)y.children[E]=Al(n,e)}p.type="complexField",p.complexField=y}else{const y={};o?(y.type="logicalType",y.logicalType=d):(y.type="physicalType",y.physicalType=d),p.type="scalarField",p.scalarField=y}return p}function j_(n,e){const i=ar(n,e,1)[0]>>>0,o=(function(u){switch(u){case 0:case 1:case 2:case 3:{const d={};d.nullable=!!(1&u),d.columnScope=0;const p={};return p.physicalType=u>1?6:4,p.type="physicalType",d.scalarType=p,d.type="scalarType",d}case 4:{const d={nullable:!1,columnScope:0},p={type:"physicalType",physicalType:0};return d.type="complexType",d.complexType=p,d}case 30:{const d={nullable:!1,columnScope:0},p={type:"physicalType",physicalType:1};return d.type="complexType",d.complexType=p,d}default:return(function(d){let p=null;switch(d){case 10:case 11:p=0;break;case 12:case 13:p=1;break;case 14:case 15:p=2;break;case 16:case 17:p=3;break;case 18:case 19:p=4;break;case 20:case 21:p=5;break;case 22:case 23:p=6;break;case 24:case 25:p=7;break;case 26:case 27:p=8;break;case 28:case 29:p=9;break;default:return null}const y={};y.nullable=!!(1&d),y.columnScope=0;const x={type:"physicalType"};return x.physicalType=p,y.type="scalarType",y.scalarType=x,y})(u)}})(i);if(!o)throw new Error(`Unsupported column type code: ${i}`);if((function(u){return u>=10})(i)?o.name=Oh(n,e):i>=0&&i<=3?o.name="id":i===4&&(o.name="geometry"),(function(u){return u===30})(i)){const u=ar(n,e,1)[0]>>>0,d=o.complexType;d.children=new Array(u);for(let p=0;p<u;p++)d.children[p]=Al(n,e)}return o}function Wg(n,e){const i={featureTables:[]},o={};o.name=Oh(n,e);const u=ar(n,e,1)[0]>>>0,d=ar(n,e,1)[0]>>>0;o.columns=new Array(d);for(let p=0;p<d;p++)o.columns[p]=j_(n,e);return i.featureTables.push(o),[i,u]}function Zf(n,e,i,o,u,d,p=!1){const y=e.scalarType.physicalType,x=El(u,d,n,i);if(y===4)switch(x){case jn.FLAT:{const E=qr(n,i,u,!1);return new fp(o,E,d)}case jn.SEQUENCE:{const E=Cm(n,i,u);return new Tm(o,E[0],E[1],u.numRleValues)}case jn.CONST:{const E=Am(n,i,u,!1);return new Sm(o,E,d)}}else switch(x){case jn.FLAT:{if(p){const D=(function(R,L,B,V){const U=(function(q,Y,se){const Q=new Float64Array(Y);for(let J=0;J<Y;J++)Q[J]=Gg(q,se);return Q})(R,B.numValues,L);return(function(q,Y,se){switch(Y.logicalLevelTechnique1){case Yt.DELTA:return Y.logicalLevelTechnique2===Yt.RLE&&(q=Zg(q,Y.runs,Y.numRleValues)),(function(Q){Q[0]=Q[0]%2==1?(Q[0]+1)/-2:Q[0]/2;const J=Q.length/4*4;let le=1;if(J>=4)for(;le<J-4;le+=4){const he=Q[le],Ae=Q[le+1],Ve=Q[le+2],Fe=Q[le+3];Q[le]=(he%2==1?(he+1)/-2:he/2)+Q[le-1],Q[le+1]=(Ae%2==1?(Ae+1)/-2:Ae/2)+Q[le],Q[le+2]=(Ve%2==1?(Ve+1)/-2:Ve/2)+Q[le+1],Q[le+3]=(Fe%2==1?(Fe+1)/-2:Fe/2)+Q[le+2]}for(;le!=Q.length;++le)Q[le]=(Q[le]%2==1?(Q[le]+1)/-2:Q[le]/2)+Q[le-1]})(q),q;case Yt.RLE:return(function(Q,J,le){return Zg(Q,J.runs,J.numRleValues)})(q,Y);case Yt.NONE:return q;default:throw new Error(`The specified Logical level technique is not supported: ${Y.logicalLevelTechnique1}`)}})(U,B)})(n,i,u);return new xm(o,D,d)}const E=zh(n,i,u,!1);return new Ph(o,E,d)}case jn.SEQUENCE:{const E=Ac(n,i,u);return new Pm(o,E[0],E[1],u.numRleValues)}case jn.CONST:{const E=Dm(n,i,u,!1);return new Vf(o,E,d)}}throw new Error("Vector type not supported for id column.")}class N_{constructor(e,i){var o;switch(this._featureData=e,this.properties=this._featureData.properties||{},(o=this._featureData.geometry)===null||o===void 0?void 0:o.type){case rr.POINT:case rr.MULTIPOINT:this.type=1;break;case rr.LINESTRING:case rr.MULTILINESTRING:this.type=2;break;case rr.POLYGON:case rr.MULTIPOLYGON:this.type=3;break;default:this.type=0}this.extent=i,this.id=Number(this._featureData.id)}loadGeometry(){const e=[];for(const i of this._featureData.geometry.coordinates){const o=[];for(const u of i)o.push(new ne(u.x,u.y));e.push(o)}return e}}class Jg{constructor(e){this.features=[],this.featureTable=e,this.name=e.name,this.extent=e.extent,this.version=2,this.features=e.getFeatures(),this.length=this.features.length}feature(e){return new N_(this.features[e],this.extent)}}class Hf{constructor(e){this.layers={};const i=(function(o,u,d=!0){const p=new Ug(0),y=[];for(;p.get()<o.length;){const x=ar(o,p,1)[0]>>>0,E=p.get()+x;if(E>o.length)throw new Error(`Block overruns tile: ${E} > ${o.length}`);if(ar(o,p,1)[0]>>>0!=1){p.set(E);continue}const D=Wg(o,p),R=D[1],L=D[0].featureTables[0];let B=null,V=null;const U=[];let q=0;for(const se of L.columns){const Q=se.name;if(Q==="id"){let J=null;if(se.nullable){const he=Gr(o,p),Ae=p.get(),Ve=Uf(o,he.numValues,p);p.set(Ae+he.byteLength),J=new eo(Ve,he.numValues)}const le=Gr(o,p);q=le.decompressedCount,B=Zf(o,se,p,Q,le,J??q,d)}else if(Q==="geometry"){const J=ar(o,p,1)[0];if(q===0){const le=p.get();q=Gr(o,p).decompressedCount,p.set(le)}V=Xg(o,J,p,q)}else{const J=Eu(se)?ar(o,p,1)[0]:1;if(J===0&&se.type==="scalarType")continue;const le=Su(o,p,se,J,q);if(le)if(Array.isArray(le))for(const he of le)U.push(he);else U.push(le)}}const Y=new bu(L.name,V,B,U,R);y.push(Y),p.set(E)}return y})(new Uint8Array(e));this.layers=i.reduce(((o,u)=>Object.assign(Object.assign({},o),{[u.name]:new Jg(u)})),{})}}class e_{constructor(e,i){this.feature=e,this.type=e.type,this.properties=e.tags?e.tags:{},this.extent=i,"id"in e&&(typeof e.id=="string"?this.id=parseInt(e.id,10):typeof e.id!="number"||isNaN(e.id)||(this.id=e.id))}loadGeometry(){const e=[],i=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const o of i){const u=[];for(const d of o)u.push(new ne(d[0],d[1]));e.push(u)}return e}}const $f="_geojsonTileLayer";function wp(n,e){e.writeVarintField(15,n.version||1),e.writeStringField(1,n.name||""),e.writeVarintField(5,n.extent||4096);const i={keys:[],values:[],keycache:{},valuecache:{}};for(let d=0;d<n.length;d++)i.feature=n.feature(d),e.writeMessage(2,Tp,i);const o=i.keys;for(const d of o)e.writeStringField(3,d);const u=i.values;for(const d of u)e.writeMessage(4,Sp,d)}function Tp(n,e){if(!n.feature)return;const i=n.feature;i.id!==void 0&&e.writeVarintField(1,i.id),e.writeMessage(2,t_,n),e.writeVarintField(3,i.type),e.writeMessage(4,Fm,i)}function t_(n,e){for(const i in n.feature?.properties){let o=n.feature.properties[i],u=n.keycache[i];if(o==null)continue;u===void 0&&(n.keys.push(i),u=n.keys.length-1,n.keycache[i]=u),e.writeVarint(u),typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"&&(o=JSON.stringify(o));const d=typeof o+":"+o;let p=n.valuecache[d];p===void 0&&(n.values.push(o),p=n.values.length-1,n.valuecache[d]=p),e.writeVarint(p)}}function Mu(n,e){return(e<<3)+(7&n)}function km(n){return n<<1^n>>31}function Fm(n,e){const i=n.loadGeometry(),o=n.type;let u=0,d=0;for(const p of i){let y=1;o===1&&(y=p.length),e.writeVarint(Mu(1,y));const x=o===3?p.length-1:p.length;for(let E=0;E<x;E++){E===1&&o!==1&&e.writeVarint(Mu(2,x-1));const D=p[E].x-u,R=p[E].y-d;e.writeVarint(km(D)),e.writeVarint(km(R)),u+=D,d+=R}n.type===3&&e.writeVarint(Mu(7,1))}}function Sp(n,e){const i=typeof n;i==="string"?e.writeStringField(1,n):i==="boolean"?e.writeBooleanField(7,n):i==="number"&&(n%1!=0?e.writeDoubleField(3,n):n<0?e.writeSVarintField(6,n):e.writeVarintField(5,n))}class jm{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Eo(Mt,16,0),this.grid3D=new Eo(Mt,16,0),this.featureIndexArray=new X,this.promoteId=i}insert(e,i,o,u,d,p){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(o,u,d);const x=p?this.grid3D:this.grid;for(let E=0;E<i.length;E++){const D=i[E],R=[1/0,1/0,-1/0,-1/0];for(let L=0;L<D.length;L++){const B=D[L];R[0]=Math.min(R[0],B.x),R[1]=Math.min(R[1],B.y),R[2]=Math.max(R[2],B.x),R[3]=Math.max(R[3],B.y)}R[0]<Mt&&R[1]<Mt&&R[2]>=0&&R[3]>=0&&x.insert(y,R[0],R[1],R[2],R[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=this.encoding!=="mlt"?new oi(new Qd(this.rawTileData)).layers:new Hf(this.rawTileData).layers,this.sourceLayerCoder=new bm(this.vtLayers?Object.keys(this.vtLayers).sort():[$f])),this.vtLayers}query(e,i,o,u){this.loadVTLayers();const d=e.params,p=Mt/e.tileSize/e.scale,y=Lr(d.filter,d.globalState),x=e.queryGeometry,E=e.queryPadding*p,D=yu.fromPoints(x),R=this.grid.query(D.minX-E,D.minY-E,D.maxX+E,D.maxY+E),L=yu.fromPoints(e.cameraQueryGeometry).expandBy(E),B=this.grid3D.query(L.minX,L.minY,L.maxX,L.maxY,((q,Y,se,Q)=>(function(J,le,he,Ae,Ve){for(const $e of J)if(le<=$e.x&&he<=$e.y&&Ae>=$e.x&&Ve>=$e.y)return!0;const Fe=[new ne(le,he),new ne(le,Ve),new ne(Ae,Ve),new ne(Ae,he)];if(J.length>2){for(const $e of Fe)if(zo(J,$e))return!0}for(let $e=0;$e<J.length-1;$e++)if(sg(J[$e],J[$e+1],Fe))return!0;return!1})(e.cameraQueryGeometry,q-E,Y-E,se+E,Q+E)));for(const q of B)R.push(q);R.sort(Ep);const V={};let U;for(let q=0;q<R.length;q++){const Y=R[q];if(Y===U)continue;U=Y;const se=this.featureIndexArray.get(Y);let Q=null;this.loadMatchingFeature(V,se.bucketIndex,se.sourceLayerIndex,se.featureIndex,y,d.layers,d.availableImages,i,o,u,((J,le,he)=>(Q||(Q=Xs(J)),le.queryIntersectsFeature({queryGeometry:x,feature:J,featureState:he,geometry:Q,zoom:this.z,transform:e.transform,pixelsToTileUnits:p,pixelPosMatrix:e.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:e.getElevation}))))}return V}loadMatchingFeature(e,i,o,u,d,p,y,x,E,D,R){const L=this.bucketLayerIDs[i];if(p&&!L.some((q=>p.has(q))))return;const B=this.sourceLayerCoder.decode(o),V=this.vtLayers[B].feature(u);if(d.needGeometry){const q=Xa(V,!0);if(!d.filter(new xi(this.tileID.overscaledZ),q,this.tileID.canonical))return}else if(!d.filter(new xi(this.tileID.overscaledZ),V))return;const U=this.getId(V,B);for(let q=0;q<L.length;q++){const Y=L[q];if(p&&!p.has(Y))continue;const se=x[Y];if(!se)continue;let Q={};U&&D&&(Q=D.getState(se.sourceLayer||$f,U));const J=Pi({},E[Y]);J.paint=i_(J.paint,se.paint,V,Q,y),J.layout=i_(J.layout,se.layout,V,Q,y);const le=!R||R(V,se,Q);if(!le)continue;const he=new cp(V,this.z,this.x,this.y,U);he.layer=J;let Ae=e[Y];Ae===void 0&&(Ae=e[Y]=[]),Ae.push({featureIndex:u,feature:he,intersectionZ:le})}}lookupSymbolFeatures(e,i,o,u,d,p,y,x){const E={};this.loadVTLayers();const D=Lr(d.filterSpec,d.globalState);for(const R of e)this.loadMatchingFeature(E,o,u,R,D,p,y,x,i);return E}hasLayer(e){for(const i of this.bucketLayerIDs)for(const o of i)if(e===o)return!0;return!1}getId(e,i){var o;let u=e.id;return this.promoteId&&(u=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof u=="boolean"&&(u=Number(u)),u===void 0&&(!((o=e.properties)===null||o===void 0)&&o.cluster)&&this.promoteId&&(u=Number(e.properties.cluster_id))),u}}function i_(n,e,i,o,u){return Tr(n,((d,p)=>{const y=e instanceof ul?e.get(p):null;return y&&y.evaluate?y.evaluate(i,o,u):y}))}function Ep(n,e){return e-n}function r(n,e,i,o,u){const d=[];for(let p=0;p<n.length;p++){const y=n[p];let x;for(let E=0;E<y.length-1;E++){let D=y[E],R=y[E+1];D.x<e&&R.x<e||(D.x<e?D=new ne(e,D.y+(e-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x<e&&(R=new ne(e,D.y+(e-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y<i&&R.y<i||(D.y<i?D=new ne(D.x+(i-D.y)/(R.y-D.y)*(R.x-D.x),i)._round():R.y<i&&(R=new ne(D.x+(i-D.y)/(R.y-D.y)*(R.x-D.x),i)._round()),D.x>=o&&R.x>=o||(D.x>=o?D=new ne(o,D.y+(o-D.x)/(R.x-D.x)*(R.y-D.y))._round():R.x>=o&&(R=new ne(o,D.y+(o-D.x)/(R.x-D.x)*(R.y-D.y))._round()),D.y>=u&&R.y>=u||(D.y>=u?D=new ne(D.x+(u-D.y)/(R.y-D.y)*(R.x-D.x),u)._round():R.y>=u&&(R=new ne(D.x+(u-D.y)/(R.y-D.y)*(R.x-D.x),u)._round()),x&&D.equals(x[x.length-1])||(x=[D],d.push(x)),x.push(R)))))}}return d}function s(n,e,i,o,u){switch(e){case 1:return(function(d,p,y,x){const E=[];for(const D of d)for(const R of D){const L=x===0?R.x:R.y;L>=p&&L<=y&&E.push([R])}return E})(n,i,o,u);case 2:return g(n,i,o,u,!1);case 3:return g(n,i,o,u,!0)}return[]}function c(n,e,i,o,u){const d=o===0?T:C;let p=[];const y=[];for(let D=0;D<n.length-1;D++){const R=n[D],L=n[D+1],B=o===0?R.x:R.y,V=o===0?L.x:L.y;let U=!1;B<e?V>e&&p.push(d(R,L,e)):B>i?V<i&&p.push(d(R,L,i)):p.push(R),V<e&&B>=e&&(p.push(d(R,L,e)),U=!0),V>i&&B<=i&&(p.push(d(R,L,i)),U=!0),!u&&U&&(y.push(p),p=[])}const x=n.length-1,E=o===0?n[x].x:n[x].y;return E>=e&&E<=i&&p.push(n[x]),u&&p.length>0&&!p[0].equals(p[p.length-1])&&p.push(new ne(p[0].x,p[0].y)),p.length>0&&y.push(p),y}function g(n,e,i,o,u){const d=[];for(const p of n){const y=c(p,e,i,o,u);y.length>0&&d.push(...y)}return d}function T(n,e,i){return new ne(i,n.y+(i-n.x)/(e.x-n.x)*(e.y-n.y))}function C(n,e,i){return new ne(n.x+(i-n.y)/(e.y-n.y)*(e.x-n.x),i)}ut("FeatureIndex",jm,{omit:["rawTileData","sourceLayerCoder"]});class N extends ne{constructor(e,i,o,u){super(e,i),this.angle=o,u!==void 0&&(this.segment=u)}clone(){return new N(this.x,this.y,this.angle,this.segment)}}function K(n,e,i,o,u){if(e.segment===void 0||i===0)return!0;let d=e,p=e.segment+1,y=0;for(;y>-i/2;){if(p--,p<0)return!1;y-=n[p].dist(d),d=n[p]}y+=n[p].dist(n[p+1]),p++;const x=[];let E=0;for(;y<i/2;){const D=n[p],R=n[p+1];if(!R)return!1;let L=n[p-1].angleTo(D)-D.angleTo(R);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),x.push({distance:y,angleDelta:L}),E+=L;y-x[0].distance>o;)E-=x.shift().angleDelta;if(E>u)return!1;p++,y+=D.dist(R)}return!0}function me(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Be(n,e,i){return n?.6*e*i:0}function Ze(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function We(n,e,i,o,u,d){const p=Be(i,u,d),y=Ze(i,o)*d;let x=0;const E=me(n)/2;for(let D=0;D<n.length-1;D++){const R=n[D],L=n[D+1],B=R.dist(L);if(x+B>E){const V=(E-x)/B,U=Wi.number(R.x,L.x,V),q=Wi.number(R.y,L.y,V),Y=new N(U,q,L.angleTo(R),D);return Y._round(),!p||K(n,Y,y,p,e)?Y:void 0}x+=B}}function ke(n,e,i,o,u,d,p,y,x){const E=Be(o,d,p),D=Ze(o,u),R=D*p,L=n[0].x===0||n[0].x===x||n[0].y===0||n[0].y===x;return e-R<e/4&&(e=R+e/4),je(n,L?e/2*y%e:(D/2+2*d)*p*y%e,e,E,i,R,L,!1,x)}function je(n,e,i,o,u,d,p,y,x){const E=d/2,D=me(n);let R=0,L=e-i,B=[];for(let V=0;V<n.length-1;V++){const U=n[V],q=n[V+1],Y=U.dist(q),se=q.angleTo(U);for(;L+i<R+Y;){L+=i;const Q=(L-R)/Y,J=Wi.number(U.x,q.x,Q),le=Wi.number(U.y,q.y,Q);if(J>=0&&J<x&&le>=0&&le<x&&L-E>=0&&L+E<=D){const he=new N(J,le,se,V);he._round(),o&&!K(n,he,d,o,u)||B.push(he)}}R+=Y}return y||B.length||p||(B=je(n,R/2,i,o,u,d,p,!0,x)),B}function xt(n,e,i,o){const u=[],d=n.image,p=d.pixelRatio,y=d.paddedRect.w-2,x=d.paddedRect.h-2;let E={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const D=d.stretchX||[[0,y]],R=d.stretchY||[[0,x]],L=(Oe,dt)=>Oe+dt[1]-dt[0],B=D.reduce(L,0),V=R.reduce(L,0),U=y-B,q=x-V;let Y=0,se=B,Q=0,J=V,le=0,he=U,Ae=0,Ve=q;if(d.content&&o){const Oe=d.content,dt=Oe[2]-Oe[0],ct=Oe[3]-Oe[1];(d.textFitWidth||d.textFitHeight)&&(E=Sl(n)),Y=Ot(D,0,Oe[0]),Q=Ot(R,0,Oe[1]),se=Ot(D,Oe[0],Oe[2]),J=Ot(R,Oe[1],Oe[3]),le=Oe[0]-Y,Ae=Oe[1]-Q,he=dt-se,Ve=ct-J}const Fe=E.x1,$e=E.y1,st=E.x2-Fe,Qe=E.y2-$e,Ne=(Oe,dt,ct,mt)=>{const lt=Te(Oe.stretch-Y,se,st,Fe),Tt=ve(Oe.fixed-le,he,Oe.stretch,B),fi=Te(dt.stretch-Q,J,Qe,$e),Wt=ve(dt.fixed-Ae,Ve,dt.stretch,V),bn=Te(ct.stretch-Y,se,st,Fe),Zr=ve(ct.fixed-le,he,ct.stretch,B),sr=Te(mt.stretch-Q,J,Qe,$e),xn=ve(mt.fixed-Ae,Ve,mt.stretch,V),ln=new ne(lt,fi),zi=new ne(bn,fi),Ln=new ne(bn,sr),Nn=new ne(lt,sr),nn=new ne(Tt/p,Wt/p),Wa=new ne(Zr/p,xn/p),Hr=e*Math.PI/180;if(Hr){const br=Math.sin(Hr),Mn=Math.cos(Hr),or=[Mn,-br,br,Mn];ln._matMult(or),zi._matMult(or),Nn._matMult(or),Ln._matMult(or)}const Ja=Oe.stretch+Oe.fixed,Bo=dt.stretch+dt.fixed;return{tl:ln,tr:zi,bl:Nn,br:Ln,tex:{x:d.paddedRect.x+1+Ja,y:d.paddedRect.y+1+Bo,w:ct.stretch+ct.fixed-Ja,h:mt.stretch+mt.fixed-Bo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nn,pixelOffsetBR:Wa,minFontScaleX:he/p/st,minFontScaleY:Ve/p/Qe,isSDF:i}};if(o&&(d.stretchX||d.stretchY)){const Oe=Hi(D,U,B),dt=Hi(R,q,V);for(let ct=0;ct<Oe.length-1;ct++){const mt=Oe[ct],lt=Oe[ct+1];for(let Tt=0;Tt<dt.length-1;Tt++)u.push(Ne(mt,dt[Tt],lt,dt[Tt+1]))}}else u.push(Ne({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:x+1}));return u}function Ot(n,e,i){let o=0;for(const u of n)o+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return o}function Hi(n,e,i){const o=[{fixed:-1,stretch:0}];for(const[u,d]of n){const p=o[o.length-1];o.push({fixed:u-p.stretch,stretch:p.stretch}),o.push({fixed:u-p.stretch,stretch:p.stretch+(d-u)})}return o.push({fixed:e+1,stretch:i}),o}function Te(n,e,i,o){return n/e*i+o}function ve(n,e,i,o){return n-e*i/o}ut("Anchor",N);class Re{constructor(e,i,o,u,d,p,y,x,E,D){var R;if(this.boxStartIndex=e.length,E){let L=p.top,B=p.bottom;const V=p.collisionPadding;V&&(L-=V[1],B+=V[3]);let U=B-L;U>0&&(U=Math.max(10,U),this.circleDiameter=U)}else{const L=!((R=p.image)===null||R===void 0)&&R.content&&(p.image.textFitWidth||p.image.textFitHeight)?Sl(p):{x1:p.left,y1:p.top,x2:p.right,y2:p.bottom};L.y1=L.y1*y-x[0],L.y2=L.y2*y+x[2],L.x1=L.x1*y-x[3],L.x2=L.x2*y+x[1];const B=p.collisionPadding;if(B&&(L.x1-=B[0]*y,L.y1-=B[1]*y,L.x2+=B[2]*y,L.y2+=B[3]*y),D){const V=new ne(L.x1,L.y1),U=new ne(L.x2,L.y1),q=new ne(L.x1,L.y2),Y=new ne(L.x2,L.y2),se=D*Math.PI/180;V._rotate(se),U._rotate(se),q._rotate(se),Y._rotate(se),L.x1=Math.min(V.x,U.x,q.x,Y.x),L.x2=Math.max(V.x,U.x,q.x,Y.x),L.y1=Math.min(V.y,U.y,q.y,Y.y),L.y2=Math.max(V.y,U.y,q.y,Y.y)}e.emplaceBack(i.x,i.y,L.x1,L.y1,L.x2,L.y2,o,u,d)}this.boxEndIndex=e.length}}class Ye{constructor(e=[],i=(o,u)=>o<u?-1:o>u?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:o}=this,u=i[e];for(;e>0;){const d=e-1>>1,p=i[d];if(o(u,p)>=0)break;i[e]=p,e=d}i[e]=u}_down(e){const{data:i,compare:o}=this,u=this.length>>1,d=i[e];for(;e<u;){let p=1+(e<<1);const y=p+1;if(y<this.length&&o(i[y],i[p])<0&&(p=y),o(i[p],d)>=0)break;i[e]=i[p],e=p}i[e]=d}}function It(n,e=1,i=!1){const o=yu.fromPoints(n[0]),u=Math.min(o.width(),o.height());let d=u/2;const p=new Ye([],Di),{minX:y,minY:x,maxX:E,maxY:D}=o;if(u===0)return new ne(y,x);for(let B=y;B<E;B+=u)for(let V=x;V<D;V+=u)p.push(new wt(B+d,V+d,d,n));let R=(function(B){let V=0,U=0,q=0;const Y=B[0];for(let se=0,Q=Y.length,J=Q-1;se<Q;J=se++){const le=Y[se],he=Y[J],Ae=le.x*he.y-he.x*le.y;U+=(le.x+he.x)*Ae,q+=(le.y+he.y)*Ae,V+=3*Ae}return new wt(U/V,q/V,0,B)})(n),L=p.length;for(;p.length;){const B=p.pop();(B.d>R.d||!R.d)&&(R=B,i&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-R.d<=e||(d=B.h/2,p.push(new wt(B.p.x-d,B.p.y-d,d,n)),p.push(new wt(B.p.x+d,B.p.y-d,d,n)),p.push(new wt(B.p.x-d,B.p.y+d,d,n)),p.push(new wt(B.p.x+d,B.p.y+d,d,n)),L+=4)}return i&&(console.log(`num probes: ${L}`),console.log(`best distance: ${R.d}`)),R.p}function Di(n,e){return e.max-n.max}function wt(n,e,i,o){this.p=new ne(n,e),this.h=i,this.d=(function(u,d){let p=!1,y=1/0;for(let x=0;x<d.length;x++){const E=d[x];for(let D=0,R=E.length,L=R-1;D<R;L=D++){const B=E[D],V=E[L];B.y>u.y!=V.y>u.y&&u.x<(V.x-B.x)*(u.y-B.y)/(V.y-B.y)+B.x&&(p=!p),y=Math.min(y,Up(u,B,V))}}return(p?1:-1)*Math.sqrt(y)})(this.p,o),this.max=this.d+this.h*Math.SQRT2}var Dt;P.aP=void 0,(Dt=P.aP||(P.aP={}))[Dt.center=1]="center",Dt[Dt.left=2]="left",Dt[Dt.right=3]="right",Dt[Dt.top=4]="top",Dt[Dt.bottom=5]="bottom",Dt[Dt["top-left"]=6]="top-left",Dt[Dt["top-right"]=7]="top-right",Dt[Dt["bottom-left"]=8]="bottom-left",Dt[Dt["bottom-right"]=9]="bottom-right";const ai=Number.POSITIVE_INFINITY;function Ti(n,e){return e[1]!==ai?(function(i,o,u){let d=0,p=0;switch(o=Math.abs(o),u=Math.abs(u),i){case"top-right":case"top-left":case"top":p=u-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-u}switch(i){case"top-right":case"bottom-right":case"right":d=-o;break;case"top-left":case"bottom-left":case"left":d=o}return[d,p]})(n,e[0],e[1]):(function(i,o){let u=0,d=0;o<0&&(o=0);const p=o/Math.SQRT2;switch(i){case"top-right":case"top-left":d=p-7;break;case"bottom-right":case"bottom-left":d=7-p;break;case"bottom":d=7-o;break;case"top":d=o-7}switch(i){case"top-right":case"bottom-right":u=-p;break;case"top-left":case"bottom-left":u=p;break;case"left":u=o;break;case"right":u=-o}return[u,d]})(n,e[0])}function Cl(n,e,i){var o;const u=n.layout,d=(o=u.get("text-variable-anchor-offset"))===null||o===void 0?void 0:o.evaluate(e,{},i);if(d){const y=d.values,x=[];for(let E=0;E<y.length;E+=2){const D=x[E]=y[E],R=y[E+1].map((L=>L*Xn));D.startsWith("top")?R[1]-=7:D.startsWith("bottom")&&(R[1]+=7),x[E+1]=R}return new pn(x)}const p=u.get("text-variable-anchor");if(p){let y;y=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[u.get("text-radial-offset").evaluate(e,{},i)*Xn,ai]:u.get("text-offset").evaluate(e,{},i).map((E=>E*Xn));const x=[];for(const E of p)x.push(E,Ti(E,y));return new pn(x)}return null}function Nm(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Q0(n,e,i,o,u,d,p,y,x,E,D,R){let L=d.textMaxSize.evaluate(e,{});L===void 0&&(L=p);const B=n.layers[0].layout,V=B.get("icon-offset").evaluate(e,{},D),U=Gy(i.horizontal),q=p/24,Y=n.tilePixelRatio*q,se=n.tilePixelRatio*L/24,Q=n.tilePixelRatio*y,J=n.tilePixelRatio*B.get("symbol-spacing"),le=B.get("text-padding")*n.tilePixelRatio,he=(function(ct,mt,lt,Tt=1){const fi=ct.get("icon-padding").evaluate(mt,{},lt),Wt=fi&&fi.values;return[Wt[0]*Tt,Wt[1]*Tt,Wt[2]*Tt,Wt[3]*Tt]})(B,e,D,n.tilePixelRatio),Ae=B.get("text-max-angle")/180*Math.PI,Ve=B.get("text-rotation-alignment")!=="viewport"&&B.get("symbol-placement")!=="point",Fe=B.get("icon-rotation-alignment")==="map"&&B.get("symbol-placement")!=="point",$e=B.get("symbol-placement"),st=J/2,Qe=B.get("icon-text-fit");let Ne;o&&Qe!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(Ne=Ks(o,i.vertical,Qe,B.get("icon-text-fit-padding"),V,q)),U&&(o=Ks(o,U,Qe,B.get("icon-text-fit-padding"),V,q)));const Oe=D?R.line.getGranularityForZoomLevel(D.z):1,dt=(ct,mt)=>{mt.x<0||mt.x>=Mt||mt.y<0||mt.y>=Mt||(function(lt,Tt,fi,Wt,bn,Zr,sr,xn,ln,zi,Ln,Nn,nn,Wa,Hr,Ja,Bo,br,Mn,or,Bn,xr,Dc,Dl,Gm){const Lh=lt.addToLineVertexArray(Tt,fi);let Xf,Mp,Ap,Cp,$y=0,Xy=0,Yy=0,Qy=0,X_=-1,Y_=-1;const zc={};let Ky=yn("");if(lt.allowVerticalPlacement&&Wt.vertical){const ha=xn.layout.get("text-rotate").evaluate(Bn,{},Dl)+90;Ap=new Re(ln,Tt,zi,Ln,Nn,Wt.vertical,nn,Wa,Hr,ha),sr&&(Cp=new Re(ln,Tt,zi,Ln,Nn,sr,Bo,br,Hr,ha))}if(bn){const ha=xn.layout.get("icon-rotate").evaluate(Bn,{}),to=xn.layout.get("icon-text-fit")!=="none",Yf=xt(bn,ha,Dc,to),Pl=sr?xt(sr,ha,Dc,to):void 0;Mp=new Re(ln,Tt,zi,Ln,Nn,bn,Bo,br,!1,ha),$y=4*Yf.length;const Qf=lt.iconSizeData;let Au=null;Qf.kind==="source"?(Au=[Qa*xn.layout.get("icon-size").evaluate(Bn,{})],Au[0]>gu&&rn(`${lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Qf.kind==="composite"&&(Au=[Qa*xr.compositeIconSizes[0].evaluate(Bn,{},Dl),Qa*xr.compositeIconSizes[1].evaluate(Bn,{},Dl)],(Au[0]>gu||Au[1]>gu)&&rn(`${lt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),lt.addSymbols(lt.icon,Yf,Au,or,Mn,Bn,P.az.none,Tt,Lh.lineStartIndex,Lh.lineLength,-1,Dl),X_=lt.icon.placedSymbolArray.length-1,Pl&&(Xy=4*Pl.length,lt.addSymbols(lt.icon,Pl,Au,or,Mn,Bn,P.az.vertical,Tt,Lh.lineStartIndex,Lh.lineLength,-1,Dl),Y_=lt.icon.placedSymbolArray.length-1)}const Wy=Object.keys(Wt.horizontal);for(const ha of Wy){const to=Wt.horizontal[ha];if(!Xf){Ky=yn(to.text);const Pl=xn.layout.get("text-rotate").evaluate(Bn,{},Dl);Xf=new Re(ln,Tt,zi,Ln,Nn,to,nn,Wa,Hr,Pl)}const Yf=to.positionedLines.length===1;if(Yy+=Uy(lt,Tt,to,Zr,xn,Hr,Bn,Ja,Lh,Wt.vertical?P.az.horizontal:P.az.horizontalOnly,Yf?Wy:[ha],zc,X_,xr,Dl),Yf)break}Wt.vertical&&(Qy+=Uy(lt,Tt,Wt.vertical,Zr,xn,Hr,Bn,Ja,Lh,P.az.vertical,["vertical"],zc,Y_,xr,Dl));const J0=Xf?Xf.boxStartIndex:lt.collisionBoxArray.length,eb=Xf?Xf.boxEndIndex:lt.collisionBoxArray.length,tb=Ap?Ap.boxStartIndex:lt.collisionBoxArray.length,ib=Ap?Ap.boxEndIndex:lt.collisionBoxArray.length,nb=Mp?Mp.boxStartIndex:lt.collisionBoxArray.length,rb=Mp?Mp.boxEndIndex:lt.collisionBoxArray.length,ab=Cp?Cp.boxStartIndex:lt.collisionBoxArray.length,sb=Cp?Cp.boxEndIndex:lt.collisionBoxArray.length;let zl=-1;const r_=(ha,to)=>ha&&ha.circleDiameter?Math.max(ha.circleDiameter,to):to;zl=r_(Xf,zl),zl=r_(Ap,zl),zl=r_(Mp,zl),zl=r_(Cp,zl);const Jy=zl>-1?1:0;Jy&&(zl*=Gm/Xn),lt.glyphOffsetArray.length>=Mh.MAX_GLYPHS&&rn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Bn.sortKey!==void 0&&lt.addToSortKeyRanges(lt.symbolInstances.length,Bn.sortKey);const ob=Cl(xn,Bn,Dl),[lb,ub]=(function(ha,to){const Yf=ha.length,Pl=to?.values;if(Pl?.length>0)for(let Qf=0;Qf<Pl.length;Qf+=2){const Au=Pl[Qf+1];ha.emplaceBack(P.aP[Pl[Qf]],Au[0],Au[1])}return[Yf,ha.length]})(lt.textAnchorOffsets,ob);lt.symbolInstances.emplaceBack(Tt.x,Tt.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical||-1,X_,Y_,Ky,J0,eb,tb,ib,nb,rb,ab,sb,zi,Yy,Qy,$y,Xy,Jy,0,nn,zl,lb,ub)})(n,mt,ct,i,o,u,Ne,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,Y,[le,le,le,le],Ve,x,Q,he,Fe,V,e,d,E,D,p)};if($e==="line")for(const ct of r(e.geometry,0,0,Mt,Mt)){const mt=vl(ct,Oe),lt=ke(mt,J,Ae,i.vertical||U,o,24,se,n.overscaling,Mt);for(const Tt of lt)U&&K0(n,U.text,st,Tt)||dt(mt,Tt)}else if($e==="line-center"){for(const ct of e.geometry)if(ct.length>1){const mt=vl(ct,Oe),lt=We(mt,Ae,i.vertical||U,o,24,se);lt&&dt(mt,lt)}}else if(e.type==="Polygon")for(const ct of $u(e.geometry,0)){const mt=It(ct,16);dt(vl(ct[0],Oe,!0),new N(mt.x,mt.y,0))}else if(e.type==="LineString")for(const ct of e.geometry){const mt=vl(ct,Oe);dt(mt,new N(mt[0].x,mt[0].y,0))}else if(e.type==="Point")for(const ct of e.geometry)for(const mt of ct)dt([mt],new N(mt.x,mt.y,0))}function Uy(n,e,i,o,u,d,p,y,x,E,D,R,L,B,V){const U=(function(se,Q,J,le,he,Ae,Ve,Fe){const $e=le.layout.get("text-rotate").evaluate(Ae,{})*Math.PI/180,st=[];for(const Qe of Q.positionedLines)for(const Ne of Qe.positionedGlyphs){if(!Ne.rect)continue;const Oe=Ne.rect||{};let dt=4,ct=!0,mt=1,lt=0;const Tt=(he||Fe)&&Ne.vertical,fi=Ne.metrics.advance*Ne.scale/2;if(Fe&&Q.verticalizable&&(lt=Qe.lineOffset/2-(Ne.imageName?-(Xn-Ne.metrics.width*Ne.scale)/2:(Ne.scale-1)*Xn)),Ne.imageName){const br=Ve[Ne.imageName];ct=br.sdf,mt=br.pixelRatio,dt=1/mt}const Wt=he?[Ne.x+fi,Ne.y]:[0,0];let bn=he?[0,0]:[Ne.x+fi+J[0],Ne.y+J[1]-lt],Zr=[0,0];Tt&&(Zr=bn,bn=[0,0]);const sr=Ne.metrics.isDoubleResolution?2:1,xn=(Ne.metrics.left-dt)*Ne.scale-fi+bn[0],ln=(-Ne.metrics.top-dt)*Ne.scale+bn[1],zi=xn+Oe.w/sr*Ne.scale/mt,Ln=ln+Oe.h/sr*Ne.scale/mt,Nn=new ne(xn,ln),nn=new ne(zi,ln),Wa=new ne(xn,Ln),Hr=new ne(zi,Ln);if(Tt){const br=new ne(-fi,fi- -17),Mn=-Math.PI/2,or=12-fi,Bn=new ne(22-or,-(Ne.imageName?or:0)),xr=new ne(...Zr);Nn._rotateAround(Mn,br)._add(Bn)._add(xr),nn._rotateAround(Mn,br)._add(Bn)._add(xr),Wa._rotateAround(Mn,br)._add(Bn)._add(xr),Hr._rotateAround(Mn,br)._add(Bn)._add(xr)}if($e){const br=Math.sin($e),Mn=Math.cos($e),or=[Mn,-br,br,Mn];Nn._matMult(or),nn._matMult(or),Wa._matMult(or),Hr._matMult(or)}const Ja=new ne(0,0),Bo=new ne(0,0);st.push({tl:Nn,tr:nn,bl:Wa,br:Hr,tex:Oe,writingMode:Q.writingMode,glyphOffset:Wt,sectionIndex:Ne.sectionIndex,isSDF:ct,pixelOffsetTL:Ja,pixelOffsetBR:Bo,minFontScaleX:0,minFontScaleY:0})}return st})(0,i,y,u,d,p,o,n.allowVerticalPlacement),q=n.textSizeData;let Y=null;q.kind==="source"?(Y=[Qa*u.layout.get("text-size").evaluate(p,{})],Y[0]>gu&&rn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):q.kind==="composite"&&(Y=[Qa*B.compositeTextSizes[0].evaluate(p,{},V),Qa*B.compositeTextSizes[1].evaluate(p,{},V)],(Y[0]>gu||Y[1]>gu)&&rn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,U,Y,y,d,p,E,e,x.lineStartIndex,x.lineLength,L,V);for(const se of D)R[se]=n.text.placedSymbolArray.length-1;return 4*U.length}function Gy(n){for(const e in n)return n[e];return null}function K0(n,e,i,o){const u=n.compareText;if(e in u){const d=u[e];for(let p=d.length-1;p>=0;p--)if(o.dist(d[p])<i)return!0}else u[e]=[];return u[e].push(o),!1}const qy=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class V_{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,o]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=o>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const d=qy[15&o];if(!d)throw new Error("Unrecognized array type.");const[p]=new Uint16Array(e,2,1),[y]=new Uint32Array(e,4,1);return new V_(y,p,d,e)}constructor(e,i=64,o=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=o,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const d=qy.indexOf(this.ArrayType),p=2*e*this.ArrayType.BYTES_PER_ELEMENT,y=e*this.IndexArrayType.BYTES_PER_ELEMENT,x=(8-y%8)%8;if(d<0)throw new Error(`Unexpected typed array class: ${o}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+x,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+p+y+x),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+y+x,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+d]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=e,this.coords[this._pos++]=i,o}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return U_(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:p,nodeSize:y}=this,x=[0,d.length-1,0],E=[];for(;x.length;){const D=x.pop()||0,R=x.pop()||0,L=x.pop()||0;if(R-L<=y){for(let q=L;q<=R;q++){const Y=p[2*q],se=p[2*q+1];Y>=e&&Y<=o&&se>=i&&se<=u&&E.push(d[q])}continue}const B=L+R>>1,V=p[2*B],U=p[2*B+1];V>=e&&V<=o&&U>=i&&U<=u&&E.push(d[B]),(D===0?e<=V:i<=U)&&(x.push(L),x.push(B-1),x.push(1-D)),(D===0?o>=V:u>=U)&&(x.push(B+1),x.push(R),x.push(1-D))}return E}within(e,i,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:d,nodeSize:p}=this,y=[0,u.length-1,0],x=[],E=o*o;for(;y.length;){const D=y.pop()||0,R=y.pop()||0,L=y.pop()||0;if(R-L<=p){for(let q=L;q<=R;q++)Hy(d[2*q],d[2*q+1],e,i)<=E&&x.push(u[q]);continue}const B=L+R>>1,V=d[2*B],U=d[2*B+1];Hy(V,U,e,i)<=E&&x.push(u[B]),(D===0?e-o<=V:i-o<=U)&&(y.push(L),y.push(B-1),y.push(1-D)),(D===0?e+o>=V:i+o>=U)&&(y.push(B+1),y.push(R),y.push(1-D))}return x}}function U_(n,e,i,o,u,d){if(u-o<=i)return;const p=o+u>>1;Zy(n,e,p,o,u,d),U_(n,e,i,o,p-1,1-d),U_(n,e,i,p+1,u,1-d)}function Zy(n,e,i,o,u,d){for(;u>o;){if(u-o>600){const E=u-o+1,D=i-o+1,R=Math.log(E),L=.5*Math.exp(2*R/3),B=.5*Math.sqrt(R*L*(E-L)/E)*(D-E/2<0?-1:1);Zy(n,e,i,Math.max(o,Math.floor(i-D*L/E+B)),Math.min(u,Math.floor(i+(E-D)*L/E+B)),d)}const p=e[2*i+d];let y=o,x=u;for(Vm(n,e,o,i),e[2*u+d]>p&&Vm(n,e,o,u);y<x;){for(Vm(n,e,y,x),y++,x--;e[2*y+d]<p;)y++;for(;e[2*x+d]>p;)x--}e[2*o+d]===p?Vm(n,e,o,x):(x++,Vm(n,e,x,u)),x<=i&&(o=x+1),i<=x&&(u=x-1)}}function Vm(n,e,i,o){G_(n,i,o),G_(e,2*i,2*o),G_(e,2*i+1,2*o+1)}function G_(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}function Hy(n,e,i,o){const u=n-i,d=e-o;return u*u+d*d}var q_;P.cH=void 0,(q_=P.cH||(P.cH={})).create="create",q_.load="load",q_.fullLoad="fullLoad";let n_=null,Um=[];const Z_=1e3/60,H_="loadTime",$_="fullLoadTime",W0={mark(n){performance.mark(n)},frame(n){const e=n;n_!=null&&Um.push(e-n_),n_=e},clearMetrics(){n_=null,Um=[],performance.clearMeasures(H_),performance.clearMeasures($_);for(const n in P.cH)performance.clearMarks(P.cH[n])},getPerformanceMetrics(){performance.measure(H_,P.cH.create,P.cH.load),performance.measure($_,P.cH.create,P.cH.fullLoad);const n=performance.getEntriesByName(H_)[0].duration,e=performance.getEntriesByName($_)[0].duration,i=Um.length,o=1/(Um.reduce(((d,p)=>d+p),0)/i/1e3),u=Um.filter((d=>d>Z_)).reduce(((d,p)=>d+(p-Z_)/Z_),0);return{loadTime:n,fullLoadTime:e,fps:o,percentDroppedFrames:u/(i+u)*100,totalFrames:i}}};P.$=xe,P.A=Ct,P.B=Va,P.C=$n,P.D=ft,P.E=ii,P.F=function([n,e,i]){return e+=90,e*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(i),y:n*Math.sin(e)*Math.sin(i),z:n*Math.cos(i)}},P.G=Wi,P.H=xi,P.I=Fi,P.J=rh,P.K=function(n){if(hn==null){const e=n.navigator?n.navigator.userAgent:null;hn=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return hn},P.L=class{constructor(n,e){this.target=n,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new op((()=>this.process())),this.subscription=Fl(this.target,"message",(i=>this.receive(i)),!1),this.globalScope=pa(self)?n:window}registerMessageHandler(n,e){this.messageHandlers[n]=e}unregisterMessageHandler(n){delete this.messageHandlers[n]}sendAsync(n,e){return new Promise(((i,o)=>{const u=Math.round(1e18*Math.random()).toString(36).substring(0,10),d=e?Fl(e.signal,"abort",(()=>{d?.unsubscribe(),delete this.resolveRejects[u];const x={id:u,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(x)}),gm):null;this.resolveRejects[u]={resolve:x=>{d?.unsubscribe(),i(x)},reject:x=>{d?.unsubscribe(),o(x)}};const p=[],y=Object.assign(Object.assign({},n),{id:u,sourceMapId:this.mapId,origin:location.origin,data:Ua(n.data,p)});this.target.postMessage(y,{transfer:p})}))}receive(n){const e=n.data,i=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[i];const o=this.abortControllers[i];return delete this.abortControllers[i],void(o&&o.abort())}if(pa(self)||e.mustQueue)return this.tasks[i]=e,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,e)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),e=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(n,e)}processTask(n,e){return h(this,void 0,void 0,(function*(){if(e.type==="<response>"){const u=this.resolveRejects[n];return delete this.resolveRejects[n],u?void(e.error?u.reject(su(e.error)):u.resolve(su(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=su(e.data),o=new AbortController;this.abortControllers[n]=o;try{const u=yield this.messageHandlers[e.type](e.sourceMapId,i,o);this.completeTask(n,null,u)}catch(u){this.completeTask(n,u)}}))}completeTask(n,e,i){const o=[];delete this.abortControllers[n];const u={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?Ua(e):null,data:Ua(i,o)};this.target.postMessage(u,{transfer:o})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},P.M=we,P.N=function(){var n=new Ct(16);return Ct!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},P.O=function(n,e,i){var o,u,d,p,y,x,E,D,R,L,B,V,U=i[0],q=i[1],Y=i[2];return e===n?(n[12]=e[0]*U+e[4]*q+e[8]*Y+e[12],n[13]=e[1]*U+e[5]*q+e[9]*Y+e[13],n[14]=e[2]*U+e[6]*q+e[10]*Y+e[14],n[15]=e[3]*U+e[7]*q+e[11]*Y+e[15]):(u=e[1],d=e[2],p=e[3],y=e[4],x=e[5],E=e[6],D=e[7],R=e[8],L=e[9],B=e[10],V=e[11],n[0]=o=e[0],n[1]=u,n[2]=d,n[3]=p,n[4]=y,n[5]=x,n[6]=E,n[7]=D,n[8]=R,n[9]=L,n[10]=B,n[11]=V,n[12]=o*U+y*q+R*Y+e[12],n[13]=u*U+x*q+L*Y+e[13],n[14]=d*U+E*q+B*Y+e[14],n[15]=p*U+D*q+V*Y+e[15]),n},P.P=ne,P.Q=function(n,e,i){var o=i[0],u=i[1],d=i[2];return n[0]=e[0]*o,n[1]=e[1]*o,n[2]=e[2]*o,n[3]=e[3]*o,n[4]=e[4]*u,n[5]=e[5]*u,n[6]=e[6]*u,n[7]=e[7]*u,n[8]=e[8]*d,n[9]=e[9]*d,n[10]=e[10]*d,n[11]=e[11]*d,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},P.R=Vr,P.S=function(n,e,i){var o=e[0],u=e[1],d=e[2],p=e[3],y=e[4],x=e[5],E=e[6],D=e[7],R=e[8],L=e[9],B=e[10],V=e[11],U=e[12],q=e[13],Y=e[14],se=e[15],Q=i[0],J=i[1],le=i[2],he=i[3];return n[0]=Q*o+J*y+le*R+he*U,n[1]=Q*u+J*x+le*L+he*q,n[2]=Q*d+J*E+le*B+he*Y,n[3]=Q*p+J*D+le*V+he*se,n[4]=(Q=i[4])*o+(J=i[5])*y+(le=i[6])*R+(he=i[7])*U,n[5]=Q*u+J*x+le*L+he*q,n[6]=Q*d+J*E+le*B+he*Y,n[7]=Q*p+J*D+le*V+he*se,n[8]=(Q=i[8])*o+(J=i[9])*y+(le=i[10])*R+(he=i[11])*U,n[9]=Q*u+J*x+le*L+he*q,n[10]=Q*d+J*E+le*B+he*Y,n[11]=Q*p+J*D+le*V+he*se,n[12]=(Q=i[12])*o+(J=i[13])*y+(le=i[14])*R+(he=i[15])*U,n[13]=Q*u+J*x+le*L+he*q,n[14]=Q*d+J*E+le*B+he*Y,n[15]=Q*p+J*D+le*V+he*se,n},P.T=Fd,P.U=function(n,e){const i={};for(let o=0;o<e.length;o++){const u=e[o];u in n&&(i[u]=n[u])}return i},P.V=Oo,P.W=ei,P.X=_m,P.Y=Fg,P.Z=fe,P._=h,P.a=W,P.a$=Vn,P.a0=Jt,P.a1=so,P.a2=Ra,P.a3=Ng,P.a4=zf,P.a5=Mt,P.a6=function(n,e,i){if(!n)return e||{};if(!e)return n||{};const o=If(n),u=If(e);(function(p,y){y.removeAll&&(p.add.clear(),p.update.clear(),p.remove.clear(),y.remove.clear());for(const x of y.remove)p.add.delete(x),p.update.delete(x);for(const[x,E]of y.update){const D=p.update.get(x);D&&(y.update.set(x,vm(D,E)),p.update.delete(x))}})(o,u);const d={};if((o.removeAll||u.removeAll)&&(d.removeAll=!0),d.remove=new Set([...o.remove,...u.remove]),d.add=new Map([...o.add,...u.add]),d.update=new Map([...o.update,...u.update]),d.remove.size&&d.add.size)for(const p of d.add.keys())d.remove.delete(p);return(function(p){const y={};return p.removeAll&&(y.removeAll=p.removeAll),p.remove&&(y.remove=Array.from(p.remove)),p.add&&(y.add=Array.from(p.add.values())),p.update&&(y.update=Array.from(p.update.values())),y})(d)},P.a7=function(n,e){const i=new Map;if(n==null||n.type==null)return i;if(n.type==="Feature"){const o=Pf(n,e);return o==null?void 0:(i.set(o,n),i)}if(n.type==="FeatureCollection"){const o=new Set;for(const u of n.features){const d=Pf(u,e);if(d==null||o.has(d))return;o.add(d),i.set(d,u)}return i}},P.a8=function(n,e,i){var o,u;const d=[];if(e.removeAll)n.clear();else if(e.remove)for(const p of e.remove){const y=n.get(p);y&&(d.push(y.geometry),n.delete(p))}if(e.add)for(const p of e.add){const y=Pf(p,i);if(y==null)continue;const x=n.get(y);x&&d.push(x.geometry),d.push(p.geometry),n.set(y,p)}if(e.update)for(const p of e.update){const y=n.get(p.id);if(!y)continue;const x=!!p.newGeometry,E=p.removeAllProperties||((o=p.removeProperties)===null||o===void 0?void 0:o.length)>0||((u=p.addOrUpdateProperties)===null||u===void 0?void 0:u.length)>0;if(!x&&!E)continue;d.push(y.geometry);const D=Object.assign({},y);if(n.set(p.id,D),x&&(d.push(p.newGeometry),D.geometry=p.newGeometry),E){if(D.properties=p.removeAllProperties?{}:Object.assign({},D.properties||{}),p.removeProperties)for(const R of p.removeProperties)delete D.properties[R];if(p.addOrUpdateProperties)for(const{key:R,value:L}of p.addOrUpdateProperties)D.properties[R]=L}}return d},P.a9=Ci,P.aA=function(n,{uSize:e,uSizeT:i},{lowerSize:o,upperSize:u}){return n.kind==="source"?o/Qa:n.kind==="composite"?Wi.number(o/Qa,u/Qa,i):e},P.aB=function(n,e){var i=e[0],o=e[1],u=e[2],d=e[3],p=e[4],y=e[5],x=e[6],E=e[7],D=e[8],R=e[9],L=e[10],B=e[11],V=e[12],U=e[13],q=e[14],Y=e[15],se=i*y-o*p,Q=i*x-u*p,J=i*E-d*p,le=o*x-u*y,he=o*E-d*y,Ae=u*E-d*x,Ve=D*U-R*V,Fe=D*q-L*V,$e=D*Y-B*V,st=R*q-L*U,Qe=R*Y-B*U,Ne=L*Y-B*q,Oe=se*Ne-Q*Qe+J*st+le*$e-he*Fe+Ae*Ve;return Oe?(n[0]=(y*Ne-x*Qe+E*st)*(Oe=1/Oe),n[1]=(u*Qe-o*Ne-d*st)*Oe,n[2]=(U*Ae-q*he+Y*le)*Oe,n[3]=(L*he-R*Ae-B*le)*Oe,n[4]=(x*$e-p*Ne-E*Fe)*Oe,n[5]=(i*Ne-u*$e+d*Fe)*Oe,n[6]=(q*J-V*Ae-Y*Q)*Oe,n[7]=(D*Ae-L*J+B*Q)*Oe,n[8]=(p*Qe-y*$e+E*Ve)*Oe,n[9]=(o*$e-i*Qe-d*Ve)*Oe,n[10]=(V*he-U*J+Y*se)*Oe,n[11]=(R*J-D*he-B*se)*Oe,n[12]=(y*Fe-p*st-x*Ve)*Oe,n[13]=(i*st-o*Fe+u*Ve)*Oe,n[14]=(U*Q-V*le-q*se)*Oe,n[15]=(D*le-R*Q+L*se)*Oe,n):null},P.aC=ot,P.aD=function(n){var e=n[0],i=n[1];return Math.sqrt(e*e+i*i)},P.aE=function(n){return n[0]=0,n[1]=0,n},P.aF=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n},P.aG=fm,P.aH=$r,P.aI=function(n,e,i,o){const u=e.y-n.y,d=e.x-n.x,p=o.y-i.y,y=o.x-i.x,x=p*d-y*u;if(x===0)return null;const E=(y*(n.y-i.y)-p*(n.x-i.x))/x;return new ne(n.x+E*d,n.y+E*u)},P.aJ=r,P.aK=vc,P.aL=function(n){let e=1/0,i=1/0,o=-1/0,u=-1/0;for(const d of n)e=Math.min(e,d.x),i=Math.min(i,d.y),o=Math.max(o,d.x),u=Math.max(u,d.y);return[e,i,o,u]},P.aM=Xn,P.aN=mi,P.aO=function(n,e,i,o,u=!1){if(!i[0]&&!i[1])return[0,0];const d=u?o==="map"?-n.bearingInRadians:0:o==="viewport"?n.bearingInRadians:0;if(d){const p=Math.sin(d),y=Math.cos(d);i=[i[0]*y-i[1]*p,i[0]*p+i[1]*y]}return[u?i[0]:mi(e,i[0],n.zoom),u?i[1]:mi(e,i[1],n.zoom)]},P.aQ=ip,P.aR=Nm,P.aS=lm,P.aT=V_,P.aU=Ji,P.aV=bf,P.aW=ee,P.aX=at,P.aY=Pe,P.aZ=Rr,P.a_=ym,P.aa=yu,P.ab=25,P.ac=fr,P.ad=n=>{const e=window.document.createElement("video");return e.muted=!0,new Promise((i=>{e.onloadstart=()=>{i(e)};for(const o of n){const u=window.document.createElement("source");Ge(o)||(e.crossOrigin="Anonymous"),u.src=o,e.appendChild(u)}}))},P.ae=et,P.af=function(){return qi++},P.ag=f,P.ah=Mh,P.ai=$f,P.aj=Lr,P.ak=Xa,P.al=cp,P.am=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((i,o,u,d)=>{const p=u||d;return e[o]=!p||p.toLowerCase(),""})),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e},P.an=Vt,P.ao=85.051129,P.ap=Yn,P.aq=function(n){return Math.pow(2,n)},P.ar=di,P.as=jg,P.at=function(n){return Math.log(n)/Math.LN2},P.au=function(n){var e=n[0],i=n[1];return e*e+i*i},P.av=function(n){if(!n.length)return new Set;const e=Math.max(...n.map((x=>x.canonical.z)));let i=1/0,o=-1/0,u=1/0,d=-1/0;const p=[];for(const x of n){const{x:E,y:D,z:R}=x.canonical,L=Math.pow(2,e-R),B=E*L,V=D*L;p.push({id:x,x:B,y:V}),B<i&&(i=B),B>o&&(o=B),V<u&&(u=V),V>d&&(d=V)}const y=new Set;for(const x of p)x.x!==i&&x.x!==o&&x.y!==u&&x.y!==d||y.add(x.id);return y},P.aw=function(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),o=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||o-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x},P.ax=class{constructor(n,e){this.max=n,this.onRemove=e,this.reset()}reset(){for(const n in this.data)for(const e of this.data[n])e.timeout&&clearTimeout(e.timeout),this.onRemove(e.value);return this.data={},this.order=[],this}add(n,e,i){const o=n.wrapped().key;this.data[o]===void 0&&(this.data[o]=[]);const u={value:e,timeout:void 0};if(i!==void 0&&(u.timeout=setTimeout((()=>{this.remove(n,u)}),i)),this.data[o].push(u),this.order.push(o),this.order.length>this.max){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const e=this.data[n].shift();return e.timeout&&clearTimeout(e.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),e.value}getByKey(n){const e=this.data[n];return e?e[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,e){if(!this.has(n))return this;const i=n.wrapped().key,o=e===void 0?0:this.data[i].indexOf(e),u=this.data[i][o];return this.data[i].splice(o,1),u.timeout&&clearTimeout(u.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(u.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(n){const e=[];for(const i in this.data)for(const o of this.data[i])n(o.value)||e.push(o);for(const i of e)this.remove(i.value.tileID,i)}},P.ay=function(n,e){let i=0,o=0;if(n.kind==="constant")o=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:u,minZoom:d,maxZoom:p}=n,y=u?Vt(Cr.interpolationFactor(u,e,d,p),0,1):0;n.kind==="camera"?o=Wi.number(n.minSize,n.maxSize,y):i=y}return{uSizeT:i,uSize:o}},P.b=zs,P.b$=$a,P.b0=cn,P.b1=function(n){var e=new Ct(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e},P.b2=function(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n},P.b3=function(n,e){var i=e[0],o=e[1],u=e[2],d=i*i+o*o+u*u;return d>0&&(d=1/Math.sqrt(d)),n[0]=e[0]*d,n[1]=e[1]*d,n[2]=e[2]*d,n},P.b4=Un,P.b5=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]},P.b6=function(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n[3]=e[3]*i[3],n},P.b7=St,P.b8=function(n,e,i){const o=e[0]*i[0]+e[1]*i[1]+e[2]*i[2];return o===0?null:(-(n[0]*i[0]+n[1]*i[1]+n[2]*i[2])-i[3])/o},P.b9=Cn,P.bA=function(n,e,i,o){return n[0]=e[0]+i[0]*o,n[1]=e[1]+i[1]*o,n[2]=e[2]+i[2]*o,n},P.bB=qe,P.bC=function(n,e,i){var o=i[0],u=i[1],d=i[2],p=i[3],y=e[0],x=e[1],E=e[2],D=u*E-d*x,R=d*y-o*E,L=o*x-u*y;return n[0]=y+p*(D+=D)+u*(L+=L)-d*(R+=R),n[1]=x+p*R+d*D-o*L,n[2]=E+p*L+o*R-u*D,n},P.bD=function(n,e,i){const o=(function(x){var E=x[3],D=x[4],R=x[5],L=x[6],B=x[7],V=x[8];return x[0]*(V*D-R*B)+x[1]*(-V*E+R*L)+x[2]*(B*E-D*L)})([n[0],n[1],n[2],e[0],e[1],e[2],i[0],i[1],i[2]]);if(o===0)return null;const u=Un([],[e[0],e[1],e[2]],[i[0],i[1],i[2]]),d=Un([],[i[0],i[1],i[2]],[n[0],n[1],n[2]]),p=Un([],[n[0],n[1],n[2]],[e[0],e[1],e[2]]),y=Vn([],u,-n[3]);return cn(y,y,Vn([],d,-e[3])),cn(y,y,Vn([],p,-i[3])),Vn(y,y,1/o),y},P.bE=lp,P.bF=function(){return new Float64Array(4)},P.bG=function(n,e,i,o){var u=[],d=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],d[0]=u[0]*Math.cos(o)-u[1]*Math.sin(o),d[1]=u[0]*Math.sin(o)+u[1]*Math.cos(o),d[2]=u[2],n[0]=d[0]+i[0],n[1]=d[1]+i[1],n[2]=d[2]+i[2],n},P.bH=function(n,e,i,o){var u=[],d=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],d[0]=u[0],d[1]=u[1]*Math.cos(o)-u[2]*Math.sin(o),d[2]=u[1]*Math.sin(o)+u[2]*Math.cos(o),n[0]=d[0]+i[0],n[1]=d[1]+i[1],n[2]=d[2]+i[2],n},P.bI=function(n,e,i,o){var u=[],d=[];return u[0]=e[0]-i[0],u[1]=e[1]-i[1],u[2]=e[2]-i[2],d[0]=u[2]*Math.sin(o)+u[0]*Math.cos(o),d[1]=u[1],d[2]=u[2]*Math.cos(o)-u[0]*Math.sin(o),n[0]=d[0]+i[0],n[1]=d[1]+i[1],n[2]=d[2]+i[2],n},P.bJ=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),d=e[0],p=e[1],y=e[2],x=e[3],E=e[8],D=e[9],R=e[10],L=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=d*u-E*o,n[1]=p*u-D*o,n[2]=y*u-R*o,n[3]=x*u-L*o,n[8]=d*o+E*u,n[9]=p*o+D*u,n[10]=y*o+R*u,n[11]=x*o+L*u,n},P.bK=function(n,e){const i=be(n,360),o=be(e,360),u=o-i,d=o>i?u-360:u+360;return Math.abs(u)<Math.abs(d)?u:d},P.bL=function(n){return n[0]=0,n[1]=0,n[2]=0,n},P.bM=function(n,e,i,o){const u=Math.sqrt(n*n+e*e),d=Math.sqrt(i*i+o*o);n/=u,e/=u,i/=d,o/=d;const p=Math.acos(n*i+e*o);return-e*i+n*o>0?p:-p},P.bN=function(n,e){const i=be(n,2*Math.PI),o=be(e,2*Math.PI);return Math.min(Math.abs(i-o),Math.abs(i-o+2*Math.PI),Math.abs(i-o-2*Math.PI))},P.bO=function(){const n={},e=Ee.$version;for(const i in Ee.$root){const o=Ee.$root[i];if(o.required){let u=null;u=i==="version"?e:o.type==="array"?[]:{},u!=null&&(n[i]=u)}}return n},P.bP=De,P.bQ=oh,P.bR=function n(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(let o=0;o<e.length;o++)if(!n(e[o],i[o]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(const o in e)if(!n(e[o],i[o]))return!1;return!0}return e===i},P.bS=function(n){n=n.slice();const e=Object.create(null);for(let i=0;i<n.length;i++)e[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=Dn(n[i],e[n[i].ref]));return n},P.bT=function(n,e){if(n.type==="custom")return new mm(n,e);switch(n.type){case"background":return new li(n,e);case"circle":return new Ld(n,e);case"color-relief":return new fg(n,e);case"fill":return new _g(n,e);case"fill-extrusion":return new tm(n,e);case"heatmap":return new cg(n,e);case"hillshade":return new vn(n,e);case"line":return new nm(n,e);case"raster":return new qs(n,e);case"symbol":return new _u(n,e)}},P.bU=n=>n.type==="raster",P.bV=Xr,P.bW=function(n,e){if(!n)return[{command:"setStyle",args:[e]}];let i=[];try{if(!Bt(n.version,e.version))return[{command:"setStyle",args:[e]}];Bt(n.center,e.center)||i.push({command:"setCenter",args:[e.center]}),Bt(n.state,e.state)||i.push({command:"setGlobalState",args:[e.state]}),Bt(n.centerAltitude,e.centerAltitude)||i.push({command:"setCenterAltitude",args:[e.centerAltitude]}),Bt(n.zoom,e.zoom)||i.push({command:"setZoom",args:[e.zoom]}),Bt(n.bearing,e.bearing)||i.push({command:"setBearing",args:[e.bearing]}),Bt(n.pitch,e.pitch)||i.push({command:"setPitch",args:[e.pitch]}),Bt(n.roll,e.roll)||i.push({command:"setRoll",args:[e.roll]}),Bt(n.sprite,e.sprite)||i.push({command:"setSprite",args:[e.sprite]}),Bt(n.glyphs,e.glyphs)||i.push({command:"setGlyphs",args:[e.glyphs]}),Bt(n.transition,e.transition)||i.push({command:"setTransition",args:[e.transition]}),Bt(n.light,e.light)||i.push({command:"setLight",args:[e.light]}),Bt(n.terrain,e.terrain)||i.push({command:"setTerrain",args:[e.terrain]}),Bt(n.sky,e.sky)||i.push({command:"setSky",args:[e.sky]}),Bt(n.projection,e.projection)||i.push({command:"setProjection",args:[e.projection]});const o={},u=[];(function(p,y,x,E){let D;for(D in y=y||{},p=p||{})Object.prototype.hasOwnProperty.call(p,D)&&(Object.prototype.hasOwnProperty.call(y,D)||Ei(D,x,E));for(D in y)Object.prototype.hasOwnProperty.call(y,D)&&(Object.prototype.hasOwnProperty.call(p,D)?Bt(p[D],y[D])||(p[D].type==="geojson"&&y[D].type==="geojson"&&Ii(p,y,D)?bi(x,{command:"setGeoJSONSourceData",args:[D,y[D].data]}):fn(D,y,x,E)):Gn(D,y,x))})(n.sources,e.sources,u,o);const d=[];n.layers&&n.layers.forEach((p=>{"source"in p&&o[p.source]?i.push({command:"removeLayer",args:[p.id]}):d.push(p)})),i=i.concat(u),(function(p,y,x){y=y||[];const E=(p=p||[]).map(jl),D=y.map(jl),R=p.reduce(Uo,{}),L=y.reduce(Uo,{}),B=E.slice(),V=Object.create(null);let U,q,Y,se,Q;for(let J=0,le=0;J<E.length;J++)U=E[J],Object.prototype.hasOwnProperty.call(L,U)?le++:(bi(x,{command:"removeLayer",args:[U]}),B.splice(B.indexOf(U,le),1));for(let J=0,le=0;J<D.length;J++)U=D[D.length-1-J],B[B.length-1-J]!==U&&(Object.prototype.hasOwnProperty.call(R,U)?(bi(x,{command:"removeLayer",args:[U]}),B.splice(B.lastIndexOf(U,B.length-le),1)):le++,se=B[B.length-J],bi(x,{command:"addLayer",args:[L[U],se]}),B.splice(B.length-J,0,U),V[U]=!0);for(let J=0;J<D.length;J++)if(U=D[J],q=R[U],Y=L[U],!V[U]&&!Bt(q,Y))if(Bt(q.source,Y.source)&&Bt(q["source-layer"],Y["source-layer"])&&Bt(q.type,Y.type)){for(Q in zn(q.layout,Y.layout,x,U,null,"setLayoutProperty"),zn(q.paint,Y.paint,x,U,null,"setPaintProperty"),Bt(q.filter,Y.filter)||bi(x,{command:"setFilter",args:[U,Y.filter]}),Bt(q.minzoom,Y.minzoom)&&Bt(q.maxzoom,Y.maxzoom)||bi(x,{command:"setLayerZoomRange",args:[U,Y.minzoom,Y.maxzoom]}),q)Object.prototype.hasOwnProperty.call(q,Q)&&Q!=="layout"&&Q!=="paint"&&Q!=="filter"&&Q!=="metadata"&&Q!=="minzoom"&&Q!=="maxzoom"&&(Q.indexOf("paint.")===0?zn(q[Q],Y[Q],x,U,Q.slice(6),"setPaintProperty"):Bt(q[Q],Y[Q])||bi(x,{command:"setLayerProperty",args:[U,Q,Y[Q]]}));for(Q in Y)Object.prototype.hasOwnProperty.call(Y,Q)&&!Object.prototype.hasOwnProperty.call(q,Q)&&Q!=="layout"&&Q!=="paint"&&Q!=="filter"&&Q!=="metadata"&&Q!=="minzoom"&&Q!=="maxzoom"&&(Q.indexOf("paint.")===0?zn(q[Q],Y[Q],x,U,Q.slice(6),"setPaintProperty"):Bt(q[Q],Y[Q])||bi(x,{command:"setLayerProperty",args:[U,Q,Y[Q]]}))}else bi(x,{command:"removeLayer",args:[U]}),se=B[B.lastIndexOf(U)+1],bi(x,{command:"addLayer",args:[Y,se]})})(d,e.layers,i)}catch(o){console.warn("Unable to compute style diff:",o),i=[{command:"setStyle",args:[e]}]}return i},P.bX=function(n){const e=[],i=n.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},P.bY=Tr,P.bZ=ao,P.b_=class extends jr{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},P.ba=function(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n},P.bb=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]},P.bc=Vg,P.bd=Ch,P.be=function(n,e,i,o,u){var d=1/Math.tan(e/2);if(n[0]=d/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0){var p=1/(o-u);n[10]=(u+o)*p,n[14]=2*u*o*p}else n[10]=-1,n[14]=-2*o;return n},P.bf=function(n){var e=new Ct(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},P.bg=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),d=e[0],p=e[1],y=e[2],x=e[3],E=e[4],D=e[5],R=e[6],L=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=d*u+E*o,n[1]=p*u+D*o,n[2]=y*u+R*o,n[3]=x*u+L*o,n[4]=E*u-d*o,n[5]=D*u-p*o,n[6]=R*u-y*o,n[7]=L*u-x*o,n},P.bh=function(n,e,i){var o=Math.sin(i),u=Math.cos(i),d=e[4],p=e[5],y=e[6],x=e[7],E=e[8],D=e[9],R=e[10],L=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=d*u+E*o,n[5]=p*u+D*o,n[6]=y*u+R*o,n[7]=x*u+L*o,n[8]=E*u-d*o,n[9]=D*u-p*o,n[10]=R*u-y*o,n[11]=L*u-x*o,n},P.bi=function(){const n=new Float32Array(16);return di(n),n},P.bj=function(){const n=new Float64Array(16);return di(n),n},P.bk=function(){return new Float64Array(16)},P.bl=function(n,e,i){const o=new Float64Array(4);return qe(o,n,e-90,i),o},P.bm=function(n,e,i,o){var u,d,p,y,x,E=e[0],D=e[1],R=e[2],L=e[3],B=i[0],V=i[1],U=i[2],q=i[3];return(d=E*B+D*V+R*U+L*q)<0&&(d=-d,B=-B,V=-V,U=-U,q=-q),1-d>Nt?(u=Math.acos(d),p=Math.sin(u),y=Math.sin((1-o)*u)/p,x=Math.sin(o*u)/p):(y=1-o,x=o),n[0]=y*E+x*B,n[1]=y*D+x*V,n[2]=y*R+x*U,n[3]=y*L+x*q,n},P.bn=function(n){const e=new Float64Array(9);(function(d,p){var y=p[0],x=p[1],E=p[2],D=p[3],R=y+y,L=x+x,B=E+E,V=y*R,U=x*R,q=x*L,Y=E*R,se=E*L,Q=E*B,J=D*R,le=D*L,he=D*B;d[0]=1-q-Q,d[3]=U-he,d[6]=Y+le,d[1]=U+he,d[4]=1-V-Q,d[7]=se-J,d[2]=Y-le,d[5]=se+J,d[8]=1-V-q})(e,n);const i=Rr(-Math.asin(Vt(e[2],-1,1)));let o,u;return Math.hypot(e[5],e[8])<.001?(o=0,u=-Rr(Math.atan2(e[3],e[4]))):(o=Rr(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),u=Rr(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:o,pitch:i+90,bearing:u}},P.bo=function(n,e){return n.roll==e.roll&&n.pitch==e.pitch&&n.bearing==e.bearing},P.bp=Gt,P.bq=pl,P.br=Da,P.bs=Ys,P.bt=hr,P.bu=Ke,P.bv=pt,P.bw=Zn,P.bx=function(n,e,i,o,u){return Ke(o,u,Vt((n-e)/(i-e),0,1))},P.by=be,P.bz=function(){return new Float64Array(3)},P.c=pe,P.c$=function(n,e,i,o,u){return h(this,void 0,void 0,(function*(){if(Jt())try{return yield so(n,e,i,o,u)}catch{}return(function(d,p,y,x,E){const D=d.width,R=d.height;es&&La||(es=new OffscreenCanvas(D,R),La=es.getContext("2d",{willReadFrequently:!0})),es.width=D,es.height=R,La.drawImage(d,0,0,D,R);const L=La.getImageData(p,y,x,E);return La.clearRect(0,0,D,R),L.data})(n,e,i,o,u)}))},P.c0=class extends jr{constructor(n,e){super(n,e),this.current=Nr}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},P.c1=hu,P.c2=class extends jr{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},P.c3=class extends jr{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},P.c4=Kt,P.c5=function(n,e){var i=Math.sin(e),o=Math.cos(e);return n[0]=o,n[1]=i,n[2]=0,n[3]=-i,n[4]=o,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},P.c6=function(n,e,i){var o=e[0],u=e[1],d=e[2];return n[0]=o*i[0]+u*i[3]+d*i[6],n[1]=o*i[1]+u*i[4]+d*i[7],n[2]=o*i[2]+u*i[5]+d*i[8],n},P.c7=function(n,e,i,o,u,d,p){var y=1/(e-i),x=1/(o-u),E=1/(d-p);return n[0]=-2*y,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*x,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*E,n[11]=0,n[12]=(e+i)*y,n[13]=(u+o)*x,n[14]=(p+d)*E,n[15]=1,n},P.c8=class extends jr{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(4*n.length);for(let i=0;i<n.length;i++)e[4*i]=n[i].r,e[4*i+1]=n[i].g,e[4*i+2]=n[i].b,e[4*i+3]=n[i].a;this.gl.uniform4fv(this.location,e)}}},P.c9=class extends jr{constructor(n,e){super(n,e),this.current=new Array}set(n){if(n!=this.current){this.current=n;const e=new Float32Array(n);this.gl.uniform1fv(this.location,e)}}},P.cA=function(n,e){return Se[e]&&"touches"in n},P.cB=function(n){return Se[n]||$[n]},P.cC=function(n,e,i){var o=e[0],u=e[1];return n[0]=i[0]*o+i[4]*u+i[12],n[1]=i[1]*o+i[5]*u+i[13],n},P.cD=function(n,e){const{x:i,y:o}=Ci.fromLngLat(e);return!(n<0||n>25||o<0||o>=1||i<0||i>=1)},P.cE=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},P.cF=class extends cl{},P.cG=W0,P.cI=_e,P.cJ=function(n,e){pe.REGISTERED_PROTOCOLS[n]=e},P.cK=function(n){delete pe.REGISTERED_PROTOCOLS[n]},P.cL=function(n,e){const i={};for(let u=0;u<n.length;u++){const d=e&&e[n[u].id]||ks(n[u]);e&&(e[n[u].id]=d);let p=i[d];p||(p=i[d]=[]),p.push(n[u])}const o=[];for(const u in i)o.push(i[u]);return o},P.cM=ut,P.cN=bm,P.cO=jm,P.cP=Jd,P.cQ=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=Mt/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],i=e.layout,o=e._unevaluatedLayout._values,u={layoutIconSize:o["icon-size"].possiblyEvaluate(new xi(n.bucket.zoom+1),n.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new xi(n.bucket.zoom+1),n.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new xi(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:E,maxZoom:D}=n.bucket.textSizeData;u.compositeTextSizes=[o["text-size"].possiblyEvaluate(new xi(E),n.canonical),o["text-size"].possiblyEvaluate(new xi(D),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:E,maxZoom:D}=n.bucket.iconSizeData;u.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new xi(E),n.canonical),o["icon-size"].possiblyEvaluate(new xi(D),n.canonical)]}const d=i.get("text-line-height")*Xn,p=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",y=i.get("text-keep-upright"),x=i.get("text-size");for(const E of n.bucket.features){const D=i.get("text-font").evaluate(E,{},n.canonical).join(","),R=x.evaluate(E,{},n.canonical),L=u.layoutTextSize.evaluate(E,{},n.canonical),B=u.layoutIconSize.evaluate(E,{},n.canonical),V={horizontal:{},vertical:void 0},U=E.text;let q,Y=[0,0];if(U){const J=U.toString(),le=i.get("text-letter-spacing").evaluate(E,{},n.canonical)*Xn,he=lh(J)?le:0,Ae=i.get("text-anchor").evaluate(E,{},n.canonical),Ve=Cl(e,E,n.canonical);if(!Ve){const Qe=i.get("text-radial-offset").evaluate(E,{},n.canonical);Y=Qe?Ti(Ae,[Qe*Xn,ai]):i.get("text-offset").evaluate(E,{},n.canonical).map((Ne=>Ne*Xn))}let Fe=p?"center":i.get("text-justify").evaluate(E,{},n.canonical);const $e=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(E,{},n.canonical)*Xn:1/0,st=()=>{n.bucket.allowVerticalPlacement&&vs(J)&&(V.vertical=Af(U,n.glyphMap,n.glyphPositions,n.imagePositions,D,$e,d,Ae,"left",he,Y,P.az.vertical,!0,L,R))};if(!p&&Ve){const Qe=new Set;if(Fe==="auto")for(let Oe=0;Oe<Ve.values.length;Oe+=2)Qe.add(Nm(Ve.values[Oe]));else Qe.add(Fe);let Ne=!1;for(const Oe of Qe)if(!V.horizontal[Oe])if(Ne)V.horizontal[Oe]=V.horizontal[0];else{const dt=Af(U,n.glyphMap,n.glyphPositions,n.imagePositions,D,$e,d,"center",Oe,he,Y,P.az.horizontal,!1,L,R);dt&&(V.horizontal[Oe]=dt,Ne=dt.positionedLines.length===1)}st()}else{Fe==="auto"&&(Fe=Nm(Ae));const Qe=Af(U,n.glyphMap,n.glyphPositions,n.imagePositions,D,$e,d,Ae,Fe,he,Y,P.az.horizontal,!1,L,R);Qe&&(V.horizontal[Fe]=Qe),st(),vs(J)&&p&&y&&(V.vertical=Af(U,n.glyphMap,n.glyphPositions,n.imagePositions,D,$e,d,Ae,Fe,he,Y,P.az.vertical,!1,L,R))}}let se=!1;if(E.icon&&E.icon.name){const J=n.imageMap[E.icon.name];J&&(q=cm(n.imagePositions[E.icon.name],i.get("icon-offset").evaluate(E,{},n.canonical),i.get("icon-anchor").evaluate(E,{},n.canonical)),se=!!J.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=se:n.bucket.sdfIcons!==se&&rn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(J.pixelRatio!==n.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const Q=Gy(V.horizontal)||V.vertical;n.bucket.iconsInText=!!Q&&Q.iconsInText,(Q||q)&&Q0(n.bucket,E,V,q,n.imageMap,u,L,B,Y,se,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},P.cR=xc,P.cS=du,P.cT=vh,P.cU=function(n){const e=new Qd;return(function(i,o){for(const u in i.layers)o.writeMessage(3,wp,i.layers[u])})(n,e),e.finish()},P.cV=function(n,e,i,o,u,d){let p=s(n,e,i,u,0);return p=s(p,e,o,d,1),p},P.cW=class{constructor(n){this.maxEntries=n,this.map=new Map}get(n){const e=this.map.get(n);return e!==void 0&&(this.map.delete(n),this.map.set(n,e)),e}set(n,e){if(this.map.has(n))this.map.delete(n);else if(this.map.size>=this.maxEntries){const i=this.map.keys().next().value;this.map.delete(i)}this.map.set(n,e)}clear(){this.map.clear()}},P.cX=oi,P.cY=Qd,P.cZ=Hf,P.c_=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},P.ca=class extends Hs{},P.cb=wg,P.cc=class extends en{},P.cd=ff,P.ce=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},P.cf=Io,P.cg=function(n,e,i){var o=e[0],u=e[1],d=e[2],p=i[3]*o+i[7]*u+i[11]*d+i[15];return n[0]=(i[0]*o+i[4]*u+i[8]*d+i[12])/(p=p||1),n[1]=(i[1]*o+i[5]*u+i[9]*d+i[13])/p,n[2]=(i[2]*o+i[6]*u+i[10]*d+i[14])/p,n},P.ch=class extends hl{},P.ci=class extends t{},P.cj=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]&&n[4]===e[4]&&n[5]===e[5]&&n[6]===e[6]&&n[7]===e[7]&&n[8]===e[8]&&n[9]===e[9]&&n[10]===e[10]&&n[11]===e[11]&&n[12]===e[12]&&n[13]===e[13]&&n[14]===e[14]&&n[15]===e[15]},P.ck=function(n,e){var i=n[0],o=n[1],u=n[2],d=n[3],p=n[4],y=n[5],x=n[6],E=n[7],D=n[8],R=n[9],L=n[10],B=n[11],V=n[12],U=n[13],q=n[14],Y=n[15],se=e[0],Q=e[1],J=e[2],le=e[3],he=e[4],Ae=e[5],Ve=e[6],Fe=e[7],$e=e[8],st=e[9],Qe=e[10],Ne=e[11],Oe=e[12],dt=e[13],ct=e[14],mt=e[15];return Math.abs(i-se)<=Nt*Math.max(1,Math.abs(i),Math.abs(se))&&Math.abs(o-Q)<=Nt*Math.max(1,Math.abs(o),Math.abs(Q))&&Math.abs(u-J)<=Nt*Math.max(1,Math.abs(u),Math.abs(J))&&Math.abs(d-le)<=Nt*Math.max(1,Math.abs(d),Math.abs(le))&&Math.abs(p-he)<=Nt*Math.max(1,Math.abs(p),Math.abs(he))&&Math.abs(y-Ae)<=Nt*Math.max(1,Math.abs(y),Math.abs(Ae))&&Math.abs(x-Ve)<=Nt*Math.max(1,Math.abs(x),Math.abs(Ve))&&Math.abs(E-Fe)<=Nt*Math.max(1,Math.abs(E),Math.abs(Fe))&&Math.abs(D-$e)<=Nt*Math.max(1,Math.abs(D),Math.abs($e))&&Math.abs(R-st)<=Nt*Math.max(1,Math.abs(R),Math.abs(st))&&Math.abs(L-Qe)<=Nt*Math.max(1,Math.abs(L),Math.abs(Qe))&&Math.abs(B-Ne)<=Nt*Math.max(1,Math.abs(B),Math.abs(Ne))&&Math.abs(V-Oe)<=Nt*Math.max(1,Math.abs(V),Math.abs(Oe))&&Math.abs(U-dt)<=Nt*Math.max(1,Math.abs(U),Math.abs(dt))&&Math.abs(q-ct)<=Nt*Math.max(1,Math.abs(q),Math.abs(ct))&&Math.abs(Y-mt)<=Nt*Math.max(1,Math.abs(Y),Math.abs(mt))},P.cl=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},P.cm=n=>n.type==="symbol",P.cn=n=>n.type==="circle",P.co=n=>n.type==="heatmap",P.cp=n=>n.type==="line",P.cq=n=>n.type==="fill",P.cr=n=>n.type==="fill-extrusion",P.cs=n=>n.type==="hillshade",P.ct=n=>n.type==="color-relief",P.cu=n=>n.type==="background",P.cv=n=>n.type==="custom",P.cw=bt,P.cx=function(n,e,i){const o=Pt(e.x-i.x,e.y-i.y),u=Pt(n.x-i.x,n.y-i.y),d=Math.atan2(o[0]*u[1]-o[1]*u[0],(function(p,y){return p[0]*y[0]+p[1]*y[1]})(o,u));return Rr(d)},P.cy=At,P.cz=function(n,e){return $[e]&&(n instanceof MouseEvent||n instanceof WheelEvent)},P.d=Ge,P.d0=mh,P.d1=ge,P.d2=class{constructor(n,e){this.layers={[$f]:this},this.name=$f,this.version=e?e.version:1,this.extent=e?e.extent:4096,this.length=n.length,this.features=n}feature(n){return new e_(this.features[n],this.extent)}},P.d3=tu,P.d4=Ta,P.e=Pi,P.f=n=>h(void 0,void 0,void 0,(function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(e)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),P.g=Ce,P.h=n=>new Promise(((e,i)=>{const o=new Image;o.onload=()=>{e(o),URL.revokeObjectURL(o.src),o.onload=null,window.requestAnimationFrame((()=>{o.src=Ps}))},o.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const u=new Blob([new Uint8Array(n)],{type:"image/png"});o.src=n.byteLength?URL.createObjectURL(u):Ps})),P.i=pa,P.j=(n,e)=>Ue(Pi(n,{type:"json"}),e),P.k=gi,P.l=Rt,P.m=Ue,P.n=(n,e)=>Ue(Pi(n,{type:"arrayBuffer"}),e),P.o=function(n){return new Qd(n).readFields(Pg,[])},P.p=om,P.q=function(n){return/[\u02EA\u02EB\u1100-\u11FF\u2E80-\u2FDF\u3000-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u4DBF\u4E00-\uA48C\uA490-\uA4C6\uA960-\uA97C\uAC00-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFE10-\uFE1F\uFE30-\uFE4F\uFF00-\uFFEF]|\uD81B[\uDFE0-\uDFFF]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFFF]|\uD82C[\uDC00-\uDEFB]|\uD83C[\uDE00-\uDEFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79]/gim.test(String.fromCodePoint(n))},P.r=hf,P.s=Fl,P.t=Sn,P.u=Ee,P.v=ac,P.w=rn,P.x=ch,P.y=Na,P.z=Gs})),F("worker",["./shared"],(function(P){class h{constructor($,Z){this.keyCache={},$&&this.replace($,Z)}replace($,Z){this._layerConfigs={},this._layers={},this.update($,[],Z)}update($,Z,W){for(const pe of $){this._layerConfigs[pe.id]=pe;const Ce=this._layers[pe.id]=P.bT(pe,W);Ce._featureFilter=P.aj(Ce.filter,W),this.keyCache[pe.id]&&delete this.keyCache[pe.id]}for(const pe of Z)delete this.keyCache[pe],delete this._layerConfigs[pe],delete this._layers[pe];this.familiesBySource={};const fe=P.cL(Object.values(this._layerConfigs),this.keyCache);for(const pe of fe){const Ce=pe.map((ht=>this._layers[ht.id])),we=Ce[0];if(we.isHidden())continue;const _e=we.source||"";let De=this.familiesBySource[_e];De||(De=this.familiesBySource[_e]={});const Ue=we.sourceLayer||P.ai;let Ge=De[Ue];Ge||(Ge=De[Ue]=[]),Ge.push(Ce)}}}class ne{constructor($){const Z={},W=[];for(const we in $){const _e=$[we],De=Z[we]={};for(const Ue in _e){const Ge=_e[+Ue];if(!Ge||Ge.bitmap.width===0||Ge.bitmap.height===0)continue;const ht={x:0,y:0,w:Ge.bitmap.width+2,h:Ge.bitmap.height+2};W.push(ht),De[Ue]={rect:ht,metrics:Ge.metrics}}}const{w:fe,h:pe}=P.p(W),Ce=new P.r({width:fe||1,height:pe||1});for(const we in $){const _e=$[we];for(const De in _e){const Ue=_e[+De];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Ge=Z[we][De].rect;P.r.copy(Ue.bitmap,Ce,{x:0,y:0},{x:Ge.x+1,y:Ge.y+1},Ue.bitmap)}}this.image=Ce,this.positions=Z}}P.cM("GlyphAtlas",ne);class ge{constructor($){this.tileID=new P.a2($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId,this.inFlightDependencies=[]}parse($,Z,W,fe,pe){return P._(this,void 0,void 0,(function*(){this.status="parsing",this.data=$,this.collisionBoxArray=new P.ag;const Ce=new P.cN(Object.keys($.layers).sort()),we=new P.cO(this.tileID,this.promoteId);we.bucketLayerIDs=[];const _e={},De={featureIndex:we,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:W,subdivisionGranularity:pe},Ue=Z.familiesBySource[this.source];for(const Ii in Ue){const zn=$.layers[Ii];if(!zn)continue;zn.version===1&&P.w(`Vector tile source "${this.source}" layer "${Ii}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const jl=Ce.encode(Ii),Uo=[];for(let et=0;et<zn.length;et++){const dr=zn.feature(et),pr=we.getId(dr,Ii);Uo.push({feature:dr,id:pr,index:et,sourceLayerIndex:jl})}for(const et of Ue[Ii]){const dr=et[0];dr.source!==this.source&&P.w(`layer.source = ${dr.source} does not equal this.source = ${this.source}`),dr.isHidden(this.zoom,!0)||(Le(et,this.zoom,W),(_e[dr.id]=dr.createBucket({index:we.bucketLayerIDs.length,layers:et,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:jl,sourceID:this.source})).populate(Uo,De,this.tileID.canonical),we.bucketLayerIDs.push(et.map((pr=>pr.id))))}}const Ge=P.bY(De.glyphDependencies,(Ii=>Object.keys(Ii).map(Number)));this.inFlightDependencies.forEach((Ii=>Ii?.abort())),this.inFlightDependencies=[];let ht=Promise.resolve({});if(Object.keys(Ge).length){const Ii=new AbortController;this.inFlightDependencies.push(Ii),ht=fe.sendAsync({type:"GG",data:{stacks:Ge,source:this.source,tileID:this.tileID,type:"glyphs"}},Ii)}const vt=Object.keys(De.iconDependencies);let Rt=Promise.resolve({});if(vt.length){const Ii=new AbortController;this.inFlightDependencies.push(Ii),Rt=fe.sendAsync({type:"GI",data:{icons:vt,source:this.source,tileID:this.tileID,type:"icons"}},Ii)}const gi=Object.keys(De.patternDependencies);let ii=Promise.resolve({});if(gi.length){const Ii=new AbortController;this.inFlightDependencies.push(Ii),ii=fe.sendAsync({type:"GI",data:{icons:gi,source:this.source,tileID:this.tileID,type:"patterns"}},Ii)}const Ee=De.dashDependencies;let vi=Promise.resolve({});if(Object.keys(Ee).length){const Ii=new AbortController;this.inFlightDependencies.push(Ii),vi=fe.sendAsync({type:"GDA",data:{dashes:Ee}},Ii)}const[Dn,Bt,bi,Gn]=yield Promise.all([ht,Rt,ii,vi]),Ei=new ne(Dn),fn=new P.cP(Bt,bi);for(const Ii in _e){const zn=_e[Ii];zn instanceof P.ah?(Le(zn.layers,this.zoom,W),P.cQ({bucket:zn,glyphMap:Dn,glyphPositions:Ei.positions,imageMap:Bt,imagePositions:fn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:De.subdivisionGranularity})):zn.hasDependencies&&(zn instanceof P.cR||zn instanceof P.cS||zn instanceof P.cT)&&(Le(zn.layers,this.zoom,W),zn.addFeatures(De,this.tileID.canonical,fn.patternPositions,Gn))}return this.status="done",{buckets:Object.values(_e).filter((Ii=>!Ii.isEmpty())),featureIndex:we,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ei.image,imageAtlas:fn,dashPositions:Gn,glyphMap:this.returnDependencies?Dn:null,iconMap:this.returnDependencies?Bt:null,glyphPositions:this.returnDependencies?Ei.positions:null}}))}}function Le(Se,$,Z){const W=new P.H($);for(const fe of Se)fe.recalculate(W,Z)}class Xe{constructor($,Z,W,fe,pe){this.type=$,this.properties=W||{},this.extent=pe,this.pointsArray=Z,this.id=fe}loadGeometry(){return this.pointsArray.map(($=>$.map((Z=>new P.P(Z.x,Z.y)))))}}class Je{constructor($,Z,W){this.version=2,this._myFeatures=$,this.name=Z,this.length=$.length,this.extent=W}feature($){return this._myFeatures[$]}}class yt{constructor(){this.layers={}}addLayer($){this.layers[$.name]=$}}function Et(Se){let $=P.cU(Se);return $.byteOffset===0&&$.byteLength===$.buffer.byteLength||($=new Uint8Array($)),{vectorTile:Se,rawData:$.buffer}}function rt(Se,$,Z){const{extent:W}=Se,fe=Math.pow(2,Z.z-$.z),pe=(Z.x-$.x*fe)*W,Ce=(Z.y-$.y*fe)*W,we=[];for(let _e=0;_e<Se.length;_e++){const De=Se.feature(_e);let Ue=De.loadGeometry();for(const ht of Ue)for(const vt of ht)vt.x=vt.x*fe-pe,vt.y=vt.y*fe-Ce;const Ge=128;Ue=P.cV(Ue,De.type,-Ge,-Ge,W+Ge,W+Ge),Ue.length!==0&&we.push(new Xe(De.type,Ue,De.properties,De.id,W))}return new Je(we,Se.name,W)}class xe{constructor($,Z,W){this.actor=$,this.layerIndex=Z,this.availableImages=W,this.fetching={},this.loading={},this.loaded={},this.overzoomedTileResultCache=new P.cW(1e3)}loadVectorTile($,Z){return P._(this,void 0,void 0,(function*(){const W=yield P.n($.request,Z);try{return{vectorTile:$.encoding!=="mlt"?new P.cX(new P.cY(W.data)):new P.cZ(W.data),rawData:W.data,cacheControl:W.cacheControl,expires:W.expires}}catch(fe){const pe=new Uint8Array(W.data);let Ce=`Unable to parse the tile at ${$.request.url}, `;throw Ce+=pe[0]===31&&pe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${fe.message}`,new Error(Ce)}}))}loadTile($){return P._(this,void 0,void 0,(function*(){const{uid:Z,overzoomParameters:W}=$;W&&($.request=W.overzoomRequest);const fe=!!($&&$.request&&$.request.collectResourceTiming)&&new P.c_($.request),pe=new ge($);this.loading[Z]=pe;const Ce=new AbortController;pe.abort=Ce;try{const we=yield this.loadVectorTile($,Ce);if(delete this.loading[Z],!we)return null;if(W){const ht=this._getOverzoomTile($,we.vectorTile);we.rawData=ht.rawData,we.vectorTile=ht.vectorTile}const _e=we.rawData,De={};we.expires&&(De.expires=we.expires),we.cacheControl&&(De.cacheControl=we.cacheControl);const Ue={};if(fe){const ht=fe.finish();ht&&(Ue.resourceTiming=JSON.parse(JSON.stringify(ht)))}pe.vectorTile=we.vectorTile;const Ge=pe.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);this.loaded[Z]=pe,this.fetching[Z]={rawTileData:_e,cacheControl:De,resourceTiming:Ue};try{const ht=yield Ge;return P.e({rawTileData:_e.slice(0),encoding:$.encoding},ht,De,Ue)}finally{delete this.fetching[Z]}}catch(we){throw delete this.loading[Z],pe.status="done",this.loaded[Z]=pe,we}}))}_getOverzoomTile($,Z){const{tileID:W,source:fe,overzoomParameters:pe}=$,{maxZoomTileID:Ce}=pe,we=`${Ce.key}_${W.key}`,_e=this.overzoomedTileResultCache.get(we);if(_e)return _e;const De=new yt,Ue=this.layerIndex.familiesBySource[fe];for(const ht in Ue){const vt=Z.layers[ht];if(!vt)continue;const Rt=rt(vt,Ce,W.canonical);Rt.length>0&&De.addLayer(Rt)}const Ge=Et(De);return this.overzoomedTileResultCache.set(we,Ge),Ge}reloadTile($){return P._(this,void 0,void 0,(function*(){const Z=$.uid;if(!this.loaded||!this.loaded[Z])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const W=this.loaded[Z];if(W.showCollisionBoxes=$.showCollisionBoxes,W.status==="parsing"){const fe=yield W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity);let pe;if(this.fetching[Z]){const{rawTileData:Ce,cacheControl:we,resourceTiming:_e}=this.fetching[Z];delete this.fetching[Z],pe=P.e({rawTileData:Ce.slice(0),encoding:$.encoding},fe,we,_e)}else pe=fe;return pe}if(W.status==="done"&&W.vectorTile)return W.parse(W.vectorTile,this.layerIndex,this.availableImages,this.actor,$.subdivisionGranularity)}))}abortTile($){return P._(this,void 0,void 0,(function*(){const Z=this.loading,W=$.uid;Z&&Z[W]&&Z[W].abort&&(Z[W].abort.abort(),delete Z[W])}))}removeTile($){return P._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[$.uid]&&delete this.loaded[$.uid]}))}}class Jt{constructor(){this.loaded={}}loadTile($){return P._(this,void 0,void 0,(function*(){const{uid:Z,encoding:W,rawImageData:fe,redFactor:pe,greenFactor:Ce,blueFactor:we,baseShift:_e}=$,De=fe.width+2,Ue=fe.height+2,Ge=P.b(fe)?new P.R({width:De,height:Ue},yield P.c$(fe,-1,-1,De,Ue)):fe,ht=new P.d0(Z,Ge,W,pe,Ce,we,_e);return this.loaded=this.loaded||{},this.loaded[Z]=ht,ht}))}removeTile($){const Z=this.loaded,W=$.uid;Z&&Z[W]&&delete Z[W]}}var Nt,Ct,Kt=(function(){if(Ct)return Nt;function Se(Z,W){if(Z.length!==0){$(Z[0],W);for(var fe=1;fe<Z.length;fe++)$(Z[fe],!W)}}function $(Z,W){for(var fe=0,pe=0,Ce=0,we=Z.length,_e=we-1;Ce<we;_e=Ce++){var De=(Z[Ce][0]-Z[_e][0])*(Z[_e][1]+Z[Ce][1]),Ue=fe+De;pe+=Math.abs(fe)>=Math.abs(De)?fe-Ue+De:De-Ue+fe,fe=Ue}fe+pe>=0!=!!W&&Z.reverse()}return Ct=1,Nt=function Z(W,fe){var pe,Ce=W&&W.type;if(Ce==="FeatureCollection")for(pe=0;pe<W.features.length;pe++)Z(W.features[pe],fe);else if(Ce==="GeometryCollection")for(pe=0;pe<W.geometries.length;pe++)Z(W.geometries[pe],fe);else if(Ce==="Feature")Z(W.geometry,fe);else if(Ce==="Polygon")Se(W.coordinates,fe);else if(Ce==="MultiPolygon")for(pe=0;pe<W.coordinates.length;pe++)Se(W.coordinates[pe],fe);return W}})(),di=P.d1(Kt);const Si={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Se=>Se},St=Math.fround||(pi=new Float32Array(1),Se=>(pi[0]=+Se,pi[0]));var pi;class cn{constructor($){this.options=Object.assign(Object.create(Si),$),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load($){const{log:Z,minZoom:W,maxZoom:fe}=this.options;Z&&console.time("total time");const pe=`prepare ${$.length} points`;Z&&console.time(pe),this.points=$;const Ce=[];for(let _e=0;_e<$.length;_e++){const De=$[_e];if(!De.geometry)continue;const[Ue,Ge]=De.geometry.coordinates,ht=St(Ni(Ue)),vt=St(Cn(Ge));Ce.push(ht,vt,1/0,_e,-1,1),this.options.reduce&&Ce.push(0)}let we=this.trees[fe+1]=this._createTree(Ce);Z&&console.timeEnd(pe);for(let _e=fe;_e>=W;_e--){const De=+Date.now();we=this.trees[_e]=this._createTree(this._cluster(we,_e)),Z&&console.log("z%d: %d clusters in %dms",_e,we.numItems,+Date.now()-De)}return Z&&console.timeEnd("total time"),this}getClusters($,Z){let W=(($[0]+180)%360+360)%360-180;const fe=Math.max(-90,Math.min(90,$[1]));let pe=$[2]===180?180:(($[2]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)W=-180,pe=180;else if(W>pe){const Ge=this.getClusters([W,fe,180,Ce],Z),ht=this.getClusters([-180,fe,pe,Ce],Z);return Ge.concat(ht)}const we=this.trees[this._limitZoom(Z)],_e=we.range(Ni(W),Cn(Ce),Ni(pe),Cn(fe)),De=we.data,Ue=[];for(const Ge of _e){const ht=this.stride*Ge;Ue.push(De[ht+5]>1?Vn(De,ht,this.clusterProps):this.points[De[ht+3]])}return Ue}getChildren($){const Z=this._getOriginId($),W=this._getOriginZoom($),fe="No cluster with the specified id.",pe=this.trees[W];if(!pe)throw new Error(fe);const Ce=pe.data;if(Z*this.stride>=Ce.length)throw new Error(fe);const we=this.options.radius/(this.options.extent*Math.pow(2,W-1)),_e=pe.within(Ce[Z*this.stride],Ce[Z*this.stride+1],we),De=[];for(const Ue of _e){const Ge=Ue*this.stride;Ce[Ge+4]===$&&De.push(Ce[Ge+5]>1?Vn(Ce,Ge,this.clusterProps):this.points[Ce[Ge+3]])}if(De.length===0)throw new Error(fe);return De}getLeaves($,Z,W){const fe=[];return this._appendLeaves(fe,$,Z=Z||10,W=W||0,0),fe}getTile($,Z,W){const fe=this.trees[this._limitZoom($)],pe=Math.pow(2,$),{extent:Ce,radius:we}=this.options,_e=we/Ce,De=(W-_e)/pe,Ue=(W+1+_e)/pe,Ge={features:[]};return this._addTileFeatures(fe.range((Z-_e)/pe,De,(Z+1+_e)/pe,Ue),fe.data,Z,W,pe,Ge),Z===0&&this._addTileFeatures(fe.range(1-_e/pe,De,1,Ue),fe.data,pe,W,pe,Ge),Z===pe-1&&this._addTileFeatures(fe.range(0,De,_e/pe,Ue),fe.data,-1,W,pe,Ge),Ge.features.length?Ge:null}getClusterExpansionZoom($){let Z=this._getOriginZoom($)-1;for(;Z<=this.options.maxZoom;){const W=this.getChildren($);if(Z++,W.length!==1)break;$=W[0].properties.cluster_id}return Z}_appendLeaves($,Z,W,fe,pe){const Ce=this.getChildren(Z);for(const we of Ce){const _e=we.properties;if(_e&&_e.cluster?pe+_e.point_count<=fe?pe+=_e.point_count:pe=this._appendLeaves($,_e.cluster_id,W,fe,pe):pe<fe?pe++:$.push(we),$.length===W)break}return pe}_createTree($){const Z=new P.aT($.length/this.stride|0,this.options.nodeSize,Float32Array);for(let W=0;W<$.length;W+=this.stride)Z.add($[W],$[W+1]);return Z.finish(),Z.data=$,Z}_addTileFeatures($,Z,W,fe,pe,Ce){for(const we of $){const _e=we*this.stride,De=Z[_e+5]>1;let Ue,Ge,ht;if(De)Ue=Un(Z,_e,this.clusterProps),Ge=Z[_e],ht=Z[_e+1];else{const gi=this.points[Z[_e+3]];Ue=gi.properties;const[ii,Ee]=gi.geometry.coordinates;Ge=Ni(ii),ht=Cn(Ee)}const vt={type:1,geometry:[[Math.round(this.options.extent*(Ge*pe-W)),Math.round(this.options.extent*(ht*pe-fe))]],tags:Ue};let Rt;Rt=De||this.options.generateId?Z[_e+3]:this.points[Z[_e+3]].id,Rt!==void 0&&(vt.id=Rt),Ce.features.push(vt)}}_limitZoom($){return Math.max(this.options.minZoom,Math.min(Math.floor(+$),this.options.maxZoom+1))}_cluster($,Z){const{radius:W,extent:fe,reduce:pe,minPoints:Ce}=this.options,we=W/(fe*Math.pow(2,Z)),_e=$.data,De=[],Ue=this.stride;for(let Ge=0;Ge<_e.length;Ge+=Ue){if(_e[Ge+2]<=Z)continue;_e[Ge+2]=Z;const ht=_e[Ge],vt=_e[Ge+1],Rt=$.within(_e[Ge],_e[Ge+1],we),gi=_e[Ge+5];let ii=gi;for(const Ee of Rt){const vi=Ee*Ue;_e[vi+2]>Z&&(ii+=_e[vi+5])}if(ii>gi&&ii>=Ce){let Ee,vi=ht*gi,Dn=vt*gi,Bt=-1;const bi=(Ge/Ue<<5)+(Z+1)+this.points.length;for(const Gn of Rt){const Ei=Gn*Ue;if(_e[Ei+2]<=Z)continue;_e[Ei+2]=Z;const fn=_e[Ei+5];vi+=_e[Ei]*fn,Dn+=_e[Ei+1]*fn,_e[Ei+4]=bi,pe&&(Ee||(Ee=this._map(_e,Ge,!0),Bt=this.clusterProps.length,this.clusterProps.push(Ee)),pe(Ee,this._map(_e,Ei)))}_e[Ge+4]=bi,De.push(vi/ii,Dn/ii,1/0,bi,-1,ii),pe&&De.push(Bt)}else{for(let Ee=0;Ee<Ue;Ee++)De.push(_e[Ge+Ee]);if(ii>1)for(const Ee of Rt){const vi=Ee*Ue;if(!(_e[vi+2]<=Z)){_e[vi+2]=Z;for(let Dn=0;Dn<Ue;Dn++)De.push(_e[vi+Dn])}}}}return De}_getOriginId($){return $-this.points.length>>5}_getOriginZoom($){return($-this.points.length)%32}_map($,Z,W){if($[Z+5]>1){const Ce=this.clusterProps[$[Z+6]];return W?Object.assign({},Ce):Ce}const fe=this.points[$[Z+3]].properties,pe=this.options.map(fe);return W&&pe===fe?Object.assign({},pe):pe}}function Vn(Se,$,Z){return{type:"Feature",id:Se[$+3],properties:Un(Se,$,Z),geometry:{type:"Point",coordinates:[(W=Se[$],360*(W-.5)),$r(Se[$+1])]}};var W}function Un(Se,$,Z){const W=Se[$+5],fe=W>=1e4?`${Math.round(W/1e3)}k`:W>=1e3?Math.round(W/100)/10+"k":W,pe=Se[$+6],Ce=pe===-1?{}:Object.assign({},Z[pe]);return Object.assign(Ce,{cluster:!0,cluster_id:Se[$+3],point_count:W,point_count_abbreviated:fe})}function Ni(Se){return Se/360+.5}function Cn(Se){const $=Math.sin(Se*Math.PI/180),Z=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return Z<0?0:Z>1?1:Z}function $r(Se){const $=(180-360*Se)*Math.PI/180;return 360*Math.atan(Math.exp($))/Math.PI-90}function lr(Se,$,Z,W){let fe=W;const pe=$+(Z-$>>1);let Ce,we=Z-$;const _e=Se[$],De=Se[$+1],Ue=Se[Z],Ge=Se[Z+1];for(let ht=$+3;ht<Z;ht+=3){const vt=qe(Se[ht],Se[ht+1],_e,De,Ue,Ge);if(vt>fe)Ce=ht,fe=vt;else if(vt===fe){const Rt=Math.abs(ht-pe);Rt<we&&(Ce=ht,we=Rt)}}fe>W&&(Ce-$>3&&lr(Se,$,Ce,W),Se[Ce+2]=fe,Z-Ce>3&&lr(Se,Ce,Z,W))}function qe(Se,$,Z,W,fe,pe){let Ce=fe-Z,we=pe-W;if(Ce!==0||we!==0){const _e=((Se-Z)*Ce+($-W)*we)/(Ce*Ce+we*we);_e>1?(Z=fe,W=pe):_e>0&&(Z+=Ce*_e,W+=we*_e)}return Ce=Se-Z,we=$-W,Ce*Ce+we*we}function ot(Se,$,Z,W){const fe={id:Se??null,type:$,geometry:Z,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if($==="Point"||$==="MultiPoint"||$==="LineString")Pt(fe,Z);else if($==="Polygon")Pt(fe,Z[0]);else if($==="MultiLineString")for(const pe of Z)Pt(fe,pe);else if($==="MultiPolygon")for(const pe of Z)Pt(fe,pe[0]);return fe}function Pt(Se,$){for(let Z=0;Z<$.length;Z+=3)Se.minX=Math.min(Se.minX,$[Z]),Se.minY=Math.min(Se.minY,$[Z+1]),Se.maxX=Math.max(Se.maxX,$[Z]),Se.maxY=Math.max(Se.maxY,$[Z+1])}function Mt(Se,$,Z,W){if(!$.geometry)return;const fe=$.geometry.coordinates;if(fe&&fe.length===0)return;const pe=$.geometry.type,Ce=Math.pow(Z.tolerance/((1<<Z.maxZoom)*Z.extent),2);let we=[],_e=$.id;if(Z.promoteId?_e=$.properties[Z.promoteId]:Z.generateId&&(_e=W||0),pe==="Point")mi(fe,we);else if(pe==="MultiPoint")for(const De of fe)mi(De,we);else if(pe==="LineString")be(fe,we,Ce,!1);else if(pe==="MultiLineString"){if(Z.lineMetrics){for(const De of fe)we=[],be(De,we,Ce,!1),Se.push(ot(_e,"LineString",we,$.properties));return}Ke(fe,we,Ce,!1)}else if(pe==="Polygon")Ke(fe,we,Ce,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(const De of $.geometry.geometries)Mt(Se,{id:_e,geometry:De,properties:$.properties},Z,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const De of fe){const Ue=[];Ke(De,Ue,Ce,!0),we.push(Ue)}}Se.push(ot(_e,pe,we,$.properties))}function mi(Se,$){$.push(pt(Se[0]),bt(Se[1]),0)}function be(Se,$,Z,W){let fe,pe,Ce=0;for(let _e=0;_e<Se.length;_e++){const De=pt(Se[_e][0]),Ue=bt(Se[_e][1]);$.push(De,Ue,0),_e>0&&(Ce+=W?(fe*Ue-De*pe)/2:Math.sqrt(Math.pow(De-fe,2)+Math.pow(Ue-pe,2))),fe=De,pe=Ue}const we=$.length-3;$[2]=1,lr($,0,we,Z),$[we+2]=1,$.size=Math.abs(Ce),$.start=0,$.end=$.size}function Ke(Se,$,Z,W){for(let fe=0;fe<Se.length;fe++){const pe=[];be(Se[fe],pe,Z,W),$.push(pe)}}function pt(Se){return Se/360+.5}function bt(Se){const $=Math.sin(Se*Math.PI/180),Z=.5-.25*Math.log((1+$)/(1-$))/Math.PI;return Z<0?0:Z>1?1:Z}function At(Se,$,Z,W,fe,pe,Ce,we){if(W/=$,pe>=(Z/=$)&&Ce<W)return Se;if(Ce<Z||pe>=W)return null;const _e=[];for(const De of Se){const Ue=De.geometry;let Ge=De.type;const ht=fe===0?De.minX:De.minY,vt=fe===0?De.maxX:De.maxY;if(ht>=Z&&vt<W){_e.push(De);continue}if(vt<Z||ht>=W)continue;let Rt=[];if(Ge==="Point"||Ge==="MultiPoint")Vt(Ue,Rt,Z,W,fe);else if(Ge==="LineString")ei(Ue,Rt,Z,W,fe,!1,we.lineMetrics);else if(Ge==="MultiLineString")qi(Ue,Rt,Z,W,fe,!1);else if(Ge==="Polygon")qi(Ue,Rt,Z,W,fe,!0);else if(Ge==="MultiPolygon")for(const gi of Ue){const ii=[];qi(gi,ii,Z,W,fe,!0),ii.length&&Rt.push(ii)}if(Rt.length){if(we.lineMetrics&&Ge==="LineString"){for(const gi of Rt)_e.push(ot(De.id,Ge,gi,De.tags));continue}Ge!=="LineString"&&Ge!=="MultiLineString"||(Rt.length===1?(Ge="LineString",Rt=Rt[0]):Ge="MultiLineString"),Ge!=="Point"&&Ge!=="MultiPoint"||(Ge=Rt.length===3?"Point":"MultiPoint"),_e.push(ot(De.id,Ge,Rt,De.tags))}}return _e.length?_e:null}function Vt(Se,$,Z,W,fe){for(let pe=0;pe<Se.length;pe+=3){const Ce=Se[pe+fe];Ce>=Z&&Ce<=W&&Tr($,Se[pe],Se[pe+1],Se[pe+2])}}function ei(Se,$,Z,W,fe,pe,Ce){let we=Pi(Se);const _e=fe===0?ao:Xr;let De,Ue,Ge=Se.start;for(let ii=0;ii<Se.length-3;ii+=3){const Ee=Se[ii],vi=Se[ii+1],Dn=Se[ii+2],Bt=Se[ii+3],bi=Se[ii+4],Gn=fe===0?Ee:vi,Ei=fe===0?Bt:bi;let fn=!1;Ce&&(De=Math.sqrt(Math.pow(Ee-Bt,2)+Math.pow(vi-bi,2))),Gn<Z?Ei>Z&&(Ue=_e(we,Ee,vi,Bt,bi,Z),Ce&&(we.start=Ge+De*Ue)):Gn>W?Ei<W&&(Ue=_e(we,Ee,vi,Bt,bi,W),Ce&&(we.start=Ge+De*Ue)):Tr(we,Ee,vi,Dn),Ei<Z&&Gn>=Z&&(Ue=_e(we,Ee,vi,Bt,bi,Z),fn=!0),Ei>W&&Gn<=W&&(Ue=_e(we,Ee,vi,Bt,bi,W),fn=!0),!pe&&fn&&(Ce&&(we.end=Ge+De*Ue),$.push(we),we=Pi(Se)),Ce&&(Ge+=De)}let ht=Se.length-3;const vt=Se[ht],Rt=Se[ht+1],gi=fe===0?vt:Rt;gi>=Z&&gi<=W&&Tr(we,vt,Rt,Se[ht+2]),ht=we.length-3,pe&&ht>=3&&(we[ht]!==we[0]||we[ht+1]!==we[1])&&Tr(we,we[0],we[1],we[2]),we.length&&$.push(we)}function Pi(Se){const $=[];return $.size=Se.size,$.start=Se.start,$.end=Se.end,$}function qi(Se,$,Z,W,fe,pe){for(const Ce of Se)ei(Ce,$,Z,W,fe,pe,!1)}function Tr(Se,$,Z,W){Se.push($,Z,W)}function ao(Se,$,Z,W,fe,pe){const Ce=(pe-$)/(W-$);return Tr(Se,pe,Z+(fe-Z)*Ce,1),Ce}function Xr(Se,$,Z,W,fe,pe){const Ce=(pe-Z)/(fe-Z);return Tr(Se,$+(W-$)*Ce,pe,1),Ce}function kl(Se,$){const Z=[];for(let W=0;W<Se.length;W++){const fe=Se[W],pe=fe.type;let Ce;if(pe==="Point"||pe==="MultiPoint"||pe==="LineString")Ce=rn(fe.geometry,$);else if(pe==="MultiLineString"||pe==="Polygon"){Ce=[];for(const we of fe.geometry)Ce.push(rn(we,$))}else if(pe==="MultiPolygon"){Ce=[];for(const we of fe.geometry){const _e=[];for(const De of we)_e.push(rn(De,$));Ce.push(_e)}}Z.push(ot(fe.id,pe,Ce,fe.tags))}return Z}function rn(Se,$){const Z=[];Z.size=Se.size,Se.start!==void 0&&(Z.start=Se.start,Z.end=Se.end);for(let W=0;W<Se.length;W+=3)Z.push(Se[W]+$,Se[W+1],Se[W+2]);return Z}function Ir(Se,$){if(Se.transformed)return Se;const Z=1<<Se.z,W=Se.x,fe=Se.y;for(const pe of Se.features){const Ce=pe.geometry,we=pe.type;if(pe.geometry=[],we===1)for(let _e=0;_e<Ce.length;_e+=2)pe.geometry.push(pa(Ce[_e],Ce[_e+1],$,Z,W,fe));else for(let _e=0;_e<Ce.length;_e++){const De=[];for(let Ue=0;Ue<Ce[_e].length;Ue+=2)De.push(pa(Ce[_e][Ue],Ce[_e][Ue+1],$,Z,W,fe));pe.geometry.push(De)}}return Se.transformed=!0,Se}function pa(Se,$,Z,W,fe,pe){return[Math.round(Z*(Se*W-fe)),Math.round(Z*($*W-pe))]}function hn(Se,$,Z,W,fe){const pe=$===fe.maxZoom?0:fe.tolerance/((1<<$)*fe.extent),Ce={features:[],numPoints:0,numSimplified:0,numFeatures:Se.length,source:null,x:Z,y:W,z:$,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const we of Se)zs(Ce,we,pe,fe);return Ce}function zs(Se,$,Z,W){const fe=$.geometry,pe=$.type,Ce=[];if(Se.minX=Math.min(Se.minX,$.minX),Se.minY=Math.min(Se.minY,$.minY),Se.maxX=Math.max(Se.maxX,$.maxX),Se.maxY=Math.max(Se.maxY,$.maxY),pe==="Point"||pe==="MultiPoint")for(let we=0;we<fe.length;we+=3)Ce.push(fe[we],fe[we+1]),Se.numPoints++,Se.numSimplified++;else if(pe==="LineString")Ps(Ce,fe,Se,Z,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(let we=0;we<fe.length;we++)Ps(Ce,fe[we],Se,Z,pe==="Polygon",we===0);else if(pe==="MultiPolygon")for(let we=0;we<fe.length;we++){const _e=fe[we];for(let De=0;De<_e.length;De++)Ps(Ce,_e[De],Se,Z,!0,De===0)}if(Ce.length){let we=$.tags||null;if(pe==="LineString"&&W.lineMetrics){we={};for(const De in $.tags)we[De]=$.tags[De];we.mapbox_clip_start=fe.start/fe.size,we.mapbox_clip_end=fe.end/fe.size}const _e={geometry:Ce,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:we};$.id!==null&&(_e.id=$.id),Se.features.push(_e)}}function Ps(Se,$,Z,W,fe,pe){const Ce=W*W;if(W>0&&$.size<(fe?Ce:W))return void(Z.numPoints+=$.length/3);const we=[];for(let _e=0;_e<$.length;_e+=3)(W===0||$[_e+2]>Ce)&&(Z.numSimplified++,we.push($[_e],$[_e+1])),Z.numPoints++;fe&&(function(_e,De){let Ue=0;for(let Ge=0,ht=_e.length,vt=ht-2;Ge<ht;vt=Ge,Ge+=2)Ue+=(_e[Ge]-_e[vt])*(_e[Ge+1]+_e[vt+1]);if(Ue>0===De)for(let Ge=0,ht=_e.length;Ge<ht/2;Ge+=2){const vt=_e[Ge],Rt=_e[Ge+1];_e[Ge]=_e[ht-2-Ge],_e[Ge+1]=_e[ht-1-Ge],_e[ht-2-Ge]=vt,_e[ht-1-Ge]=Rt}})(we,pe),Se.push(we)}const so={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class es{constructor($,Z){const W=(Z=this.options=(function(pe,Ce){for(const we in Ce)pe[we]=Ce[we];return pe})(Object.create(so),Z)).debug;if(W&&console.time("preprocess data"),Z.maxZoom<0||Z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Z.promoteId&&Z.generateId)throw new Error("promoteId and generateId cannot be used together.");let fe=(function(pe,Ce){const we=[];if(pe.type==="FeatureCollection")for(let _e=0;_e<pe.features.length;_e++)Mt(we,pe.features[_e],Ce,_e);else Mt(we,pe.type==="Feature"?pe:{geometry:pe},Ce);return we})($,Z);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Z.indexMaxZoom,Z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),fe=(function(pe,Ce){const we=Ce.buffer/Ce.extent;let _e=pe;const De=At(pe,1,-1-we,we,0,-1,2,Ce),Ue=At(pe,1,1-we,2+we,0,-1,2,Ce);return(De||Ue)&&(_e=At(pe,1,-we,1+we,0,-1,2,Ce)||[],De&&(_e=kl(De,1).concat(_e)),Ue&&(_e=_e.concat(kl(Ue,-1)))),_e})(fe,Z),fe.length&&this.splitTile(fe,0,0,0),W&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile($,Z,W,fe,pe,Ce,we){const _e=[$,Z,W,fe],De=this.options,Ue=De.debug;for(;_e.length;){fe=_e.pop(),W=_e.pop(),Z=_e.pop(),$=_e.pop();const Ge=1<<Z,ht=La(Z,W,fe);let vt=this.tiles[ht];if(!vt&&(Ue>1&&console.time("creation"),vt=this.tiles[ht]=hn($,Z,W,fe,De),this.tileCoords.push({z:Z,x:W,y:fe}),Ue)){Ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Z,W,fe,vt.numFeatures,vt.numPoints,vt.numSimplified),console.timeEnd("creation"));const fn=`z${Z}`;this.stats[fn]=(this.stats[fn]||0)+1,this.total++}if(vt.source=$,pe==null){if(Z===De.indexMaxZoom||vt.numPoints<=De.indexMaxPoints)continue}else{if(Z===De.maxZoom||Z===pe)continue;if(pe!=null){const fn=pe-Z;if(W!==Ce>>fn||fe!==we>>fn)continue}}if(vt.source=null,$.length===0)continue;Ue>1&&console.time("clipping");const Rt=.5*De.buffer/De.extent,gi=.5-Rt,ii=.5+Rt,Ee=1+Rt;let vi=null,Dn=null,Bt=null,bi=null,Gn=At($,Ge,W-Rt,W+ii,0,vt.minX,vt.maxX,De),Ei=At($,Ge,W+gi,W+Ee,0,vt.minX,vt.maxX,De);$=null,Gn&&(vi=At(Gn,Ge,fe-Rt,fe+ii,1,vt.minY,vt.maxY,De),Dn=At(Gn,Ge,fe+gi,fe+Ee,1,vt.minY,vt.maxY,De),Gn=null),Ei&&(Bt=At(Ei,Ge,fe-Rt,fe+ii,1,vt.minY,vt.maxY,De),bi=At(Ei,Ge,fe+gi,fe+Ee,1,vt.minY,vt.maxY,De),Ei=null),Ue>1&&console.timeEnd("clipping"),_e.push(vi||[],Z+1,2*W,2*fe),_e.push(Dn||[],Z+1,2*W,2*fe+1),_e.push(Bt||[],Z+1,2*W+1,2*fe),_e.push(bi||[],Z+1,2*W+1,2*fe+1)}}getTile($,Z,W){$=+$,Z=+Z,W=+W;const fe=this.options,{extent:pe,debug:Ce}=fe;if($<0||$>24)return null;const we=1<<$,_e=La($,Z=Z+we&we-1,W);if(this.tiles[_e])return Ir(this.tiles[_e],pe);Ce>1&&console.log("drilling down to z%d-%d-%d",$,Z,W);let De,Ue=$,Ge=Z,ht=W;for(;!De&&Ue>0;)Ue--,Ge>>=1,ht>>=1,De=this.tiles[La(Ue,Ge,ht)];return De&&De.source?(Ce>1&&(console.log("found parent tile z%d-%d-%d",Ue,Ge,ht),console.time("drilling down")),this.splitTile(De.source,Ue,Ge,ht,$,Z,W),Ce>1&&console.timeEnd("drilling down"),this.tiles[_e]?Ir(this.tiles[_e],pe):null):null}}function La(Se,$,Z){return 32*((1<<Se)*Z+$)+Se}class Fl extends xe{constructor($,Z,W,fe=Yn){super($,Z,W),this._dataUpdateable=new Map,this._createGeoJSONIndex=fe}loadVectorTile($,Z){return P._(this,void 0,void 0,(function*(){const W=$.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const fe=this._geoJSONIndex.getTile(W.z,W.x,W.y);return fe?Et(new P.d2(fe.features,{version:2,extent:P.a5})):null}))}loadData($){return P._(this,void 0,void 0,(function*(){var Z;(Z=this._pendingRequest)===null||Z===void 0||Z.abort();const W=this._startPerformance($);this._pendingRequest=new AbortController;try{(!this._pendingData||$.request||$.data||$.dataDiff)&&(this._pendingData=this.loadAndProcessGeoJSON($,this._pendingRequest));const fe=yield this._pendingData;this._geoJSONIndex=this._createGeoJSONIndex(fe,$),this.loaded={};const pe={};return $.request&&(pe.data=fe),this._finishPerformance(W,$,pe),pe}catch(fe){if(delete this._pendingRequest,P.Z(fe))return{abandoned:!0};throw fe}}))}_startPerformance($){var Z;if(!((Z=$?.request)===null||Z===void 0)&&Z.collectResourceTiming)return new P.c_($.request)}_finishPerformance($,Z,W){if(!$)return;const fe=$.finish();fe&&(W.resourceTiming={},W.resourceTiming[Z.source]=JSON.parse(JSON.stringify(fe)))}getData(){return P._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile($){const Z=this.loaded;return Z&&Z[$.uid]?super.reloadTile($):this.loadTile($)}loadAndProcessGeoJSON($,Z){return P._(this,void 0,void 0,(function*(){let W;if($.request?W=yield this.loadGeoJSONFromUrl($.request,$.promoteId,Z):$.data?W=this._loadGeoJSONFromObject($.data,$.promoteId):$.dataDiff&&(W=this._loadGeoJSONFromDiff($.dataDiff,$.promoteId,$.source)),delete this._pendingRequest,typeof W!="object")throw new Error(`Input data given to '${$.source}' is not a valid GeoJSON object.`);return di(W,!0),$.filter&&(W=this._filterGeoJSON(W,$.filter)),W}))}loadGeoJSONFromUrl($,Z,W){return P._(this,void 0,void 0,(function*(){const fe=yield P.j($,W);return this._dataUpdateable=P.a7(fe.data,Z),fe.data}))}_loadGeoJSONFromObject($,Z){return this._dataUpdateable=P.a7($,Z),$}_loadGeoJSONFromDiff($,Z,W){if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W}`);P.a8(this._dataUpdateable,$,Z);const fe=Array.from(this._dataUpdateable.values());return this._toFeatureCollection(fe)}_filterGeoJSON($,Z){const W=P.d3(Z,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(W.result==="error")throw new Error(W.value.map((pe=>`${pe.key}: ${pe.message}`)).join(", "));const fe=$.features.filter((pe=>W.value.evaluate({zoom:0},pe)));return this._toFeatureCollection(fe)}_toFeatureCollection($){return{type:"FeatureCollection",features:$}}removeSource($){return P._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom($){return this._geoJSONIndex.getClusterExpansionZoom($.clusterId)}getClusterChildren($){return this._geoJSONIndex.getChildren($.clusterId)}getClusterLeaves($){return this._geoJSONIndex.getLeaves($.clusterId,$.limit,$.offset)}}function Yn(Se,$){return $.cluster?new cn((function({superclusterOptions:Z,clusterProperties:W}){if(!W||!Z)return Z;const fe={},pe={},Ce={accumulated:null,zoom:0},we={properties:null},_e=Object.keys(W);for(const De of _e){const[Ue,Ge]=W[De],ht=P.d3(Ge),vt=P.d3(typeof Ue=="string"?[Ue,["accumulated"],["get",De]]:Ue);fe[De]=ht.value,pe[De]=vt.value}return Z.map=De=>{we.properties=De;const Ue={};for(const Ge of _e)Ue[Ge]=fe[Ge].evaluate(Ce,we);return Ue},Z.reduce=(De,Ue)=>{we.properties=Ue;for(const Ge of _e)Ce.accumulated=De[Ge],De[Ge]=pe[Ge].evaluate(Ce,we)},Z})($)).load(Se.features):(function(Z,W){return new es(Z,W)})(Se,$.geojsonVtOptions)}class Rr{constructor($){this.self=$,this.actor=new P.L($),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(Z,W)=>{if(this.externalWorkerSourceTypes[Z])throw new Error(`Worker source with name "${Z}" already registered.`);this.externalWorkerSourceTypes[Z]=W},this.self.addProtocol=P.cJ,this.self.removeProtocol=P.cK,this.self.registerRTLTextPlugin=Z=>{P.d4.setMethods(Z)},this.actor.registerMessageHandler("LDT",((Z,W)=>this._getDEMWorkerSource(Z,W.source).loadTile(W))),this.actor.registerMessageHandler("RDT",((Z,W)=>P._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(Z,W.source).removeTile(W)})))),this.actor.registerMessageHandler("GCEZ",((Z,W)=>P._(this,void 0,void 0,(function*(){return this._getWorkerSource(Z,W.type,W.source).getClusterExpansionZoom(W)})))),this.actor.registerMessageHandler("GCC",((Z,W)=>P._(this,void 0,void 0,(function*(){return this._getWorkerSource(Z,W.type,W.source).getClusterChildren(W)})))),this.actor.registerMessageHandler("GCL",((Z,W)=>P._(this,void 0,void 0,(function*(){return this._getWorkerSource(Z,W.type,W.source).getClusterLeaves(W)})))),this.actor.registerMessageHandler("LD",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).loadData(W))),this.actor.registerMessageHandler("GD",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).getData())),this.actor.registerMessageHandler("LT",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).loadTile(W))),this.actor.registerMessageHandler("RT",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).reloadTile(W))),this.actor.registerMessageHandler("AT",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).abortTile(W))),this.actor.registerMessageHandler("RMT",((Z,W)=>this._getWorkerSource(Z,W.type,W.source).removeTile(W))),this.actor.registerMessageHandler("RS",((Z,W)=>P._(this,void 0,void 0,(function*(){if(!this.workerSources[Z]||!this.workerSources[Z][W.type]||!this.workerSources[Z][W.type][W.source])return;const fe=this.workerSources[Z][W.type][W.source];delete this.workerSources[Z][W.type][W.source],fe.removeSource!==void 0&&fe.removeSource(W)})))),this.actor.registerMessageHandler("RM",(Z=>P._(this,void 0,void 0,(function*(){delete this.layerIndexes[Z],delete this.availableImages[Z],delete this.workerSources[Z],delete this.demWorkerSources[Z],this.globalStates.delete(Z)})))),this.actor.registerMessageHandler("SR",((Z,W)=>P._(this,void 0,void 0,(function*(){this.referrer=W})))),this.actor.registerMessageHandler("SRPS",((Z,W)=>this._syncRTLPluginState(Z,W))),this.actor.registerMessageHandler("IS",((Z,W)=>P._(this,void 0,void 0,(function*(){this.self.importScripts(W)})))),this.actor.registerMessageHandler("SI",((Z,W)=>this._setImages(Z,W))),this.actor.registerMessageHandler("UL",((Z,W)=>P._(this,void 0,void 0,(function*(){this._getLayerIndex(Z).update(W.layers,W.removedIds,this._getGlobalState(Z))})))),this.actor.registerMessageHandler("UGS",((Z,W)=>P._(this,void 0,void 0,(function*(){const fe=this._getGlobalState(Z);for(const pe in W)fe[pe]=W[pe]})))),this.actor.registerMessageHandler("SL",((Z,W)=>P._(this,void 0,void 0,(function*(){this._getLayerIndex(Z).replace(W,this._getGlobalState(Z))}))))}_getGlobalState($){let Z=this.globalStates.get($);return Z||(Z={},this.globalStates.set($,Z)),Z}_setImages($,Z){return P._(this,void 0,void 0,(function*(){this.availableImages[$]=Z;for(const W in this.workerSources[$]){const fe=this.workerSources[$][W];for(const pe in fe)fe[pe].availableImages=Z}}))}_syncRTLPluginState($,Z){return P._(this,void 0,void 0,(function*(){return yield P.d4.syncState(Z,this.self.importScripts)}))}_getAvailableImages($){let Z=this.availableImages[$];return Z||(Z=[]),Z}_getLayerIndex($){let Z=this.layerIndexes[$];return Z||(Z=this.layerIndexes[$]=new h),Z}_getWorkerSource($,Z,W){if(this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][Z]||(this.workerSources[$][Z]={}),!this.workerSources[$][Z][W]){const fe={sendAsync:(pe,Ce)=>(pe.targetMapId=$,this.actor.sendAsync(pe,Ce))};switch(Z){case"vector":this.workerSources[$][Z][W]=new xe(fe,this._getLayerIndex($),this._getAvailableImages($));break;case"geojson":this.workerSources[$][Z][W]=new Fl(fe,this._getLayerIndex($),this._getAvailableImages($));break;default:this.workerSources[$][Z][W]=new this.externalWorkerSourceTypes[Z](fe,this._getLayerIndex($),this._getAvailableImages($))}}return this.workerSources[$][Z][W]}_getDEMWorkerSource($,Z){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][Z]||(this.demWorkerSources[$][Z]=new Jt),this.demWorkerSources[$][Z]}}return P.i(self)&&(self.worker=new Rr(self)),Rr})),F("index",["exports","./shared"],(function(P,h){var ne="5.16.0";function ge(){var m=new h.A(4);return h.A!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m}let Le,Xe,Je;const yt={frame(m,t,a){const l=requestAnimationFrame((_=>{f(),t(_)})),{unsubscribe:f}=h.s(m.signal,"abort",(()=>{f(),cancelAnimationFrame(l),a(new h.a(m.signal.reason))}),!1)},frameAsync(m){return new Promise(((t,a)=>{this.frame(m,t,a)}))},getImageData(m,t=0){return this.getImageCanvasContext(m).getImageData(-t,-t,m.width+2*t,m.height+2*t)},getImageCanvasContext(m){const t=window.document.createElement("canvas"),a=t.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return t.width=m.width,t.height=m.height,a.drawImage(m,0,0,m.width,m.height),a},resolveURL:m=>(Le||(Le=document.createElement("a")),Le.href=m,Le.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return Je!==void 0?Je:!!matchMedia&&(Xe==null&&(Xe=matchMedia("(prefers-reduced-motion: reduce)")),Xe.matches)},set prefersReducedMotion(m){Je=m}},Et=new class{constructor(){this._realTime=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),this._frozenAt=null}getCurrentTime(){return this._frozenAt!==null?this._frozenAt:this._realTime()}setNow(m){this._frozenAt=m}restoreNow(){this._frozenAt=null}isFrozen(){return this._frozenAt!==null}};function rt(){return Et.getCurrentTime()}class xe{static testProp(t){if(!xe.docStyle)return t[0];for(let a=0;a<t.length;a++)if(t[a]in xe.docStyle)return t[a];return t[0]}static create(t,a,l){const f=window.document.createElement(t);return a!==void 0&&(f.className=a),l&&l.appendChild(f),f}static createNS(t,a){return window.document.createElementNS(t,a)}static disableDrag(){xe.docStyle&&xe.selectProp&&(xe.userSelect=xe.docStyle[xe.selectProp],xe.docStyle[xe.selectProp]="none")}static enableDrag(){xe.docStyle&&xe.selectProp&&(xe.docStyle[xe.selectProp]=xe.userSelect)}static setTransform(t,a){t.style[xe.transformProp]=a}static addEventListener(t,a,l,f={}){t.addEventListener(a,l,"passive"in f?f:f.capture)}static removeEventListener(t,a,l,f={}){t.removeEventListener(a,l,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",xe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",xe.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",xe.suppressClickInternal,!0)}),0)}static getScale(t){const a=t.getBoundingClientRect();return{x:a.width/t.offsetWidth||1,y:a.height/t.offsetHeight||1,boundingClientRect:a}}static getPoint(t,a,l){const f=a.boundingClientRect;return new h.P((l.clientX-f.left)/a.x-t.clientLeft,(l.clientY-f.top)/a.y-t.clientTop)}static mousePos(t,a){const l=xe.getScale(t);return xe.getPoint(t,l,a)}static touchPos(t,a){const l=[],f=xe.getScale(t);for(let _=0;_<a.length;_++)l.push(xe.getPoint(t,f,a[_]));return l}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const a=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const f of l)f.remove();return xe.clean(a),a.innerHTML}static isPossiblyDangerous(t,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!l.includes("javascript:")&&!l.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const a=t.children;for(const l of a)xe.removeAttributes(l),xe.clean(l)}static removeAttributes(t){for(const{name:a,value:l}of t.attributes)xe.isPossiblyDangerous(a,l)&&t.removeAttribute(a)}}xe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,xe.selectProp=xe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),xe.transformProp=xe.testProp(["transform","WebkitTransform"]);const Jt={supported:!1,testSupport:function(m){!Kt&&Ct&&(di?Si(m):Nt=m)}};let Nt,Ct,Kt=!1,di=!1;function Si(m){const t=m.createTexture();m.bindTexture(m.TEXTURE_2D,t);try{if(m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,Ct),m.isContextLost())return;Jt.supported=!0}catch{}m.deleteTexture(t),Kt=!0}var St;typeof document<"u"&&(Ct=document.createElement("img"),Ct.onload=()=>{Nt&&Si(Nt),Nt=null,di=!0},Ct.onerror=()=>{Kt=!0,Nt=null},Ct.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(m){let t,a,l,f;m.resetRequestQueue=()=>{t=[],a=0,l=0,f={}},m.addThrottleControl=A=>{const I=l++;return f[I]=A,I},m.removeThrottleControl=A=>{delete f[A],b()},m.getImage=(A,I,O=!0)=>new Promise(((j,k)=>{Jt.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),h.e(A,{type:"image"}),t.push({abortController:I,requestParameters:A,supportImageRefresh:O,state:"queued",onError:G=>{k(G)},onSuccess:G=>{j(G)}}),b()}));const _=A=>h._(this,void 0,void 0,(function*(){A.state="running";const{requestParameters:I,supportImageRefresh:O,onError:j,onSuccess:k,abortController:G}=A,X=O===!1&&!h.i(self)&&!h.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce(((te,ae)=>te&&ae==="accept"),!0));a++;const ee=X?w(I,G):h.m(I,G);try{const te=yield ee;delete A.abortController,A.state="completed",te.data instanceof HTMLImageElement||h.b(te.data)?k(te):te.data&&k({data:yield(ie=te.data,typeof createImageBitmap=="function"?h.f(ie):h.h(ie)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete A.abortController,j(te)}finally{a--,b()}var ie})),b=()=>{const A=(()=>{for(const I of Object.keys(f))if(f[I]())return!0;return!1})()?h.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=a;I<A&&t.length>0;I++){const O=t.shift();O.abortController.signal.aborted?I--:_(O)}},w=(A,I)=>new Promise(((O,j)=>{const k=new Image,G=A.url,X=A.credentials;X&&X==="include"?k.crossOrigin="use-credentials":(X&&X==="same-origin"||!h.d(G))&&(k.crossOrigin="anonymous"),I.signal.addEventListener("abort",(()=>{k.src="",j(new h.a(I.signal.reason))})),k.fetchPriority="high",k.onload=()=>{k.onerror=k.onload=null,O({data:k})},k.onerror=()=>{k.onerror=k.onload=null,I.signal.aborted||j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},k.src=G}))})(St||(St={})),St.resetRequestQueue();class pi{constructor(t){this._transformRequestFn=t??null}transformRequest(t,a){return this._transformRequestFn&&this._transformRequestFn(t,a)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function cn(m){const t=[];if(typeof m=="string")t.push({id:"default",url:m});else if(m&&m.length>0){const a=[];for(const{id:l,url:f}of m){const _=`${l}${f}`;a.indexOf(_)===-1&&(a.push(_),t.push({id:l,url:f}))}}return t}function Vn(m,t,a){try{const l=new URL(m);return l.pathname+=`${t}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${m}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Un(m){const{userImage:t}=m;return!!(t&&t.render&&t.render())&&(m.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ni extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}destroy(){this.atlasTexture&&(this.atlasTexture.destroy(),this.atlasTexture=null);for(const t of Object.keys(this.images))this.removeImage(t);this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(t){const a=this.images[t];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new h.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(t,a){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,a)&&(this.images[t]=a)}_validate(t,a){let l=!0;const f=a.data||a.spriteData;return this._validateStretch(a.stretchX,f&&f.width)||(this.fire(new h.k(new Error(`Image "${t}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,f&&f.height)||(this.fire(new h.k(new Error(`Image "${t}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new h.k(new Error(`Image "${t}" has invalid "content" value`))),l=!1),l}_validateStretch(t,a){if(!t)return!0;let l=0;for(const f of t){if(f[0]<l||f[1]<f[0]||a<f[1])return!1;l=f[1]}return!0}_validateContent(t,a){if(!t)return!0;if(t.length!==4)return!1;const l=a.spriteData,f=l&&l.width||a.data.width,_=l&&l.height||a.data.height;return!(t[0]<0||f<t[0]||t[1]<0||_<t[1]||t[2]<0||f<t[2]||t[3]<0||_<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,a,l=!0){const f=this.getImage(t);if(l&&(f.data.width!==a.data.width||f.data.height!==a.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=f.version+1,this.images[t]=a,this.updatedImages[t]=!0}removeImage(t){const a=this.images[t];delete this.images[t],delete this.patterns[t],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((a,l)=>{let f=!0;if(!this.isLoaded())for(const _ of t)this.images[_]||(f=!1);this.isLoaded()||f?a(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:a})}))}_getImagesForIds(t){const a={};for(const l of t){let f=this.getImage(l);f||(this.fire(new h.l("styleimagemissing",{id:l})),f=this.getImage(l)),f?a[l]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:h.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:t,height:a}=this.atlasImage;return{width:t,height:a}}getPattern(t){const a=this.patterns[t],l=this.getImage(t);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const f={w:l.data.width+2,h:l.data.height+2,x:0,y:0},_=new h.I(f,l);this.patterns[t]={bin:f,position:_}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const a=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.T(t,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const _ in this.patterns)t.push(this.patterns[_].bin);const{w:a,h:l}=h.p(t),f=this.atlasImage;f.resize({width:a||1,height:l||1});for(const _ in this.patterns){const{bin:b}=this.patterns[_],w=b.x+1,A=b.y+1,I=this.getImage(_).data,O=I.width,j=I.height;h.R.copy(I,f,{x:0,y:0},{x:w,y:A},{width:O,height:j}),h.R.copy(I,f,{x:0,y:j-1},{x:w,y:A-1},{width:O,height:1}),h.R.copy(I,f,{x:0,y:0},{x:w,y:A+j},{width:O,height:1}),h.R.copy(I,f,{x:O-1,y:0},{x:w-1,y:A},{width:1,height:j}),h.R.copy(I,f,{x:0,y:0},{x:w+O,y:A},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const a of t){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||h.w(`Image with ID: "${a}" was not found`),Un(l)&&this.updateImage(a,l)}}cloneImages(){const t={};for(const a in this.images){const l=this.images[a];t[a]=Object.assign(Object.assign({},l),{data:l.data?l.data.clone():null})}return t}}const Cn=1e20;function $r(m,t,a,l,f,_,b,w,A){for(let I=t;I<t+l;I++)lr(m,a*_+I,_,f,b,w,A);for(let I=a;I<a+f;I++)lr(m,I*_+t,1,l,b,w,A)}function lr(m,t,a,l,f,_,b){_[0]=0,b[0]=-Cn,b[1]=Cn,f[0]=m[t];for(let w=1,A=0,I=0;w<l;w++){f[w]=m[t+w*a];const O=w*w;do{const j=_[A];I=(f[w]-f[j]+O-j*j)/(w-j)/2}while(I<=b[A]&&--A>-1);A++,_[A]=w,b[A]=I,b[A+1]=Cn}for(let w=0,A=0;w<l;w++){for(;b[A+1]<w;)A++;const I=_[A],O=w-I;m[t+w*a]=f[I]+O*O}}const qe=h.v.layout_symbol["text-font"].default.join(",");class ot{constructor(t,a,l){this.requestManager=t,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(t){this.url=t}getGlyphs(t){return h._(this,void 0,void 0,(function*(){const a=[];for(const _ in t)for(const b of t[_])a.push(this._getAndCacheGlyphsPromise(_,b));const l=yield Promise.all(a),f={};for(const{stack:_,id:b,glyph:w}of l)f[_]||(f[_]={}),f[_][b]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return f}))}_getAndCacheGlyphsPromise(t,a){return h._(this,void 0,void 0,(function*(){let l=this.entries[t];l||(l=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=l.glyphs[a];return f!==void 0?{stack:t,id:a,glyph:f}:!this.url||this._charUsesLocalIdeographFontFamily(a)?(f=l.glyphs[a]=this._drawGlyph(l,t,a),{stack:t,id:a,glyph:f}):yield this._downloadAndCacheRangePromise(t,a)}))}_downloadAndCacheRangePromise(t,a){return h._(this,void 0,void 0,(function*(){const l=this.entries[t],f=Math.floor(a/256);if(l.ranges[f])return{stack:t,id:a,glyph:null};if(!l.requests[f]){const _=ot.loadGlyphRange(t,f,this.url,this.requestManager);l.requests[f]=_}try{const _=yield l.requests[f];for(const b in _)l.glyphs[+b]=_[+b];return l.ranges[f]=!0,{stack:t,id:a,glyph:_[a]||null}}catch(_){const b=l.glyphs[a]=this._drawGlyph(l,t,a);return this._warnOnMissingGlyphRange(b,f,a,_),{stack:t,id:a,glyph:b}}}))}_warnOnMissingGlyphRange(t,a,l,f){const _=256*a,b=_+255,w=l.toString(16).padStart(4,"0").toUpperCase();h.w(`Unable to load glyph range ${a}, ${_}-${b}. Rendering codepoint U+${w} locally instead. ${f}`)}_charUsesLocalIdeographFontFamily(t){return!!this.localIdeographFontFamily&&h.q(t)}_drawGlyph(t,a,l){const f=a===qe&&this.localIdeographFontFamily!==""&&this._charUsesLocalIdeographFontFamily(l),_=f?"ideographTinySDF":"tinySDF";t[_]||(t[_]=this._createTinySDF(f?this.localIdeographFontFamily:a));const b=t[_].draw(String.fromCodePoint(l)),w=new RegExp("^\\p{gc=Cf}+$","u").test(String.fromCodePoint(l));return{id:l,bitmap:new h.r({width:b.width||60,height:b.height||60},b.data),metrics:{width:w?0:b.glyphWidth/2||24,height:b.glyphHeight/2||24,left:b.glyphLeft/2+.5||0,top:b.glyphTop/2-27.5||-8,advance:w?0:b.glyphAdvance/2||24,isDoubleResolution:!0}}}_createTinySDF(t){const a=t?t.split(","):[];a.push("sans-serif");const l=a.map((f=>/[-\w]+/.test(f)?f:`'${CSS.escape(f)}'`)).join(",");return new ot.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:l,fontWeight:this._fontWeight(a[0]),fontStyle:this._fontStyle(a[0]),lang:this.lang})}_fontStyle(t){return/italic/i.test(t)?"italic":/oblique/i.test(t)?"oblique":"normal"}_fontWeight(t){const a={thin:100,hairline:100,"extra light":200,"ultra light":200,light:300,normal:400,regular:400,medium:500,semibold:600,demibold:600,bold:700,"extra bold":800,"ultra bold":800,black:900,heavy:900,"extra black":950,"ultra black":950};let l;for(const[f,_]of Object.entries(a))new RegExp(`\\b${f}\\b`,"i").test(t)&&(l=`${_}`);return l}destroy(){for(const t in this.entries){const a=this.entries[t];a.tinySDF&&(a.tinySDF=null),a.ideographTinySDF&&(a.ideographTinySDF=null),a.glyphs={},a.requests={},a.ranges={}}this.entries={}}}ot.loadGlyphRange=function(m,t,a,l){return h._(this,void 0,void 0,(function*(){const f=256*t,_=f+255,b=l.transformRequest(a.replace("{fontstack}",m).replace("{range}",`${f}-${_}`),"Glyphs"),w=yield h.n(b,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${_}`);const A={};for(const I of h.o(w.data))A[I.id]=I;return A}))},ot.TinySDF=class{constructor({fontSize:m=24,buffer:t=3,radius:a=8,cutoff:l=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:b="normal",lang:w=null}={}){this.buffer=t,this.cutoff=l,this.radius=a,this.lang=w;const A=this.size=m+4*t,I=this._createCanvas(A),O=this.ctx=I.getContext("2d",{willReadFrequently:!0});O.font=`${b} ${_} ${m}px ${f}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(m){const t=document.createElement("canvas");return t.width=t.height=m,t}draw(m){const{width:t,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(m),b=Math.ceil(a),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),A=Math.min(this.size-this.buffer,b+Math.ceil(l)),I=w+2*this.buffer,O=A+2*this.buffer,j=Math.max(I*O,0),k=new Uint8ClampedArray(j),G={data:k,width:I,height:O,glyphWidth:w,glyphHeight:A,glyphTop:b,glyphLeft:0,glyphAdvance:t};if(w===0||A===0)return G;const{ctx:X,buffer:ee,gridInner:ie,gridOuter:te}=this;this.lang&&(X.lang=this.lang),X.clearRect(ee,ee,w,A),X.fillText(m,ee,ee+b);const ae=X.getImageData(ee,ee,w,A);te.fill(Cn,0,j),ie.fill(0,0,j);for(let ce=0;ce<A;ce++)for(let re=0;re<w;re++){const ue=ae.data[4*(ce*w+re)+3]/255;if(ue===0)continue;const de=(ce+ee)*I+re+ee;if(ue===1)te[de]=0,ie[de]=Cn;else{const oe=.5-ue;te[de]=oe>0?oe*oe:0,ie[de]=oe<0?oe*oe:0}}$r(te,0,0,I,O,I,this.f,this.v,this.z),$r(ie,ee,ee,w,A,I,this.f,this.v,this.z);for(let ce=0;ce<j;ce++){const re=Math.sqrt(te[ce])-Math.sqrt(ie[ce]);k[ce]=Math.round(255-255*(re/this.radius+this.cutoff))}return G}};class Pt{constructor(){this.specification=h.u.light.position}possiblyEvaluate(t,a){return h.F(t.expression.evaluate(a))}interpolate(t,a,l){return{x:h.G.number(t.x,a.x,l),y:h.G.number(t.y,a.y,l),z:h.G.number(t.z,a.z,l)}}}let Mt;class mi extends h.E{constructor(t){super(),Mt=Mt||new h.t({anchor:new h.D(h.u.light.anchor),position:new Pt,color:new h.D(h.u.light.color),intensity:new h.D(h.u.light.intensity)}),this._transitionable=new h.x(Mt,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,a={}){if(!this._validate(h.y,t,a))for(const l in t){const f=t[l];l.endsWith(h.z)?this._transitionable.setTransition(l.slice(0,-h.z.length),f):this._transitionable.setValue(l,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l){return(!l||l.validate!==!1)&&h.B(this,t.call(h.C,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:h.u}))}}const be=new h.t({"sky-color":new h.D(h.u.sky["sky-color"]),"horizon-color":new h.D(h.u.sky["horizon-color"]),"fog-color":new h.D(h.u.sky["fog-color"]),"fog-ground-blend":new h.D(h.u.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.u.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.u.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.u.sky["atmosphere-blend"])});class Ke extends h.E{constructor(t){super(),this._transitionable=new h.x(be,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.H(0))}setSky(t,a={}){if(!this._validate(h.J,t,a)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in t){const f=t[l];l.endsWith(h.z)?this._transitionable.setTransition(l.slice(0,-h.z.length),f):this._transitionable.setValue(l,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,a,l={}){return l?.validate!==!1&&h.B(this,t.call(h.C,h.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:h.u})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class pt{constructor(t,a){this.width=t,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,a){const l=t.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(t,a)),this.dashEntry[l]}getDashRanges(t,a,l){const f=[];let _=t.length%2==1?-t[t.length-1]*l:0,b=t[0]*l,w=!0;f.push({left:_,right:b,isDash:w,zeroLength:t[0]===0});let A=t[0];for(let I=1;I<t.length;I++){w=!w;const O=t[I];_=A*l,A+=O,b=A*l,f.push({left:_,right:b,isDash:w,zeroLength:O===0})}return f}addRoundDash(t,a,l){const f=a/2;for(let _=-l;_<=l;_++){const b=this.width*(this.nextRow+l+_);let w=0,A=t[w];for(let I=0;I<this.width;I++){I/A.right>1&&(A=t[++w]);const O=Math.abs(I-A.left),j=Math.abs(I-A.right),k=Math.min(O,j);let G;const X=_/l*(f+1);if(A.isDash){const ee=f-Math.abs(X);G=Math.sqrt(k*k+ee*ee)}else G=f-Math.sqrt(k*k+X*X);this.data[b+I]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(t){for(let w=t.length-1;w>=0;--w){const A=t[w],I=t[w+1];A.zeroLength?t.splice(w,1):I&&I.isDash===A.isDash&&(I.left=A.left,t.splice(w,1))}const a=t[0],l=t[t.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const f=this.width*this.nextRow;let _=0,b=t[_];for(let w=0;w<this.width;w++){w/b.right>1&&(b=t[++_]);const A=Math.abs(w-b.left),I=Math.abs(w-b.right),O=Math.min(A,I);this.data[f+w]=Math.max(0,Math.min(255,(b.isDash?O:-O)+128))}}addDash(t,a){const l=a?7:0,f=2*l+1;if(this.nextRow+f>this.height)return h.w("LineAtlas out of space"),null;let _=0;for(let w=0;w<t.length;w++)_+=t[w];if(_!==0){const w=this.width/_,A=this.getDashRanges(t,this.width,w);a?this.addRoundDash(A,w,l):this.addRegularDash(A)}const b={y:this.nextRow+l,height:2*l,width:_};return this.nextRow+=f,this.dirty=!0,b}bind(t){const a=t.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const bt="maplibre_preloaded_worker_pool";class At{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<At.workerCount;)this.workers.push(new Worker(h.c.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[bt]}numActive(){return Object.keys(this.active).length}}const Vt=Math.floor(yt.hardwareConcurrency/2);let ei,Pi;function qi(){return ei||(ei=new At),ei}At.workerCount=h.K(globalThis)?Math.max(Math.min(Vt,3),1):1;class Tr{constructor(t,a){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let f=0;f<l.length;f++){const _=new h.L(l[f],a);_.name=`Worker ${f}`,this.actors.push(_)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,a){const l=[];for(const f of this.actors)l.push(f.sendAsync({type:t,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,a){for(const l of this.actors)l.registerMessageHandler(t,a)}unregisterMessageHandler(t){for(const a of this.actors)a.unregisterMessageHandler(t)}}function ao(){return Pi||(Pi=new Tr(qi(),h.M),Pi.registerMessageHandler("GR",((m,t,a)=>h.m(t,a)))),Pi}function Xr(m,t){const a=h.N();return h.O(a,a,[1,1,0]),h.Q(a,a,[.5*m.width,.5*m.height,1]),m.calculatePosMatrix?h.S(a,a,m.calculatePosMatrix(t.toUnwrapped())):a}function kl(m,t,a,l,f,_,b){var w;const A=(function(k,G,X){if(k)for(const ee of k){const ie=G[ee];if(ie&&ie.source===X&&ie.type==="fill-extrusion")return!0}else for(const ee in G){const ie=G[ee];if(ie.source===X&&ie.type==="fill-extrusion")return!0}return!1})((w=f?.layers)!==null&&w!==void 0?w:null,t,m.id),I=_.maxPitchScaleFactor(),O=m.tilesIn(l,I,A);O.sort(rn);const j=[];for(const k of O)j.push({wrappedTileID:k.tileID.wrapped().key,queryResults:k.tile.queryRenderedFeatures(t,a,m.getState(),k.queryGeometry,k.cameraQueryGeometry,k.scale,f,_,I,Xr(_,k.tileID),b?(G,X)=>b(k.tileID,G,X):void 0)});return(function(k,G){for(const X in k)for(const ee of k[X])Ir(ee,G);return k})((function(k){const G={},X={};for(const ee of k){const ie=ee.queryResults,te=ee.wrappedTileID,ae=X[te]=X[te]||{};for(const ce in ie){const re=ie[ce],ue=ae[ce]=ae[ce]||{},de=G[ce]=G[ce]||[];for(const oe of re)ue[oe.featureIndex]||(ue[oe.featureIndex]=!0,de.push(oe))}}return G})(j),m)}function rn(m,t){const a=m.tileID,l=t.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function Ir(m,t){const a=m.feature,l=t.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function pa(m,t,a){return h._(this,void 0,void 0,(function*(){let l=m;if(m.url?l=(yield h.j(t.transformRequest(m.url,"Source"),a)).data:yield yt.frameAsync(a),!l)return null;const f=h.U(h.e(l,m),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(f.vectorLayerIds=l.vector_layers.map((_=>_.id))),f}))}class hn{constructor(t,a){t&&(a?this.setSouthWest(t).setNorthEast(a):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof h.V?new h.V(t.lng,t.lat):h.V.convert(t),this}setSouthWest(t){return this._sw=t instanceof h.V?new h.V(t.lng,t.lat):h.V.convert(t),this}extend(t){const a=this._sw,l=this._ne;let f,_;if(t instanceof h.V)f=t,_=t;else{if(!(t instanceof hn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(hn.convert(t)):this.extend(h.V.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(h.V.convert(t)):this;if(f=t._sw,_=t._ne,!f||!_)return this}return a||l?(a.lng=Math.min(f.lng,a.lng),a.lat=Math.min(f.lat,a.lat),l.lng=Math.max(_.lng,l.lng),l.lat=Math.max(_.lat,l.lat)):(this._sw=new h.V(f.lng,f.lat),this._ne=new h.V(_.lng,_.lat)),this}getCenter(){return new h.V((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.V(this.getWest(),this.getNorth())}getSouthEast(){return new h.V(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:a,lat:l}=h.V.convert(t);let f=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&f}intersects(t){if(!((t=hn.convert(t)).getNorth()>=this.getSouth()&&t.getSouth()<=this.getNorth()))return!1;const a=Math.abs(this.getEast()-this.getWest()),l=Math.abs(t.getEast()-t.getWest());if(a>=360||l>=360)return!0;const f=h.W(this.getWest(),-180,180),_=h.W(this.getEast(),-180,180),b=h.W(t.getWest(),-180,180),w=h.W(t.getEast(),-180,180),A=f>=_,I=b>=w;return!(!A||!I)||(A?w>=f||b<=_:I?_>=b||f<=w:b<=_&&w>=f)}static convert(t){return t instanceof hn?t:t&&new hn(t)}static fromLngLat(t,a=0){const l=360*a/40075017,f=l/Math.cos(Math.PI/180*t.lat);return new hn(new h.V(t.lng-f,t.lat-l),new h.V(t.lng+f,t.lat+l))}adjustAntiMeridian(){const t=new h.V(this._sw.lng,this._sw.lat),a=new h.V(this._ne.lng,this._ne.lat);return new hn(t,t.lng>a.lng?new h.V(a.lng+360,a.lat):a)}}class zs{constructor(t,a,l){this.bounds=hn.convert(this.validateBounds(t)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const a=Math.pow(2,t.z),l=Math.floor(h.Y(this.bounds.getWest())*a),f=Math.floor(h.X(this.bounds.getNorth())*a),_=Math.ceil(h.Y(this.bounds.getEast())*a),b=Math.ceil(h.X(this.bounds.getSouth())*a);return t.x>=l&&t.x<_&&t.y>=f&&t.y<b}}class Ps extends h.E{constructor(t,a,l,f){if(super(),this.id=t,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.U(a,["url","scheme","tileSize","promoteId","encoding"])),this._options=h.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return h._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield pa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.tileManagers[this.id].clearTiles(),t&&(h.e(this,t),t.bounds&&(this.tileBounds=new zs(t.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,h.Z(t)||this.fire(new h.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(t){return h._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,encoding:this.encoding,overzoomParameters:this._getOverzoomParameters(t)};l.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((_,b)=>{t.reloadPromise={resolve:_,reject:b}}))}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const _=yield t.actor.sendAsync({type:f,data:l},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,_)}catch(_){if(delete t.abortController,t.aborted)return;if(_&&_.status!==404)throw _;this._afterTileLoadWorkerResponse(t,null)}}))}_getOverzoomParameters(t){if(t.tileID.canonical.z<=this.maxzoom||this.map._zoomLevelsToOverscale===void 0)return;const a=t.tileID.scaledTo(this.maxzoom).canonical,l=a.url(this.tiles,this.map.getPixelRatio(),this.scheme);return{maxZoomTileID:a,overzoomRequest:this.map._requestManager.transformRequest(l,"Tile")}}_afterTileLoadWorkerResponse(t,a){if(a&&a.resourceTiming&&(t.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&t.setExpiryData(a),t.loadVectorData(a,this.map.painter),t.reloadPromise){const l=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(l.resolve).catch(l.reject)}}abortTile(t){return h._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return h._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class so extends h.E{constructor(t,a,l,f){super(),this.id=t,this.dispatcher=l,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},a),h.e(this,h.U(a,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield pa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(h.e(this,a),a.bounds&&(this.tileBounds=new zs(a.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,h.Z(a)||this.fire(new h.k(a))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return h.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return h._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const l=yield St.getImage(this.map._requestManager.transformRequest(a,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&t.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const f=this.map.painter.context,_=f.gl,b=l.data;t.texture=this.map.painter.getTileTexture(b.width),t.texture?t.texture.update(b,{useMipmap:!0}):(t.texture=new h.T(f,b,_.RGBA,{useMipmap:!0}),t.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE,_.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(l){if(delete t.abortController,t.aborted)t.state="unloaded";else if(l)throw t.state="errored",l}}))}abortTile(t){return h._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return h._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class es extends so{constructor(t,a,l,f){super(t,a,l,f),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(t){return h._(this,void 0,void 0,(function*(){const a=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield St.getImage(l,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const _=f.data;this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const b=h.b(_)&&h.$()?_:yield this.readImageNow(_),w={type:this.type,uid:t.uid,source:this.id,rawImageData:b,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const A=yield t.actor.sendAsync({type:"LDT",data:w});t.dem=A,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}}))}readImageNow(t){return h._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&h.a0()){const a=t.width+2,l=t.height+2;try{return new h.R({width:a,height:l},yield h.a1(t,-1,-1,a,l))}catch{}}return yt.getImageData(t,1)}))}_getNeighboringTiles(t){const a=t.canonical,l=Math.pow(2,a.z),f=(a.x-1+l)%l,_=a.x===0?t.wrap-1:t.wrap,b=(a.x+1+l)%l,w=a.x+1===l?t.wrap+1:t.wrap,A={};return A[new h.a2(t.overscaledZ,_,a.z,f,a.y).key]={backfilled:!1},A[new h.a2(t.overscaledZ,w,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(A[new h.a2(t.overscaledZ,_,a.z,f,a.y-1).key]={backfilled:!1},A[new h.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},A[new h.a2(t.overscaledZ,w,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<l&&(A[new h.a2(t.overscaledZ,_,a.z,f,a.y+1).key]={backfilled:!1},A[new h.a2(t.overscaledZ,t.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},A[new h.a2(t.overscaledZ,w,a.z,b,a.y+1).key]={backfilled:!1}),A}unloadTile(t){return h._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}function La(m){return m.type==="GeometryCollection"?m.geometries.map((t=>t.coordinates)).flat(1/0):m.coordinates.flat(1/0)}function Fl(m){const t=new hn;let a;switch(m.type){case"FeatureCollection":a=m.features.map((l=>La(l.geometry))).flat(1/0);break;case"Feature":a=La(m.geometry);break;default:a=La(m)}if(a.length==0)return t;for(let l=0;l<a.length-1;l+=2)t.extend([a[l],a[l+1]]);return t}class Yn extends h.E{constructor(t,a,l,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(f),this._data=typeof a.data=="string"?{url:a.data}:{geojson:a.data},this._options=h.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:h.a5,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:h.a5,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_hasPendingWorkerUpdate(){return this._pendingWorkerUpdate.data!==void 0||this._pendingWorkerUpdate.diff!==void 0||this._pendingWorkerUpdate.optionsChanged}_pixelsToTileUnits(t){return t*(h.a5/this.tileSize)}_getClusterMaxZoom(t){const a=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||h.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${a}"`),a}load(){return h._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t,a){this._data=typeof t=="string"?{url:t}:{geojson:t},this._pendingWorkerUpdate={data:t};const l=this._updateWorkerData();return a?l:this}updateData(t,a){this._pendingWorkerUpdate.diff=h.a6(this._pendingWorkerUpdate.diff,t);const l=this._updateWorkerData();return a?l:this}getData(){return h._(this,void 0,void 0,(function*(){const t=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getBounds(){return h._(this,void 0,void 0,(function*(){return Fl(yield this.getData())}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom)),this._pendingWorkerUpdate.optionsChanged=!0,this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:a,offset:l}})}_updateWorkerData(){return h._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;if(!this._hasPendingWorkerUpdate())return void h.w(`No pending worker updates for GeoJSONSource ${this.id}.`);const{data:t,diff:a}=this._pendingWorkerUpdate,l=h.e({type:this.type},this.workerOptions);t!==void 0?(typeof t=="string"?(l.request=this.map._requestManager.transformRequest(yt.resolveURL(t),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=t,this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._pendingWorkerUpdate.optionsChanged=void 0,this._isUpdatingWorker=!0,this.fire(new h.l("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||f.abandoned)return void this.fire(new h.l("dataabort",{dataType:"source"}));f.data&&(this._data={geojson:f.data});const _=this._applyDiffToSource(a),b=this._getShouldReloadTileOptions(_);let w=null;f.resourceTiming&&f.resourceTiming[this.id]&&(w=f.resourceTiming[this.id].slice(0));const A={dataType:"source"};this._collectResourceTiming&&w&&w.length>0&&h.e(A,{resourceTiming:w}),this.fire(new h.l("data",Object.assign(Object.assign({},A),{sourceDataType:"metadata"}))),this.fire(new h.l("data",Object.assign(Object.assign({},A),{sourceDataType:"content",shouldReloadTileOptions:b})))}catch(f){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new h.l("dataabort",{dataType:"source"}));this.fire(new h.k(f))}finally{this._hasPendingWorkerUpdate()&&this._updateWorkerData()}}))}_applyDiffToSource(t){if(!t)return;const a=typeof this.promoteId=="string"?this.promoteId:void 0;if(!this._data.url&&!this._data.updateable){const f=h.a7(this._data.geojson,a);if(!f)throw new Error(`GeoJSONSource "${this.id}": GeoJSON data is not compatible with updateData`);this._data={updateable:f}}if(!this._data.updateable)return;const l=h.a8(this._data.updateable,t,a);return t.removeAll||this._options.cluster?void 0:l}_getShouldReloadTileOptions(t){if(t)return{affectedBounds:t.filter(Boolean).map((a=>Fl(a)))}}shouldReloadTile(t,{affectedBounds:a}){if(t.state==="loading")return!0;if(t.state==="unloaded")return!1;const{buffer:l,extent:f}=this.workerOptions.geojsonVtOptions,_=(function({x:b,y:w,z:A},I=0){const O=h.a3((b-I)/Math.pow(2,A)),j=h.a4((w+1+I)/Math.pow(2,A)),k=h.a3((b+1+I)/Math.pow(2,A)),G=h.a4((w-I)/Math.pow(2,A));return new hn([O,j],[k,G])})(t.tileID.canonical,l/f);for(const b of a)if(_.intersects(b))return!0;return!1}loaded(){return!this._isUpdatingWorker&&!this._hasPendingWorkerUpdate()}loadTile(t){return h._(this,void 0,void 0,(function*(){const a=t.actor?"RT":"LT";t.actor=this.actor;const l={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:a,data:l},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,a==="RT")}))}abortTile(t){return h._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return h._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data.updateable?{type:"FeatureCollection",features:Array.from(this._data.updateable.values())}:this._data.url||this._data.geojson})}hasTransition(){return!1}}class Rr extends h.E{constructor(t,a,l,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=a}load(t){return h._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield St.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,t&&(this.coordinates=t),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,h.Z(a)||this.fire(new h.k(a))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const a=t.map(h.a9.fromLngLat);var l;return this.tileID=(function(f){const _=h.aa.fromPoints(f),b=_.width(),w=_.height(),A=Math.max(b,w),I=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),O=Math.pow(2,I);return new h.ac(I,Math.floor((_.minX+_.maxX)/2*O),Math.floor((_.minY+_.maxY)/2*O))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((f=>this.tileID.getTilePoint(f)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,a=t.gl;this.texture||(this.texture=new h.T(t,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return h._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:a,minY:l,maxX:f,maxY:_}=h.aa.fromPoints(t),b={};for(let w=0;w<=h.ab;w++){const A=Math.pow(2,w),I=Math.floor(a*A),O=Math.floor(l*A),j=Math.floor(f*A),k=Math.floor(_*A),G=(I%A+A)%A,X=j%A,ee=Math.floor(I/A),ie=Math.floor(j/A);b[w]={minWrap:ee,maxWrap:ie,minTileXWrapped:G,maxTileXWrapped:X,minTileY:O,maxTileY:k}}return b}}class Se extends Rr{constructor(t,a,l,f){super(t,a,l,f),this.roundZoom=!0,this.type="video",this.options=a}load(){return h._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const a of t.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield h.ad(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new h.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const a=this.video.seekable;t<a.start(0)||t>a.end(0)?this.fire(new h.k(new h.ae(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,a=t.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new h.T(t,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const f in this.tiles){const _=this.tiles[f];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,l=!0)}l&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class $ extends Rr{constructor(t,a,l,f){super(t,a,l,f),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((_=>!Array.isArray(_)||_.length!==2||_.some((b=>typeof b!="number"))))||this.fire(new h.k(new h.ae(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.k(new h.ae(`sources.${t}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new h.k(new h.ae(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new h.k(new h.ae(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.k(new h.ae(`sources.${t}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return h._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):(this.texture=new h.T(a,this.canvas,l.RGBA,{premultiply:!0}),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const b=this.tiles[_];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture,f=!0)}f&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",animate:this.animate,canvas:this.options.canvas,coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Z={},W=m=>{switch(m){case"geojson":return Yn;case"image":return Rr;case"raster":return so;case"raster-dem":return es;case"vector":return Ps;case"video":return Se;case"canvas":return $}return Z[m]},fe="RTLPluginLoaded";class pe extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ao()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return h._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=yt.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return h._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.l(fe))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ce=null;function we(){return Ce||(Ce=new pe),Ce}var _e,De;(function(m){m[m.Base=0]="Base",m[m.Parent=1]="Parent"})(_e||(_e={})),(function(m){m[m.Departing=0]="Departing",m[m.Incoming=1]="Incoming"})(De||(De={}));class Ue{constructor(t,a){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=h.af(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:a,fadingParentID:l,fadeEndTime:f}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=a,this.fadingParentID=l,this.fadeEndTime=f}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=rt(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData,this.latestFeatureIndex.encoding=t.encoding):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData,this.latestFeatureIndex.encoding=this.latestEncoding)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(f,_){const b={};if(!_)return b;for(const w of f){const A=w.layerIds.map((I=>_.getLayer(I))).filter(Boolean);if(A.length!==0){w.layers=A,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map((I=>A.filter((O=>O.id===I))[0])));for(const I of A)b[I.id]=w}}return b})(t.buckets,a?.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof h.ah){if(this.hasSymbolBuckets=!0,!l)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof h.ah&&_.hasRTLText){this.hasRTLText=!0,we().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(f).queryRadius(_))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new h.ag}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const l in this.buckets){const f=this.buckets[l];f.uploadPending()&&f.upload(t)}const a=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new h.T(t,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new h.T(t,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,a,l,f,_,b,w,A,I,O,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:_,scale:b,tileSize:this.tileSize,pixelPosMatrix:O,transform:A,params:w,queryPadding:this.queryPadding*I,getElevation:j},t,a,l):{}}querySourceFeatures(t,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const f=l.loadVTLayers(),_=a&&a.sourceLayer?a.sourceLayer:"",b=f[h.ai]||f[_];if(!b)return;const w=h.aj(a?.filter,a?.globalState),{z:A,x:I,y:O}=this.tileID.canonical,j={z:A,x:I,y:O};for(let k=0;k<b.length;k++){const G=b.feature(k);if(w.needGeometry){const ie=h.ak(G,!0);if(!w.filter(new h.H(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!w.filter(new h.H(this.tileID.overscaledZ),G))continue;const X=l.getId(G,_),ee=new h.al(G,A,I,O,X);ee.tile=j,t.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const a=this.expirationTime;if(t.cacheControl){const l=h.am(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let f=!1;if(this.expirationTime>l)f=!1;else if(a)if(this.expirationTime<a)f=!0;else{const _=this.expirationTime-a;_?this.expirationTime=l+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!a.style.hasLayer(f))continue;const _=this.buckets[f],b=_.layers[0].sourceLayer||h.ai,w=l[b],A=t[b];if(!w||!A||Object.keys(A).length===0)continue;_.update(A,w,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const I=a&&a.style&&a.style.getLayer(f);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(_)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rt()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=rt()+t}setDependencies(t,a){const l={};for(const f of a)l[f]=!0;this.dependencies[t]=l}hasDependency(t,a){for(const l of t){const f=this.dependencies[l];if(f){for(const _ of a)if(f[_])return!0}}return!1}}class Ge{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,a,l){const f=String(a);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},h.e(this.stateChanges[t][f],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const _ in this.state[t])_!==f&&(this.deletedStates[t][_]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const _ in this.state[t][f])l[_]||(this.deletedStates[t][f][_]=null)}else for(const _ in l)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][_]===null&&delete this.deletedStates[t][f][_]}removeFeatureState(t,a,l){if(this.deletedStates[t]===null)return;const f=String(a);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&a!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][l]=null);else if(a!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(l in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][l]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,a){const l=String(a),f=h.e({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const _=this.deletedStates[t][a];if(_===null)return{};for(const b in _)delete f[b]}return f}initializeTileState(t,a){t.setFeatureState(this.state,a)}coalesceChanges(t,a){const l={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const b in this.stateChanges[f])this.state[f][b]||(this.state[f][b]={}),h.e(this.state[f][b],this.stateChanges[f][b]),_[b]=this.state[f][b];l[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(this.deletedStates[f]===null)for(const b in this.state[f])_[b]={},this.state[f][b]={};else for(const b in this.deletedStates[f]){if(this.deletedStates[f][b]===null)this.state[f][b]={};else for(const w of Object.keys(this.deletedStates[f][b]))delete this.state[f][b][w];_[b]=this.state[f][b]}l[f]=l[f]||{},h.e(l[f],_)}this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0&&t.setFeatureState(l,a)}}const ht=89.25;function vt(m,t){const a=h.an(t.lat,-h.ao,h.ao);return new h.P(h.Y(t.lng)*m,h.X(a)*m)}function Rt(m,t){return new h.a9(t.x/m,t.y/m).toLngLat()}function gi(m){return m.cameraToCenterDistance*Math.min(.85*Math.tan(h.ap(90-m.pitch)),Math.tan(h.ap(ht-m.pitch)))}function ii(m,t){const a=m.canonical,l=t/h.aq(a.z),f=a.x+Math.pow(2,a.z)*m.wrap,_=h.ar(new Float64Array(16));return h.O(_,_,[f*l,a.y*l,0]),h.Q(_,_,[l/h.a5,l/h.a5,1]),_}function Ee(m,t,a,l,f){const _=h.a9.fromLngLat(m,t),b=f*h.as(1,m.lat),{x:w,y:A,z:I}=vi(a,l);return new h.a9(_.x+b*-w,_.y+b*-A,_.z+b*-I)}function vi(m,t){const a=h.ap(m),l=h.ap(t),f=Math.cos(-a),_=Math.sin(a);return{x:_*Math.sin(l),y:-_*Math.cos(l),z:f}}function Dn(m,t,a){const l=t.intersectsFrustum(m);if(!a||l===0)return l;const f=t.intersectsPlane(a);return f===0?0:l===2&&f===2?2:1}function Bt(m,t,a){let l=0;const f=(a-t)/10;for(let _=0;_<10;_++)l+=f*Math.pow(Math.cos(t+(_+.5)/10*(a-t)),m);return l}function bi(m,t){return function(a,l,f,_,b){const w=2*((m-1)/h.at(Math.cos(h.ap(ht-b))/Math.cos(h.ap(ht)))-1),A=Math.acos(f/_),I=2*Bt(w-1,0,h.ap(b/2)),O=Math.min(h.ap(ht),A+h.ap(b/2)),j=Bt(w-1,Math.min(O,A-h.ap(b/2)),O),k=Math.atan(l/f),G=Math.hypot(l,f);let X=a;return X+=h.at(_/G/Math.max(.5,Math.cos(h.ap(b/2)))),X+=w*h.at(Math.cos(k))/2,X-=h.at(Math.max(1,j/I/t))/2,X}}const Gn=bi(9.314,3);function Ei(m,t){const a=(t.roundZoom?Math.round:Math.floor)(m.zoom+h.at(m.tileSize/t.tileSize));return Math.max(0,a)}function fn(m,t){const a=m.getCameraFrustum(),l=m.getClippingPlane(),f=m.screenPointToMercatorCoordinate(m.getCameraPoint()),_=h.a9.fromLngLat(m.center,m.elevation);f.z=_.z+Math.cos(m.pitchInRadians)*m.cameraToCenterDistance/m.worldSize;const b=m.getCoveringTilesDetailsProvider(),w=b.allowVariableZoom(m,t),A=Ei(m,t),I=t.minzoom||0,O=t.maxzoom!==void 0?t.maxzoom:m.maxZoom,j=Math.min(Math.max(0,A),O),k=Math.pow(2,j),G=[k*f.x,k*f.y,0],X=[k*_.x,k*_.y,0],ee=Math.hypot(_.x-f.x,_.y-f.y),ie=Math.abs(_.z-f.z),te=Math.hypot(ee,ie),ae=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),ce=[],re=[];if(m.renderWorldCopies&&b.allowWorldCopies())for(let ue=1;ue<=3;ue++)ce.push(ae(-ue)),ce.push(ae(ue));for(ce.push(ae(0));ce.length>0;){const ue=ce.pop(),de=ue.x,oe=ue.y;let ye=ue.fullyVisible;const Ie={x:de,y:oe,z:ue.zoom},Me=b.getTileBoundingVolume(Ie,ue.wrap,m.elevation,t);if(!ye){const it=Dn(a,Me,l);if(it===0)continue;ye=it===2}const ze=b.distanceToTile2d(f.x,f.y,Ie,Me);let Pe=A;w&&(Pe=(t.calculateTileZoom||Gn)(m.zoom+h.at(m.tileSize/t.tileSize),ze,ie,te,m.fov)),Pe=(t.roundZoom?Math.round:Math.floor)(Pe),Pe=Math.max(0,Pe);const tt=Math.min(Pe,O);if(ue.wrap=b.getWrap(_,Ie,ue.wrap),ue.zoom>=tt){if(ue.zoom<I)continue;const it=j-ue.zoom,He=G[0]-.5-(de<<it),at=G[1]-.5-(oe<<it),Lt=t.reparseOverscaled?Math.max(ue.zoom,Pe):ue.zoom;re.push({tileID:new h.a2(ue.zoom===O?Lt:ue.zoom,ue.wrap,ue.zoom,de,oe),distanceSq:h.au([X[0]-.5-de,X[1]-.5-oe]),tileDistanceToCamera:Math.sqrt(He*He+at*at)})}else for(let it=0;it<4;it++)ce.push({zoom:ue.zoom+1,x:(de<<1)+it%2,y:(oe<<1)+(it>>1),wrap:ue.wrap,fullyVisible:ye})}return re.sort(((ue,de)=>ue.distanceSq-de.distanceSq)).map((ue=>ue.tileID))}const Ii=h.aa.fromPoints([new h.P(0,0),new h.P(h.a5,h.a5)]);function zn(m){return m==="raster"||m==="image"||m==="video"}function jl(m,t,a,l,f,_,b){if(!t.hasData())return!1;const{tileID:w,fadingRole:A,fadingDirection:I,fadingParentID:O}=t;if(A===_e.Base&&I===De.Incoming&&O)return a[O.key]=O,!0;const j=Math.max(w.overscaledZ-f,_);for(let k=w.overscaledZ-1;k>=j;k--){const G=w.scaledTo(k),X=m.getLoadedTile(G);if(X)return t.setCrossFadeLogic({fadingRole:_e.Base,fadingDirection:De.Incoming,fadingParentID:X.tileID,fadeEndTime:l+b}),X.setCrossFadeLogic({fadingRole:_e.Parent,fadingDirection:De.Departing,fadeEndTime:l+b}),a[G.key]=G,!0}return!1}function Uo(m,t,a,l,f,_){if(!t.hasData())return!1;const b=t.tileID.children(f);let w=et(m,t,b,a,l,f,_);if(w)return!0;for(const A of b)et(m,t,A.children(f),a,l,f,_)&&(w=!0);return w}function et(m,t,a,l,f,_,b){if(a[0].overscaledZ>=_)return!1;let w=!1;for(const A of a){const I=m.getLoadedTile(A);if(!I)continue;const{fadingRole:O,fadingDirection:j,fadingParentID:k}=I;O===_e.Base&&j===De.Departing&&k||(I.setCrossFadeLogic({fadingRole:_e.Base,fadingDirection:De.Departing,fadingParentID:t.tileID,fadeEndTime:f+b}),t.setCrossFadeLogic({fadingRole:_e.Parent,fadingDirection:De.Incoming,fadeEndTime:f+b})),l[A.key]=A,w=!0}return w}function dr(m,t,a,l){const f=m.tileID;return!!m.selfFading||!m.hasData()&&!!t.has(f)&&(m.setSelfFadeLogic(a+l),!0)}function pr(m,t){var a;m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let l=t.tileID.canonical.x-m.tileID.canonical.x;const f=t.tileID.canonical.y-m.tileID.canonical.y,_=Math.pow(2,m.tileID.canonical.z),b=t.tileID.key;l===0&&f===0||Math.abs(f)>1||(Math.abs(l)>1&&(Math.abs(l+_)===1?l+=_:Math.abs(l-_)===1&&(l-=_)),t.dem&&m.dem&&(m.dem.backfillBorder(t.dem,l,f),!((a=m.neighboringTiles)===null||a===void 0)&&a[b]&&(m.neighboringTiles[b].backfilled=!0)))}class Ba{constructor(){this._tiles={}}handleWrapJump(t){const a={};for(const l in this._tiles){const f=this._tiles[l];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+t),a[f.tileID.key]=f}this._tiles=a}setFeatureState(t,a){for(const l in this._tiles)this._tiles[l].setFeatureState(t,a)}getAllTiles(){return Object.values(this._tiles)}getAllIds(t=!1){return t?Object.values(this._tiles).map((a=>a.tileID)).sort(h.aw).map((a=>a.key)):Object.keys(this._tiles)}getTileById(t){return this._tiles[t]}setTile(t,a){this._tiles[t]=a}deleteTileById(t){delete this._tiles[t]}getLoadedTile(t){const a=this.getTileById(t.key);return a?.hasData()?a:null}isIdRenderable(t,a=!1){var l;return(l=this.getTileById(t))===null||l===void 0?void 0:l.isRenderable(a)}getRenderableIds(t=0,a){const l=[];for(const f of this.getAllIds())this.isIdRenderable(f,a)&&l.push(this.getTileById(f));return a?l.sort(((f,_)=>{const b=f.tileID,w=_.tileID,A=new h.P(b.canonical.x,b.canonical.y)._rotate(-t),I=new h.P(w.canonical.x,w.canonical.y)._rotate(-t);return b.overscaledZ-w.overscaledZ||I.y-A.y||I.x-A.x})).map((f=>f.tileID.key)):l.map((f=>f.tileID)).sort(h.aw).map((f=>f.key))}}class Vi extends h.E{constructor(t,a,l){super(),this.id=t,this.dispatcher=l,this.on("data",(f=>this._dataHandler(f))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((f,_,b,w)=>{const A=new(W(_.type))(f,_,b,w);if(A.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${A.id}`);return A})(t,a,l,this),this._inViewTiles=new Ba,this._outOfViewCache=new h.ax(0,(f=>this._unloadTile(f))),this._timers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new Ge,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){for(const a of this._inViewTiles.getAllTiles())a.unloadVectorData();this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t),this._inViewTiles=new Ba}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}getSource(){return this._source}getState(){return this._state}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,a,l){return h._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,a,l)}catch(f){t.state="errored",f.status!==404?this._source.fire(new h.k(f,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new h.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._inViewTiles,this.map?this.map.painter:null);for(const a of this._inViewTiles.getAllTiles())a.upload(t),a.prepare(this.map.style.imageManager)}getIds(){return this._inViewTiles.getAllIds(!0)}getRenderableIds(t){var a;return this._inViewTiles.getRenderableIds((a=this.transform)===null||a===void 0?void 0:a.bearingInRadians,t)}hasRenderableParent(t){const a=t.overscaledZ-1;if(a>=this._source.minzoom){const l=this.getLoadedTile(t.scaledTo(a));if(l)return this._inViewTiles.isIdRenderable(l.tileID.key)}return!1}reload(t,a=void 0){if(this._paused)this._shouldReloadOnResume=!0;else{this._outOfViewCache.reset();for(const l of this._inViewTiles.getAllIds()){const f=this._inViewTiles.getTileById(l);a&&!this._source.shouldReloadTile(f,a)||(t?this._reloadTile(l,"expired"):f.state!=="errored"&&this._reloadTile(l,"reloading"))}}}_reloadTile(t,a){return h._(this,void 0,void 0,(function*(){const l=this._inViewTiles.getTileById(t);l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,t,a))}))}_tileLoaded(t,a,l){t.timeAdded=rt(),t.selfFading&&(t.fadeEndTime=t.timeAdded+this._rasterFadeDuration),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(a,t),this.getSource().type==="raster-dem"&&t.dem&&(function(f,_){var b,w;const A=_.getRenderableIds();for(const I of A){if(!f.neighboringTiles||!f.neighboringTiles[I])continue;const O=_.getTileById(I);f.neighboringTiles[I].backfilled||pr(f,O),!((w=(b=O.neighboringTiles)===null||b===void 0?void 0:b[f.tileID.key])===null||w===void 0)&&w.backfilled||pr(O,f)}})(t,this._inViewTiles),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new h.l("data",{dataType:"source",tile:t,coord:t.tileID}))}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._inViewTiles.getTileById(t)}_retainLoadedChildren(t,a){const l=this._getLoadedDescendents(a),f=new Set;for(const _ of a){const b=l[_.key];if(!b?.length){f.add(_);continue}const w=_.overscaledZ+Vi.maxOverzooming,A=b.filter((j=>j.tileID.overscaledZ<=w));if(!A.length){f.add(_);continue}const I=Math.min(...A.map((j=>j.tileID.overscaledZ))),O=A.filter((j=>j.tileID.overscaledZ===I)).map((j=>j.tileID));for(const j of O)t[j.key]=j;this._areDescendentsComplete(O,I,_.overscaledZ)||f.add(_)}return f}_getLoadedDescendents(t){var a;const l={};for(const f of this._inViewTiles.getAllTiles().filter((_=>_.hasData())))for(const _ of t)f.tileID.isChildOf(_)&&(l[a=_.key]||(l[a]=[])).push(f);return l}_areDescendentsComplete(t,a,l){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===a:Math.pow(4,a-l)===t.length}getLoadedTile(t){return this._inViewTiles.getLoadedTile(t)}updateCacheSize(t){const a=Math.ceil(t.width/this._source.tileSize)+1,l=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?h.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),_=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._outOfViewCache.setMaxSize(_)}handleWrapJump(t){const a=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);this._prevLng=t,a&&(this._inViewTiles.handleWrapJump(a),this._resetTileReloadTimers())}update(t,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=t,this.terrain=a,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?l=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((A=>new h.a2(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y))):(l=fn(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.type==="vector"&&this.map._zoomLevelsToOverscale!==void 0?t.maxZoom-this.map._zoomLevelsToOverscale:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((A=>this._source.hasTile(A))))):l=[],this.usedForTerrain&&(l=this._addTerrainIdealTiles(l));const f=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,f&&this.fire(new h.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const _=Ei(t,this._source),b=this._updateRetainedTiles(l,_),w=zn(this._source.type);w&&this._rasterFadeDuration>0&&!a&&(function(A,I,O,j,k,G,X){const ee=rt(),ie=h.av(I);for(const te of I){const ae=A.getTileById(te.key);ae.fadingDirection!==De.Departing&&ae.fadeOpacity!==0||ae.resetFadeLogic(),jl(A,ae,O,ee,j,k,X)||Uo(A,ae,O,ee,G,X)||dr(ae,ie,ee,X)||ae.resetFadeLogic()}})(this._inViewTiles,l,b,this._maxFadingAncestorLevels,this._source.minzoom,this._source.maxzoom,this._rasterFadeDuration),w?this._cleanUpRasterTiles(b):this._cleanUpVectorTiles(b)}_cleanUpRasterTiles(t){for(const a of this._inViewTiles.getAllIds())t[a]||this._removeTile(a)}_cleanUpVectorTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);t[a]?l.clearSymbolFadeHold():l.hasSymbolBuckets?l.holdingForSymbolFade()?l.symbolFadeFinished()&&this._removeTile(a):l.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(a)}}_addTerrainIdealTiles(t){const a=[];for(const l of t)if(l.canonical.z>this._source.minzoom){const f=l.scaledTo(l.canonical.z-1);a.push(f);const _=l.scaledTo(Math.max(this._source.minzoom,Math.min(l.canonical.z,5)));a.push(_)}return t.concat(a)}releaseSymbolFadeTiles(){for(const t of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(t).holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,a){var l;const f=new Set;for(const I of t)this._addTile(I).hasData()||f.add(I);const _=t.reduce(((I,O)=>(I[O.key]=O,I)),{}),b=this._retainLoadedChildren(_,f),w={},A=Math.max(a-Vi.maxUnderzooming,this._source.minzoom);for(const I of b){let O=this._inViewTiles.getTileById(I.key),j=O?.wasRequested();for(let k=I.overscaledZ-1;k>=A;--k){const G=I.scaledTo(k);if(w[G.key])break;if(w[G.key]=!0,O=this.getTile(G),!O&&j&&(O=this._addTile(G)),O){const X=O.hasData();if((X||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||j)&&(_[G.key]=G),j=O.wasRequested(),X)break}}}return _}_addTile(t){let a=this._inViewTiles.getTileById(t.key);if(a)return a;a=this._outOfViewCache.getAndRemove(t),a&&(a.resetFadeLogic(),this._setTileReloadTimer(t.key,a),a.tileID=t,this._state.initializeTileState(a,this.map?this.map.painter:null));const l=a;return a||(a=new Ue(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(a,t.key,a.state)),a.uses++,this._inViewTiles.setTile(t.key,a),l||this._source.fire(new h.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(t,a){this._clearTileReloadTimer(t);const l=a.getExpiryTimeout();l&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),l))}_clearTileReloadTimer(t){const a=this._timers[t];a&&(clearTimeout(a),delete this._timers[t])}_resetTileReloadTimers(){for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t of this._inViewTiles.getAllIds()){const a=this._inViewTiles.getTileById(t);this._setTileReloadTimer(t,a)}}refreshTiles(t){for(const a of this._inViewTiles.getAllIds()){const l=this._inViewTiles.getTileById(a);(this._inViewTiles.isIdRenderable(a)||l.state=="errored")&&t.some((f=>f.equals(l.tileID.canonical)))&&this._reloadTile(a,"expired")}}_removeTile(t){const a=this._inViewTiles.getTileById(t);a&&(a.uses--,this._inViewTiles.deleteTileById(t),this._clearTileReloadTimer(t),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._outOfViewCache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged,t.shouldReloadTileOptions),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t of this._inViewTiles.getAllIds())this._removeTile(t);this._outOfViewCache.reset()}tilesIn(t,a,l){const f=[],_=this.transform;if(!_)return f;const b=_.getCoveringTilesDetailsProvider().allowWorldCopies(),w=l?_.getCameraQueryGeometry(t):t,A=G=>_.screenPointToMercatorCoordinate(G,this.terrain),I=this.transformBbox(t,A,!b),O=this.transformBbox(w,A,!b),j=this.getIds(),k=h.aa.fromPoints(O);for(let G=0;G<j.length;G++){const X=this._inViewTiles.getTileById(j[G]);if(X.holdingForSymbolFade())continue;const ee=b?[X.tileID]:[X.tileID.unwrapTo(-1),X.tileID.unwrapTo(0)],ie=Math.pow(2,_.zoom-X.tileID.overscaledZ),te=a*X.queryPadding*h.a5/X.tileSize/ie;for(const ae of ee){const ce=k.map((re=>ae.getTilePoint(new h.a9(re.x,re.y))));if(ce.expandBy(te),ce.intersects(Ii)){const re=I.map((de=>ae.getTilePoint(de))),ue=O.map((de=>ae.getTilePoint(de)));f.push({tile:X,tileID:b?ae:ae.unwrapTo(0),queryGeometry:re,cameraQueryGeometry:ue,scale:ie})}}}return f}transformBbox(t,a,l){let f=t.map(a);if(l){const _=h.aa.fromPoints(t);_.shrinkBy(.001*Math.min(_.width(),_.height()));const b=_.map(a);h.aa.fromPoints(f).covers(b)||(f=f.map((w=>w.x>.5?new h.a9(w.x-1,w.y,w.z):w)))}return f}getVisibleCoordinates(t){const a=this.getRenderableIds(t).map((l=>this._inViewTiles.getTileById(l).tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){return!!this._source.hasTransition()||!(!zn(this._source.type)||!(function(t,a){if(a<=0)return!1;const l=rt();for(const f of t.getAllTiles())if(f.fadeEndTime>=l)return!0;return!1})(this._inViewTiles,this._rasterFadeDuration))}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,a,l){this._state.updateState(t=t||h.ai,a,l)}removeFeatureState(t,a,l){this._state.removeFeatureState(t=t||h.ai,a,l)}getFeatureState(t,a){return this._state.getState(t=t||h.ai,a)}setDependencies(t,a,l){const f=this._inViewTiles.getTileById(t);f&&f.setDependencies(a,l)}reloadTilesForDependencies(t,a){for(const l of this._inViewTiles.getAllIds())this._inViewTiles.getTileById(l).hasDependency(t,a)&&this._reloadTile(l,"reloading");this._outOfViewCache.filter((l=>!l.hasDependency(t,a)))}areTilesLoaded(){for(const t of this._inViewTiles.getAllTiles())if(t.state!=="loaded"&&t.state!=="errored")return!1;return!0}}Vi.maxUnderzooming=10,Vi.maxOverzooming=3;class nt{constructor(t,a){this.reset(t,a)}reset(t,a){this.points=t||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=h.an(t,0,1);let a=1,l=this._distances[a];const f=t*this.paddedLength+this.padding;for(;l<f&&a<this._distances.length;)l=this._distances[++a];const _=a-1,b=this._distances[_],w=l-b,A=w>0?(f-b)/w:0;return this.points[_].mult(1-A).add(this.points[a].mult(A))}}function Ft(m,t){let a=!0;return m==="always"||m!=="never"&&t!=="never"||(a=!1),a}class qt{constructor(t,a,l){const f=this.boxCells=[],_=this.circleCells=[];this.xCellCount=Math.ceil(t/l),this.yCellCount=Math.ceil(a/l);for(let b=0;b<this.xCellCount*this.yCellCount;b++)f.push([]),_.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=a,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,a,l,f,_){this._forEachCell(a,l,f,_,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(_)}insertCircle(t,a,l,f){this._forEachCell(a-f,l-f,a+f,l+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(a),this.circles.push(l),this.circles.push(f)}_insertBoxCell(t,a,l,f,_,b){this.boxCells[_].push(b)}_insertCircleCell(t,a,l,f,_,b){this.circleCells[_].push(b)}_query(t,a,l,f,_,b,w){if(l<0||t>this.width||f<0||a>this.height)return[];const A=[];if(t<=0&&a<=0&&this.width<=l&&this.height<=f){if(_)return[{key:null,x1:t,y1:a,x2:l,y2:f}];for(let I=0;I<this.boxKeys.length;I++)A.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const O=this.circles[3*I],j=this.circles[3*I+1],k=this.circles[3*I+2];A.push({key:this.circleKeys[I],x1:O-k,y1:j-k,x2:O+k,y2:j+k})}}else this._forEachCell(t,a,l,f,this._queryCell,A,{hitTest:_,overlapMode:b,seenUids:{box:{},circle:{}}},w);return A}query(t,a,l,f){return this._query(t,a,l,f,!1,null)}hitTest(t,a,l,f,_,b){return this._query(t,a,l,f,!0,_,b).length>0}hitTestCircle(t,a,l,f,_){const b=t-l,w=t+l,A=a-l,I=a+l;if(w<0||b>this.width||I<0||A>this.height)return!1;const O=[];return this._forEachCell(b,A,w,I,this._queryCellCircle,O,{hitTest:!0,overlapMode:f,circle:{x:t,y:a,radius:l},seenUids:{box:{},circle:{}}},_),O.length>0}_queryCell(t,a,l,f,_,b,w,A){const{seenUids:I,hitTest:O,overlapMode:j}=w,k=this.boxCells[_];if(k!==null){const X=this.bboxes;for(const ee of k)if(!I.box[ee]){I.box[ee]=!0;const ie=4*ee,te=this.boxKeys[ee];if(t<=X[ie+2]&&a<=X[ie+3]&&l>=X[ie+0]&&f>=X[ie+1]&&(!A||A(te))&&(!O||!Ft(j,te.overlapMode))&&(b.push({key:te,x1:X[ie],y1:X[ie+1],x2:X[ie+2],y2:X[ie+3]}),O))return!0}}const G=this.circleCells[_];if(G!==null){const X=this.circles;for(const ee of G)if(!I.circle[ee]){I.circle[ee]=!0;const ie=3*ee,te=this.circleKeys[ee];if(this._circleAndRectCollide(X[ie],X[ie+1],X[ie+2],t,a,l,f)&&(!A||A(te))&&(!O||!Ft(j,te.overlapMode))){const ae=X[ie],ce=X[ie+1],re=X[ie+2];if(b.push({key:te,x1:ae-re,y1:ce-re,x2:ae+re,y2:ce+re}),O)return!0}}}return!1}_queryCellCircle(t,a,l,f,_,b,w,A){const{circle:I,seenUids:O,overlapMode:j}=w,k=this.boxCells[_];if(k!==null){const X=this.bboxes;for(const ee of k)if(!O.box[ee]){O.box[ee]=!0;const ie=4*ee,te=this.boxKeys[ee];if(this._circleAndRectCollide(I.x,I.y,I.radius,X[ie+0],X[ie+1],X[ie+2],X[ie+3])&&(!A||A(te))&&!Ft(j,te.overlapMode))return b.push(!0),!0}}const G=this.circleCells[_];if(G!==null){const X=this.circles;for(const ee of G)if(!O.circle[ee]){O.circle[ee]=!0;const ie=3*ee,te=this.circleKeys[ee];if(this._circlesCollide(X[ie],X[ie+1],X[ie+2],I.x,I.y,I.radius)&&(!A||A(te))&&!Ft(j,te.overlapMode))return b.push(!0),!0}}}_forEachCell(t,a,l,f,_,b,w,A){const I=this._convertToXCellCoord(t),O=this._convertToYCellCoord(a),j=this._convertToXCellCoord(l),k=this._convertToYCellCoord(f);for(let G=I;G<=j;G++)for(let X=O;X<=k;X++)if(_.call(this,t,a,l,f,this.xCellCount*X+G,b,w,A))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,a,l,f,_,b){const w=f-t,A=_-a,I=l+b;return I*I>w*w+A*A}_circleAndRectCollide(t,a,l,f,_,b,w){const A=(b-f)/2,I=Math.abs(t-(f+A));if(I>A+l)return!1;const O=(w-_)/2,j=Math.abs(a-(_+O));if(j>O+l)return!1;if(I<=A||j<=O)return!0;const k=I-A,G=j-O;return k*k+G*G<=l*l}}function Yr(m,t,a){const l=h.N();if(!m){const{vecSouth:j,vecEast:k}=ts(t),G=ge();G[0]=k[0],G[1]=k[1],G[2]=j[0],G[3]=j[1],f=G,(O=(b=(_=G)[0])*(I=_[3])-(A=_[2])*(w=_[1]))&&(f[0]=I*(O=1/O),f[1]=-w*O,f[2]=-A*O,f[3]=b*O),l[0]=G[0],l[1]=G[1],l[4]=G[2],l[5]=G[3]}var f,_,b,w,A,I,O;return h.Q(l,l,[1/a,1/a,1]),l}function kc(m,t,a,l){if(m){const f=h.N();if(!t){const{vecSouth:_,vecEast:b}=ts(a);f[0]=b[0],f[1]=b[1],f[4]=_[0],f[5]=_[1]}return h.Q(f,f,[l,l,1]),f}return a.pixelsToClipSpaceMatrix}function ts(m){const t=Math.cos(m.rollInRadians),a=Math.sin(m.rollInRadians),l=Math.cos(m.pitchInRadians),f=Math.cos(m.bearingInRadians),_=Math.sin(m.bearingInRadians),b=h.aC();b[0]=-f*l*a-_*t,b[1]=-_*l*a+f*t;const w=h.aD(b);w<1e-9?h.aE(b):h.aF(b,b,1/w);const A=h.aC();A[0]=f*l*t-_*a,A[1]=_*l*t+f*a;const I=h.aD(A);return I<1e-9?h.aE(A):h.aF(A,A,1/I),{vecEast:A,vecSouth:b}}function kt(m,t,a,l){let f;l?(f=[m,t,l(m,t),1],h.aH(f,f,a)):(f=[m,t,0,1],ma(f,f,a));const _=f[3];return{point:new h.P(f[0]/_,f[1]/_),signedDistanceFromCamera:_,isOccluded:!1}}function Go(m,t){return .5+m/t*.5}function is(m,t){return m.x>=-t[0]&&m.x<=t[0]&&m.y>=-t[1]&&m.y<=t[1]}function Is(m,t,a,l,f,_,b,w,A,I,O,j,k){const G=a?m.textSizeData:m.iconSizeData,X=h.ay(G,t.transform.zoom),ee=[256/t.width*2+1,256/t.height*2+1],ie=a?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ie.clear();const te=m.lineVertexArray,ae=a?m.text.placedSymbolArray:m.icon.placedSymbolArray,ce=t.transform.width/t.transform.height;let re=!1;for(let ue=0;ue<ae.length;ue++){const de=ae.get(ue);if(de.hidden||de.writingMode===h.az.vertical&&!re){as(de.numGlyphs,ie);continue}re=!1;const oe=new h.P(de.anchorX,de.anchorY),ye={getElevation:k,pitchedLabelPlaneMatrix:l,lineVertexArray:te,pitchWithMap:_,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:oe,unwrappedTileID:A,width:I,height:O,translation:j},Ie=Vl(de.anchorX,de.anchorY,ye);if(!is(Ie.point,ee)){as(de.numGlyphs,ie);continue}const Me=Go(t.transform.cameraToCenterDistance,Ie.signedDistanceFromCamera),ze=h.aA(G,X,de),Pe=_?ze*t.transform.getPitchedTextCorrection(de.anchorX,de.anchorY,A)/Me:ze*Me,tt=dn({projectionContext:ye,pitchedLabelPlaneMatrixInverse:f,symbol:de,fontSize:Pe,flip:!1,keepUpright:b,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:ce,rotateToLine:w});re=tt.useVertical,(tt.notEnoughRoom||re||tt.needsFlipping&&dn({projectionContext:ye,pitchedLabelPlaneMatrixInverse:f,symbol:de,fontSize:Pe,flip:!0,keepUpright:b,glyphOffsetArray:m.glyphOffsetArray,dynamicLayoutVertexArray:ie,aspectRatio:ce,rotateToLine:w}).notEnoughRoom)&&as(de.numGlyphs,ie)}a?m.text.dynamicLayoutVertexBuffer.updateData(ie):m.icon.dynamicLayoutVertexBuffer.updateData(ie)}function ns(m,t,a,l,f,_,b,w){const A=_.glyphStartIndex+_.numGlyphs,I=_.lineStartIndex,O=_.lineStartIndex+_.lineLength,j=t.getoffsetX(_.glyphStartIndex),k=t.getoffsetX(A-1),G=ka(m*j,a,l,f,_.segment,I,O,w,b);if(!G)return null;const X=ka(m*k,a,l,f,_.segment,I,O,w,b);return X?w.projectionCache.anyProjectionOccluded?null:{first:G,last:X}:null}function rs(m,t,a,l){return m===h.az.horizontal&&Math.abs(a.y-t.y)>Math.abs(a.x-t.x)*l?{useVertical:!0}:(m===h.az.vertical?t.y<a.y:t.x>a.x)?{needsFlipping:!0}:null}function dn(m){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:f,flip:_,keepUpright:b,glyphOffsetArray:w,dynamicLayoutVertexArray:A,aspectRatio:I,rotateToLine:O}=m,j=f/24,k=l.lineOffsetX*j,G=l.lineOffsetY*j;let X;if(l.numGlyphs>1){const ee=l.glyphStartIndex+l.numGlyphs,ie=l.lineStartIndex,te=l.lineStartIndex+l.lineLength,ae=ns(j,w,k,G,_,l,O,t);if(!ae)return{notEnoughRoom:!0};const ce=Rs(ae.first.point.x,ae.first.point.y,t,a),re=Rs(ae.last.point.x,ae.last.point.y,t,a);if(b&&!_){const ue=rs(l.writingMode,ce,re,I);if(ue)return ue}X=[ae.first];for(let ue=l.glyphStartIndex+1;ue<ee-1;ue++){const de=ka(j*w.getoffsetX(ue),k,G,_,l.segment,ie,te,t,O);if(!de)return{notEnoughRoom:!0};X.push(de)}X.push(ae.last)}else{if(b&&!_){const ie=ni(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,te=l.lineStartIndex+l.segment+1,ae=new h.P(t.lineVertexArray.getx(te),t.lineVertexArray.gety(te)),ce=ni(ae.x,ae.y,t),re=ce.signedDistanceFromCamera>0?ce.point:Nl(t.tileAnchorPoint,ae,ie,1,t),ue=Rs(ie.x,ie.y,t,a),de=Rs(re.x,re.y,t,a),oe=rs(l.writingMode,ue,de,I);if(oe)return oe}const ee=ka(j*w.getoffsetX(l.glyphStartIndex),k,G,_,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,t,O);if(!ee||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};X=[ee]}for(const ee of X)h.aG(A,ee.point,ee.angle);return{}}function Nl(m,t,a,l,f){const _=m.add(m.sub(t)._unit()),b=ni(_.x,_.y,f).point,w=a.sub(b);return a.add(w._mult(l/w.mag()))}function mr(m,t,a){const l=t.projectionCache;if(l.projections[m])return l.projections[m];const f=new h.P(t.lineVertexArray.getx(m),t.lineVertexArray.gety(m)),_=ni(f.x,f.y,t);if(_.signedDistanceFromCamera>0)return l.projections[m]=_.point,l.anyProjectionOccluded=l.anyProjectionOccluded||_.isOccluded,_.point;const b=m-a.direction;return Nl(a.distanceFromAnchor===0?t.tileAnchorPoint:new h.P(t.lineVertexArray.getx(b),t.lineVertexArray.gety(b)),f,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,t)}function ni(m,t,a){const l=m+a.translation[0],f=t+a.translation[1];let _;return a.pitchWithMap?(_=kt(l,f,a.pitchedLabelPlaneMatrix,a.getElevation),_.isOccluded=!1):(_=a.transform.projectTileCoordinates(l,f,a.unwrappedTileID,a.getElevation),_.point.x=(.5*_.point.x+.5)*a.width,_.point.y=(.5*-_.point.y+.5)*a.height),_}function Rs(m,t,a,l){if(a.pitchWithMap){const f=[m,t,0,1];return h.aH(f,f,l),a.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],a.unwrappedTileID,a.getElevation).point}return{x:m/a.width*2-1,y:1-t/a.height*2}}function Vl(m,t,a){return a.transform.projectTileCoordinates(m,t,a.unwrappedTileID,a.getElevation)}function Ul(m,t,a){return m._unit()._perp()._mult(t*a)}function oo(m,t,a,l,f,_,b,w,A){if(w.projectionCache.offsets[m])return w.projectionCache.offsets[m];const I=a.add(t);if(m+A.direction<l||m+A.direction>=f)return w.projectionCache.offsets[m]=I,I;const O=mr(m+A.direction,w,A),j=Ul(O.sub(a),b,A.direction),k=a.add(j),G=O.add(j);return w.projectionCache.offsets[m]=h.aI(_,I,k,G)||I,w.projectionCache.offsets[m]}function ka(m,t,a,l,f,_,b,w,A){const I=l?m-t:m+t;let O=I>0?1:-1,j=0;l&&(O*=-1,j=Math.PI),O<0&&(j+=Math.PI);let k,G=O>0?_+f:_+f+1;w.projectionCache.cachedAnchorPoint?k=w.projectionCache.cachedAnchorPoint:(k=ni(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=k);let X,ee,ie=k,te=k,ae=0,ce=0;const re=Math.abs(I),ue=[];let de;for(;ae+ce<=re;){if(G+=O,G<_||G>=b)return null;ae+=ce,te=ie,ee=X;const Ie={absOffsetX:re,direction:O,distanceFromAnchor:ae,previousVertex:te};if(ie=mr(G,w,Ie),a===0)ue.push(te),de=ie.sub(te);else{let Me;const ze=ie.sub(te);Me=ze.mag()===0?Ul(mr(G+O,w,Ie).sub(ie),a,O):Ul(ze,a,O),ee||(ee=te.add(Me)),X=oo(G,Me,ie,_,b,ee,a,w,Ie),ue.push(ee),de=X.sub(ee)}ce=de.mag()}const oe=de._mult((re-ae)/ce)._add(ee||te),ye=j+Math.atan2(ie.y-te.y,ie.x-te.x);return ue.push(oe),{point:oe,angle:A?ye:0,path:ue}}const Ru=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function as(m,t){for(let a=0;a<m;a++){const l=t.length;t.resize(l+4),t.float32.set(Ru,3*l)}}function ma(m,t,a){const l=t[0],f=t[1];return m[0]=a[0]*l+a[4]*f+a[12],m[1]=a[1]*l+a[5]*f+a[13],m[3]=a[3]*l+a[7]*f+a[15],m}const ui=100;class Nh{constructor(t,a=new qt(t.width+200,t.height+200,25),l=new qt(t.width+200,t.height+200,25)){this.transform=t,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ui,this.screenBottomBoundary=t.height+ui,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,a,l,f,_,b,w,A,I,O,j,k){const G=this.projectAndGetPerspectiveRatio(t.anchorPointX+A[0],t.anchorPointY+A[1],_,O,k),X=l*G.perspectiveRatio;let ee;if(b||w)ee=this._projectCollisionBox(t,X,f,_,b,w,A,G,O,j,k);else{const de=G.x+(j?j.x*X:0),oe=G.y+(j?j.y*X:0);ee={allPointsOccluded:!1,box:[de+t.x1*X,oe+t.y1*X,de+t.x2*X,oe+t.y2*X]}}const[ie,te,ae,ce]=ee.box,re=b?ee.allPointsOccluded:G.isOccluded;let ue=re;return ue||(ue=G.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(ie,te,ae,ce)),ue||a!=="always"&&this.grid.hitTest(ie,te,ae,ce,a,I)?{box:[ie,te,ae,ce],placeable:!1,offscreen:!1,occluded:re}:{box:[ie,te,ae,ce],placeable:!0,offscreen:this.isOffscreen(ie,te,ae,ce),occluded:re}}placeCollisionCircles(t,a,l,f,_,b,w,A,I,O,j,k,G,X){const ee=[],ie=new h.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(ie.x,ie.y,b,X),ae=(I?_*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,b)/te:_*te)/h.aM,ce={getElevation:X,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:I,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ie,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:G},re=ns(ae,f,a.lineOffsetX*ae,a.lineOffsetY*ae,!1,a,!1,ce);let ue=!1,de=!1,oe=!0;if(re){const ye=.5*j*te+k,Ie=new h.P(-100,-100),Me=new h.P(this.screenRightBoundary,this.screenBottomBoundary),ze=new nt,Pe=re.first,tt=re.last;let it=[];for(let Lt=Pe.path.length-1;Lt>=1;Lt--)it.push(Pe.path[Lt]);for(let Lt=1;Lt<tt.path.length;Lt++)it.push(tt.path[Lt]);const He=2.5*ye;if(I){const Lt=this.projectPathToScreenSpace(it,ce);it=Lt.some((yi=>yi.signedDistanceFromCamera<=0))?[]:Lt.map((yi=>yi.point))}let at=[];if(it.length>0){const Lt=it[0].clone(),yi=it[0].clone();for(let Ui=1;Ui<it.length;Ui++)Lt.x=Math.min(Lt.x,it[Ui].x),Lt.y=Math.min(Lt.y,it[Ui].y),yi.x=Math.max(yi.x,it[Ui].x),yi.y=Math.max(yi.y,it[Ui].y);at=Lt.x>=Ie.x&&yi.x<=Me.x&&Lt.y>=Ie.y&&yi.y<=Me.y?[it]:yi.x<Ie.x||Lt.x>Me.x||yi.y<Ie.y||Lt.y>Me.y?[]:h.aJ([it],Ie.x,Ie.y,Me.x,Me.y)}for(const Lt of at){ze.reset(Lt,.25*ye);let yi=0;yi=ze.length<=.5*ye?1:Math.ceil(ze.paddedLength/He)+1;for(let Ui=0;Ui<yi;Ui++){const Li=Ui/Math.max(yi-1,1),Xi=ze.lerp(Li),Ai=Xi.x+ui,on=Xi.y+ui;ee.push(Ai,on,ye,0);const Yi=Ai-ye,Wn=on-ye,_n=Ai+ye,yn=on+ye;if(oe=oe&&this.isOffscreen(Yi,Wn,_n,yn),de=de||this.isInsideGrid(Yi,Wn,_n,yn),t!=="always"&&this.grid.hitTestCircle(Ai,on,ye,t,O)&&(ue=!0,!A))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!A&&ue||!de||te<this.perspectiveRatioCutoff?[]:ee,offscreen:oe,collisionDetected:ue}}projectPathToScreenSpace(t,a){const l=(function(f,_){const b=h.N();return h.aB(b,_.pitchedLabelPlaneMatrix),f.map((w=>{const A=kt(w.x,w.y,b,_.getElevation),I=_.transform.projectTileCoordinates(A.point.x,A.point.y,_.unwrappedTileID,_.getElevation);return I.point.x=(.5*I.point.x+.5)*_.width,I.point.y=(.5*-I.point.y+.5)*_.height,I}))})(t,a);return(function(f){let _=0,b=0,w=0,A=0;for(let I=0;I<f.length;I++)f[I].isOccluded?(w=I+1,A=0):(A++,A>b&&(b=A,_=w));return f.slice(_,_+b)})(l)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new h.aa;for(const j of t){const k=new h.P(j.x+ui,j.y+ui);l.extend(k),a.push(k)}const{minX:f,minY:_,maxX:b,maxY:w}=l,A=this.grid.query(f,_,b,w).concat(this.ignoredGrid.query(f,_,b,w)),I={},O={};for(const j of A){const k=j.key;if(I[k.bucketInstanceId]===void 0&&(I[k.bucketInstanceId]={}),I[k.bucketInstanceId][k.featureIndex])continue;const G=[new h.P(j.x1,j.y1),new h.P(j.x2,j.y1),new h.P(j.x2,j.y2),new h.P(j.x1,j.y2)];h.aK(a,G)&&(I[k.bucketInstanceId][k.featureIndex]=!0,O[k.bucketInstanceId]===void 0&&(O[k.bucketInstanceId]=[]),O[k.bucketInstanceId].push(k.featureIndex))}return O}insertCollisionBox(t,a,l,f,_,b){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:a},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,a,l,f,_,b){const w=l?this.ignoredGrid:this.grid,A={bucketInstanceId:f,featureIndex:_,collisionGroupID:b,overlapMode:a};for(let I=0;I<t.length;I+=4)w.insertCircle(A,t[I],t[I+1],t[I+2])}projectAndGetPerspectiveRatio(t,a,l,f,_){if(_){let b;f?(b=[t,a,f(t,a),1],h.aH(b,b,_)):(b=[t,a,0,1],ma(b,b,_));const w=b[3];return{x:(b[0]/w+1)/2*this.transform.width+ui,y:(-b[1]/w+1)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const b=this.transform.projectTileCoordinates(t,a,l,f);return{x:(b.point.x+1)/2*this.transform.width+ui,y:(1-b.point.y)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/b.signedDistanceFromCamera*.5,isOccluded:b.isOccluded,signedDistanceFromCamera:b.signedDistanceFromCamera}}}getPerspectiveRatio(t,a,l,f){const _=this.transform.projectTileCoordinates(t,a,l,f);return .5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5}isOffscreen(t,a,l,f){return l<ui||t>=this.screenRightBoundary||f<ui||a>this.screenBottomBoundary}isInsideGrid(t,a,l,f){return l>=0&&t<this.gridRightBoundary&&f>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const t=h.ar([]);return h.O(t,t,[-100,-100,0]),t}_projectCollisionBox(t,a,l,f,_,b,w,A,I,O,j){let k=1,G=0,X=0,ee=1;const ie=t.anchorPointX+w[0],te=t.anchorPointY+w[1];if(b&&!_){const it=this.projectAndGetPerspectiveRatio(ie+1,te,f,I,j),He=it.x-A.x,at=Math.atan((it.y-A.y)/He)+(He<0?Math.PI:0),Lt=Math.sin(at),yi=Math.cos(at);k=yi,G=Lt,X=-Lt,ee=yi}else if(!b&&_){const it=ts(this.transform);k=it.vecEast[0],G=it.vecEast[1],X=it.vecSouth[0],ee=it.vecSouth[1]}let ae=A.x,ce=A.y,re=a;_&&(ae=ie,ce=te,re=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),re*=this.transform.getPitchedTextCorrection(ie,te,f),O||(re*=h.an(.5+A.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),O&&(ae+=k*O.x*re+X*O.y*re,ce+=G*O.x*re+ee*O.y*re);const ue=t.x1*re,de=t.x2*re,oe=(ue+de)/2,ye=t.y1*re,Ie=t.y2*re,Me=(ye+Ie)/2,ze=[{offsetX:ue,offsetY:ye},{offsetX:oe,offsetY:ye},{offsetX:de,offsetY:ye},{offsetX:de,offsetY:Me},{offsetX:de,offsetY:Ie},{offsetX:oe,offsetY:Ie},{offsetX:ue,offsetY:Ie},{offsetX:ue,offsetY:Me}];let Pe=[];for(const{offsetX:it,offsetY:He}of ze)Pe.push(new h.P(ae+k*it+X*He,ce+G*it+ee*He));let tt=!1;if(_){const it=Pe.map((He=>this.projectAndGetPerspectiveRatio(He.x,He.y,f,I,j)));tt=it.some((He=>!He.isOccluded)),Pe=it.map((He=>new h.P(He.x,He.y)))}else tt=!0;return{box:h.aL(Pe),allPointsOccluded:!tt}}}class ld{constructor(t,a,l,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?a:-a))):f&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class qo{constructor(t,a,l,f,_){this.text=new ld(t?t.text:null,a,l,_),this.icon=new ld(t?t.icon:null,a,f,_)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Vh{constructor(t,a,l){this.text=t,this.icon=a,this.skipFade=l}}class Ou{constructor(t,a,l,f,_){this.bucketInstanceId=t,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=f,this.tileID=_}}class ud{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const a=++this.maxGroupID;this.collisionGroups[t]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[t]}}function Sr(m,t,a,l,f){const{horizontalAlign:_,verticalAlign:b}=h.aS(m);return new h.P(-(_-.5)*t+l[0]*f,-(b-.5)*a+l[1]*f)}class Lu{constructor(t,a,l,f,_){this.transform=t.clone(),this.terrain=a,this.collisionIndex=new Nh(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ud(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const a=this.terrain;return a?(l,f)=>a.getElevation(t,l,f):null}getBucketParts(t,a,l,f){const _=l.getBucket(a),b=l.latestFeatureIndex;if(!_||!b||a.id!==_.layerIds[0])return;const w=l.collisionBoxArray,A=_.layers[0].layout,I=_.layers[0].paint,O=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),j=l.tileSize/h.a5,k=l.tileID.toUnwrapped(),G=A.get("text-rotation-alignment")==="map",X=h.aN(l,1,this.transform.zoom),ee=h.aO(this.collisionIndex.transform,l,I.get("text-translate"),I.get("text-translate-anchor")),ie=h.aO(this.collisionIndex.transform,l,I.get("icon-translate"),I.get("icon-translate-anchor")),te=Yr(G,this.transform,X);this.retainedQueryData[_.bucketInstanceId]=new Ou(_.bucketInstanceId,b,_.sourceLayerIndex,_.index,l.tileID);const ae={bucket:_,layout:A,translationText:ee,translationIcon:ie,unwrappedTileID:k,pitchedLabelPlaneMatrix:te,scale:O,textPixelRatio:j,holdingForFade:l.holdingForSymbolFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:h.ay(_.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(_.sourceID)};if(f)for(const ce of _.sortKeyRanges){const{sortKey:re,symbolInstanceStart:ue,symbolInstanceEnd:de}=ce;t.push({sortKey:re,symbolInstanceStart:ue,symbolInstanceEnd:de,parameters:ae})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:_.symbolInstances.length,parameters:ae})}attemptAnchorPlacement(t,a,l,f,_,b,w,A,I,O,j,k,G,X,ee,ie,te,ae,ce,re){const ue=h.aP[t.textAnchor],de=[t.textOffset0,t.textOffset1],oe=Sr(ue,l,f,de,_),ye=this.collisionIndex.placeCollisionBox(a,k,A,I,O,w,b,ie,j.predicate,ce,oe,re);if((!ae||this.collisionIndex.placeCollisionBox(ae,k,A,I,O,w,b,te,j.predicate,ce,oe,re).placeable)&&ye.placeable){let Ie;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(Ie=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:de,width:l,height:f,anchor:ue,textBoxScale:_,prevAnchor:Ie},this.markUsedJustification(X,ue,G,ee),X.allowVerticalPlacement&&(this.markUsedOrientation(X,ee,G),this.placedOrientations[G.crossTileID]=ee),{shift:oe,placedGlyphBoxes:ye}}}placeLayerBucketPart(t,a,l){const{bucket:f,layout:_,translationText:b,translationIcon:w,unwrappedTileID:A,pitchedLabelPlaneMatrix:I,textPixelRatio:O,holdingForFade:j,collisionBoxArray:k,partiallyEvaluatedTextSize:G,collisionGroup:X}=t.parameters,ee=_.get("text-optional"),ie=_.get("icon-optional"),te=h.aQ(_,"text-overlap","text-allow-overlap"),ae=te==="always",ce=h.aQ(_,"icon-overlap","icon-allow-overlap"),re=ce==="always",ue=_.get("text-rotation-alignment")==="map",de=_.get("text-pitch-alignment")==="map",oe=_.get("icon-text-fit")!=="none",ye=_.get("symbol-z-order")==="viewport-y",Ie=ae&&(re||!f.hasIconData()||ie),Me=re&&(ae||!f.hasTextData()||ee);!f.collisionArrays&&k&&f.deserializeCollisionBoxes(k);const ze=this.retainedQueryData[f.bucketInstanceId].tileID,Pe=this._getTerrainElevationFunc(ze),tt=this.transform.getFastPathSimpleProjectionMatrix(ze),it=(He,at,Lt)=>{var yi,Ui;if(a[He.crossTileID])return;if(j)return void(this.placements[He.crossTileID]=new Vh(!1,!1,!1));let Li=!1,Xi=!1,Ai=!0,on=null,Yi={box:null,placeable:!1,offscreen:null,occluded:!1},Wn={placeable:!1},_n=null,yn=null,Jn=null,Ss=0,Es=0,Ha=0;at.textFeatureIndex?Ss=at.textFeatureIndex:He.useRuntimeCollisionCircles&&(Ss=He.featureIndex),at.verticalTextFeatureIndex&&(Es=at.verticalTextFeatureIndex);const jr=at.textBox;if(jr){const Nr=wi=>{let Bi=h.az.horizontal;if(f.allowVerticalPlacement&&!wi&&this.prevPlacement){const Rn=this.prevPlacement.placedOrientations[He.crossTileID];Rn&&(this.placedOrientations[He.crossTileID]=Rn,Bi=Rn,this.markUsedOrientation(f,Bi,He))}return Bi},sa=(wi,Bi)=>{if(f.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&at.verticalTextBox){for(const Rn of f.writingModes)if(Rn===h.az.vertical?(Yi=Bi(),Wn=Yi):Yi=wi(),Yi&&Yi.placeable)break}else Yi=wi()},Ma=He.textAnchorOffsetStartIndex,Aa=He.textAnchorOffsetEndIndex;if(Aa===Ma){const wi=(Bi,Rn)=>{const Fn=this.collisionIndex.placeCollisionBox(Bi,te,O,ze,A,de,ue,b,X.predicate,Pe,void 0,tt);return Fn&&Fn.placeable&&(this.markUsedOrientation(f,Rn,He),this.placedOrientations[He.crossTileID]=Rn),Fn};sa((()=>wi(jr,h.az.horizontal)),(()=>{const Bi=at.verticalTextBox;return f.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Bi?wi(Bi,h.az.vertical):{box:null,offscreen:null}})),Nr(Yi&&Yi.placeable)}else{let wi=h.aP[(Ui=(yi=this.prevPlacement)===null||yi===void 0?void 0:yi.variableOffsets[He.crossTileID])===null||Ui===void 0?void 0:Ui.anchor];const Bi=(Fn,hh,fh)=>{const Co=Fn.x2-Fn.x1,Ad=Fn.y2-Fn.y1,Do=He.textBoxScale,dh=oe&&ce==="never"?hh:null;let $s=null,Xs=te==="never"?1:2,Xa="never";wi&&Xs++;for(let ph=0;ph<Xs;ph++){for(let _c=Ma;_c<Aa;_c++){const yc=f.textAnchorOffsets.get(_c);if(wi&&yc.textAnchor!==wi)continue;const vc=this.attemptAnchorPlacement(yc,Fn,Co,Ad,Do,ue,de,O,ze,A,X,Xa,He,f,fh,b,w,dh,Pe);if(vc&&($s=vc.placedGlyphBoxes,$s&&$s.placeable))return Li=!0,on=vc.shift,$s}wi?wi=null:Xa=te}return l&&!$s&&($s={box:this.collisionIndex.placeCollisionBox(jr,"always",O,ze,A,de,ue,b,X.predicate,Pe,void 0,tt).box,offscreen:!1,placeable:!1,occluded:!1}),$s};sa((()=>Bi(jr,at.iconBox,h.az.horizontal)),(()=>{const Fn=at.verticalTextBox;return f.allowVerticalPlacement&&(!Yi||!Yi.placeable)&&He.numVerticalGlyphVertices>0&&Fn?Bi(Fn,at.verticalIconBox,h.az.vertical):{box:null,occluded:!0,offscreen:null}})),Yi&&(Li=Yi.placeable,Ai=Yi.offscreen);const Rn=Nr(Yi&&Yi.placeable);if(!Li&&this.prevPlacement){const Fn=this.prevPlacement.variableOffsets[He.crossTileID];Fn&&(this.variableOffsets[He.crossTileID]=Fn,this.markUsedJustification(f,Fn.anchor,He,Rn))}}}if(_n=Yi,Li=_n&&_n.placeable,Ai=_n&&_n.offscreen,He.useRuntimeCollisionCircles&&He.centerJustifiedTextSymbolIndex>=0){const Nr=f.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),sa=h.aA(f.textSizeData,G,Nr),Ma=_.get("text-padding");yn=this.collisionIndex.placeCollisionCircles(te,Nr,f.lineVertexArray,f.glyphOffsetArray,sa,A,I,l,de,X.predicate,He.collisionCircleDiameter,Ma,b,Pe),yn.circles.length&&yn.collisionDetected&&!l&&h.w("Collisions detected, but collision boxes are not shown"),Li=ae||yn.circles.length>0&&!yn.collisionDetected,Ai=Ai&&yn.offscreen}if(at.iconFeatureIndex&&(Ha=at.iconFeatureIndex),at.iconBox){const Nr=sa=>this.collisionIndex.placeCollisionBox(sa,ce,O,ze,A,de,ue,w,X.predicate,Pe,oe&&on?on:void 0,tt);Wn&&Wn.placeable&&at.verticalIconBox?(Jn=Nr(at.verticalIconBox),Xi=Jn.placeable):(Jn=Nr(at.iconBox),Xi=Jn.placeable),Ai=Ai&&Jn.offscreen}const pl=ee||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,hu=ie||He.numIconVertices===0;pl||hu?hu?pl||(Xi=Xi&&Li):Li=Xi&&Li:Xi=Li=Xi&&Li;const $a=Xi&&Jn.placeable;if(Li&&_n.placeable&&this.collisionIndex.insertCollisionBox(_n.box,te,_.get("text-ignore-placement"),f.bucketInstanceId,Wn&&Wn.placeable&&Es?Es:Ss,X.ID),$a&&this.collisionIndex.insertCollisionBox(Jn.box,ce,_.get("icon-ignore-placement"),f.bucketInstanceId,Ha,X.ID),yn&&Li&&this.collisionIndex.insertCollisionCircles(yn.circles,te,_.get("text-ignore-placement"),f.bucketInstanceId,Ss,X.ID),l&&this.storeCollisionData(f.bucketInstanceId,Lt,at,_n,Jn,yn),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new Vh((Li||Ie)&&!_n?.occluded,(Xi||Me)&&!Jn?.occluded,Ai||f.justReloaded),a[He.crossTileID]=!0};if(ye){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const He=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let at=He.length-1;at>=0;--at){const Lt=He[at];it(f.symbolInstances.get(Lt),f.collisionArrays[Lt],Lt)}}else for(let He=t.symbolInstanceStart;He<t.symbolInstanceEnd;He++)it(f.symbolInstances.get(He),f.collisionArrays[He],He);f.justReloaded=!1}storeCollisionData(t,a,l,f,_,b){if(l.textBox||l.iconBox){let w,A;this.collisionBoxArrays.has(t)?w=this.collisionBoxArrays.get(t):(w=new Map,this.collisionBoxArrays.set(t,w)),w.has(a)?A=w.get(a):(A={text:null,icon:null},w.set(a,A)),l.textBox&&(A.text=f.box),l.iconBox&&(A.icon=_.box)}if(b){let w=this.collisionCircleArrays[t];w===void 0&&(w=this.collisionCircleArrays[t]=[]);for(let A=0;A<b.circles.length;A+=4)w.push(b.circles[A+0]-ui),w.push(b.circles[A+1]-ui),w.push(b.circles[A+2]),w.push(b.collisionDetected?1:0)}}markUsedJustification(t,a,l,f){let _;_=f===h.az.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[h.aR(a)];const b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of b)w>=0&&(t.text.placedSymbolArray.get(w).crossTileID=_>=0&&w!==_?0:l.crossTileID)}markUsedOrientation(t,a,l){const f=a===h.az.horizontal||a===h.az.horizontalOnly?a:0,_=a===h.az.vertical?a:0,b=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of b)t.text.placedSymbolArray.get(w).placedOrientation=f;l.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=_)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const f=a?a.symbolFadeChange(t):1,_=a?a.opacities:{},b=a?a.variableOffsets:{},w=a?a.placedOrientations:{};for(const A in this.placements){const I=this.placements[A],O=_[A];O?(this.opacities[A]=new qo(O,f,I.text,I.icon),l=l||I.text!==O.text.placed||I.icon!==O.icon.placed):(this.opacities[A]=new qo(null,f,I.text,I.icon,I.skipFade),l=l||I.text||I.icon)}for(const A in _){const I=_[A];if(!this.opacities[A]){const O=new qo(I,f,!1,!1);O.isHidden()||(this.opacities[A]=O,l=l||I.text.placed||I.icon.placed)}}for(const A in b)this.variableOffsets[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.variableOffsets[A]=b[A]);for(const A in w)this.placedOrientations[A]||!this.opacities[A]||this.opacities[A].isHidden()||(this.placedOrientations[A]=w[A]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:t)}updateLayerOpacities(t,a){const l={};for(const f of a){const _=f.getBucket(t);_&&f.latestFeatureIndex&&t.id===_.layerIds[0]&&this.updateBucketOpacities(_,f.tileID,l,f.collisionBoxArray)}}updateBucketOpacities(t,a,l,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const _=t.layers[0],b=_.layout,w=new qo(null,0,!1,!1,!0),A=b.get("text-allow-overlap"),I=b.get("icon-allow-overlap"),O=_._unevaluatedLayout.hasValue("text-variable-anchor")||_._unevaluatedLayout.hasValue("text-variable-anchor-offset"),j=b.get("text-rotation-alignment")==="map",k=b.get("text-pitch-alignment")==="map",G=b.get("icon-text-fit")!=="none",X=new qo(null,0,A&&(I||!t.hasIconData()||b.get("icon-optional")),I&&(A||!t.hasTextData()||b.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ee=(te,ae,ce)=>{for(let re=0;re<ae/4;re++)te.opacityVertexArray.emplaceBack(ce);te.hasVisibleVertices=te.hasVisibleVertices||ce!==Ho},ie=this.collisionBoxArrays.get(t.bucketInstanceId);for(let te=0;te<t.symbolInstances.length;te++){const ae=t.symbolInstances.get(te),{numHorizontalGlyphVertices:ce,numVerticalGlyphVertices:re,crossTileID:ue}=ae;let de=this.opacities[ue];l[ue]?de=w:de||(de=X,this.opacities[ue]=de),l[ue]=!0;const oe=ae.numIconVertices>0,ye=this.placedOrientations[ae.crossTileID],Ie=ye===h.az.vertical,Me=ye===h.az.horizontal||ye===h.az.horizontalOnly;if(ce>0||re>0){const Pe=jc(de.text);ee(t.text,ce,Ie?Ho:Pe),ee(t.text,re,Me?Ho:Pe);const tt=de.text.isHidden();[ae.rightJustifiedTextSymbolIndex,ae.centerJustifiedTextSymbolIndex,ae.leftJustifiedTextSymbolIndex].forEach((at=>{at>=0&&(t.text.placedSymbolArray.get(at).hidden=tt||Ie?1:0)})),ae.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ae.verticalPlacedTextSymbolIndex).hidden=tt||Me?1:0);const it=this.variableOffsets[ae.crossTileID];it&&this.markUsedJustification(t,it.anchor,ae,ye);const He=this.placedOrientations[ae.crossTileID];He&&(this.markUsedJustification(t,"left",ae,He),this.markUsedOrientation(t,He,ae))}if(oe){const Pe=jc(de.icon),tt=!(G&&ae.verticalPlacedIconSymbolIndex&&Ie);ae.placedIconSymbolIndex>=0&&(ee(t.icon,ae.numIconVertices,tt?Pe:Ho),t.icon.placedSymbolArray.get(ae.placedIconSymbolIndex).hidden=de.icon.isHidden()),ae.verticalPlacedIconSymbolIndex>=0&&(ee(t.icon,ae.numVerticalIconVertices,tt?Ho:Pe),t.icon.placedSymbolArray.get(ae.verticalPlacedIconSymbolIndex).hidden=de.icon.isHidden())}const ze=ie&&ie.has(te)?ie.get(te):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Pe=t.collisionArrays[te];if(Pe){let tt=new h.P(0,0);if(Pe.textBox||Pe.verticalTextBox){let it=!0;if(O){const He=this.variableOffsets[ue];He?(tt=Sr(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),j&&tt._rotate(k?-this.transform.bearingInRadians:this.transform.bearingInRadians)):it=!1}if(Pe.textBox||Pe.verticalTextBox){let He;Pe.textBox&&(He=Ie),Pe.verticalTextBox&&(He=Me),Fc(t.textCollisionBox.collisionVertexArray,de.text.placed,!it||He,ze.text,tt.x,tt.y)}}if(Pe.iconBox||Pe.verticalIconBox){const it=!!(!Me&&Pe.verticalIconBox);let He;Pe.iconBox&&(He=it),Pe.verticalIconBox&&(He=!it),Fc(t.iconCollisionBox.collisionVertexArray,de.icon.placed,He,ze.icon,G?tt.x:0,G?tt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>t}setStale(){this.stale=!0}}function Fc(m,t,a,l,f,_){l&&l.length!==0||(l=[0,0,0,0]);const b=l[0]-ui,w=l[1]-ui,A=l[2]-ui,I=l[3]-ui;m.emplaceBack(t?1:0,a?1:0,f||0,_||0,b,w),m.emplaceBack(t?1:0,a?1:0,f||0,_||0,A,w),m.emplaceBack(t?1:0,a?1:0,f||0,_||0,A,I),m.emplaceBack(t?1:0,a?1:0,f||0,_||0,b,I)}const Bu=Math.pow(2,25),lo=Math.pow(2,24),cd=Math.pow(2,17),Gl=Math.pow(2,16),Os=Math.pow(2,9),hd=Math.pow(2,8),Zo=Math.pow(2,1);function jc(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const t=m.placed?1:0,a=Math.floor(127*m.opacity);return a*Bu+t*lo+a*cd+t*Gl+a*Os+t*hd+a*Zo+t}const Ho=0;class uo{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,a,l,f,_){const b=this._bucketParts;for(;this._currentTileIndex<t.length;)if(a.getBucketParts(b,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,_())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,b.sort(((w,A)=>w.sortKey-A.sortKey)));this._currentPartIndex<b.length;)if(a.placeLayerBucketPart(b[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,_())return!0;return!1}}class ql{constructor(t,a,l,f,_,b,w,A){this.placement=new Lu(t,a,b,w,A),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(t,a,l){const f=rt(),_=()=>!this._forceFullPlacement&&rt()-f>2;for(;this._currentPlacementIndex>=0;){const b=a[t[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(b.type==="symbol"&&(!b.minzoom||b.minzoom<=w)&&(!b.maxzoom||b.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new uo(b)),this._inProgressLayer.continuePlacement(l[b.source],this.placement,this._showCollisionBoxes,b,_))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Gt=512/h.a5/2;class Fa{constructor(t,a,l){this.tileID=t,this.bucketInstanceId=l,this._symbolsByKey={};const f=new Map;for(let _=0;_<a.length;_++){const b=a.get(_),w=b.key,A=f.get(w);A?A.push(b):f.set(w,[b])}for(const[_,b]of f){const w={positions:b.map((A=>({x:Math.floor(A.anchorX*Gt),y:Math.floor(A.anchorY*Gt)}))),crossTileIDs:b.map((A=>A.crossTileID))};if(w.positions.length>128){const A=new h.aT(w.positions.length,16,Uint16Array);for(const{x:I,y:O}of w.positions)A.add(I,O);A.finish(),delete w.positions,w.index=A}this._symbolsByKey[_]=w}}getScaledCoordinates(t,a){const{x:l,y:f,z:_}=this.tileID.canonical,{x:b,y:w,z:A}=a.canonical,I=Gt/Math.pow(2,A-_),O=(w*h.a5+t.anchorY)*I,j=f*h.a5*Gt;return{x:Math.floor((b*h.a5+t.anchorX)*I-l*h.a5*Gt),y:Math.floor(O-j)}}findMatches(t,a,l){const f=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let _=0;_<t.length;_++){const b=t.get(_);if(b.crossTileID)continue;const w=this._symbolsByKey[b.key];if(!w)continue;const A=this.getScaledCoordinates(b,a);if(w.index){const I=w.index.range(A.x-f,A.y-f,A.x+f,A.y+f).sort();for(const O of I){const j=w.crossTileIDs[O];if(!l[j]){l[j]=!0,b.crossTileID=j;break}}}else if(w.positions)for(let I=0;I<w.positions.length;I++){const O=w.positions[I],j=w.crossTileIDs[I];if(Math.abs(O.x-A.x)<=f&&Math.abs(O.y-A.y)<=f&&!l[j]){l[j]=!0,b.crossTileID=j;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class Uh{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ku{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const a=Math.round((t-this.lng)/360);if(a!==0)for(const l in this.indexes){const f=this.indexes[l],_={};for(const b in f){const w=f[b];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+a),_[w.tileID.key]=w}this.indexes[l]=_}this.lng=t}addBucket(t,a,l){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let _=0;_<a.symbolInstances.length;_++)a.symbolInstances.get(_).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const _ in this.indexes){const b=this.indexes[_];if(Number(_)>t.overscaledZ)for(const w in b){const A=b[w];A.tileID.isChildOf(t)&&A.findMatches(a.symbolInstances,t,f)}else{const w=b[t.scaledTo(Number(_)).key];w&&w.findMatches(a.symbolInstances,t,f)}}for(let _=0;_<a.symbolInstances.length;_++){const b=a.symbolInstances.get(_);b.crossTileID||(b.crossTileID=l.generate(),f[b.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Fa(t,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(t,a){for(const l of a.getCrossTileIDsLists())for(const f of l)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let a=!1;for(const l in this.indexes){const f=this.indexes[l];for(const _ in f)t[f[_].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,f[_]),delete f[_],a=!0)}return a}}class qn{constructor(){this.layerIndexes={},this.crossTileIDs=new Uh,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,a,l){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new ku);let _=!1;const b={};f.handleWrapJump(l);for(const w of a){const A=w.getBucket(t);A&&t.id===A.layerIds[0]&&(A.bucketInstanceId||(A.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(w.tileID,A,this.crossTileIDs)&&(_=!0),b[A.bucketInstanceId]=!0)}return f.removeStaleBuckets(b)&&(_=!0),_}pruneUnusedLayers(t){const a={};t.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var Pn="void main() {fragColor=vec4(1.0);}";const Qi={prelude:zt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:zt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:zt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:zt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:zt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zt(Pn,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:zt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:zt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:zt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:zt(Pn,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:zt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:zt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:zt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:zt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:zt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zt(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0/u_device_pixel_ratio)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:zt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:zt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:zt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:zt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:zt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:zt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:zt(`#ifdef GL_ES
precision highp float;
#endif
in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:zt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function zt(m,t){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=t.match(/in ([\w]+) ([\w]+)/g),f=m.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),b=_?_.concat(f):f,w={};return{fragmentSource:m=m.replace(a,((A,I,O,j,k)=>(w[k]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${k}
in ${O} ${j} ${k};
#else
uniform ${O} ${j} u_${k};
#endif
`:`
#ifdef HAS_UNIFORM_u_${k}
    ${O} ${j} ${k} = u_${k};
#endif
`))),vertexSource:t=t.replace(a,((A,I,O,j,k)=>{const G=j==="float"?"vec2":"vec4",X=k.match(/color/)?"color":G;return w[k]?I==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${O} ${G} a_${k};
out ${O} ${j} ${k};
#else
uniform ${O} ${j} u_${k};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = a_${k};
#else
    ${O} ${j} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = unpack_mix_${X}(a_${k}, u_${k}_t);
#else
    ${O} ${j} ${k} = u_${k};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${O} ${G} a_${k};
#else
uniform ${O} ${j} u_${k};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${O} ${j} ${k} = a_${k};
#else
    ${O} ${j} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${O} ${j} ${k} = unpack_mix_${X}(a_${k}, u_${k}_t);
#else
    ${O} ${j} ${k} = u_${k};
#endif
`})),staticAttributes:l,staticUniforms:b}}class Ri{constructor(t,a,l){this.vertexBuffer=t,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var ga=h.aU([{name:"a_pos",type:"Int16",components:2}]);const pn="#define PROJECTION_MERCATOR",Er="mercator";class Zn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Er}get shaderDefine(){return pn}get shaderPreludeCode(){return Qi.projectionMercator}get vertexShaderPreludeCode(){return Qi.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aV.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,a,l,f,_){if(this._cachedMesh)return this._cachedMesh;const b=new h.aW;b.emplaceBack(0,0),b.emplaceBack(h.a5,0),b.emplaceBack(0,h.a5),b.emplaceBack(h.a5,h.a5);const w=t.createVertexBuffer(b,ga.members),A=h.aX.simpleSegment(0,0,4,2),I=new h.aY;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3);const O=t.createIndexBuffer(I);return this._cachedMesh=new Ri(w,O,A),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class Qr{constructor(t=0,a=0,l=0,f=0){if(isNaN(t)||t<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=a,this.left=l,this.right=f}interpolate(t,a,l){return a.top!=null&&t.top!=null&&(this.top=h.G.number(t.top,a.top,l)),a.bottom!=null&&t.bottom!=null&&(this.bottom=h.G.number(t.bottom,a.bottom,l)),a.left!=null&&t.left!=null&&(this.left=h.G.number(t.left,a.left,l)),a.right!=null&&t.right!=null&&(this.right=h.G.number(t.right,a.right,l)),this}getCenter(t,a){const l=h.an((this.left+t-this.right)/2,0,t),f=h.an((this.top+a-this.bottom)/2,0,a);return new h.P(l,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Qr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function ss(m,t){if(!m.renderWorldCopies||m.lngRange)return;const a=t.lng-m.center.lng;t.lng+=a>180?-360:a<-180?360:0}function Ki(m){return Math.max(0,Math.floor(m))}class co{constructor(t,a){var l;this.applyConstrain=(f,_)=>this._constrainOverride!==null?this._constrainOverride(f,_):this._callbacks.defaultConstrain(f,_),this._callbacks=t,this._tileSize=512,this._renderWorldCopies=a?.renderWorldCopies===void 0||!!a?.renderWorldCopies,this._minZoom=a?.minZoom||0,this._maxZoom=a?.maxZoom||22,this._minPitch=a?.minPitch==null?0:a?.minPitch,this._maxPitch=a?.maxPitch==null?60:a?.maxPitch,this._constrainOverride=(l=a?.constrainOverride)!==null&&l!==void 0?l:null,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.V(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ki(this._zoom),this._scale=h.aq(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Qr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,a,l){this._constrainOverride=t.constrainOverride,this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ki(this._zoom),this._scale=h.aq(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new Qr(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!l&&t.autoCalculateNearFarZ,a&&this.constrainInternal(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.applyConstrain(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get constrainOverride(){return this._constrainOverride}setConstrainOverride(t){t===void 0&&(t=null),this._constrainOverride!==t&&(this._constrainOverride=t,this.constrainInternal(),this._calcMatrices())}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const a=h.W(t,-180,180)*Math.PI/180;var l,f,_,b,w,A,I,O,j;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=ge(),l=this._rotationMatrix,_=-this._bearingInRadians,b=(f=this._rotationMatrix)[0],w=f[1],A=f[2],I=f[3],O=Math.sin(_),j=Math.cos(_),l[0]=b*j+A*O,l[1]=w*j+I*O,l[2]=b*-O+A*j,l[3]=w*-O+I*j)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const a=h.an(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const a=t/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aZ(this._fovInRadians)}setFov(t){t=h.an(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=h.ap(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const a=this.applyConstrain(this._center,t).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=h.aq(a),this.constrainInternal(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this.constrainInternal(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this.constrainInternal(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,a){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,a,l){this._unmodified=!1,this._edgeInsets.interpolate(t,a,l),this.constrainInternal(),this._calcMatrices()}resize(t,a,l=!0){this._width=t,this._height=a,l&&this.constrainInternal(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new hn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this.constrainInternal()):(this._lngRange=null,this._latRange=[-h.ao,h.ao])}getCameraQueryGeometry(t,a){if(a.length===1)return[a[0],t];{const{minX:l,minY:f,maxX:_,maxY:b}=h.aa.fromPoints(a).extend(t);return[new h.P(l,f),new h.P(_,f),new h.P(_,b),new h.P(l,b),new h.P(l,f)]}}constrainInternal(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:a,zoom:l}=this.applyConstrain(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=h.ar(new Float64Array(16));h.Q(t,t,[this._width/2,-this._height/2,1]),h.O(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=h.ar(new Float64Array(16)),h.Q(t,t,[1,-1,1]),h.O(t,t,[-1,-1,0]),h.Q(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,a,l,f){const _=l!==void 0?l:this.bearing,b=f=f!==void 0?f:this.pitch,{distanceToCenter:w,clampedElevation:A}=this._distanceToCenterFromAltElevationPitch(a,this.elevation,b),{x:I,y:O}=vi(b,_),j=h.a9.fromLngLat(t,a);let k,G,X=h.a_(1,j.y),ee=0;do{if(ee+=1,ee>10)break;G=w/X,k=new h.a9(j.x+I*G,j.y+O*G),X=1/k.meterInMercatorCoordinateUnits()}while(Math.abs(w-G*X)>1e-12);return{center:k.toLngLat(),elevation:A,zoom:h.at(this.height/2/Math.tan(this.fovInRadians/2)/G/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const a=1/this.worldSize,l=h.as(1,this.center.lat)*this.worldSize,f=h.a9.fromLngLat(this.center,this.elevation),_=f.x/a,b=f.y/a,w=f.z/a,A=this.pitch,I=this.bearing,{x:O,y:j,z:k}=vi(A,I),G=this.cameraToCenterDistance,X=_+G*-O,ee=b+G*-j,ie=w+G*k,{distanceToCenter:te,clampedElevation:ae}=this._distanceToCenterFromAltElevationPitch(ie/l,t,A),ce=te*l,re=new h.a9((X+O*ce)*a,(ee+j*ce)*a,0).toLngLat(),ue=h.as(1,re.lat),de=h.at(this.height/2/Math.tan(this.fovInRadians/2)/te/ue/this.tileSize);this._elevation=ae,this._center=re,this.setZoom(de)}_distanceToCenterFromAltElevationPitch(t,a,l){const f=-Math.cos(h.ap(l)),_=t-a;let b,w=a;return f*_>=0||Math.abs(f)<.1?(b=1e4,w=t+b*f):b=-_/f,{distanceToCenter:b,clampedElevation:w}}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=h.as(1,this.center.lat)*this.worldSize;return Ee(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const a=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/a,t.canonical.y/a,1/a/h.a5,1/a/h.a5]}}class Kr{constructor(t,a){this.min=t,this.max=a,this.center=h.a$([],h.b0([],this.min,this.max),.5)}quadrant(t){const a=[t%2==0,t<2],l=h.b1(this.min),f=h.b1(this.max);for(let _=0;_<a.length;_++)l[_]=a[_]?this.min[_]:this.center[_],f[_]=a[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new Kr(l,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let a=!0;for(let l=0;l<t.planes.length;l++){const f=this.intersectsPlane(t.planes[l]);if(f===0)return 0;f===1&&(a=!1)}return a?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let a=t[3],l=t[3];for(let f=0;f<3;f++)t[f]>0?(a+=t[f]*this.min[f],l+=t[f]*this.max[f]):(l+=t[f]*this.min[f],a+=t[f]*this.max[f]);return a>=0?2:l<0?0:1}}class $o{distanceToTile2d(t,a,l,f){const _=f.distanceX([t,a]),b=f.distanceY([t,a]);return Math.hypot(_,b)}getWrap(t,a,l){return l}getTileBoundingVolume(t,a,l,f){var _,b;let w=0,A=0;if(f?.terrain){const O=new h.a2(t.z,a,t.z,t.x,t.y),j=f.terrain.getMinMaxElevation(O);w=(_=j.minElevation)!==null&&_!==void 0?_:Math.min(0,l),A=(b=j.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}const I=1<<t.z;return new Kr([a+t.x/I,t.y/I,w],[a+(t.x+1)/I,(t.y+1)/I,A])}allowVariableZoom(t,a){const l=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=h.an(78.5-l/2,0,60);return!!a.terrain||t.pitch>f}allowWorldCopies(){return!0}prepareNextFrame(){}}class Mr{constructor(t,a,l){this.points=t,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(t,a=1,l=0,f,_){const b=_?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],w=Math.pow(2,l),A=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((k=>(function(G,X,ee,ie){const te=h.aH([],G,X),ae=1/te[3]/ee*ie;return h.b6(te,te,[ae,ae,1/te[3],ae])})(k,t,a,w)));f&&(function(k,G,X,ee){const ie=ee?4:0,te=ee?0:4;let ae=0;const ce=[],re=[];for(let oe=0;oe<4;oe++){const ye=h.b2([],k[oe+te],k[oe+ie]),Ie=h.b7(ye);h.a$(ye,ye,1/Ie),ce.push(Ie),re.push(ye)}for(let oe=0;oe<4;oe++){const ye=h.b8(k[oe+ie],re[oe],X);ae=ye!==null&&ye>=0?Math.max(ae,ye):Math.max(ae,ce[oe])}const ue=(function(oe,ye){const Ie=h.b2([],oe[ye[0]],oe[ye[1]]),Me=h.b2([],oe[ye[2]],oe[ye[1]]),ze=[0,0,0,0];return h.b3(ze,h.b4([],Ie,Me)),ze[3]=-h.b5(ze,oe[ye[0]]),ze})(k,G),de=(function(oe,ye){const Ie=h.b9(oe),Me=h.ba([],oe,1/Ie),ze=h.b2([],ye,h.a$([],Me,h.b5(ye,Me))),Pe=h.b9(ze);if(Pe>0){const tt=Math.sqrt(1-Me[3]*Me[3]),it=h.a$([],Me,-Me[3]),He=h.b0([],it,h.a$([],ze,tt/Pe));return h.bb(ye,He)}return null})(X,ue);if(de!==null){const oe=de/h.b5(re[0],ue);ae=Math.min(ae,oe)}for(let oe=0;oe<4;oe++){const ye=Math.min(ae,ce[oe]);k[oe+te]=[k[oe+ie][0]+re[oe][0]*ye,k[oe+ie][1]+re[oe][1]*ye,k[oe+ie][2]+re[oe][2]*ye,1]}})(A,b[0],f,_);const I=b.map((k=>{const G=h.b2([],A[k[0]],A[k[1]]),X=h.b2([],A[k[2]],A[k[1]]),ee=h.b3([],h.b4([],G,X)),ie=-h.b5(ee,A[k[1]]);return ee.concat(ie)})),O=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],j=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const k of A)for(let G=0;G<3;G++)O[G]=Math.min(O[G],k[G]),j[G]=Math.max(j[G],k[G]);return new Mr(A,I,new Kr(O,j))}}class kn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,a){}constructor(t){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this.defaultConstrain=(a,l)=>{l=h.an(+l,this.minZoom,this.maxZoom);const f={center:new h.V(a.lng,a.lat),zoom:l};let _=this._helper._lngRange;if(!this._helper._renderWorldCopies&&_===null){const re=179.9999999999;_=[-re,re]}const b=this.tileSize*h.aq(f.zoom);let w=0,A=b,I=0,O=b,j=0,k=0;const{x:G,y:X}=this.size;if(this._helper._latRange){const re=this._helper._latRange;w=h.X(re[1])*b,A=h.X(re[0])*b,A-w<X&&(j=X/(A-w))}_&&(I=h.W(h.Y(_[0])*b,0,b),O=h.W(h.Y(_[1])*b,0,b),O<I&&(O+=b),O-I<G&&(k=G/(O-I)));const{x:ee,y:ie}=vt(b,a);let te,ae;const ce=Math.max(k||0,j||0);if(ce){const re=new h.P(k?(O+I)/2:ee,j?(A+w)/2:ie);return f.center=Rt(b,re).wrap(),f.zoom+=h.at(ce),f}if(this._helper._latRange){const re=X/2;ie-re<w&&(ae=w+re),ie+re>A&&(ae=A-re)}if(_){const re=(I+O)/2;let ue=ee;this._helper._renderWorldCopies&&(ue=h.W(ee,re-b/2,re+b/2));const de=G/2;ue-de<I&&(te=I+de),ue+de>O&&(te=O-de)}if(te!==void 0||ae!==void 0){const re=new h.P(te??ee,ae??ie);f.center=Rt(b,re).wrap()}return f},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new co({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new $o}clone(){const t=new kn;return t.apply(this,!1),t}apply(t,a,l){this._helper.apply(t,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const a=[new h.bc(0,t)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new h.P(0,0)),f=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),_=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),b=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,f.x,_.x,b.x)),A=Math.floor(Math.max(l.x,f.x,_.x,b.x)),I=1;for(let O=w-I;O<=A+I;O++)O!==0&&a.push(new h.bc(O,t))}return a}getCameraFrustum(){return Mr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const a=this.screenPointToLocation(this.centerPoint,t),l=t?t.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(t,a){const l=h.as(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(a,l),_=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),b=h.a9.fromLngLat(t),w=new h.a9(b.x-(f.x-_.x),b.y-(f.y-_.y));this.setCenter(w?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,a){return a?this.coordinatePoint(h.a9.fromLngLat(t),a.getElevationForLngLat(t,this),this._pixelMatrix3D):this.coordinatePoint(h.a9.fromLngLat(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,a){const l=a||0,f=[t.x,t.y,0,1],_=[t.x,t.y,1,1];h.aH(f,f,this._pixelMatrixInverse),h.aH(_,_,this._pixelMatrixInverse);const b=f[3],w=_[3],A=f[1]/b,I=_[1]/w,O=f[2]/b,j=_[2]/w,k=O===j?0:(l-O)/(j-O);return new h.a9(h.G.number(f[0]/b,_[0]/w,k)/this.worldSize,h.G.number(A,I,k)/this.worldSize,l)}coordinatePoint(t,a=0,l=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,a,1];return h.aH(f,f,l),new h.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-gi(this));return new hn().extend(this.screenPointToLocation(new h.P(0,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(t,a){return a?a.pointCoordinate(t)!=null:t.y>this.height/2-gi(this)}calculatePosMatrix(t,a=!1,l){var f;const _=(f=t.key)!==null&&f!==void 0?f:h.bd(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),b=a?this._alignedPosMatrixCache:this._posMatrixCache;if(b.has(_)){const I=b.get(_);return l?I.f32:I.f64}const w=ii(t,this.worldSize);h.S(w,a?this._alignedProjMatrix:this._viewProjMatrix,w);const A={f64:w,f32:new Float32Array(w)};return b.set(_,A),l?A.f32:A.f64}calculateFogMatrix(t){const a=t.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const f=ii(t,this.worldSize);return h.S(f,this._fogMatrix,f),l.set(a,new Float32Array(f)),l.get(a)}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}_calculateNearFarZIfNeeded(t,a,l){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),_=t-f*this._helper._pixelPerMeter/Math.cos(a),b=f<0?_:t,w=Math.PI/2+this.pitchInRadians,A=h.ap(this.fov)*(Math.abs(Math.cos(h.ap(this.roll)))*this.height+Math.abs(Math.sin(h.ap(this.roll)))*this.width)/this.height*(.5+l.y/this.height),I=Math.sin(A)*b/Math.sin(h.an(Math.PI-w-A,.01,Math.PI-.01)),O=gi(this),j=Math.atan(O/this._helper.cameraToCenterDistance),k=h.ap(.75),G=j>k?2*j*(.5+l.y/(2*O)):k,X=Math.sin(G)*b/Math.sin(h.an(Math.PI-w-G,.01,Math.PI-.01)),ee=Math.min(I,X);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*ee+b),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,a=vt(this.worldSize,this.center),l=a.x,f=a.y;this._helper._pixelPerMeter=h.as(1,this.center.lat)*this.worldSize;const _=h.ap(Math.min(this.pitch,ht)),b=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(_));let w;this._calculateNearFarZIfNeeded(b,_,t),w=new Float64Array(16),h.be(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.aB(this._invProjMatrix,w),w[8]=2*-t.x/this._helper._width,w[9]=2*t.y/this._helper._height,this._projectionMatrix=h.bf(w),h.Q(w,w,[1,-1,1]),h.O(w,w,[0,0,-this._helper.cameraToCenterDistance]),h.bg(w,w,-this.rollInRadians),h.bh(w,w,this.pitchInRadians),h.bg(w,w,-this.bearingInRadians),h.O(w,w,[-l,-f,0]),this._mercatorMatrix=h.Q([],w,[this.worldSize,this.worldSize,this.worldSize]),h.Q(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),h.O(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=h.aB([],w);const A=[0,0,-1,1];h.aH(A,A,this._invViewProjMatrix),this._cameraPosition=[A[0]/A[3],A[1]/A[3],A[2]/A[3]],this._fogMatrix=new Float64Array(16),h.be(this._fogMatrix,this.fovInRadians,this.width/this.height,b,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,h.Q(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.O(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.bg(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.bh(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.bg(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.O(this._fogMatrix,this._fogMatrix,[-l,-f,0]),h.Q(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.O(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.S(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const I=this._helper._width%2/2,O=this._helper._height%2/2,j=Math.cos(this.bearingInRadians),k=Math.sin(-this.bearingInRadians),G=l-Math.round(l)+j*I+k*O,X=f-Math.round(f)+j*O+k*I,ee=new Float64Array(w);if(h.O(ee,ee,[G>.5?G-1:G,X>.5?X-1:X,0]),this._alignedProjMatrix=ee,w=h.aB(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new h.P(0,0)),a=[t.x*this.worldSize,t.y*this.worldSize,0,1];return h.aH(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=h.as(1,this.center.lat)*this.worldSize;return Ee(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,a){const l=h.a9.fromLngLat(t),f=[l.x*this.worldSize,l.y*this.worldSize,a,1];return h.aH(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:f}=t,_=this._helper.getMercatorTileCoordinates(a),b=a?this.calculatePosMatrix(a,l,!0):null;let w;return w=a&&a.terrainRttPosMatrix32f&&f?a.terrainRttPosMatrix32f:b||h.bi(),{mainMatrix:w,tileMercatorCoords:_,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,a,l){return 1}transformLightDirection(t){return h.b1(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,a,l,f){const _=this.calculatePosMatrix(l);let b;f?(b=[t,a,f(t,a),1],h.aH(b,b,_)):(b=[t,a,0,1],ma(b,b,_));const w=b[3];return{point:new h.P(b[0]/w,b[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(t){for(const a of t)this.calculatePosMatrix(a)}getMatrixForModel(t,a){const l=h.a9.fromLngLat(t,a),f=l.meterInMercatorCoordinateUnits(),_=h.bj();return h.O(_,_,[l.x,l.y,l.z]),h.bg(_,_,Math.PI),h.bh(_,_,Math.PI/2),h.Q(_,_,[-f,f,f]),_}getProjectionDataForCustomLayer(t=!0){const a=new h.a2(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:t}),f=ii(a,this.worldSize);h.S(f,this._viewProjMatrix,f),l.tileMercatorCoords=[0,0,1,1];const _=[h.a5,h.a5,this.worldSize/this._helper.pixelsPerMeter],b=h.bk();return h.Q(b,f,_),l.fallbackMatrix=b,l.mainMatrix=b,l}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Ar(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Fu(m){if(m.useSlerp)if(m.k<1){const t=h.bl(m.startEulerAngles.roll,m.startEulerAngles.pitch,m.startEulerAngles.bearing),a=h.bl(m.endEulerAngles.roll,m.endEulerAngles.pitch,m.endEulerAngles.bearing),l=new Float64Array(4);h.bm(l,t,a,m.k);const f=h.bn(l);m.tr.setRoll(f.roll),m.tr.setPitch(f.pitch),m.tr.setBearing(f.bearing)}else m.tr.setRoll(m.endEulerAngles.roll),m.tr.setPitch(m.endEulerAngles.pitch),m.tr.setBearing(m.endEulerAngles.bearing);else m.tr.setRoll(h.G.number(m.startEulerAngles.roll,m.endEulerAngles.roll,m.k)),m.tr.setPitch(h.G.number(m.startEulerAngles.pitch,m.endEulerAngles.pitch,m.k)),m.tr.setBearing(h.G.number(m.startEulerAngles.bearing,m.endEulerAngles.bearing,m.k))}function Xo(m,t,a,l,f){const _=f.padding,b=vt(f.worldSize,a.getNorthWest()),w=vt(f.worldSize,a.getNorthEast()),A=vt(f.worldSize,a.getSouthEast()),I=vt(f.worldSize,a.getSouthWest()),O=h.ap(-l),j=b.rotate(O),k=w.rotate(O),G=A.rotate(O),X=I.rotate(O),ee=new h.P(Math.max(j.x,k.x,X.x,G.x),Math.max(j.y,k.y,X.y,G.y)),ie=new h.P(Math.min(j.x,k.x,X.x,G.x),Math.min(j.y,k.y,X.y,G.y)),te=ee.sub(ie),ae=(f.width-(_.left+_.right+t.left+t.right))/te.x,ce=(f.height-(_.top+_.bottom+t.top+t.bottom))/te.y;if(ce<0||ae<0)return void Ar();const re=Math.min(h.at(f.scale*Math.min(ae,ce)),m.maxZoom),ue=h.P.convert(m.offset),de=new h.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(h.ap(l)),oe=ue.add(de).mult(f.scale/h.aq(re));return{center:Rt(f.worldSize,b.add(A).div(2).sub(oe)),zoom:re,bearing:l}}class Yo{get useGlobeControls(){return!1}handlePanInertia(t,a){const l=t.mag(),f=Math.abs(gi(a));return{easingOffset:t.mult(Math.min(.75*f/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(t,a){t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta),t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta)}handleMapControlsPan(t,a,l){t.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,t.around)}cameraForBoxAndBearing(t,a,l,f,_){return Xo(t,a,l,f,_)}handleJumpToCenterZoom(t,a){t.zoom!==(a.zoom!==void 0?+a.zoom:t.zoom)&&t.setZoom(+a.zoom),a.center!==void 0&&t.setCenter(h.V.convert(a.center))}handleEaseTo(t,a){const l=t.zoom,f=t.padding,_={roll:t.roll,pitch:t.pitch,bearing:t.bearing},b={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},w=a.zoom!==void 0,A=!t.isPaddingEqual(a.padding);let I=!1;const O=w?+a.zoom:t.zoom;let j=t.centerPoint.add(a.offsetAsPoint);const k=t.screenPointToLocation(j),{center:G,zoom:X}=t.applyConstrain(h.V.convert(a.center||k),O??l);ss(t,G);const ee=vt(t.worldSize,k),ie=vt(t.worldSize,G).sub(ee),te=h.aq(X-l);return I=X!==l,{easeFunc:ae=>{if(I&&t.setZoom(h.G.number(l,X,ae)),h.bo(_,b)||Fu({startEulerAngles:_,endEulerAngles:b,tr:t,k:ae,useSlerp:_.roll!=b.roll}),A&&(t.interpolatePadding(f,a.padding,ae),j=t.centerPoint.add(a.offsetAsPoint)),a.around)t.setLocationAtPoint(a.around,a.aroundPoint);else{const ce=h.aq(t.zoom-l),re=X>l?Math.min(2,te):Math.max(.5,te),ue=Math.pow(re,1-ae),de=Rt(t.worldSize,ee.add(ie.mult(ae*ue)).mult(ce));t.setLocationAtPoint(t.renderWorldCopies?de.wrap():de,j)}},isZooming:I,elevationCenter:G}}handleFlyTo(t,a){const l=a.zoom!==void 0,f=t.zoom,_=t.applyConstrain(h.V.convert(a.center||a.locationAtOffset),l?+a.zoom:f),b=_.center,w=_.zoom;ss(t,b);const A=vt(t.worldSize,a.locationAtOffset),I=vt(t.worldSize,b).sub(A),O=I.mag(),j=h.aq(w-f);let k;if(a.minZoom!==void 0){const G=Math.min(+a.minZoom,f,w),X=t.applyConstrain(b,G).zoom;k=h.aq(X-f)}return{easeFunc:(G,X,ee,ie)=>{t.setZoom(G===1?w:f+h.at(X));const te=G===1?b:Rt(t.worldSize,A.add(I.mult(ee)).mult(X));t.setLocationAtPoint(t.renderWorldCopies?te.wrap():te,ie)},scaleOfZoom:j,targetCenter:b,scaleOfMinZoom:k,pixelPathLength:O}}}class Mi{constructor(t,a,l){this.blendFunction=t,this.blendColor=a,this.mask=l}}Mi.Replace=[1,0],Mi.disabled=new Mi(Mi.Replace,h.bp.transparent,[!1,!1,!1,!1]),Mi.unblended=new Mi(Mi.Replace,h.bp.transparent,[!0,!0,!0,!0]),Mi.alphaBlended=new Mi([1,771],h.bp.transparent,[!0,!0,!0,!0]);const ho=2305;class Xt{constructor(t,a,l){this.enable=t,this.mode=a,this.frontFace=l}}Xt.disabled=new Xt(!1,1029,ho),Xt.backCCW=new Xt(!0,1029,ho),Xt.frontCCW=new Xt(!0,1028,ho);class jt{constructor(t,a,l){this.func=t,this.mask=a,this.range=l}}jt.ReadOnly=!1,jt.ReadWrite=!0,jt.disabled=new jt(519,jt.ReadOnly,[0,1]);const Qo=7680;class ri{constructor(t,a,l,f,_,b){this.test=t,this.ref=a,this.mask=l,this.fail=f,this.depthFail=_,this.pass=b}}ri.disabled=new ri({func:519,mask:0},0,0,Qo,Qo,Qo);const ju=new WeakMap;function _a(m){var t;if(ju.has(m))return ju.get(m);{const a=(t=m.getParameter(m.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return ju.set(m,a),a}}class fo{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const a=t.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const f=new h.aW;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const _=new h.aY;_.emplaceBack(0,1,2),this._fullscreenTriangle=new Ri(a.createVertexBuffer(f,ga.members),a.createIndexBuffer(_),h.aX.simpleSegment(0,0,f.length,_.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const b=l.createTexture();l.bindTexture(l.TEXTURE_2D,b),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(b),_a(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,a=t.gl;t.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,a){const l=this._cachedRenderContext.context,f=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:h.bp.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,f.TRIANGLES,jt.disabled,ri.disabled,Mi.unblended,Xt.disabled,((_,b)=>({u_input:_,u_output_expected:b}))(t,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&_a(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const _=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:_}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&_a(t)){const a=t.clientWaitSync(this._readbackQueue.sync,0,0);if(a===t.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=fo._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let a=0;return a+=t[0]/256,a+=t[1]/65536,a+=t[2]/16777216,t[3]<127&&(a=-a),a/128}}const po=h.a5/128;function fd(m,t){const a=m.granularity!==void 0?Math.max(m.granularity,1):1,l=a+(m.generateBorders?2:0),f=a+(m.extendToNorthPole||m.generateBorders?1:0)+(m.extendToSouthPole||m.generateBorders?1:0),_=l+1,b=f+1,w=m.generateBorders?-1:0,A=m.generateBorders||m.extendToNorthPole?-1:0,I=a+(m.generateBorders?1:0),O=a+(m.generateBorders||m.extendToSouthPole?1:0),j=_*b,k=l*f*6,G=_*b>65536;if(G&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const X=G||t==="32bit",ee=new Int16Array(2*j);let ie=0;for(let ce=A;ce<=O;ce++)for(let re=w;re<=I;re++){let ue=re/a*h.a5;re===-1&&(ue=-po),re===a+1&&(ue=h.a5+po);let de=ce/a*h.a5;ce===-1&&(de=m.extendToNorthPole?h.br:-po),ce===a+1&&(de=m.extendToSouthPole?h.bs:h.a5+po),ee[ie++]=ue,ee[ie++]=de}const te=X?new Uint32Array(k):new Uint16Array(k);let ae=0;for(let ce=0;ce<f;ce++)for(let re=0;re<l;re++){const ue=re+1+ce*_,de=re+(ce+1)*_,oe=re+1+(ce+1)*_;te[ae++]=re+ce*_,te[ae++]=de,te[ae++]=ue,te[ae++]=ue,te[ae++]=de,te[ae++]=oe}return{vertices:ee.buffer.slice(0),indices:te.buffer.slice(0),uses32bitIndices:X}}const Nu=new h.aV({fill:new h.bt(128,2),line:new h.bt(512,0),tile:new h.bt(128,32),stencil:new h.bt(128,1),circle:3});class Gh{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Qi.projectionGlobe}get vertexShaderPreludeCode(){return Qi.projectionMercator.vertexSource}get subdivisionGranularity(){return Nu}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new fo(t));const a=h.X(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(a,l),_=rt();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=_);const b=Math.min(Math.max((_-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.bu(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.bv(b))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,a,l,f,_){const b=(_==="stencil"?Nu.stencil:Nu.tile).getGranularityForZoomLevel(a.z);return this._getMesh(t,{granularity:b,generateBorders:l,extendToNorthPole:a.y===0&&f,extendToSouthPole:a.y===(1<<a.z)-1&&f})}_getMesh(t,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const f=(function(_,b){const w=fd(b,"16bit"),A=h.aW.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),I=h.aY.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Ri(_.createVertexBuffer(A,ga.members),_.createIndexBuffer(I),h.aX.simpleSegment(0,0,A.length,I.length))})(t,a);return this._tileMeshCache[l]=f,f}recalculate(t){}hasTransition(){const t=rt();let a=!1;return a=a||(t-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Fp=new h.t({type:new h.D(h.u.projection.type)});class qh extends h.E{constructor(t){super(),this._transitionable=new h.x(Fp,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.H(0)),this._mercatorProjection=new Zn,this._verticalPerspectiveProjection=new Gh}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof h.bw){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,a,l,f,_){return this.currentProjection.getMeshFromTileID(t,a,l,f,_)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Cr(m){const t=Ko(m.worldSize,m.center.lat);return 2*Math.PI*t}function os(m,t,a,l,f){const _=1/(1<<f),b=t/h.a5*_+l*_,w=h.by((m/h.a5*_+a*_)*Math.PI*2+Math.PI,2*Math.PI),A=2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI,I=Math.cos(A),O=new Float64Array(3);return O[0]=Math.sin(w)*I,O[1]=Math.sin(A),O[2]=Math.cos(w)*I,O}function Wi(m){return(function(t,a){const l=Math.cos(a),f=new Float64Array(3);return f[0]=Math.sin(t)*l,f[1]=Math.sin(a),f[2]=Math.cos(t)*l,f})(m.lng*Math.PI/180,m.lat*Math.PI/180)}function Ko(m,t){return m/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Vu(m){const t=Math.asin(m[1])/Math.PI*180,a=Math.sqrt(m[0]*m[0]+m[2]*m[2]);if(a>1e-6){const l=m[0]/a,f=Math.acos(m[2]/a),_=(l>0?f:-f)/Math.PI*180;return new h.V(h.W(_,-180,180),t)}return new h.V(0,t)}function Uu(m){return Math.cos(m*Math.PI/180)}function mn(m,t){const a=Uu(m),l=Uu(t);return h.at(l/a)}function dd(m,t){const a=m.rotate(t.bearingInRadians),l=t.zoom+mn(t.center.lat,0),f=h.bu(1/Uu(t.center.lat),1/Uu(Math.min(Math.abs(t.center.lat),60)),h.bx(l,7,3,0,1)),_=360/Cr({worldSize:t.worldSize,center:{lat:t.center.lat}});return new h.V(t.center.lng-a.x*_*f,h.an(t.center.lat+a.y*_,-h.ao,h.ao))}function Nc(m){const t=.5*m,a=Math.sin(t),l=Math.cos(t);return Math.log(a+l)-Math.log(l-a)}function pd(m,t,a,l){const f=m.lat+a*l;if(Math.abs(a)>1){const _=(Math.sign(m.lat+a)!==Math.sign(m.lat)?-Math.abs(m.lat):Math.abs(m.lat))*Math.PI/180,b=Math.abs(m.lat+a)*Math.PI/180,w=Nc(_+l*(b-_)),A=Nc(_),I=Nc(b);return new h.V(m.lng+t*((w-A)/(I-A)),f)}return new h.V(m.lng+t*l,f)}class jp{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,a,l,f){const _=`${t.z}_${t.x}_${t.y}_${f?.terrain?"t":""}`,b=this._cache.get(_);if(b)return b;const w=this._cachePrevious.get(_);if(w)return this._cache.set(_,w),w;const A=this._boundingVolumeFactory(t,a,l,f);return this._cache.set(_,A),this._hadAnyChanges=!0,A}}class Zl{constructor(t,a,l,f){this.min=l,this.max=f,this.points=t,this.planes=a}static fromAabb(t,a){const l=[];for(let f=0;f<8;f++)l.push([1&~f?t[0]:a[0],(f>>1&1)==1?a[1]:t[1],(f>>2&1)==1?a[2]:t[2]]);return new Zl(l,[[-1,0,0,a[0]],[1,0,0,-t[0]],[0,-1,0,a[1]],[0,1,0,-t[1]],[0,0,-1,a[2]],[0,0,1,-t[2]]],t,a)}static fromCenterSizeAngles(t,a,l){const f=h.bB([],l[0],l[1],l[2]),_=h.bC([],[a[0],0,0],f),b=h.bC([],[0,a[1],0],f),w=h.bC([],[0,0,a[2]],f),A=[...t],I=[...t];for(let j=0;j<8;j++)for(let k=0;k<3;k++){const G=t[k]+_[k]*(1&~j?-1:1)+b[k]*((j>>1&1)==1?1:-1)+w[k]*((j>>2&1)==1?1:-1);A[k]=Math.min(A[k],G),I[k]=Math.max(I[k],G)}const O=[];for(let j=0;j<8;j++){const k=[...t];h.b0(k,k,h.a$([],_,1&~j?-1:1)),h.b0(k,k,h.a$([],b,(j>>1&1)==1?1:-1)),h.b0(k,k,h.a$([],w,(j>>2&1)==1?1:-1)),O.push(k)}return new Zl(O,[[..._,-h.b5(_,O[0])],[...b,-h.b5(b,O[0])],[...w,-h.b5(w,O[0])],[-_[0],-_[1],-_[2],-h.b5(_,O[7])],[-b[0],-b[1],-b[2],-h.b5(b,O[7])],[-w[0],-w[1],-w[2],-h.b5(w,O[7])]],A,I)}intersectsFrustum(t){let a=!0;const l=this.points.length,f=this.planes.length,_=t.planes.length,b=t.points.length;for(let w=0;w<_;w++){const A=t.planes[w];let I=0;for(let O=0;O<l;O++){const j=this.points[O];A[0]*j[0]+A[1]*j[1]+A[2]*j[2]+A[3]>=0&&I++}if(I===0)return 0;I<l&&(a=!1)}if(a)return 2;for(let w=0;w<f;w++){const A=this.planes[w];let I=0;for(let O=0;O<b;O++){const j=t.points[O];A[0]*j[0]+A[1]*j[1]+A[2]*j[2]+A[3]>=0&&I++}if(I===0)return 0}return 1}intersectsPlane(t){const a=this.points.length;let l=0;for(let f=0;f<a;f++){const _=this.points[f];t[0]*_[0]+t[1]*_[1]+t[2]*_[2]+t[3]>=0&&l++}return l===a?2:l===0?0:1}}function Vc(m,t,a){const l=m-t;return l<0?-l:Math.max(0,l-a)}function Hl(m,t,a,l,f){const _=m-a;let b;return b=_<0?Math.min(-_,1+_-f):_>1?Math.min(Math.max(_-f,0),1-_):0,Math.max(b,Vc(t,l,f))}class Zh{constructor(){this._boundingVolumeCache=new jp(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,a,l,f){const _=1<<l.z,b=1/_,w=l.x/_,A=l.y/_;let I=2;return I=Math.min(I,Hl(t,a,w,A,b)),I=Math.min(I,Hl(t,a,w+.5,-A-b,b)),I=Math.min(I,Hl(t,a,w+.5,2-A-b,b)),I}getWrap(t,a,l){const f=1<<a.z,_=1/f,b=a.x/f,w=Vc(t.x,b,_),A=Vc(t.x,b-1,_),I=Vc(t.x,b+1,_),O=Math.min(w,A,I);return O===I?1:O===A?-1:0}allowVariableZoom(t,a){return Ei(t,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,a,l,f){return this._boundingVolumeCache.getTileBoundingVolume(t,a,l,f)}_computeTileBoundingVolume(t,a,l,f){var _,b;let w=0,A=0;if(f?.terrain){const I=new h.a2(t.z,a,t.z,t.x,t.y),O=f.terrain.getMinMaxElevation(I);w=(_=O.minElevation)!==null&&_!==void 0?_:Math.min(0,l),A=(b=O.maxElevation)!==null&&b!==void 0?b:Math.max(0,l)}if(w/=h.bE,A/=h.bE,w+=1,A+=1,t.z<=0)return Zl.fromAabb([-A,-A,-A],[A,A,A]);if(t.z===1)return Zl.fromAabb([t.x===0?-A:0,t.y===0?0:-A,-A],[t.x===0?0:A,t.y===0?A:0,A]);{const I=[os(0,0,t.x,t.y,t.z),os(h.a5,0,t.x,t.y,t.z),os(h.a5,h.a5,t.x,t.y,t.z),os(0,h.a5,t.x,t.y,t.z)],O=[];for(const ze of I)O.push(h.a$([],ze,A));if(A!==w)for(const ze of I)O.push(h.a$([],ze,w));t.y===0&&O.push([0,1,0]),t.y===(1<<t.z)-1&&O.push([0,-1,0]);const j=[1,1,1],k=[-1,-1,-1];for(const ze of O)for(let Pe=0;Pe<3;Pe++)j[Pe]=Math.min(j[Pe],ze[Pe]),k[Pe]=Math.max(k[Pe],ze[Pe]);const G=os(h.a5/2,h.a5/2,t.x,t.y,t.z),X=h.b4([],[0,1,0],G);h.b3(X,X);const ee=h.b4([],G,X);h.b3(ee,ee);const ie=h.b4([],I[2],I[1]);h.b3(ie,ie);const te=h.b4([],I[0],I[3]);h.b3(te,te),O.push(h.a$([],G,A)),t.y>=(1<<t.z)/2&&O.push(h.a$([],os(h.a5/2,0,t.x,t.y,t.z),A)),t.y<(1<<t.z)/2&&O.push(h.a$([],os(h.a5/2,h.a5,t.x,t.y,t.z),A));const ae=Gu(G,O),ce=Gu(ee,O),re=[-G[0],-G[1],-G[2],ae.max],ue=[G[0],G[1],G[2],-ae.min],de=[-ee[0],-ee[1],-ee[2],ce.max],oe=[ee[0],ee[1],ee[2],-ce.min],ye=[...ie,0],Ie=[...te,0],Me=[];return t.y===0?Me.push(h.bD(Ie,ye,re),h.bD(Ie,ye,ue)):Me.push(h.bD(de,ye,re),h.bD(de,ye,ue),h.bD(de,Ie,re),h.bD(de,Ie,ue)),t.y===(1<<t.z)-1?Me.push(h.bD(Ie,ye,re),h.bD(Ie,ye,ue)):Me.push(h.bD(oe,ye,re),h.bD(oe,ye,ue),h.bD(oe,Ie,re),h.bD(oe,Ie,ue)),new Zl(Me,[re,ue,de,oe,ye,Ie],j,k)}}}function Gu(m,t){let a=1/0,l=-1/0;for(const f of t){const _=h.b5(m,f);a=Math.min(a,_),l=Math.max(l,_)}return{min:a,max:l}}class $l{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a){this._helper.resize(t,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(t){this._cachedClippingPlane=h.bF(),this._projectionMatrix=h.bj(),this._globeViewProjMatrix32f=h.bi(),this._globeViewProjMatrixNoCorrection=h.bj(),this._globeViewProjMatrixNoCorrectionInverted=h.bj(),this._globeProjMatrixInverted=h.bj(),this._cameraPosition=h.bz(),this._globeLatitudeErrorCorrectionRadians=0,this.defaultConstrain=(a,l)=>{const f=h.an(a.lat,-h.ao,h.ao),_=h.an(+l,this.minZoom+mn(0,f),this.maxZoom);return{center:new h.V(a.lng,f),zoom:_}},this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new co({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._coveringTilesDetailsProvider=new Zh}clone(){const t=new $l;return t.apply(this,!1),t}apply(t,a,l){this._globeLatitudeErrorCorrectionRadians=l||0,this._helper.apply(t,a)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=h.bz();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:a,applyGlobeMatrix:l}=t,f=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const a=this.pitchInRadians,l=this.cameraToCenterDistance/t,f=Math.sin(a)*l,_=Math.cos(a)*l+1,b=1/Math.sqrt(f*f+_*_)*1;let w=-f,A=_;const I=Math.sqrt(w*w+A*A);w/=I,A/=I;const O=[0,w,A];h.bG(O,O,[0,0,0],-this.bearingInRadians),h.bH(O,O,[0,0,0],-1*this.center.lat*Math.PI/180),h.bI(O,O,[0,0,0],this.center.lng*Math.PI/180);const j=1/h.b7(O);return h.a$(O,O,j),[...O,-b*j]}isLocationOccluded(t){return!this.isSurfacePointVisible(Wi(t))}transformLightDirection(t){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,f=Math.cos(l),_=[Math.sin(a)*f,Math.sin(l),Math.cos(a)*f],b=[_[2],0,-_[0]],w=[0,0,0];h.b4(w,b,_),h.b3(b,b),h.b3(w,w);const A=[0,0,0];return h.b3(A,[b[0]*t[0]+w[0]*t[1]+_[0]*t[2],b[1]*t[0]+w[1]*t[1]+_[1]*t[2],b[2]*t[0]+w[2]*t[1]+_[2]*t[2]]),A}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,a,l){const f=(function(w,A,I){const O=1/(1<<I.z);return new h.a9(w/h.a5*O+I.x*O,A/h.a5*O+I.y*O)})(t,a,l.canonical),_=(b=f.y,[h.by(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-b*Math.PI*2))-.5*Math.PI]);var b;return this.getCircleRadiusCorrection()/Math.cos(_[1])}projectTileCoordinates(t,a,l,f){const _=l.canonical,b=os(t,a,_.x,_.y,_.z),w=1+(f?f(t,a):0)/h.bE,A=[b[0]*w,b[1]*w,b[2]*w,1];h.aH(A,A,this._globeViewProjMatrixNoCorrection);const I=this._cachedClippingPlane,O=I[0]*b[0]+I[1]*b[1]+I[2]*b[2]+I[3]<0;return{point:new h.P(A[0]/A[3],A[1]/A[3]),signedDistanceFromCamera:A[3],isOccluded:O}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Ko(this.worldSize,this.center.lat),a=h.bk(),l=h.bk();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),h.be(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;a[8]=2*-f.x/this._helper._width,a[9]=2*f.y/this._helper._height,this._projectionMatrix=h.bf(a),this._globeProjMatrixInverted=h.bk(),h.aB(this._globeProjMatrixInverted,a),h.O(a,a,[0,0,-this.cameraToCenterDistance]),h.bg(a,a,this.rollInRadians),h.bh(a,a,-this.pitchInRadians),h.bg(a,a,this.bearingInRadians),h.O(a,a,[0,0,-t]);const _=h.bz();_[0]=t,_[1]=t,_[2]=t,h.bh(l,a,this.center.lat*Math.PI/180),h.bJ(l,l,-this.center.lng*Math.PI/180),h.Q(l,l,_),this._globeViewProjMatrixNoCorrection=l,h.bh(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bJ(a,a,-this.center.lng*Math.PI/180),h.Q(a,a,_),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=h.bk(),h.aB(this._globeViewProjMatrixNoCorrectionInverted,l);const b=h.bz();this._cameraPosition=h.bz(),this._cameraPosition[2]=this.cameraToCenterDistance/t,h.bG(this._cameraPosition,this._cameraPosition,b,-this.rollInRadians),h.bH(this._cameraPosition,this._cameraPosition,b,this.pitchInRadians),h.bG(this._cameraPosition,this._cameraPosition,b,-this.bearingInRadians),h.b0(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bH(this._cameraPosition,this._cameraPosition,b,-this.center.lat*Math.PI/180),h.bI(this._cameraPosition,this._cameraPosition,b,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const w=h.bf(this._globeViewProjMatrixNoCorrectionInverted);h.Q(w,w,[1,1,-1]),this._cachedFrustum=Mr.fromInvProjectionMatrix(w,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){h.w("calculateFogMatrix is not supported on globe projection.");const a=h.bk();return h.ar(a),a}getVisibleUnwrappedCoordinates(t){return[new h.bc(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Wi(t);h.a$(l,l,1+a/h.bE);const f=h.bF();return h.aH(f,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,a=.5*this.height,l=[new h.P(0,0),new h.P(t,0),new h.P(this.width,0),new h.P(this.width,a),new h.P(this.width,this.height),new h.P(t,this.height),new h.P(0,this.height),new h.P(0,a)],f=[];for(const j of l)f.push(this.unprojectScreenPoint(j));let _=0,b=0,w=0,A=0;const I=this.center;for(const j of f){const k=h.bK(I.lng,j.lng),G=h.bK(I.lat,j.lat);k<b&&(b=k),k>_&&(_=k),G<A&&(A=G),G>w&&(w=G)}const O=[I.lng+b,I.lat+A,I.lng+_,I.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(O[3]=90,O[0]=-180,O[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(O[1]=-90,O[0]=-180,O[2]=180),new hn(O)}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}setLocationAtPoint(t,a){const l=Wi(this.unprojectScreenPoint(a)),f=Wi(t),_=h.bz();h.bL(_);const b=h.bz();h.bI(b,l,_,-this.center.lng*Math.PI/180),h.bH(b,b,_,this.center.lat*Math.PI/180);const w=f[0]*f[0]+f[2]*f[2],A=b[0]*b[0];if(w<A)return;const I=Math.sqrt(w-A),O=-I,j=h.bM(f[0],f[2],b[0],I),k=h.bM(f[0],f[2],b[0],O),G=h.bz();h.bI(G,f,_,-j);const X=h.bM(G[1],G[2],b[1],b[2]),ee=h.bz();h.bI(ee,f,_,-k);const ie=h.bM(ee[1],ee[2],b[1],b[2]),te=.5*Math.PI,ae=X>=-te&&X<=te,ce=ie>=-te&&ie<=te;let re,ue;if(ae&&ce){const Ie=this.center.lng*Math.PI/180,Me=this.center.lat*Math.PI/180;h.bN(j,Ie)+h.bN(X,Me)<h.bN(k,Ie)+h.bN(ie,Me)?(re=j,ue=X):(re=k,ue=ie)}else if(ae)re=j,ue=X;else{if(!ce)return;re=k,ue=ie}const de=re/Math.PI*180,oe=ue/Math.PI*180,ye=this.center.lat;this.setCenter(new h.V(de,h.an(oe,-90,90))),this.setZoom(this.zoom+mn(ye,this.center.lat))}locationToScreenPoint(t,a){const l=Wi(t);if(a){const f=a.getElevationForLngLatZoom(t,this._helper._tileZoom);h.a$(l,l,1+f/h.bE)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(t){const a=h.bF();return h.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new h.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,a){if(a){const l=a.pointCoordinate(t);if(l)return l}return h.a9.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,a){var l;return(l=this.screenPointToMercatorCoordinate(t,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(t,a){const l=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(l,f)}getRayDirectionFromPixel(t){const a=h.bF();a[0]=t.x/this.width*2-1,a[1]=-1*(t.y/this.height*2-1),a[2]=1,a[3]=1,h.aH(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=h.bz();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const f=h.bz();return h.b3(f,l),f}isSurfacePointVisible(t){const a=this._cachedClippingPlane;return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const a=h.bF();return h.aH(a,[...t,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(t,a){const l=h.b5(t,a),f=h.bz(),_=h.bz();h.a$(_,a,l),h.b2(f,t,_);const b=1-h.b5(f,f);if(b<0)return null;const w=h.b5(t,t)-1,A=-l+(l<0?1:-1)*Math.sqrt(b),I=w/A,O=A;return{tMin:Math.min(I,O),tMax:Math.max(I,O)}}unprojectScreenPoint(t){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(a,l);if(f){const O=h.bz();h.b0(O,a,[l[0]*f.tMin,l[1]*f.tMin,l[2]*f.tMin]);const j=h.bz();return h.b3(j,O),Vu(j)}const _=this._cachedClippingPlane,b=_[0]*l[0]+_[1]*l[1]+_[2]*l[2],w=-h.bb(_,a)/b,A=h.bz();if(w>0)h.b0(A,a,[l[0]*w,l[1]*w,l[2]*w]);else{const O=h.bz();h.b0(O,a,[2*l[0],2*l[1],2*l[2]]);const j=h.bb(this._cachedClippingPlane,O);h.b2(A,O,[this._cachedClippingPlane[0]*j,this._cachedClippingPlane[1]*j,this._cachedClippingPlane[2]*j])}const I=(function(O){const j=h.bz();return j[0]=O[0]*-O[3],j[1]=O[1]*-O[3],j[2]=O[2]*-O[3],{center:j,radius:Math.sqrt(1-O[3]*O[3])}})(_);return Vu((function(O,j,k){const G=h.bz();h.b2(G,k,O);const X=h.bz();return h.bA(X,O,G,j/h.b9(G)),X})(I.center,I.radius,A))}getMatrixForModel(t,a){const l=h.V.convert(t),f=1/h.bE,_=h.bj();return h.bJ(_,_,l.lng/180*Math.PI),h.bh(_,_,-l.lat/180*Math.PI),h.O(_,_,[0,0,1+a/h.bE]),h.bh(_,_,.5*Math.PI),h.Q(_,_,[f,f,f]),_}getProjectionDataForCustomLayer(t=!0){const a=this.getProjectionData({overscaledTileID:new h.a2(0,0,0,0,0),applyGlobeMatrix:t});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(t){}}class Xl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,a,l){return this._helper.interpolatePadding(t,a,l)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,a,l=!0){this._helper.resize(t,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}setConstrainOverride(t){this._helper.setConstrainOverride(t)}overrideNearFarZ(t,a){this._helper.overrideNearFarZ(t,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get constrainOverride(){return this._helper.constrainOverride}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,a){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(t){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this.defaultConstrain=(a,l)=>this.currentTransform.defaultConstrain(a,l),this.applyConstrain=(a,l)=>this._helper.applyConstrain(a,l),this._helper=new co({calcMatrices:()=>{this._calcMatrices()},defaultConstrain:(a,l)=>this.defaultConstrain(a,l)},t),this._globeness=1,this._mercatorTransform=new kn,this._verticalPerspectiveTransform=new $l}clone(){const t=new Xl;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this,!1),t}apply(t,a){this._helper.apply(t,a),this._mercatorTransform.apply(this,!1),this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const a=this._mercatorTransform.getProjectionData(t),l=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return h.bu(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.bu(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,a,l){const f=this._mercatorTransform.getPitchedTextCorrection(t,a,l),_=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,a,l);return h.bu(f,_,this._globeness)}projectTileCoordinates(t,a,l,f){return this.currentTransform.projectTileCoordinates(t,a,l,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,!1,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,a){return this.currentTransform.lngLatToCameraDepth(t,a)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}calculateCenterFromCameraLngLatAlt(t,a,l,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,a,l,f)}setLocationAtPoint(t,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,a),void this.apply(this._mercatorTransform,!1);this._verticalPerspectiveTransform.setLocationAtPoint(t,a),this.apply(this._verticalPerspectiveTransform,!1)}locationToScreenPoint(t,a){return this.currentTransform.locationToScreenPoint(t,a)}screenPointToMercatorCoordinate(t,a){return this.currentTransform.screenPointToMercatorCoordinate(t,a)}screenPointToLocation(t,a){return this.currentTransform.screenPointToLocation(t,a)}isPointOnMapSurface(t,a){return this.currentTransform.isPointOnMapSurface(t,a)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,a){return this.currentTransform.getMatrixForModel(t,a)}getProjectionDataForCustomLayer(t=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class wn{get useGlobeControls(){return!0}handlePanInertia(t,a){const l=dd(t,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,a){const l=t.around,f=a.screenPointToLocation(l);t.bearingDelta&&a.setBearing(a.bearing+t.bearingDelta),t.pitchDelta&&a.setPitch(a.pitch+t.pitchDelta),t.rollDelta&&a.setRoll(a.roll+t.rollDelta);const _=a.zoom;t.zoomDelta&&a.setZoom(a.zoom+t.zoomDelta);const b=a.zoom-_;if(b===0)return;const w=h.bK(a.center.lng,f.lng),A=w/(Math.abs(w/180)+1),I=h.bK(a.center.lat,f.lat),O=a.getRayDirectionFromPixel(l),j=a.cameraPosition,k=-1*h.b5(j,O),G=h.bz();h.b0(G,j,[O[0]*k,O[1]*k,O[2]*k]);const X=h.b7(G)-1,ee=Math.exp(.5*-Math.max(X-.3,0)),ie=Ko(a.worldSize,a.center.lat)/Math.min(a.width,a.height),te=h.bx(ie,.9,.5,1,.25),ae=(1-h.aq(-b))*Math.min(ee,te),ce=a.center.lat,re=a.zoom,ue=new h.V(a.center.lng+A*ae,h.an(a.center.lat+I*ae,-h.ao,h.ao));a.setLocationAtPoint(f,l);const de=a.center,oe=h.bx(Math.abs(w),45,85,0,1),ye=h.bx(ie,.75,.35,0,1),Ie=Math.pow(Math.max(oe,ye),.25),Me=h.bK(de.lng,ue.lng),ze=h.bK(de.lat,ue.lat);a.setCenter(new h.V(de.lng+Me*Ie,de.lat+ze*Ie).wrap()),a.setZoom(re+mn(ce,a.center.lat))}handleMapControlsPan(t,a,l){if(!t.panDelta)return;const f=a.center.lat,_=a.zoom;a.setCenter(dd(t.panDelta,a).wrap()),a.setZoom(_+mn(f,a.center.lat))}cameraForBoxAndBearing(t,a,l,f,_){const b=Xo(t,a,l,f,_),w=a.left/_.width*2-1,A=(_.width-a.right)/_.width*2-1,I=a.top/_.height*-2+1,O=(_.height-a.bottom)/_.height*-2+1,j=h.bK(l.getWest(),l.getEast())<0,k=j?l.getEast():l.getWest(),G=j?l.getWest():l.getEast(),X=Math.max(l.getNorth(),l.getSouth()),ee=Math.min(l.getNorth(),l.getSouth()),ie=k+.5*h.bK(k,G),te=X+.5*h.bK(X,ee),ae=_.clone();ae.setCenter(b.center),ae.setBearing(b.bearing),ae.setPitch(0),ae.setRoll(0),ae.setZoom(b.zoom);const ce=ae.modelViewProjectionMatrix,re=[Wi(l.getNorthWest()),Wi(l.getNorthEast()),Wi(l.getSouthWest()),Wi(l.getSouthEast()),Wi(new h.V(G,te)),Wi(new h.V(k,te)),Wi(new h.V(ie,X)),Wi(new h.V(ie,ee))],ue=Wi(b.center);let de=Number.POSITIVE_INFINITY;for(const oe of re)w<0&&(de=wn.getLesserNonNegativeNonNull(de,wn.solveVectorScale(oe,ue,ce,"x",w))),A>0&&(de=wn.getLesserNonNegativeNonNull(de,wn.solveVectorScale(oe,ue,ce,"x",A))),I>0&&(de=wn.getLesserNonNegativeNonNull(de,wn.solveVectorScale(oe,ue,ce,"y",I))),O<0&&(de=wn.getLesserNonNegativeNonNull(de,wn.solveVectorScale(oe,ue,ce,"y",O)));if(Number.isFinite(de)&&de!==0)return b.zoom=ae.zoom+h.at(de),b;Ar()}handleJumpToCenterZoom(t,a){const l=t.center.lat,f=t.applyConstrain(a.center?h.V.convert(a.center):t.center,t.zoom).center;t.setCenter(f.wrap());const _=a.zoom!==void 0?+a.zoom:t.zoom+mn(l,f.lat);t.zoom!==_&&t.setZoom(_)}handleEaseTo(t,a){const l=t.zoom,f=t.center,_=t.padding,b={roll:t.roll,pitch:t.pitch,bearing:t.bearing},w={roll:a.roll===void 0?t.roll:a.roll,pitch:a.pitch===void 0?t.pitch:a.pitch,bearing:a.bearing===void 0?t.bearing:a.bearing},A=a.zoom!==void 0,I=!t.isPaddingEqual(a.padding);let O=!1;const j=a.center?h.V.convert(a.center):f,k=t.applyConstrain(j,l).center;ss(t,k);const G=t.clone();G.setCenter(k),G.setZoom(A?+a.zoom:l+mn(f.lat,j.lat)),G.setBearing(a.bearing);const X=new h.P(h.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),h.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));G.setLocationAtPoint(k,X);const ee=(a.offset&&a.offsetAsPoint.mag())>0?G.center:k,ie=A?+a.zoom:l+mn(f.lat,ee.lat),te=l+mn(f.lat,0),ae=ie+mn(ee.lat,0),ce=h.bK(f.lng,ee.lng),re=h.bK(f.lat,ee.lat),ue=h.aq(ae-te);return O=ie!==l,{easeFunc:de=>{if(h.bo(b,w)||Fu({startEulerAngles:b,endEulerAngles:w,tr:t,k:de,useSlerp:b.roll!=w.roll}),I&&t.interpolatePadding(_,a.padding,de),a.around)h.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(a.around,a.aroundPoint);else{const oe=ae>te?Math.min(2,ue):Math.max(.5,ue),ye=Math.pow(oe,1-de),Ie=pd(f,ce,re,de*ye);t.setCenter(Ie.wrap())}if(O){const oe=h.G.number(te,ae,de)+mn(0,t.center.lat);t.setZoom(oe)}},isZooming:O,elevationCenter:ee}}handleFlyTo(t,a){const l=a.zoom!==void 0,f=t.center,_=t.zoom,b=t.padding,w=!t.isPaddingEqual(a.padding),A=t.applyConstrain(h.V.convert(a.center||a.locationAtOffset),_).center,I=l?+a.zoom:t.zoom+mn(t.center.lat,A.lat),O=t.clone();O.setCenter(A),O.setZoom(I),O.setBearing(a.bearing);const j=new h.P(h.an(t.centerPoint.x+a.offsetAsPoint.x,0,t.width),h.an(t.centerPoint.y+a.offsetAsPoint.y,0,t.height));O.setLocationAtPoint(A,j);const k=O.center;ss(t,k);const G=(function(re,ue,de){const oe=Wi(ue),ye=Wi(de),Ie=h.b5(oe,ye),Me=Math.acos(Ie),ze=Cr(re);return Me/(2*Math.PI)*ze})(t,f,k),X=_+mn(f.lat,0),ee=I+mn(k.lat,0),ie=h.aq(ee-X);let te;if(typeof a.minZoom=="number"){const re=+a.minZoom+mn(k.lat,0),ue=Math.min(re,X,ee)+mn(0,k.lat),de=t.applyConstrain(k,ue).zoom+mn(k.lat,0);te=h.aq(de-X)}const ae=h.bK(f.lng,k.lng),ce=h.bK(f.lat,k.lat);return{easeFunc:(re,ue,de,oe)=>{const ye=pd(f,ae,ce,de);w&&t.interpolatePadding(b,a.padding,re);const Ie=re===1?k:ye;t.setCenter(Ie.wrap());const Me=X+h.at(ue);t.setZoom(re===1?I:Me+mn(0,Ie.lat))},scaleOfZoom:ie,targetCenter:k,scaleOfMinZoom:te,pixelPathLength:G}}static solveVectorScale(t,a,l,f,_){const b=f==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],A=t[0]*b[0]+t[1]*b[1]+t[2]*b[2],I=t[0]*w[0]+t[1]*w[1]+t[2]*w[2],O=a[0]*b[0]+a[1]*b[1]+a[2]*b[2],j=a[0]*w[0]+a[1]*w[1]+a[2]*w[2];return O+_*I===A+_*j||w[3]*(A-O)+b[3]*(j-I)+A*j==O*I?null:(O+b[3]-_*j-_*w[3])/(O-A-_*j+_*I)}static getLesserNonNegativeNonNull(t,a){return a!==null&&a>=0&&a<t?a:t}}class Yl{constructor(t){this._globe=t,this._mercatorCameraHelper=new Yo,this._verticalPerspectiveCameraHelper=new wn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,a){return this.currentHelper.handlePanInertia(t,a)}handleMapControlsRollPitchBearingZoom(t,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,a)}handleMapControlsPan(t,a,l){this.currentHelper.handleMapControlsPan(t,a,l)}cameraForBoxAndBearing(t,a,l,f,_){return this.currentHelper.cameraForBoxAndBearing(t,a,l,f,_)}handleJumpToCenterZoom(t,a){this.currentHelper.handleJumpToCenterZoom(t,a)}handleEaseTo(t,a){return this.currentHelper.handleEaseTo(t,a)}handleFlyTo(t,a){return this.currentHelper.handleFlyTo(t,a)}}const Ql=(m,t)=>h.B(m,t&&t.filter((a=>a.identifier!=="source.canvas"))),Kl=h.bO();class mo extends h.E{constructor(t,a={}){var l,f;super(),this._rtlPluginLoaded=()=>{for(const b in this.tileManagers){const w=this.tileManagers[b].getSource().type;w!=="vector"&&w!=="geojson"||this.tileManagers[b].reload()}},this.map=t,this.dispatcher=new Tr(qi(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((b,w)=>this.getGlyphs(b,w))),this.dispatcher.registerMessageHandler("GI",((b,w)=>this.getImages(b,w))),this.dispatcher.registerMessageHandler("GDA",((b,w)=>this.getDashes(b,w))),this.imageManager=new Ni,this.imageManager.setEventedParent(this);const _=((l=t._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((f=document.documentElement)===null||f===void 0?void 0:f.lang)||void 0;this.glyphManager=new ot(t._requestManager,a.localIdeographFontFamily,_),this.lineAtlas=new pt(256,512),this.crossTileSymbolIndex=new qn,this._setInitialValues(),this._resetUpdates(),this.dispatcher.broadcast("SR",h.bP()),we().on(fe,this._rtlPluginLoaded),this.on("data",(b=>{if(b.dataType!=="source"||b.sourceDataType!=="metadata")return;const w=this.tileManagers[b.sourceId];if(!w)return;const A=w.getSource();if(A&&A.vectorLayerIds)for(const I in this._layers){const O=this._layers[I];O.source===A.id&&this._validateLayer(O)}}))}_setInitialValues(){var t;this._spritesImagesIds={},this._layers={},this._order=[],this.tileManagers={},this.zoomHistory=new h.bQ,this._availableImages=[],this._globalState={},this._serializedLayers={},this.stylesheet=null,this.light=null,this.sky=null,this.projection&&(this.projection.destroy(),delete this.projection),this._loaded=!1,this._changed=!1,this._updatedLayers={},this._updatedSources={},this._changedImages={},this._glyphsDidChange=!1,this._updatedPaintProps={},this._layerOrderChanged=!1,this.crossTileSymbolIndex=new(((t=this.crossTileSymbolIndex)===null||t===void 0?void 0:t.constructor)||Object),this.pauseablePlacement=void 0,this.placement=void 0,this.z=0}setGlobalStateProperty(t,a){var l,f,_;this._checkLoaded();const b=a===null?(_=(f=(l=this.stylesheet.state)===null||l===void 0?void 0:l[t])===null||f===void 0?void 0:f.default)!==null&&_!==void 0?_:null:a;if(h.bR(b,this._globalState[t]))return this;this._globalState[t]=b,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const a=[];for(const l in t)!h.bR(this._globalState[l],t[l].default)&&(a.push(l),this._globalState[l]=t[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(t){if(t.length===0)return;const a=new Set,l={};for(const f of t){l[f]=this._globalState[f];for(const _ in this._layers){const b=this._layers[_],w=b.getLayoutAffectingGlobalStateRefs(),A=b.getPaintAffectingGlobalStateRefs(),I=b.getVisibilityAffectingGlobalStateRefs();if(w.has(f)&&a.add(b.source),A.has(f))for(const{name:O,value:j}of A.get(f))this._updatePaintProperty(b,O,j);I?.has(f)&&(b.recalculateVisibility(),this._updateLayer(b))}}this.dispatcher.broadcast("UGS",l);for(const f in this.tileManagers)a.has(f)&&(this._reloadSource(f),this._changed=!0)}loadURL(t,a={},l){this.fire(new h.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const _=this._loadStyleRequest;h.j(f,this._loadStyleRequest).then((b=>{this._loadStyleRequest=null,this._load(b.data,a,l)})).catch((b=>{this._loadStyleRequest=null,b&&!_.signal.aborted&&this.fire(new h.k(b))}))}loadJSON(t,a={},l){this.fire(new h.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,yt.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(t,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new h.l("dataloading",{dataType:"style"})),this._load(Kl,{validate:!1})}_load(t,a,l){var f,_;let b=a.transformStyle?a.transformStyle(l,t):t;if(!a.validate||!Ql(this,h.C(b))){b=Object.assign({},b),this._loaded=!0,this.stylesheet=b;for(const w in b.sources)this.addSource(w,b.sources[w],{validate:!1});b.sprite?this._loadSprite(b.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(b.glyphs),this._createLayers(),this.light=new mi(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Ke(this.stylesheet.sky),this.map.setTerrain((_=this.stylesheet.terrain)!==null&&_!==void 0?_:null),this.fire(new h.l("data",{dataType:"style"})),this.fire(new h.l("style.load"))}}_createLayers(){var t,a,l;const f=h.bS(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",f),this._order=f.map((_=>_.id)),this._layers={},this._serializedLayers=null;for(const _ of f){const b=h.bT(_,this._globalState);if(b.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=b,h.bU(b)&&this.tileManagers[b.source]){const w=(l=(a=_.paint)===null||a===void 0?void 0:a["raster-fade-duration"])!==null&&l!==void 0?l:b.paint.get("raster-fade-duration");this.tileManagers[b.source].setRasterFadeDuration(w)}}}_loadSprite(t,a=!1,l=void 0){this.imageManager.setLoaded(!1);const f=new AbortController;let _;this._spriteRequest=f,(function(b,w,A,I){return h._(this,void 0,void 0,(function*(){const O=cn(b),j=A>1?"@2x":"",k={},G={};for(const{id:X,url:ee}of O){const ie=w.transformRequest(Vn(ee,j,".json"),"SpriteJSON");k[X]=h.j(ie,I);const te=w.transformRequest(Vn(ee,j,".png"),"SpriteImage");G[X]=St.getImage(te,I)}return yield Promise.all([...Object.values(k),...Object.values(G)]),(function(X,ee){return h._(this,void 0,void 0,(function*(){const ie={};for(const te in X){ie[te]={};const ae=yt.getImageCanvasContext((yield ee[te]).data),ce=(yield X[te]).data;for(const re in ce){const{width:ue,height:de,x:oe,y:ye,sdf:Ie,pixelRatio:Me,stretchX:ze,stretchY:Pe,content:tt,textFitWidth:it,textFitHeight:He}=ce[re];ie[te][re]={data:null,pixelRatio:Me,sdf:Ie,stretchX:ze,stretchY:Pe,content:tt,textFitWidth:it,textFitHeight:He,spriteData:{width:ue,height:de,x:oe,y:ye,context:ae}}}}return ie}))})(k,G)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((b=>{if(this._spriteRequest=null,b)for(const w in b){this._spritesImagesIds[w]=[];const A=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter((I=>!(I in b))):[];for(const I of A)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in b[w]){const O=w==="default"?I:`${w}:${I}`;this._spritesImagesIds[w].push(O),O in this.imageManager.images?this.imageManager.updateImage(O,b[w][I],!1):this.imageManager.addImage(O,b[w][I]),a&&(this._changedImages[O]=!0)}}})).catch((b=>{this._spriteRequest=null,_=b,f.signal.aborted||this.fire(new h.k(_))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"})),l&&l(_)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}_validateLayer(t){const a=this.tileManagers[t.source];if(!a)return;const l=t.sourceLayer;if(!l)return;const f=a.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(l)===-1)&&this.fire(new h.k(new Error(`Source layer "${l}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.tileManagers)if(!this.tileManagers[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,a=!1){const l=this._serializedAllLayers();if(!t||t.length===0)return Object.values(a?h.bV(l):l);const f=[];for(const _ of t)if(l[_]){const b=a?h.bV(l[_]):l[_];f.push(b)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const f=this._layers[l];f.type!=="custom"&&(t[l]=f.serialize())}return t}hasTransitions(){var t,a,l;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const f in this.tileManagers)if(this.tileManagers[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const a=this._changed;if(a){const f=Object.keys(this._updatedLayers),_=Object.keys(this._removedLayers);(f.length||_.length)&&this._updateWorkerLayers(f,_);for(const b in this._updatedSources){const w=this._updatedSources[b];if(w==="reload")this._reloadSource(b);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(b)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const b in this._updatedPaintProps)this._layers[b].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const l={};for(const f in this.tileManagers){const _=this.tileManagers[f];l[f]=_.used,_.used=!1}for(const f of this._order){const _=this._layers[f];_.recalculate(t,this._availableImages),!_.isHidden(t.zoom)&&_.source&&(this.tileManagers[_.source].used=!0)}for(const f in l){const _=this.tileManagers[f];!!l[f]!=!!_.used&&_.fire(new h.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,a&&this.fire(new h.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const a in this.tileManagers)this.tileManagers[a].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.tileManagers)this.tileManagers[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,a={}){var l;this._checkLoaded();const f=this.serialize();if(t=a.transformStyle?a.transformStyle(f,t):t,((l=a.validate)===null||l===void 0||l)&&Ql(this,h.C(t)))return!1;(t=h.bV(t)).layers=h.bS(t.layers);const _=h.bW(f,t),b=this._getOperationsToPerform(_);if(b.unimplemented.length>0)throw new Error(`Unimplemented: ${b.unimplemented.join(", ")}.`);if(b.operations.length===0)return!1;for(const w of b.operations)w();return this.stylesheet=t,this._serializedLayers=null,this.fire(new h.l("style.load",{style:this})),!0}_getOperationsToPerform(t){const a=[],l=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,f.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,f.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,f.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,f.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,f.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,f.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,f.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,f.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,f.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,f.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,f.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,f.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,f.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,f.args)));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,f.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(f.command)}return{operations:a,unimplemented:l}}addImage(t,a){if(this.getImage(t))return this.fire(new h.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,a),this._afterImageUpdated(t)}updateImage(t,a){this.imageManager.updateImage(t,a)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new h.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,a,l={}){if(this._checkLoaded(),this.tileManagers[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(h.C.source,`sources.${t}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const f=this.tileManagers[t]=new Vi(t,a,this.dispatcher);f.style=this,f.setEventedParent(this,(()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t}))),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===t)return this.fire(new h.k(new Error(`Source "${t}" cannot be removed while layer "${l}" is using it.`)));const a=this.tileManagers[t];delete this.tileManagers[t],delete this._updatedSources[t],a.fire(new h.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,a){if(this._checkLoaded(),this.tileManagers[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const l=this.tileManagers[t].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(t){return this.tileManagers[t]&&this.tileManagers[t].getSource()}addLayer(t,a,l={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new h.k(new Error(`Layer "${f}" already exists on this map.`)));let _;if(t.type==="custom"){if(Ql(this,h.bX(t)))return;_=h.bT(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=h.bV(t),t=h.e(t,{source:f})),this._validate(h.C.layer,`layers.${f}`,t,{arrayIndex:-1},l))return;_=h.bT(t,this._globalState),this._validateLayer(_),_.setEventedParent(this,{layer:{id:f}})}const b=a?this._order.indexOf(a):this._order.length;if(a&&b===-1)this.fire(new h.k(new Error(`Cannot add layer "${f}" before non-existing layer "${a}".`)));else{if(this._order.splice(b,0,f),this._layerOrderChanged=!0,this._layers[f]=_,this._removedLayers[f]&&_.source&&_.type!=="custom"){const w=this._removedLayers[f];delete this._removedLayers[f],w.type!==_.type?this._updatedSources[_.source]="clear":(this._updatedSources[_.source]="reload",this.tileManagers[_.source].pause())}this._updateLayer(_),_.onAdd&&_.onAdd(this.map)}}moveLayer(t,a){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new h.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===a)return;const l=this._order.indexOf(t);this._order.splice(l,1);const f=a?this._order.indexOf(a):this._order.length;a&&f===-1?this.fire(new h.k(new Error(`Cannot move layer "${t}" before non-existing layer "${a}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const a=this._layers[t];if(!a)return void this.fire(new h.k(new Error(`Cannot remove non-existing layer "${t}".`)));a.setEventedParent(null);const l=this._order.indexOf(t);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=a,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],a.onRemove&&a.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,a,l){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===a&&f.maxzoom===l||(a!=null&&(f.minzoom=a),l!=null&&(f.maxzoom=l),this._updateLayer(f)):this.fire(new h.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,a,l={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!h.bR(f.filter,a))return a==null?(f.setFilter(void 0),void this._updateLayer(f)):void(this._validate(h.C.filter,`layers.${f.id}.filter`,a,null,l)||(f.setFilter(h.bV(a)),this._updateLayer(f)))}else this.fire(new h.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return h.bV(this.getLayer(t).filter)}setLayoutProperty(t,a,l,f={}){this._checkLoaded();const _=this.getLayer(t);_?h.bR(_.getLayoutProperty(a),l)||(_.setLayoutProperty(a,l,f),this._updateLayer(_)):this.fire(new h.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,a){const l=this.getLayer(t);if(l)return l.getLayoutProperty(a);this.fire(new h.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,a,l,f={}){this._checkLoaded();const _=this.getLayer(t);_?h.bR(_.getPaintProperty(a),l)||this._updatePaintProperty(_,a,l,f):this.fire(new h.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,a,l,f={}){t.setPaintProperty(a,l,f)&&this._updateLayer(t),h.bU(t)&&a==="raster-fade-duration"&&this.tileManagers[t.source].setRasterFadeDuration(l),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,a){return this.getLayer(t).getPaintProperty(a)}setFeatureState(t,a){this._checkLoaded();const l=t.source,f=t.sourceLayer,_=this.tileManagers[l];if(_===void 0)return void this.fire(new h.k(new Error(`The source '${l}' does not exist in the map's style.`)));const b=_.getSource().type;b==="geojson"&&f?this.fire(new h.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):b!=="vector"||f?(t.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),_.setFeatureState(f,t.id,a)):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,a){this._checkLoaded();const l=t.source,f=this.tileManagers[l];if(f===void 0)return void this.fire(new h.k(new Error(`The source '${l}' does not exist in the map's style.`)));const _=f.getSource().type,b=_==="vector"?t.sourceLayer:void 0;_!=="vector"||b?a&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new h.k(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(b,t.id,a):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const a=t.source,l=t.sourceLayer,f=this.tileManagers[a];if(f!==void 0)return f.getSource().type!=="vector"||l?(t.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),f.getFeatureState(l,t.id)):void this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=h.bY(this.tileManagers,(_=>_.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,f=this.stylesheet;return h.bZ({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:a,terrain:l},(_=>_!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.tileManagers[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.tileManagers[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const a=b=>this._layers[b].type==="fill-extrusion",l={},f=[];for(let b=this._order.length-1;b>=0;b--){const w=this._order[b];if(a(w)){l[w]=b;for(const A of t){const I=A[w];if(I)for(const O of I)f.push(O)}}}f.sort(((b,w)=>w.intersectionZ-b.intersectionZ));const _=[];for(let b=this._order.length-1;b>=0;b--){const w=this._order[b];if(a(w))for(let A=f.length-1;A>=0;A--){const I=f[A].feature;if(l[I.layer.id]<b)break;_.push(I),f.pop()}else for(const A of t){const I=A[w];if(I)for(const O of I)_.push(O.feature)}}return _}queryRenderedFeatures(t,a,l){a&&a.filter&&this._validate(h.C.filter,"queryRenderedFeatures.filter",a.filter,null,a);const f={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new h.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const I of a.layers){const O=this._layers[I];if(!O)return this.fire(new h.k(new Error(`The layer '${I}' does not exist in the map's style and cannot be queried for features.`))),[];f[O.source]=!0}}const _=[];a.availableImages=this._availableImages;const b=this._serializedAllLayers(),w=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,A=Object.assign(Object.assign({},a),{layers:w,globalState:this._globalState});for(const I in this.tileManagers)a.layers&&!f[I]||_.push(kl(this.tileManagers[I],this._layers,b,t,A,l,this.map.terrain?(O,j,k)=>this.map.terrain.getElevation(O,j,k):void 0));return this.placement&&_.push((function(I,O,j,k,G,X,ee){const ie={},te=X.queryRenderedSymbols(k),ae=[];for(const ce of Object.keys(te).map(Number))ae.push(ee[ce]);ae.sort(rn);for(const ce of ae){const re=ce.featureIndex.lookupSymbolFeatures(te[ce.bucketInstanceId],O,ce.bucketIndex,ce.sourceLayerIndex,{filterSpec:G.filter,globalState:G.globalState},G.layers,G.availableImages,I);for(const ue in re){const de=ie[ue]=ie[ue]||[],oe=re[ue];oe.sort(((ye,Ie)=>{const Me=ce.featureSortOrder;if(Me){const ze=Me.indexOf(ye.featureIndex);return Me.indexOf(Ie.featureIndex)-ze}return Ie.featureIndex-ye.featureIndex}));for(const ye of oe)de.push(ye)}}return(function(ce,re,ue){for(const de in ce)for(const oe of ce[de])Ir(oe,ue[re[de].source]);return ce})(ie,I,j)})(this._layers,b,this.tileManagers,t,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_)}querySourceFeatures(t,a){a?.filter&&this._validate(h.C.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.tileManagers[t];return l?(function(f,_){const b=f.getRenderableIds().map((I=>f.getTileByID(I))),w=[],A={};for(let I=0;I<b.length;I++){const O=b[I],j=O.tileID.canonical.key;A[j]||(A[j]=!0,O.querySourceFeatures(w,_))}return w})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,a={}){this._checkLoaded();const l=this.light.getLight();let f=!1;for(const b in t)if(!h.bR(t[b],l[b])){f=!0;break}if(!f)return;const _={now:rt(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,a),this.light.updateTransitions(_)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,a={}){this._checkLoaded();const l=this.getSky();let f=!1;if(!t&&!l)return;if(t&&!l)f=!0;else if(!t&&l)f=!0;else for(const b in t)if(!h.bR(t[b],l[b])){f=!0;break}if(!f)return;const _={now:rt(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,a),this.sky.updateTransitions(_)}_setProjectionInternal(t){const a=(function(l,f){const _={constrainOverride:f};if(Array.isArray(l)){const b=new qh({type:l});return{projection:b,transform:new Xl(_),cameraHelper:new Yl(b)}}switch(l){case"mercator":return{projection:new Zn,transform:new kn(_),cameraHelper:new Yo};case"globe":{const b=new qh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:b,transform:new Xl(_),cameraHelper:new Yl(b)}}case"vertical-perspective":return{projection:new Gh,transform:new $l(_),cameraHelper:new wn};default:return h.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new Zn,transform:new kn(_),cameraHelper:new Yo}}})(t,this.map.transformConstrain);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.tileManagers)this.tileManagers[l].reload()}_validate(t,a,l,f,_={}){return(!_||_.validate!==!1)&&Ql(this,t.call(h.C,h.e({key:a,style:this.serialize(),value:l,styleSpec:h.u},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),we().off(fe,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.tileManagers){const l=this.tileManagers[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.tileManagers[t].clearTiles()}_reloadSource(t){this.tileManagers[t].resume(),this.tileManagers[t].reload()}_updateSources(t){for(const a in this.tileManagers)this.tileManagers[a].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.tileManagers)this._reloadSource(t)}_updatePlacement(t,a,l,f,_=!1){let b=!1,w=!1;const A={};for(const I of this._order){const O=this._layers[I];if(O.type!=="symbol")continue;if(!A[O.source]){const k=this.tileManagers[O.source];A[O.source]=k.getRenderableIds(!0).map((G=>k.getTileByID(G))).sort(((G,X)=>X.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(X.tileID)?-1:1)))}const j=this.crossTileSymbolIndex.addLayer(O,A[O.source],t.center.lng);b=b||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((_=_||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(rt(),t.zoom))&&(this.pauseablePlacement=new ql(t,this.map.terrain,this._order,_,a,l,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,A),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(rt()),w=!0),b&&this.pauseablePlacement.placement.setStale()),w||b)for(const I of this._order){const O=this._layers[I];O.type==="symbol"&&this.placement.updateLayerOpacities(O,A[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(rt())}_releaseSymbolFadeTiles(){for(const t in this.tileManagers)this.tileManagers[t].releaseSymbolFadeTiles()}getImages(t,a){return h._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(t,a){return h._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),f=this.tileManagers[a.source];return f&&f.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,a={}){this._checkLoaded(),t&&this._validate(h.C.glyphs,"glyphs",t,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,a){return h._(this,void 0,void 0,(function*(){const l={};for(const[f,_]of Object.entries(a.dashes))l[f]=this.lineAtlas.getDash(_.dasharray,_.round);return l}))}addSprite(t,a,l={},f){this._checkLoaded();const _=[{id:t,url:a}],b=[...cn(this.stylesheet.sprite),..._];this._validate(h.C.sprite,"sprite",b,null,l)||(this.stylesheet.sprite=b,this._loadSprite(_,!0,f))}removeSprite(t){this._checkLoaded();const a=cn(this.stylesheet.sprite);if(a.find((l=>l.id===t))){if(this._spritesImagesIds[t])for(const l of this._spritesImagesIds[t])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===t)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}else this.fire(new h.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return cn(this.stylesheet.sprite)}setSprite(t,a={},l){this._checkLoaded(),t&&this._validate(h.C.sprite,"sprite",t,null,a)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,l):(this._unloadSprite(),l&&l(null)))}destroy(){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null);for(const t in this.tileManagers){const a=this.tileManagers[t];a.setEventedParent(null),a.onRemove(this.map)}this.tileManagers={},this.imageManager&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this._availableImages=[],this._spritesImagesIds={}),this.glyphManager&&this.glyphManager.destroy();for(const t in this._layers){const a=this._layers[t];a.setEventedParent(null),a.onRemove&&a.onRemove(this.map)}this._setInitialValues(),this.setEventedParent(null),this.dispatcher.unregisterMessageHandler("GG"),this.dispatcher.unregisterMessageHandler("GI"),this.dispatcher.unregisterMessageHandler("GDA"),this.dispatcher.remove(!0),this._listeners={},this._oneTimeListeners={}}}var md=h.aU([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class qu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,a,l,f,_,b,w,A,I){this.context=t;let O=this.boundPaintVertexBuffers.length!==f.length;for(let j=0;!O&&j<f.length;j++)this.boundPaintVertexBuffers[j]!==f[j]&&(O=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||O||this.boundIndexBuffer!==_||this.boundVertexOffset!==b||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==A||this.boundDynamicVertexBuffer3!==I?this.freshBind(a,l,f,_,b,w,A,I):(t.bindVertexArray.set(this.vao),w&&w.bind(),_&&_.dynamicDraw&&_.bind(),A&&A.bind(),I&&I.bind())}freshBind(t,a,l,f,_,b,w,A){const I=t.numAttributes,O=this.context,j=O.gl;this.vao&&this.destroy(),this.vao=O.createVertexArray(),O.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=f,this.boundVertexOffset=_,this.boundDynamicVertexBuffer=b,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=A,a.enableAttributes(j,t);for(const k of l)k.enableAttributes(j,t);b&&b.enableAttributes(j,t),w&&w.enableAttributes(j,t),A&&A.enableAttributes(j,t),a.bind(),a.setVertexAttribPointers(j,t,_);for(const k of l)k.bind(),k.setVertexAttribPointers(j,t,_);b&&(b.bind(),b.setVertexAttribPointers(j,t,_)),f&&f.bind(),w&&(w.bind(),w.setVertexAttribPointers(j,t,_)),A&&(A.bind(),A.setVertexAttribPointers(j,t,_)),O.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const gd=(m,t,a,l,f)=>({u_texture:0,u_ele_delta:m,u_fog_matrix:t,u_fog_color:a?a.properties.get("fog-color"):h.bp.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):h.bp.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),ja={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Uc(m){const t=[];for(let a=0;a<m.length;a++){if(m[a]===null)continue;const l=m[a].split(" ");t.push(l.pop())}return t}class _d{constructor(t,a,l,f,_,b,w,A,I=[]){const O=t.gl;this.program=O.createProgram();const j=Uc(a.staticAttributes),k=l?l.getBinderAttributes():[],G=j.concat(k),X=Qi.prelude.staticUniforms?Uc(Qi.prelude.staticUniforms):[],ee=w.staticUniforms?Uc(w.staticUniforms):[],ie=a.staticUniforms?Uc(a.staticUniforms):[],te=l?l.getBinderUniforms():[],ae=X.concat(ee).concat(ie).concat(te),ce=[];for(const Me of ae)ce.indexOf(Me)<0&&ce.push(Me);const re=l?l.defines():[];_a(O)&&re.unshift("#version 300 es"),_&&re.push("#define OVERDRAW_INSPECTOR;"),b&&re.push("#define TERRAIN3D;"),A&&re.push(A),I&&re.push(...I);let ue=re.concat(Qi.prelude.fragmentSource,w.fragmentSource,a.fragmentSource).join(`
`),de=re.concat(Qi.prelude.vertexSource,w.vertexSource,a.vertexSource).join(`
`);_a(O)||(ue=(function(Me){return Me.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ue),de=(function(Me){return Me.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(de));const oe=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(oe,ue),O.compileShader(oe),!O.getShaderParameter(oe,O.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${O.getShaderInfoLog(oe)}`);O.attachShader(this.program,oe);const ye=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);if(O.shaderSource(ye,de),O.compileShader(ye),!O.getShaderParameter(ye,O.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${O.getShaderInfoLog(ye)}`);O.attachShader(this.program,ye),this.attributes={};const Ie={};this.numAttributes=G.length;for(let Me=0;Me<this.numAttributes;Me++)G[Me]&&(O.bindAttribLocation(this.program,Me,G[Me]),this.attributes[G[Me]]=Me);if(O.linkProgram(this.program),!O.getProgramParameter(this.program,O.LINK_STATUS))throw new Error(`Program failed to link: ${O.getProgramInfoLog(this.program)}`);O.deleteShader(ye),O.deleteShader(oe);for(let Me=0;Me<ce.length;Me++){const ze=ce[Me];if(ze&&!Ie[ze]){const Pe=O.getUniformLocation(this.program,ze);Pe&&(Ie[ze]=Pe)}}this.fixedUniforms=f(t,Ie),this.terrainUniforms=((Me,ze)=>({u_depth:new h.b_(Me,ze.u_depth),u_terrain:new h.b_(Me,ze.u_terrain),u_terrain_dim:new h.bq(Me,ze.u_terrain_dim),u_terrain_matrix:new h.c0(Me,ze.u_terrain_matrix),u_terrain_unpack:new h.c1(Me,ze.u_terrain_unpack),u_terrain_exaggeration:new h.bq(Me,ze.u_terrain_exaggeration)}))(t,Ie),this.projectionUniforms=((Me,ze)=>({u_projection_matrix:new h.c0(Me,ze.u_projection_matrix),u_projection_tile_mercator_coords:new h.c1(Me,ze.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.c1(Me,ze.u_projection_clipping_plane),u_projection_transition:new h.bq(Me,ze.u_projection_transition),u_projection_fallback_matrix:new h.c0(Me,ze.u_projection_fallback_matrix)}))(t,Ie),this.binderUniforms=l?l.getUniforms(t,Ie):[]}draw(t,a,l,f,_,b,w,A,I,O,j,k,G,X,ee,ie,te,ae,ce){const re=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(l),t.setStencilMode(f),t.setColorMode(_),t.setCullFace(b),A){t.activeTexture.set(re.TEXTURE2),re.bindTexture(re.TEXTURE_2D,A.depthTexture),t.activeTexture.set(re.TEXTURE3),re.bindTexture(re.TEXTURE_2D,A.texture);for(const de in this.terrainUniforms)this.terrainUniforms[de].set(A[de])}if(I)for(const de in I)this.projectionUniforms[ja[de]].set(I[de]);if(w)for(const de in this.fixedUniforms)this.fixedUniforms[de].set(w[de]);ie&&ie.setUniforms(t,this.binderUniforms,X,{zoom:ee});let ue=0;switch(a){case re.LINES:ue=2;break;case re.TRIANGLES:ue=3;break;case re.LINE_STRIP:ue=1}for(const de of G.get()){const oe=de.vaos||(de.vaos={});(oe[O]||(oe[O]=new qu)).bind(t,this,j,ie?ie.getPaintVertexBuffers():[],k,de.vertexOffset,te,ae,ce),re.drawElements(a,de.primitiveLength*ue,re.UNSIGNED_SHORT,de.primitiveOffset*ue*2)}}}function yd(m,t,a){const l=1/h.aN(a,1,t.transform.tileZoom),f=Math.pow(2,a.tileID.overscaledZ),_=a.tileSize*Math.pow(2,t.transform.tileZoom)/f,b=_*(a.tileID.canonical.x+a.tileID.wrap*f),w=_*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,m.fromScale,m.toScale],u_fade:m.t,u_pixel_coord_upper:[b>>16,w>>16],u_pixel_coord_lower:[65535&b,65535&w]}}const Gc=(m,t,a,l)=>{const f=m.style.light,_=f.properties.get("position"),b=[_.x,_.y,_.z],w=h.c4();f.properties.get("anchor")==="viewport"&&h.c5(w,m.transform.bearingInRadians),h.c6(b,b,w);const A=m.transform.transformLightDirection(b),I=f.properties.get("color");return{u_lightpos:b,u_lightpos_globe:A,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+t,u_opacity:a,u_fill_translate:l}},qc=(m,t,a,l,f,_,b)=>h.e(Gc(m,t,a,l),yd(_,m,b),{u_height_factor:-Math.pow(2,f.overscaledZ)/b.tileSize/8}),Wo=(m,t,a,l)=>h.e(yd(t,m,a),{u_fill_translate:l}),Wl=(m,t)=>({u_world:m,u_fill_translate:t}),vd=(m,t,a,l,f)=>h.e(Wo(m,t,a,f),{u_world:l}),Zu=(m,t,a,l,f)=>{const _=m.transform;let b,w,A=0;if(a.paint.get("circle-pitch-alignment")==="map"){const I=h.aN(t,1,_.zoom);b=!0,w=[I,I],A=I/(h.a5*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else b=!1,w=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+b,u_device_pixel_ratio:m.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:A,u_translate:l}},go=m=>({u_pixel_extrude_scale:[1/m.width,1/m.height]}),Hh=m=>({u_viewport_size:[m.width,m.height]}),Hu=(m,t=1)=>({u_color:m,u_overlay:0,u_overlay_scale:t}),_o=(m,t,a,l)=>{const f=h.aN(m,1,t)/(h.a5*Math.pow(2,m.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:h.aN(m,1,t),u_intensity:a,u_globe_extrude_scale:f}},$h=(m,t,a,l)=>{const f=h.N();h.c7(f,0,m.width,m.height,0,0,1);const _=m.context.gl;return{u_matrix:f,u_world:[_.drawingBufferWidth,_.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:t.paint.get("heatmap-opacity")}},$u=(m,t,a)=>{const l=a.paint.get("hillshade-accent-color");let f;switch(a.paint.get("hillshade-method")){case"basic":f=4;break;case"combined":f=1;break;case"igor":f=2;break;case"multidirectional":f=3;break;default:f=0}const _=a.getIlluminationProperties();for(let b=0;b<_.directionRadians.length;b++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(_.directionRadians[b]+=m.transform.bearingInRadians);return{u_image:0,u_latrange:Np(0,t.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:_.altitudeRadians,u_azimuths:_.directionRadians,u_accent:l,u_method:f,u_highlights:_.highlightColor,u_shadows:_.shadowColor}},bd=(m,t)=>{const a=t.stride,l=h.N();return h.c7(l,0,h.a5,-h.a5,0,0,1),h.O(l,l,[0,-h.a5,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:m.overscaledZ,u_unpack:t.getUnpackVector()}};function Np(m,t){const a=Math.pow(2,t.canonical.z),l=t.canonical.y;return[new h.a9(0,l/a).toLngLat().lat,new h.a9(0,(l+1)/a).toLngLat().lat]}const xd=(m,t,a=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:m.paint.get("color-relief-opacity")}),Xu=(m,t,a,l)=>{const f=m.transform;return{u_translation:Yu(m,t,a),u_ratio:l/h.aN(t,1,f.zoom),u_device_pixel_ratio:m.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},wd=(m,t,a,l,f)=>h.e(Xu(m,t,a,l),{u_image:0,u_image_height:f}),Xh=(m,t,a,l,f)=>{const _=m.transform,b=ya(t,_);return{u_translation:Yu(m,t,a),u_texsize:t.imageAtlasTexture.size,u_ratio:l/h.aN(t,1,_.zoom),u_device_pixel_ratio:m.pixelRatio,u_image:0,u_scale:[b,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Or=(m,t,a,l,f)=>{const _=ya(t,m.transform);return h.e(Xu(m,t,a,l),{u_tileratio:_,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image:0,u_mix:f.t,u_lineatlas_width:m.lineAtlas.width,u_lineatlas_height:m.lineAtlas.height})},yo=(m,t,a,l,f,_)=>{const b=ya(t,m.transform);return h.e(Xu(m,t,a,l),{u_image:0,u_image_height:_,u_tileratio:b,u_crossfade_from:f.fromScale,u_crossfade_to:f.toScale,u_image_dash:1,u_mix:f.t,u_lineatlas_width:m.lineAtlas.width,u_lineatlas_height:m.lineAtlas.height})};function ya(m,t){return 1/h.aN(m,1,t.tileZoom)}function Yu(m,t,a){return h.aO(m.transform,t,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Zc=(m,t,a,l,f)=>{return{u_tl_parent:m,u_scale_parent:t,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(b=l.paint.get("raster-saturation"),b>0?1-1/(1.001-b):-b),u_contrast_factor:(_=l.paint.get("raster-contrast"),_>0?1/(1-_):1+_),u_spin_weights:Hc(l.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var _,b};function Hc(m){m*=Math.PI/180;const t=Math.sin(m),a=Math.cos(m);return[(2*a+1)/3,(-Math.sqrt(3)*t-a+1)/3,(Math.sqrt(3)*t-a+1)/3]}const Qu=(m,t,a,l,f,_,b,w,A,I,O,j,k)=>{const G=b.transform;return{u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:G.width/G.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:A,u_is_text:+O,u_pitch_with_map:+l,u_is_along_line:f,u_is_variable_anchor:_,u_texsize:j,u_texture:0,u_translation:I,u_pitched_scale:k}},$c=(m,t,a,l,f,_,b,w,A,I,O,j,k,G)=>{const X=b.transform;return h.e(Qu(m,t,a,l,f,_,b,w,A,I,O,j,G),{u_gamma_scale:l?Math.cos(X.pitch*Math.PI/180)*X.cameraToCenterDistance:1,u_device_pixel_ratio:b.pixelRatio,u_is_halo:1})},va=(m,t,a,l,f,_,b,w,A,I,O,j,k)=>h.e($c(m,t,a,l,f,_,b,w,A,I,!0,O,0,k),{u_texsize_icon:j,u_texture_icon:1}),Ku=(m,t)=>({u_opacity:m,u_color:t}),Wu=(m,t,a,l,f)=>h.e((function(_,b,w,A){const I=w.imageManager.getPattern(_.from.toString()),O=w.imageManager.getPattern(_.to.toString()),{width:j,height:k}=w.imageManager.getPixelSize(),G=Math.pow(2,A.tileID.overscaledZ),X=A.tileSize*Math.pow(2,w.transform.tileZoom)/G,ee=X*(A.tileID.canonical.x+A.tileID.wrap*G),ie=X*A.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:O.tl,u_pattern_br_b:O.br,u_texsize:[j,k],u_mix:b.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:O.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/h.aN(A,1,w.transform.tileZoom),u_pixel_coord_upper:[ee>>16,ie>>16],u_pixel_coord_lower:[65535&ee,65535&ie]}})(a,f,t,l),{u_opacity:m}),Xc=(m,t)=>{},Td={fillExtrusion:(m,t)=>({u_lightpos:new h.c2(m,t.u_lightpos),u_lightpos_globe:new h.c2(m,t.u_lightpos_globe),u_lightintensity:new h.bq(m,t.u_lightintensity),u_lightcolor:new h.c2(m,t.u_lightcolor),u_vertical_gradient:new h.bq(m,t.u_vertical_gradient),u_opacity:new h.bq(m,t.u_opacity),u_fill_translate:new h.c3(m,t.u_fill_translate)}),fillExtrusionPattern:(m,t)=>({u_lightpos:new h.c2(m,t.u_lightpos),u_lightpos_globe:new h.c2(m,t.u_lightpos_globe),u_lightintensity:new h.bq(m,t.u_lightintensity),u_lightcolor:new h.c2(m,t.u_lightcolor),u_vertical_gradient:new h.bq(m,t.u_vertical_gradient),u_height_factor:new h.bq(m,t.u_height_factor),u_opacity:new h.bq(m,t.u_opacity),u_fill_translate:new h.c3(m,t.u_fill_translate),u_image:new h.b_(m,t.u_image),u_texsize:new h.c3(m,t.u_texsize),u_pixel_coord_upper:new h.c3(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.c3(m,t.u_pixel_coord_lower),u_scale:new h.c2(m,t.u_scale),u_fade:new h.bq(m,t.u_fade)}),fill:(m,t)=>({u_fill_translate:new h.c3(m,t.u_fill_translate)}),fillPattern:(m,t)=>({u_image:new h.b_(m,t.u_image),u_texsize:new h.c3(m,t.u_texsize),u_pixel_coord_upper:new h.c3(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.c3(m,t.u_pixel_coord_lower),u_scale:new h.c2(m,t.u_scale),u_fade:new h.bq(m,t.u_fade),u_fill_translate:new h.c3(m,t.u_fill_translate)}),fillOutline:(m,t)=>({u_world:new h.c3(m,t.u_world),u_fill_translate:new h.c3(m,t.u_fill_translate)}),fillOutlinePattern:(m,t)=>({u_world:new h.c3(m,t.u_world),u_image:new h.b_(m,t.u_image),u_texsize:new h.c3(m,t.u_texsize),u_pixel_coord_upper:new h.c3(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.c3(m,t.u_pixel_coord_lower),u_scale:new h.c2(m,t.u_scale),u_fade:new h.bq(m,t.u_fade),u_fill_translate:new h.c3(m,t.u_fill_translate)}),circle:(m,t)=>({u_camera_to_center_distance:new h.bq(m,t.u_camera_to_center_distance),u_scale_with_map:new h.b_(m,t.u_scale_with_map),u_pitch_with_map:new h.b_(m,t.u_pitch_with_map),u_extrude_scale:new h.c3(m,t.u_extrude_scale),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_globe_extrude_scale:new h.bq(m,t.u_globe_extrude_scale),u_translate:new h.c3(m,t.u_translate)}),collisionBox:(m,t)=>({u_pixel_extrude_scale:new h.c3(m,t.u_pixel_extrude_scale)}),collisionCircle:(m,t)=>({u_viewport_size:new h.c3(m,t.u_viewport_size)}),debug:(m,t)=>({u_color:new h.b$(m,t.u_color),u_overlay:new h.b_(m,t.u_overlay),u_overlay_scale:new h.bq(m,t.u_overlay_scale)}),depth:Xc,clippingMask:Xc,heatmap:(m,t)=>({u_extrude_scale:new h.bq(m,t.u_extrude_scale),u_intensity:new h.bq(m,t.u_intensity),u_globe_extrude_scale:new h.bq(m,t.u_globe_extrude_scale)}),heatmapTexture:(m,t)=>({u_matrix:new h.c0(m,t.u_matrix),u_world:new h.c3(m,t.u_world),u_image:new h.b_(m,t.u_image),u_color_ramp:new h.b_(m,t.u_color_ramp),u_opacity:new h.bq(m,t.u_opacity)}),hillshade:(m,t)=>({u_image:new h.b_(m,t.u_image),u_latrange:new h.c3(m,t.u_latrange),u_exaggeration:new h.bq(m,t.u_exaggeration),u_altitudes:new h.c9(m,t.u_altitudes),u_azimuths:new h.c9(m,t.u_azimuths),u_accent:new h.b$(m,t.u_accent),u_method:new h.b_(m,t.u_method),u_shadows:new h.c8(m,t.u_shadows),u_highlights:new h.c8(m,t.u_highlights)}),hillshadePrepare:(m,t)=>({u_matrix:new h.c0(m,t.u_matrix),u_image:new h.b_(m,t.u_image),u_dimension:new h.c3(m,t.u_dimension),u_zoom:new h.bq(m,t.u_zoom),u_unpack:new h.c1(m,t.u_unpack)}),colorRelief:(m,t)=>({u_image:new h.b_(m,t.u_image),u_unpack:new h.c1(m,t.u_unpack),u_dimension:new h.c3(m,t.u_dimension),u_elevation_stops:new h.b_(m,t.u_elevation_stops),u_color_stops:new h.b_(m,t.u_color_stops),u_color_ramp_size:new h.b_(m,t.u_color_ramp_size),u_opacity:new h.bq(m,t.u_opacity)}),line:(m,t)=>({u_translation:new h.c3(m,t.u_translation),u_ratio:new h.bq(m,t.u_ratio),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_units_to_pixels:new h.c3(m,t.u_units_to_pixels)}),lineGradient:(m,t)=>({u_translation:new h.c3(m,t.u_translation),u_ratio:new h.bq(m,t.u_ratio),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_units_to_pixels:new h.c3(m,t.u_units_to_pixels),u_image:new h.b_(m,t.u_image),u_image_height:new h.bq(m,t.u_image_height)}),linePattern:(m,t)=>({u_translation:new h.c3(m,t.u_translation),u_texsize:new h.c3(m,t.u_texsize),u_ratio:new h.bq(m,t.u_ratio),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_image:new h.b_(m,t.u_image),u_units_to_pixels:new h.c3(m,t.u_units_to_pixels),u_scale:new h.c2(m,t.u_scale),u_fade:new h.bq(m,t.u_fade)}),lineSDF:(m,t)=>({u_translation:new h.c3(m,t.u_translation),u_ratio:new h.bq(m,t.u_ratio),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_units_to_pixels:new h.c3(m,t.u_units_to_pixels),u_image:new h.b_(m,t.u_image),u_mix:new h.bq(m,t.u_mix),u_tileratio:new h.bq(m,t.u_tileratio),u_crossfade_from:new h.bq(m,t.u_crossfade_from),u_crossfade_to:new h.bq(m,t.u_crossfade_to),u_lineatlas_width:new h.bq(m,t.u_lineatlas_width),u_lineatlas_height:new h.bq(m,t.u_lineatlas_height)}),lineGradientSDF:(m,t)=>({u_translation:new h.c3(m,t.u_translation),u_ratio:new h.bq(m,t.u_ratio),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_units_to_pixels:new h.c3(m,t.u_units_to_pixels),u_image:new h.b_(m,t.u_image),u_image_height:new h.bq(m,t.u_image_height),u_tileratio:new h.bq(m,t.u_tileratio),u_crossfade_from:new h.bq(m,t.u_crossfade_from),u_crossfade_to:new h.bq(m,t.u_crossfade_to),u_image_dash:new h.b_(m,t.u_image_dash),u_mix:new h.bq(m,t.u_mix),u_lineatlas_width:new h.bq(m,t.u_lineatlas_width),u_lineatlas_height:new h.bq(m,t.u_lineatlas_height)}),raster:(m,t)=>({u_tl_parent:new h.c3(m,t.u_tl_parent),u_scale_parent:new h.bq(m,t.u_scale_parent),u_buffer_scale:new h.bq(m,t.u_buffer_scale),u_fade_t:new h.bq(m,t.u_fade_t),u_opacity:new h.bq(m,t.u_opacity),u_image0:new h.b_(m,t.u_image0),u_image1:new h.b_(m,t.u_image1),u_brightness_low:new h.bq(m,t.u_brightness_low),u_brightness_high:new h.bq(m,t.u_brightness_high),u_saturation_factor:new h.bq(m,t.u_saturation_factor),u_contrast_factor:new h.bq(m,t.u_contrast_factor),u_spin_weights:new h.c2(m,t.u_spin_weights),u_coords_top:new h.c1(m,t.u_coords_top),u_coords_bottom:new h.c1(m,t.u_coords_bottom)}),symbolIcon:(m,t)=>({u_is_size_zoom_constant:new h.b_(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.b_(m,t.u_is_size_feature_constant),u_size_t:new h.bq(m,t.u_size_t),u_size:new h.bq(m,t.u_size),u_camera_to_center_distance:new h.bq(m,t.u_camera_to_center_distance),u_pitch:new h.bq(m,t.u_pitch),u_rotate_symbol:new h.b_(m,t.u_rotate_symbol),u_aspect_ratio:new h.bq(m,t.u_aspect_ratio),u_fade_change:new h.bq(m,t.u_fade_change),u_label_plane_matrix:new h.c0(m,t.u_label_plane_matrix),u_coord_matrix:new h.c0(m,t.u_coord_matrix),u_is_text:new h.b_(m,t.u_is_text),u_pitch_with_map:new h.b_(m,t.u_pitch_with_map),u_is_along_line:new h.b_(m,t.u_is_along_line),u_is_variable_anchor:new h.b_(m,t.u_is_variable_anchor),u_texsize:new h.c3(m,t.u_texsize),u_texture:new h.b_(m,t.u_texture),u_translation:new h.c3(m,t.u_translation),u_pitched_scale:new h.bq(m,t.u_pitched_scale)}),symbolSDF:(m,t)=>({u_is_size_zoom_constant:new h.b_(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.b_(m,t.u_is_size_feature_constant),u_size_t:new h.bq(m,t.u_size_t),u_size:new h.bq(m,t.u_size),u_camera_to_center_distance:new h.bq(m,t.u_camera_to_center_distance),u_pitch:new h.bq(m,t.u_pitch),u_rotate_symbol:new h.b_(m,t.u_rotate_symbol),u_aspect_ratio:new h.bq(m,t.u_aspect_ratio),u_fade_change:new h.bq(m,t.u_fade_change),u_label_plane_matrix:new h.c0(m,t.u_label_plane_matrix),u_coord_matrix:new h.c0(m,t.u_coord_matrix),u_is_text:new h.b_(m,t.u_is_text),u_pitch_with_map:new h.b_(m,t.u_pitch_with_map),u_is_along_line:new h.b_(m,t.u_is_along_line),u_is_variable_anchor:new h.b_(m,t.u_is_variable_anchor),u_texsize:new h.c3(m,t.u_texsize),u_texture:new h.b_(m,t.u_texture),u_gamma_scale:new h.bq(m,t.u_gamma_scale),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_is_halo:new h.b_(m,t.u_is_halo),u_translation:new h.c3(m,t.u_translation),u_pitched_scale:new h.bq(m,t.u_pitched_scale)}),symbolTextAndIcon:(m,t)=>({u_is_size_zoom_constant:new h.b_(m,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.b_(m,t.u_is_size_feature_constant),u_size_t:new h.bq(m,t.u_size_t),u_size:new h.bq(m,t.u_size),u_camera_to_center_distance:new h.bq(m,t.u_camera_to_center_distance),u_pitch:new h.bq(m,t.u_pitch),u_rotate_symbol:new h.b_(m,t.u_rotate_symbol),u_aspect_ratio:new h.bq(m,t.u_aspect_ratio),u_fade_change:new h.bq(m,t.u_fade_change),u_label_plane_matrix:new h.c0(m,t.u_label_plane_matrix),u_coord_matrix:new h.c0(m,t.u_coord_matrix),u_is_text:new h.b_(m,t.u_is_text),u_pitch_with_map:new h.b_(m,t.u_pitch_with_map),u_is_along_line:new h.b_(m,t.u_is_along_line),u_is_variable_anchor:new h.b_(m,t.u_is_variable_anchor),u_texsize:new h.c3(m,t.u_texsize),u_texsize_icon:new h.c3(m,t.u_texsize_icon),u_texture:new h.b_(m,t.u_texture),u_texture_icon:new h.b_(m,t.u_texture_icon),u_gamma_scale:new h.bq(m,t.u_gamma_scale),u_device_pixel_ratio:new h.bq(m,t.u_device_pixel_ratio),u_is_halo:new h.b_(m,t.u_is_halo),u_translation:new h.c3(m,t.u_translation),u_pitched_scale:new h.bq(m,t.u_pitched_scale)}),background:(m,t)=>({u_opacity:new h.bq(m,t.u_opacity),u_color:new h.b$(m,t.u_color)}),backgroundPattern:(m,t)=>({u_opacity:new h.bq(m,t.u_opacity),u_image:new h.b_(m,t.u_image),u_pattern_tl_a:new h.c3(m,t.u_pattern_tl_a),u_pattern_br_a:new h.c3(m,t.u_pattern_br_a),u_pattern_tl_b:new h.c3(m,t.u_pattern_tl_b),u_pattern_br_b:new h.c3(m,t.u_pattern_br_b),u_texsize:new h.c3(m,t.u_texsize),u_mix:new h.bq(m,t.u_mix),u_pattern_size_a:new h.c3(m,t.u_pattern_size_a),u_pattern_size_b:new h.c3(m,t.u_pattern_size_b),u_scale_a:new h.bq(m,t.u_scale_a),u_scale_b:new h.bq(m,t.u_scale_b),u_pixel_coord_upper:new h.c3(m,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.c3(m,t.u_pixel_coord_lower),u_tile_units_to_pixels:new h.bq(m,t.u_tile_units_to_pixels)}),terrain:(m,t)=>({u_texture:new h.b_(m,t.u_texture),u_ele_delta:new h.bq(m,t.u_ele_delta),u_fog_matrix:new h.c0(m,t.u_fog_matrix),u_fog_color:new h.b$(m,t.u_fog_color),u_fog_ground_blend:new h.bq(m,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.bq(m,t.u_fog_ground_blend_opacity),u_horizon_color:new h.b$(m,t.u_horizon_color),u_horizon_fog_blend:new h.bq(m,t.u_horizon_fog_blend),u_is_globe_mode:new h.bq(m,t.u_is_globe_mode)}),terrainDepth:(m,t)=>({u_ele_delta:new h.bq(m,t.u_ele_delta)}),terrainCoords:(m,t)=>({u_texture:new h.b_(m,t.u_texture),u_terrain_coords_id:new h.bq(m,t.u_terrain_coords_id),u_ele_delta:new h.bq(m,t.u_ele_delta)}),projectionErrorMeasurement:(m,t)=>({u_input:new h.bq(m,t.u_input),u_output_expected:new h.bq(m,t.u_output_expected)}),atmosphere:(m,t)=>({u_sun_pos:new h.c2(m,t.u_sun_pos),u_atmosphere_blend:new h.bq(m,t.u_atmosphere_blend),u_globe_position:new h.c2(m,t.u_globe_position),u_globe_radius:new h.bq(m,t.u_globe_radius),u_inv_proj_matrix:new h.c0(m,t.u_inv_proj_matrix)}),sky:(m,t)=>({u_sky_color:new h.b$(m,t.u_sky_color),u_horizon_color:new h.b$(m,t.u_horizon_color),u_horizon:new h.c3(m,t.u_horizon),u_horizon_normal:new h.c3(m,t.u_horizon_normal),u_sky_horizon_blend:new h.bq(m,t.u_sky_horizon_blend),u_sky_blend:new h.bq(m,t.u_sky_blend)})};class Jo{constructor(t,a,l){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const el={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yh{constructor(t,a,l,f){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=f,this.context=t;const _=t.gl;this.buffer=_.createBuffer(),t.bindVertexBuffer.set(this.buffer),_.bufferData(_.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,a){for(let l=0;l<this.attributes.length;l++){const f=a.attributes[this.attributes[l].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,a,l){for(let f=0;f<this.attributes.length;f++){const _=this.attributes[f],b=a.attributes[_.name];b!==void 0&&t.vertexAttribPointer(b,_.components,t[el[_.type]],!1,this.itemSize,_.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ci{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ls extends ci{getDefault(){return h.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ju extends ci{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ec extends ci{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Yc extends ci{getDefault(){return[!0,!0,!0,!0]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class tl extends ci{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class tc extends ci{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Jl extends ci{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const a=this.current;(t.func!==a.func||t.ref!==a.ref||t.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Wr extends ci{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Qh extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=t,this.dirty=!1}}class Qc extends ci{getDefault(){return[0,1]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Jr extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=t,this.dirty=!1}}class us extends ci{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Dr extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.BLEND):a.disable(a.BLEND),this.current=t,this.dirty=!1}}class Ls extends ci{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class il extends ci{getDefault(){return h.bp.transparent}set(t){const a=this.current;(t.r!==a.r||t.g!==a.g||t.b!==a.b||t.a!==a.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class nl extends ci{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class ic extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;t?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=t,this.dirty=!1}}class vo extends ci{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class ba extends ci{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Kh extends ci{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class eu extends ci{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ut extends ci{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const a=this.current;(t[0]!==a[0]||t[1]!==a[1]||t[2]!==a[2]||t[3]!==a[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Kc extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class ea extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Wc extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class ta extends ci{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Sd extends ci{getDefault(){return null}set(t){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Jc extends ci{getDefault(){return null}set(t){var a;if(t===this.current&&!this.dirty)return;const l=this.gl;_a(l)?l.bindVertexArray(t):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class bo extends ci{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Wh extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class eh extends ci{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class xo extends ci{constructor(t,a){super(t),this.context=t,this.parent=a}getDefault(){return null}}class tu extends xo{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class zr extends xo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class wo extends xo{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const To="Framebuffer is not complete";class rl{constructor(t,a,l,f,_){this.context=t,this.width=a,this.height=l;const b=t.gl,w=this.framebuffer=b.createFramebuffer();if(this.colorAttachment=new tu(t,w),f)this.depthAttachment=_?new wo(t,w):new zr(t,w);else if(_)throw new Error("Stencil cannot be set without depth");if(b.checkFramebufferStatus(b.FRAMEBUFFER)!==b.FRAMEBUFFER_COMPLETE)throw new Error(To)}destroy(){const t=this.context.gl,a=this.colorAttachment.get();if(a&&t.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&t.deleteRenderbuffer(l)}t.deleteFramebuffer(this.framebuffer)}}class So{constructor(t){var a,l;if(this.gl=t,this.clearColor=new ls(this),this.clearDepth=new Ju(this),this.clearStencil=new ec(this),this.colorMask=new Yc(this),this.depthMask=new tl(this),this.stencilMask=new tc(this),this.stencilFunc=new Jl(this),this.stencilOp=new Wr(this),this.stencilTest=new Qh(this),this.depthRange=new Qc(this),this.depthTest=new Jr(this),this.depthFunc=new us(this),this.blend=new Dr(this),this.blendFunc=new Ls(this),this.blendColor=new il(this),this.blendEquation=new nl(this),this.cullFace=new ic(this),this.cullFaceSide=new vo(this),this.frontFace=new ba(this),this.program=new Kh(this),this.activeTexture=new eu(this),this.viewport=new Ut(this),this.bindFramebuffer=new Kc(this),this.bindRenderbuffer=new ea(this),this.bindTexture=new Wc(this),this.bindVertexBuffer=new ta(this),this.bindElementBuffer=new Sd(this),this.bindVertexArray=new Jc(this),this.pixelStoreUnpack=new bo(this),this.pixelStoreUnpackPremultiplyAlpha=new Wh(this),this.pixelStoreUnpackFlipY=new eh(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),_a(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=t.RGBA16F)!==null&&a!==void 0?a:f?.RGBA16F_EXT,this.RGB16F=(l=t.RGB16F)!==null&&l!==void 0?l:f?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,a){return new Jo(this,t,a)}createVertexBuffer(t,a,l){return new Yh(this,t,a,l)}createRenderbuffer(t,a,l){const f=this.gl,_=f.createRenderbuffer();return this.bindRenderbuffer.set(_),f.renderbufferStorage(f.RENDERBUFFER,t,a,l),this.bindRenderbuffer.set(null),_}createFramebuffer(t,a,l,f){return new rl(this,t,a,l,f)}clear({color:t,depth:a,stencil:l}){const f=this.gl;let _=0;t&&(_|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(_|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(_|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),f.clear(_)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){h.bR(t.blendFunction,Mi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return _a(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var a;return _a(this.gl)?this.gl.deleteVertexArray(t):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Hn;function Qn(m,t,a,l,f){const _=m.context,b=m.transform,w=_.gl,A=m.useProgram("collisionBox"),I=[];let O=0,j=0;for(let te=0;te<l.length;te++){const ae=l[te],ce=t.getTile(ae).getBucket(a);if(!ce)continue;const re=f?ce.textCollisionBox:ce.iconCollisionBox,ue=ce.collisionCircleArray;ue.length>0&&(I.push({circleArray:ue,circleOffset:j,coord:ae}),O+=ue.length/4,j=O),re&&A.draw(_,w.LINES,jt.disabled,ri.disabled,m.colorModeForRenderPass(),Xt.disabled,go(m.transform),m.style.map.terrain&&m.style.map.terrain.getTerrainData(ae),b.getProjectionData({overscaledTileID:ae,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,null,m.transform.zoom,null,null,re.collisionVertexBuffer)}if(!f||!I.length)return;const k=m.useProgram("collisionCircle"),G=new h.ca;G.resize(4*O),G._trim();let X=0;for(const te of I)for(let ae=0;ae<te.circleArray.length/4;ae++){const ce=4*ae,re=te.circleArray[ce+0],ue=te.circleArray[ce+1],de=te.circleArray[ce+2],oe=te.circleArray[ce+3];G.emplace(X++,re,ue,de,oe,0),G.emplace(X++,re,ue,de,oe,1),G.emplace(X++,re,ue,de,oe,2),G.emplace(X++,re,ue,de,oe,3)}(!Hn||Hn.length<2*O)&&(Hn=(function(te){const ae=2*te,ce=new h.cc;ce.resize(ae),ce._trim();for(let re=0;re<ae;re++){const ue=6*re;ce.uint16[ue+0]=4*re+0,ce.uint16[ue+1]=4*re+1,ce.uint16[ue+2]=4*re+2,ce.uint16[ue+3]=4*re+2,ce.uint16[ue+4]=4*re+3,ce.uint16[ue+5]=4*re+0}return ce})(O));const ee=_.createIndexBuffer(Hn,!0),ie=_.createVertexBuffer(G,h.cb.members,!0);for(const te of I){const ae=Hh(m.transform);k.draw(_,w.TRIANGLES,jt.disabled,ri.disabled,m.colorModeForRenderPass(),Xt.disabled,ae,m.style.map.terrain&&m.style.map.terrain.getTerrainData(te.coord),null,a.id,ie,ee,h.aX.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,m.transform.zoom,null,null,null)}ie.destroy(),ee.destroy()}const cs=h.ar(new Float32Array(16));function hs(m,t,a,l,f,_){const{horizontalAlign:b,verticalAlign:w}=h.aS(m);return new h.P((-(b-.5)*t/f+l[0])*_,(-(w-.5)*a/f+l[1])*_)}function Lr(m,t,a,l,f,_){const b=t.tileAnchorPoint.add(new h.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let w=l.mult(_);a||(w=w.rotate(-f));const A=b.add(w);return kt(A.x,A.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(a){const w=ni(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(m),A=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return m.add(l.rotate(A))}return m.add(l)}function Bs(m,t,a,l,f,_,b,w,A,I,O,j){const k=m.text.placedSymbolArray,G=m.text.dynamicLayoutVertexArray,X=m.icon.dynamicLayoutVertexArray,ee={};G.clear();for(let ie=0;ie<k.length;ie++){const te=k.get(ie),ae=te.hidden||!te.crossTileID||m.allowVerticalPlacement&&!te.placedOrientation?null:l[te.crossTileID];if(ae){const ce=new h.P(te.anchorX,te.anchorY),re={getElevation:j,width:f.width,height:f.height,pitchedLabelPlaneMatrix:_,pitchWithMap:a,transform:f,tileAnchorPoint:ce,translation:I,unwrappedTileID:O},ue=a?Vl(ce.x,ce.y,re):ni(ce.x,ce.y,re),de=Go(f.cameraToCenterDistance,ue.signedDistanceFromCamera);let oe=h.aA(m.textSizeData,w,te)*de/h.aM;a&&(oe*=m.tilePixelRatio/b);const{width:ye,height:Ie,anchor:Me,textOffset:ze,textBoxScale:Pe}=ae,tt=hs(Me,ye,Ie,ze,Pe,oe),it=f.getPitchedTextCorrection(ce.x+I[0],ce.y+I[1],O),He=Lr(ue.point,re,t,tt,-f.bearingInRadians,it),at=m.allowVerticalPlacement&&te.placedOrientation===h.az.vertical?Math.PI/2:0;for(let Lt=0;Lt<te.numGlyphs;Lt++)h.aG(G,He,at);A&&te.associatedIconIndex>=0&&(ee[te.associatedIconIndex]={shiftedAnchor:He,angle:at})}else as(te.numGlyphs,G)}if(A){X.clear();const ie=m.icon.placedSymbolArray;for(let te=0;te<ie.length;te++){const ae=ie.get(te);if(ae.hidden)as(ae.numGlyphs,X);else{const ce=ee[te];if(ce)for(let re=0;re<ae.numGlyphs;re++)h.aG(X,ce.shiftedAnchor,ce.angle);else as(ae.numGlyphs,X)}}m.icon.dynamicLayoutVertexBuffer.updateData(X)}m.text.dynamicLayoutVertexBuffer.updateData(G)}function Jh(m,t,a){return a.iconsInText&&t?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function al(m,t,a,l,f,_,b,w,A,I,O,j,k){const G=m.context,X=G.gl,ee=m.transform,ie=w==="map",te=A==="map",ae=w!=="viewport"&&a.layout.get("symbol-placement")!=="point",ce=ie&&!te&&!ae,re=!a.layout.get("symbol-sort-key").isConstant();let ue=!1;const de=m.getDepthModeForSublayer(0,jt.ReadOnly),oe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),ye=[],Ie=ee.getCircleRadiusCorrection();for(const Me of l){const ze=t.getTile(Me),Pe=ze.getBucket(a);if(!Pe)continue;const tt=f?Pe.text:Pe.icon;if(!tt||!tt.segments.get().length||!tt.hasVisibleVertices)continue;const it=tt.programConfigurations.get(a.id),He=f||Pe.sdfIcons,at=f?Pe.textSizeData:Pe.iconSizeData,Lt=te||ee.pitch!==0,yi=m.useProgram(Jh(He,f,Pe),it),Ui=h.ay(at,ee.zoom),Li=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Me);let Xi,Ai,on,Yi,Wn=[0,0],_n=null;if(f)Ai=ze.glyphAtlasTexture,on=X.LINEAR,Xi=ze.glyphAtlasTexture.size,Pe.iconsInText&&(Wn=ze.imageAtlasTexture.size,_n=ze.imageAtlasTexture,Yi=Lt||m.options.rotating||m.options.zooming||at.kind==="composite"||at.kind==="camera"?X.LINEAR:X.NEAREST);else{const wi=a.layout.get("icon-size").constantOr(0)!==1||Pe.iconsNeedLinear;Ai=ze.imageAtlasTexture,on=He||m.options.rotating||m.options.zooming||wi||Lt?X.LINEAR:X.NEAREST,Xi=ze.imageAtlasTexture.size}const yn=h.aN(ze,1,m.transform.zoom),Jn=Yr(ie,m.transform,yn),Ss=h.N();h.aB(Ss,Jn);const Es=kc(te,ie,m.transform,yn),Ha=h.aO(ee,ze,_,b),jr=ee.getProjectionData({overscaledTileID:Me,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),pl=oe&&Pe.hasTextData(),hu=a.layout.get("icon-text-fit")!=="none"&&pl&&Pe.hasIconData();if(ae){const wi=m.style.map.terrain?(Rn,Fn)=>m.style.map.terrain.getElevation(Me,Rn,Fn):null,Bi=a.layout.get("text-rotation-alignment")==="map";Is(Pe,m,f,Jn,Ss,te,I,Bi,Me.toUnwrapped(),ee.width,ee.height,Ha,wi)}const $a=f&&oe||hu,Nr=ae||$a?cs:te?Jn:m.transform.clipSpaceToPixelsMatrix,sa=He&&a.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ma;Ma=He?Pe.iconsInText?va(at.kind,Ui,ce,te,ae,$a,m,Nr,Es,Ha,Xi,Wn,Ie):$c(at.kind,Ui,ce,te,ae,$a,m,Nr,Es,Ha,f,Xi,0,Ie):Qu(at.kind,Ui,ce,te,ae,$a,m,Nr,Es,Ha,f,Xi,Ie);const Aa={program:yi,buffers:tt,uniformValues:Ma,projectionData:jr,atlasTexture:Ai,atlasTextureIcon:_n,atlasInterpolation:on,atlasInterpolationIcon:Yi,isSDF:He,hasHalo:sa};if(re&&Pe.canOverlap){ue=!0;const wi=tt.segments.get();for(const Bi of wi)ye.push({segments:new h.aX([Bi]),sortKey:Bi.sortKey,state:Aa,terrainData:Li})}else ye.push({segments:tt.segments,sortKey:0,state:Aa,terrainData:Li})}ue&&ye.sort(((Me,ze)=>Me.sortKey-ze.sortKey));for(const Me of ye){const ze=Me.state;if(G.activeTexture.set(X.TEXTURE0),ze.atlasTexture.bind(ze.atlasInterpolation,X.CLAMP_TO_EDGE),ze.atlasTextureIcon&&(G.activeTexture.set(X.TEXTURE1),ze.atlasTextureIcon&&ze.atlasTextureIcon.bind(ze.atlasInterpolationIcon,X.CLAMP_TO_EDGE)),ze.isSDF){const Pe=ze.uniformValues;ze.hasHalo&&(Pe.u_is_halo=1,iu(ze.buffers,Me.segments,a,m,ze.program,de,O,j,Pe,ze.projectionData,Me.terrainData)),Pe.u_is_halo=0}iu(ze.buffers,Me.segments,a,m,ze.program,de,O,j,ze.uniformValues,ze.projectionData,Me.terrainData)}}function iu(m,t,a,l,f,_,b,w,A,I,O){const j=l.context;f.draw(j,j.gl.TRIANGLES,_,b,w,Xt.backCCW,A,O,I,a.id,m.layoutVertexBuffer,m.indexBuffer,t,a.paint,l.transform.zoom,m.programConfigurations.get(a.id),m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer)}function ef(m,t,a,l,f){const _=m.context,b=_.gl,w=ri.disabled,A=new Mi([b.ONE,b.ONE],h.bp.transparent,[!0,!0,!0,!0]),I=t.getBucket(a);if(!I)return;const O=l.key;let j=a.heatmapFbos.get(O);j||(j=Oi(_,t.tileSize,t.tileSize),a.heatmapFbos.set(O,j)),_.bindFramebuffer.set(j.framebuffer),_.viewport.set([0,0,t.tileSize,t.tileSize]),_.clear({color:h.bp.transparent});const k=I.programConfigurations.get(a.id),G=m.useProgram("heatmap",k,!f),X=m.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ee=m.style.map.terrain.getTerrainData(l);G.draw(_,b.TRIANGLES,jt.disabled,w,A,Xt.disabled,_o(t,m.transform.zoom,a.paint.get("heatmap-intensity"),1),ee,X,a.id,I.layoutVertexBuffer,I.indexBuffer,I.segments,a.paint,m.transform.zoom,k)}function Kn(m,t,a,l,f){const _=m.context,b=_.gl,w=m.transform;_.setColorMode(m.colorModeForRenderPass());const A=ti(_,t),I=a.key,O=t.heatmapFbos.get(I);if(!O)return;_.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,O.colorAttachment.get()),_.activeTexture.set(b.TEXTURE1),A.bind(b.LINEAR,b.CLAMP_TO_EDGE);const j=w.getProjectionData({overscaledTileID:a,applyTerrainMatrix:f,applyGlobeMatrix:!l});m.useProgram("heatmapTexture").draw(_,b.TRIANGLES,jt.disabled,ri.disabled,m.colorModeForRenderPass(),Xt.disabled,$h(m,t,0,1),null,j,t.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments,t.paint,w.zoom),O.destroy(),t.heatmapFbos.delete(I)}function Oi(m,t,a){var l,f;const _=m.gl,b=_.createTexture();_.bindTexture(_.TEXTURE_2D,b),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,_.CLAMP_TO_EDGE),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,_.LINEAR),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,_.LINEAR);const w=(l=m.HALF_FLOAT)!==null&&l!==void 0?l:_.UNSIGNED_BYTE,A=(f=m.RGBA16F)!==null&&f!==void 0?f:_.RGBA;_.texImage2D(_.TEXTURE_2D,0,A,t,a,0,_.RGBA,w,null);const I=m.createFramebuffer(t,a,!1,!1);return I.colorAttachment.set(b),I}function ti(m,t){return t.colorRampTexture||(t.colorRampTexture=new h.T(m,t.colorRamp,m.gl.RGBA)),t.colorRampTexture}function ks(m,t,a,l,f,_,b,w){let A=256;if(f.stepInterpolant){const I=t.getSource().maxzoom,O=b.canonical.z===I?Math.ceil(1<<m.transform.maxZoom-b.canonical.z):1;A=h.an(h.ce(_.maxLineLength/h.a5*1024*O),256,a.maxTextureSize)}return w.gradient=h.cf({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:A,image:w.gradient||void 0,clips:_.lineClipsArray}),w.texture?w.texture.update(w.gradient):w.texture=new h.T(a,w.gradient,l.RGBA),w.version=f.gradientVersion,w.texture}function ia(m,t,a,l,f){m.activeTexture.set(t.TEXTURE0),a.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),l.updatePaintBuffers(f)}function an(m,t,a,l,f,_){(f||m.lineAtlas.dirty)&&(t.activeTexture.set(a.TEXTURE0),m.lineAtlas.bind(t)),l.updatePaintBuffers(_)}function Br(m,t,a,l,f,_,b){const w=_.gradients[f.id];let A=w.texture;f.gradientVersion!==w.version&&(A=ks(m,t,a,l,f,_,b,w)),a.activeTexture.set(l.TEXTURE0),A.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE)}function kr(m,t,a,l,f,_,b,w,A){const I=_.gradients[f.id];let O=I.texture;f.gradientVersion!==I.version&&(O=ks(m,t,a,l,f,_,b,I)),a.activeTexture.set(l.TEXTURE0),O.bind(f.stepInterpolant?l.NEAREST:l.LINEAR,l.CLAMP_TO_EDGE),a.activeTexture.set(l.TEXTURE1),m.lineAtlas.bind(a),w.updatePaintBuffers(A)}function nc(m,t,a,l,f){if(!a||!l||!l.imageAtlas)return;const _=l.imageAtlas.patternPositions;let b=_[a.to.toString()],w=_[a.from.toString()];if(!b&&w&&(b=w),!w&&b&&(w=b),!b||!w){const A=f.getPaintProperty(t);b=_[A],w=_[A]}b&&w&&m.setConstantPatternPositions(b,w)}function fs(m,t,a,l,f,_,b,w){const A=m.context.gl,I="fill-pattern",O=a.paint.get(I),j=O&&O.constantOr(1),k=a.getCrossfadeParameters();let G,X,ee,ie,te;const ae=m.transform,ce=a.paint.get("fill-translate"),re=a.paint.get("fill-translate-anchor");b?(X=j&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",G=A.LINES):(X=j?"fillPattern":"fill",G=A.TRIANGLES);const ue=O.constantOr(null);for(const de of l){const oe=t.getTile(de);if(j&&!oe.patternsLoaded())continue;const ye=oe.getBucket(a);if(!ye)continue;const Ie=ye.programConfigurations.get(a.id),Me=m.useProgram(X,Ie),ze=m.style.map.terrain&&m.style.map.terrain.getTerrainData(de);j&&(m.context.activeTexture.set(A.TEXTURE0),oe.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),Ie.updatePaintBuffers(k)),nc(Ie,I,ue,oe,a);const Pe=ae.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),tt=h.aO(ae,oe,ce,re);if(b){ie=ye.indexBuffer2,te=ye.segments2;const He=[A.drawingBufferWidth,A.drawingBufferHeight];ee=X==="fillOutlinePattern"&&j?vd(m,k,oe,He,tt):Wl(He,tt)}else ie=ye.indexBuffer,te=ye.segments,ee=j?Wo(m,k,oe,tt):{u_fill_translate:tt};const it=m.stencilModeForClipping(de);Me.draw(m.context,G,f,it,_,Xt.backCCW,ee,ze,Pe,a.id,ye.layoutVertexBuffer,ie,te,a.paint,m.transform.zoom,Ie)}}function ds(m,t,a,l,f,_,b,w){const A=m.context,I=A.gl,O="fill-extrusion-pattern",j=a.paint.get(O),k=j.constantOr(1),G=a.getCrossfadeParameters(),X=a.paint.get("fill-extrusion-opacity"),ee=j.constantOr(null),ie=m.transform;for(const te of l){const ae=t.getTile(te),ce=ae.getBucket(a);if(!ce)continue;const re=m.style.map.terrain&&m.style.map.terrain.getTerrainData(te),ue=ce.programConfigurations.get(a.id),de=m.useProgram(k?"fillExtrusionPattern":"fillExtrusion",ue);k&&(m.context.activeTexture.set(I.TEXTURE0),ae.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ue.updatePaintBuffers(G));const oe=ie.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!w,applyTerrainMatrix:!0});nc(ue,O,ee,ae,a);const ye=h.aO(ie,ae,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ie=a.paint.get("fill-extrusion-vertical-gradient"),Me=k?qc(m,Ie,X,ye,te,G,ae):Gc(m,Ie,X,ye);de.draw(A,A.gl.TRIANGLES,f,_,b,Xt.backCCW,Me,re,oe,a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,a.paint,m.transform.zoom,ue,m.style.map.terrain&&ce.centroidVertexBuffer)}}function ps(m,t,a,l,f,_,b,w,A){var I;const O=m.style.projection,j=m.context,k=m.transform,G=j.gl,X=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],ee=m.useProgram("hillshade",null,!1,X),ie=!m.options.moving;for(const te of l){const ae=t.getTile(te),ce=ae.fbo;if(!ce)continue;const re=O.getMeshFromTileID(j,te.canonical,w,!0,"raster"),ue=(I=m.style.map.terrain)===null||I===void 0?void 0:I.getTerrainData(te);j.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,ce.colorAttachment.get());const de=k.getProjectionData({overscaledTileID:te,aligned:ie,applyGlobeMatrix:!A,applyTerrainMatrix:!0});ee.draw(j,G.TRIANGLES,_,f[te.overscaledZ],b,Xt.backCCW,$u(m,ae,a),ue,de,a.id,re.vertexBuffer,re.indexBuffer,re.segments)}}function Fs(m,t,a,l,f,_,b,w,A){var I;const O=m.style.projection,j=m.context,k=m.transform,G=j.gl,X=m.useProgram("colorRelief"),ee=!m.options.moving;let ie=!0,te=0;for(const ae of l){const ce=t.getTile(ae),re=ce.dem;if(ie){const Me=G.getParameter(G.MAX_TEXTURE_SIZE),{elevationTexture:ze,colorTexture:Pe}=a.getColorRampTextures(j,Me,re.getUnpackVector());j.activeTexture.set(G.TEXTURE1),ze.bind(G.NEAREST,G.CLAMP_TO_EDGE),j.activeTexture.set(G.TEXTURE4),Pe.bind(G.LINEAR,G.CLAMP_TO_EDGE),ie=!1,te=ze.size[0]}if(!re||!re.data)continue;const ue=re.stride,de=re.getPixels();if(j.activeTexture.set(G.TEXTURE0),j.pixelStoreUnpackPremultiplyAlpha.set(!1),ce.demTexture=ce.demTexture||m.getTileTexture(ue),ce.demTexture){const Me=ce.demTexture;Me.update(de,{premultiply:!1}),Me.bind(G.LINEAR,G.CLAMP_TO_EDGE)}else ce.demTexture=new h.T(j,de,G.RGBA,{premultiply:!1}),ce.demTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE);const oe=O.getMeshFromTileID(j,ae.canonical,w,!0,"raster"),ye=(I=m.style.map.terrain)===null||I===void 0?void 0:I.getTerrainData(ae),Ie=k.getProjectionData({overscaledTileID:ae,aligned:ee,applyGlobeMatrix:!A,applyTerrainMatrix:!0});X.draw(j,G.TRIANGLES,_,f[ae.overscaledZ],b,Xt.backCCW,xd(a,ce.dem,te),ye,Ie,a.id,oe.vertexBuffer,oe.indexBuffer,oe.segments)}}const js=[new h.P(0,0),new h.P(h.a5,0),new h.P(h.a5,h.a5),new h.P(0,h.a5)];function xa(m,t,a,l,f,_,b,w,A=!1,I=!1){const O=l[l.length-1].overscaledZ,j=m.context,k=j.gl,G=m.useProgram("raster"),X=m.transform,ee=m.style.projection,ie=m.colorModeForRenderPass(),te=!m.options.moving,ae=a.paint.get("raster-opacity"),ce=a.paint.get("raster-resampling"),re=a.paint.get("raster-fade-duration"),ue=!!m.style.map.terrain;for(const de of l){const oe=m.getDepthModeForSublayer(de.overscaledZ-O,ae===1?jt.ReadWrite:jt.ReadOnly,k.LESS),ye=t.getTile(de),Ie=ce==="nearest"?k.NEAREST:k.LINEAR;j.activeTexture.set(k.TEXTURE0),ye.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),j.activeTexture.set(k.TEXTURE1);const{parentTile:Me,parentScaleBy:ze,parentTopLeft:Pe,fadeValues:tt}=ms(ye,t,re,ue);ye.fadeOpacity=tt.tileOpacity,Me?(Me.fadeOpacity=tt.parentTileOpacity,Me.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST)):ye.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),ye.texture.useMipmap&&j.extTextureFilterAnisotropic&&m.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const it=m.style.map.terrain&&m.style.map.terrain.getTerrainData(de),He=X.getProjectionData({overscaledTileID:de,aligned:te,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),at=Zc(Pe,ze,tt.fadeMix,a,w),Lt=ee.getMeshFromTileID(j,de.canonical,_,b,"raster");G.draw(j,k.TRIANGLES,oe,f?f[de.overscaledZ]:ri.disabled,ie,A?Xt.frontCCW:Xt.backCCW,at,it,He,a.id,Lt.vertexBuffer,Lt.indexBuffer,Lt.segments)}}function ms(m,t,a,l){const f={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(a===0||l)return f;if(m.fadingParentID){const _=t.getLoadedTile(m.fadingParentID);if(!_)return f;const b=Math.pow(2,_.tileID.overscaledZ-m.tileID.overscaledZ),w=[m.tileID.canonical.x*b%1,m.tileID.canonical.y*b%1],A=(function(I,O,j){const k=rt(),G=(k-O.timeAdded)/j,X=I.fadingDirection===De.Incoming,ee=h.an((k-I.timeAdded)/j,0,1),ie=h.an(1-G,0,1),te=X?ee:ie;return{tileOpacity:te,parentTileOpacity:X?ie:ee,fadeMix:{opacity:1,mix:1-te}}})(m,_,a);return{parentTile:_,parentScaleBy:b,parentTopLeft:w,fadeValues:A}}if(m.selfFading){const _=(function(b,w){const A=(rt()-b.timeAdded)/w,I=h.an(A,0,1);return{tileOpacity:I,fadeMix:{opacity:I,mix:0}}})(m,a);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:_}}return f}const Ns=new h.bp(1,0,0,1),gs=new h.bp(0,1,0,1),th=new h.bp(0,0,1,1),ih=new h.bp(1,0,1,1),na=new h.bp(0,1,1,1);function nu(m,t,a,l){In(m,0,t+a/2,m.transform.width,a,l)}function Vs(m,t,a,l){In(m,t-a/2,0,a,m.transform.height,l)}function In(m,t,a,l,f,_){const b=m.context,w=b.gl;w.enable(w.SCISSOR_TEST),w.scissor(t*m.pixelRatio,a*m.pixelRatio,l*m.pixelRatio,f*m.pixelRatio),b.clear({color:_}),w.disable(w.SCISSOR_TEST)}function rc(m,t,a){const l=m.context,f=l.gl,_=m.useProgram("debug"),b=jt.disabled,w=ri.disabled,A=m.colorModeForRenderPass(),I="$debug",O=m.style.map.terrain&&m.style.map.terrain.getTerrainData(a);l.activeTexture.set(f.TEXTURE0);const j=t.getTileByID(a.key).latestRawTileData,k=Math.floor((j&&j.byteLength||0)/1024),G=t.getTile(a).tileSize,X=512/Math.min(G,512)*(a.overscaledZ/m.transform.zoom)*.5;let ee=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ee+=` => ${a.overscaledZ}`),(function(te,ae){te.initDebugOverlayCanvas();const ce=te.debugOverlayCanvas,re=te.context.gl,ue=te.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,ce.width,ce.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(ae,5,5),ue.strokeText(ae,5,5),te.debugOverlayTexture.update(ce),te.debugOverlayTexture.bind(re.LINEAR,re.CLAMP_TO_EDGE)})(m,`${ee} ${k}kB`);const ie=m.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(l,f.TRIANGLES,b,w,Mi.alphaBlended,Xt.disabled,Hu(h.bp.transparent,X),null,ie,I,m.debugBuffer,m.quadTriangleIndexBuffer,m.debugSegments),_.draw(l,f.LINE_STRIP,b,w,A,Xt.disabled,Hu(h.bp.red),O,ie,I,m.debugBuffer,m.tileBorderIndexBuffer,m.debugSegments)}function nh(m,t,a,l){const{isRenderingGlobe:f}=l,_=m.context,b=_.gl,w=m.transform,A=m.colorModeForRenderPass(),I=m.getDepthModeFor3D(),O=m.useProgram("terrain");_.bindFramebuffer.set(null),_.viewport.set([0,0,m.width,m.height]);for(const j of a){const k=t.getTerrainMesh(j.tileID),G=m.renderToTexture.getTexture(j),X=t.getTerrainData(j.tileID);_.activeTexture.set(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,G.texture);const ee=t.getMeshFrameDelta(w.zoom),ie=w.calculateFogMatrix(j.tileID.toUnwrapped()),te=gd(ee,ie,m.style.sky,w.pitch,f),ae=w.getProjectionData({overscaledTileID:j.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});O.draw(_,b.TRIANGLES,I,ri.disabled,A,Xt.backCCW,te,X,ae,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}function tf(m,t){if(!t.mesh){const a=new h.aW;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new h.aY;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),t.mesh=new Ri(m.createVertexBuffer(a,ga.members),m.createIndexBuffer(l),h.aX.simpleSegment(0,0,a.length,l.length))}return t.mesh}class Ed{constructor(t,a){this.context=new So(t),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.ar(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Vi.maxOverzooming+Vi.maxUnderzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new qn}resize(t,a,l){if(this.width=Math.floor(t*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,a=new h.aW;a.emplaceBack(0,0),a.emplaceBack(h.a5,0),a.emplaceBack(0,h.a5),a.emplaceBack(h.a5,h.a5),this.tileExtentBuffer=t.createVertexBuffer(a,ga.members),this.tileExtentSegments=h.aX.simpleSegment(0,0,4,2);const l=new h.aW;l.emplaceBack(0,0),l.emplaceBack(h.a5,0),l.emplaceBack(0,h.a5),l.emplaceBack(h.a5,h.a5),this.debugBuffer=t.createVertexBuffer(l,ga.members),this.debugSegments=h.aX.simpleSegment(0,0,4,5);const f=new h.ch;f.emplaceBack(0,0,0,0),f.emplaceBack(h.a5,0,h.a5,0),f.emplaceBack(0,h.a5,0,h.a5),f.emplaceBack(h.a5,h.a5,h.a5,h.a5),this.rasterBoundsBuffer=t.createVertexBuffer(f,md.members),this.rasterBoundsSegments=h.aX.simpleSegment(0,0,4,2);const _=new h.aW;_.emplaceBack(0,0),_.emplaceBack(h.a5,0),_.emplaceBack(0,h.a5),_.emplaceBack(h.a5,h.a5),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(_,ga.members),this.rasterBoundsSegmentsPosOnly=h.aX.simpleSegment(0,0,4,5);const b=new h.aW;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(b,ga.members),this.viewportSegments=h.aX.simpleSegment(0,0,4,2);const w=new h.ci;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(w);const A=new h.aY;A.emplaceBack(1,0,2),A.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(A);const I=this.context.gl;this.stencilClearMode=new ri({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.tileExtentMesh=new Ri(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,a=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=h.N();h.c7(l,0,this.width,this.height,0,0,1),h.Q(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const f={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(t,a.TRIANGLES,jt.disabled,this.stencilClearMode,Mi.disabled,Xt.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,a,l){if(this.currentStencilSource===t.source||!t.isTileClipped()||!a||!a.length)return;this.currentStencilSource=t.source,this.nextStencilID+a.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Mi.disabled),f.setDepthMode(jt.disabled);const _={};for(const b of a)_[b.key]=this.nextStencilID++;this._renderTileMasks(_,a,l,!0),this._renderTileMasks(_,a,l,!1),this._tileClippingMaskIDs=_}_renderTileMasks(t,a,l,f){const _=this.context,b=_.gl,w=this.style.projection,A=this.transform,I=this.useProgram("clippingMask");for(const O of a){const j=t[O.key],k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(O),G=w.getMeshFromTileID(this.context,O.canonical,f,!0,"stencil"),X=A.getProjectionData({overscaledTileID:O,applyGlobeMatrix:!l,applyTerrainMatrix:!0});I.draw(_,b.TRIANGLES,jt.disabled,new ri({func:b.ALWAYS,mask:0},j,255,b.KEEP,b.KEEP,b.REPLACE),Mi.disabled,l?Xt.disabled:Xt.backCCW,null,k,X,"$clipping",G.vertexBuffer,G.indexBuffer,G.segments)}}_renderTilesDepthBuffer(){const t=this.context,a=t.gl,l=this.style.projection,f=this.transform,_=this.useProgram("depth"),b=this.getDepthModeFor3D(),w=fn(f,{tileSize:f.tileSize});for(const A of w){const I=this.style.map.terrain&&this.style.map.terrain.getTerrainData(A),O=l.getMeshFromTileID(this.context,A.canonical,!0,!0,"raster"),j=f.getProjectionData({overscaledTileID:A,applyGlobeMatrix:!0,applyTerrainMatrix:!0});_.draw(t,a.TRIANGLES,b,ri.disabled,Mi.disabled,Xt.backCCW,null,I,j,"$clipping",O.vertexBuffer,O.indexBuffer,O.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,a=this.context.gl;return new ri({func:a.NOTEQUAL,mask:255},t,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(t){const a=this.context.gl;return new ri({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const a=this.context.gl,l=t.sort(((b,w)=>w.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,_=l[0].overscaledZ-f+1;if(_>1){this.currentStencilSource=void 0,this.nextStencilID+_>256&&this.clearStencil();const b={};for(let w=0;w<_;w++)b[w+f]=new ri({func:a.GEQUAL,mask:255},w+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=_,[b,l]}return[{[f]:ri.disabled},l]}stencilConfigForOverlapTwoPass(t){const a=this.context.gl,l=t.sort(((b,w)=>w.overscaledZ-b.overscaledZ)),f=l[l.length-1].overscaledZ,_=l[0].overscaledZ-f+1;if(this.clearStencil(),_>1){const b={},w={};for(let A=0;A<_;A++)b[A+f]=new ri({func:a.GREATER,mask:255},_+1+A,255,a.KEEP,a.KEEP,a.REPLACE),w[A+f]=new ri({func:a.GREATER,mask:255},1+A,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*_+1,[b,w,l]}return this.nextStencilID=3,[{[f]:new ri({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[f]:new ri({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Mi([t.CONSTANT_COLOR,t.ONE],new h.bp(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mi.unblended:Mi.alphaBlended}getDepthModeForSublayer(t,a,l){if(!this.opaquePassEnabledForLayer())return jt.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new jt(l||this.context.gl.LEQUAL,a,[f,f])}getDepthModeFor3D(){return new jt(this.context.gl.LEQUAL,jt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,a){var l,f;this.style=t,this.options=a,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(rt()),this.imageManager.beginFrame();const _=this.style._order,b=this.style.tileManagers,w={},A={},I={},O={isRenderingToTexture:!1,isRenderingGlobe:((l=t.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const k in b){const G=b[k];G.used&&G.prepare(this.context),w[k]=G.getVisibleCoordinates(!1),A[k]=w[k].slice().reverse(),I[k]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<_.length;k++)if(this.style._layers[_[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of _){const G=this.style._layers[k];if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const X=A[G.source];(G.type==="custom"||X.length)&&this.renderLayer(this,b[G.source],G,X,O)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:k=>this.useProgram(k)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?h.bp.black:h.bp.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(k,G){const X=k.context,ee=X.gl,ie=((de,oe,ye)=>{const Ie=Math.cos(oe.rollInRadians),Me=Math.sin(oe.rollInRadians),ze=gi(oe),Pe=oe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:de.properties.get("sky-color"),u_horizon_color:de.properties.get("horizon-color"),u_horizon:[(oe.width/2-ze*Me)*ye,(oe.height/2+ze*Ie)*ye],u_horizon_normal:[-Me,Ie],u_sky_horizon_blend:de.properties.get("sky-horizon-blend")*oe.height/2*ye,u_sky_blend:Pe}})(G,k.style.map.transform,k.pixelRatio),te=new jt(ee.LEQUAL,jt.ReadWrite,[0,1]),ae=ri.disabled,ce=k.colorModeForRenderPass(),re=k.useProgram("sky"),ue=tf(X,G);re.draw(X,ee.TRIANGLES,te,ae,ce,Xt.disabled,ie,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[_[this.currentLayer]],G=b[k.source],X=w[k.source];this._renderTileClippingMasks(k,X,!1),this.renderLayer(this,G,k,X,O)}this.renderPass="translucent";let j=!1;for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const k=this.style._layers[_[this.currentLayer]],G=b[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k,O))continue;this.opaquePassEnabledForLayer()||j||(j=!0,O.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const X=(k.type==="symbol"?I:A)[k.source];this._renderTileClippingMasks(k,w[k.source],!!this.renderToTexture),this.renderLayer(this,G,k,X,O)}if(O.isRenderingGlobe&&(function(k,G,X){const ee=k.context,ie=ee.gl,te=k.useProgram("atmosphere"),ae=new jt(ie.LEQUAL,jt.ReadOnly,[0,1]),ce=k.transform,re=(function(Pe,tt){const it=Pe.properties.get("position"),He=[-it.x,-it.y,-it.z],at=h.ar(new Float64Array(16));return Pe.properties.get("anchor")==="map"&&(h.bg(at,at,tt.rollInRadians),h.bh(at,at,-tt.pitchInRadians),h.bg(at,at,tt.bearingInRadians),h.bh(at,at,tt.center.lat*Math.PI/180),h.bJ(at,at,-tt.center.lng*Math.PI/180)),h.cg(He,He,at),He})(X,k.transform),ue=ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),de=G.properties.get("atmosphere-blend")*ue.projectionTransition;if(de===0)return;const oe=Ko(ce.worldSize,ce.center.lat),ye=ce.inverseProjectionMatrix,Ie=new Float64Array(4);Ie[3]=1,h.aH(Ie,Ie,ce.modelViewProjectionMatrix),Ie[0]/=Ie[3],Ie[1]/=Ie[3],Ie[2]/=Ie[3],Ie[3]=1,h.aH(Ie,Ie,ye),Ie[0]/=Ie[3],Ie[1]/=Ie[3],Ie[2]/=Ie[3],Ie[3]=1;const Me=((Pe,tt,it,He,at)=>({u_sun_pos:Pe,u_atmosphere_blend:tt,u_globe_position:it,u_globe_radius:He,u_inv_proj_matrix:at}))(re,de,[Ie[0],Ie[1],Ie[2]],oe,ye),ze=tf(ee,G);te.draw(ee,ie.TRIANGLES,ae,ri.disabled,Mi.alphaBlended,Xt.disabled,Me,null,null,"atmosphere",ze.vertexBuffer,ze.indexBuffer,ze.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const k=(function(G,X){let ee=null;const ie=Object.values(G._layers).flatMap((re=>re.source&&!re.isHidden(X)?[G.tileManagers[re.source]]:[])),te=ie.filter((re=>re.getSource().type==="vector")),ae=ie.filter((re=>re.getSource().type!=="vector")),ce=re=>{(!ee||ee.getSource().maxzoom<re.getSource().maxzoom)&&(ee=re)};return te.forEach((re=>ce(re))),ee||ae.forEach((re=>ce(re))),ee})(this.style,this.transform.zoom);k&&(function(G,X,ee){for(let ie=0;ie<ee.length;ie++)rc(G,X,ee[ie])})(this,k,k.getVisibleCoordinates())}this.options.showPadding&&(function(k){const G=k.transform.padding;nu(k,k.transform.height-(G.top||0),3,Ns),nu(k,G.bottom||0,3,gs),Vs(k,G.left||0,3,th),Vs(k,k.transform.width-(G.right||0),3,ih);const X=k.transform.centerPoint;(function(ee,ie,te,ae){In(ee,ie-1,te-10,2,20,ae),In(ee,ie-10,te-1,20,2,ae)})(k,X.x,k.transform.height-X.y,na)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!h.cj(a,l):!h.ck(a,l)),f||(f=this.style.map.terrain.tileManager.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(h.cl(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(_,b){const w=_.context,A=w.gl,I=_.transform,O=Mi.unblended,j=new jt(A.LEQUAL,jt.ReadWrite,[0,1]),k=b.tileManager.getRenderableTiles(),G=_.useProgram("terrainDepth");w.bindFramebuffer.set(b.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),w.clear({color:h.bp.transparent,depth:1});for(const X of k){const ee=b.getTerrainMesh(X.tileID),ie=b.getTerrainData(X.tileID),te=I.getProjectionData({overscaledTileID:X.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ae={u_ele_delta:b.getMeshFrameDelta(I.zoom)};G.draw(w,A.TRIANGLES,j,ri.disabled,O,Xt.backCCW,ae,ie,te,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,_.width,_.height])})(this,this.style.map.terrain),(function(_,b){const w=_.context,A=w.gl,I=_.transform,O=Mi.unblended,j=new jt(A.LEQUAL,jt.ReadWrite,[0,1]),k=b.getCoordsTexture(),G=b.tileManager.getRenderableTiles(),X=_.useProgram("terrainCoords");w.bindFramebuffer.set(b.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,_.width/devicePixelRatio,_.height/devicePixelRatio]),w.clear({color:h.bp.transparent,depth:1}),b.coordsIndex=[];for(const ee of G){const ie=b.getTerrainMesh(ee.tileID),te=b.getTerrainData(ee.tileID);w.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,k.texture);const ae={u_terrain_coords_id:(255-b.coordsIndex.length)/255,u_texture:0,u_ele_delta:b.getMeshFrameDelta(I.zoom)},ce=I.getProjectionData({overscaledTileID:ee.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});X.draw(w,A.TRIANGLES,j,ri.disabled,O,Xt.backCCW,ae,te,ce,"terrain",ie.vertexBuffer,ie.indexBuffer,ie.segments),b.coordsIndex.push(ee.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,_.width,_.height])})(this,this.style.map.terrain))}renderLayer(t,a,l,f,_){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(f||[]).length)&&(this.id=l.id,h.cm(l)?(function(b,w,A,I,O,j){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:k}=j,G=ri.disabled,X=b.colorModeForRenderPass();(A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(ee,ie,te,ae,ce,re,ue,de,oe){const ye=ie.transform,Ie=ie.style.map.terrain,Me=ce==="map",ze=re==="map";for(const Pe of ee){const tt=ae.getTile(Pe),it=tt.getBucket(te);if(!it||!it.text||!it.text.segments.get().length)continue;const He=h.ay(it.textSizeData,ye.zoom),at=h.aN(tt,1,ie.transform.zoom),Lt=Yr(Me,ie.transform,at),yi=te.layout.get("icon-text-fit")!=="none"&&it.hasIconData();if(He){const Ui=Math.pow(2,ye.zoom-tt.tileID.overscaledZ),Li=Ie?(Xi,Ai)=>Ie.getElevation(Pe,Xi,Ai):null;Bs(it,Me,ze,oe,ye,Lt,Ui,He,yi,h.aO(ye,tt,ue,de),Pe.toUnwrapped(),Li)}}})(I,b,A,w,A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),O),A.paint.get("icon-opacity").constantOr(1)!==0&&al(b,w,A,I,!1,A.paint.get("icon-translate"),A.paint.get("icon-translate-anchor"),A.layout.get("icon-rotation-alignment"),A.layout.get("icon-pitch-alignment"),A.layout.get("icon-keep-upright"),G,X,k),A.paint.get("text-opacity").constantOr(1)!==0&&al(b,w,A,I,!0,A.paint.get("text-translate"),A.paint.get("text-translate-anchor"),A.layout.get("text-rotation-alignment"),A.layout.get("text-pitch-alignment"),A.layout.get("text-keep-upright"),G,X,k),w.map.showCollisionBoxes&&(Qn(b,w,A,I,!0),Qn(b,w,A,I,!1))})(t,a,l,f,this.style.placement.variableOffsets,_):h.cn(l)?(function(b,w,A,I,O){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:j}=O,k=A.paint.get("circle-opacity"),G=A.paint.get("circle-stroke-width"),X=A.paint.get("circle-stroke-opacity"),ee=!A.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(G.constantOr(1)===0||X.constantOr(1)===0))return;const ie=b.context,te=ie.gl,ae=b.transform,ce=b.getDepthModeForSublayer(0,jt.ReadOnly),re=ri.disabled,ue=b.colorModeForRenderPass(),de=[],oe=ae.getCircleRadiusCorrection();for(let ye=0;ye<I.length;ye++){const Ie=I[ye],Me=w.getTile(Ie),ze=Me.getBucket(A);if(!ze)continue;const Pe=A.paint.get("circle-translate"),tt=A.paint.get("circle-translate-anchor"),it=h.aO(ae,Me,Pe,tt),He=ze.programConfigurations.get(A.id),at=b.useProgram("circle",He),Lt=ze.layoutVertexBuffer,yi=ze.indexBuffer,Ui=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Ie),Li={programConfiguration:He,program:at,layoutVertexBuffer:Lt,indexBuffer:yi,uniformValues:Zu(b,Me,A,it,oe),terrainData:Ui,projectionData:ae.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!j,applyTerrainMatrix:!0})};if(ee){const Xi=ze.segments.get();for(const Ai of Xi)de.push({segments:new h.aX([Ai]),sortKey:Ai.sortKey,state:Li})}else de.push({segments:ze.segments,sortKey:0,state:Li})}ee&&de.sort(((ye,Ie)=>ye.sortKey-Ie.sortKey));for(const ye of de){const{programConfiguration:Ie,program:Me,layoutVertexBuffer:ze,indexBuffer:Pe,uniformValues:tt,terrainData:it,projectionData:He}=ye.state;Me.draw(ie,te.TRIANGLES,ce,re,ue,Xt.backCCW,tt,it,He,A.id,ze,Pe,ye.segments,A.paint,b.transform.zoom,Ie)}})(t,a,l,f,_):h.co(l)?(function(b,w,A,I,O){if(A.paint.get("heatmap-opacity")===0)return;const j=b.context,{isRenderingToTexture:k,isRenderingGlobe:G}=O;if(b.style.map.terrain){for(const X of I){const ee=w.getTile(X);w.hasRenderableParent(X)||(b.renderPass==="offscreen"?ef(b,ee,A,X,G):b.renderPass==="translucent"&&Kn(b,A,X,k,G))}j.viewport.set([0,0,b.width,b.height])}else b.renderPass==="offscreen"?(function(X,ee,ie,te){const ae=X.context,ce=ae.gl,re=X.transform,ue=ri.disabled,de=new Mi([ce.ONE,ce.ONE],h.bp.transparent,[!0,!0,!0,!0]);(function(oe,ye,Ie){const Me=oe.gl;oe.activeTexture.set(Me.TEXTURE1),oe.viewport.set([0,0,ye.width/4,ye.height/4]);let ze=Ie.heatmapFbos.get(h.cd);ze?(Me.bindTexture(Me.TEXTURE_2D,ze.colorAttachment.get()),oe.bindFramebuffer.set(ze.framebuffer)):(ze=Oi(oe,ye.width/4,ye.height/4),Ie.heatmapFbos.set(h.cd,ze))})(ae,X,ie),ae.clear({color:h.bp.transparent});for(let oe=0;oe<te.length;oe++){const ye=te[oe];if(ee.hasRenderableParent(ye))continue;const Ie=ee.getTile(ye),Me=Ie.getBucket(ie);if(!Me)continue;const ze=Me.programConfigurations.get(ie.id),Pe=X.useProgram("heatmap",ze),tt=re.getProjectionData({overscaledTileID:ye,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),it=re.getCircleRadiusCorrection();Pe.draw(ae,ce.TRIANGLES,jt.disabled,ue,de,Xt.backCCW,_o(Ie,re.zoom,ie.paint.get("heatmap-intensity"),it),null,tt,ie.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,ie.paint,re.zoom,ze)}ae.viewport.set([0,0,X.width,X.height])})(b,w,A,I):b.renderPass==="translucent"&&(function(X,ee){const ie=X.context,te=ie.gl;ie.setColorMode(X.colorModeForRenderPass());const ae=ee.heatmapFbos.get(h.cd);ae&&(ie.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,ae.colorAttachment.get()),ie.activeTexture.set(te.TEXTURE1),ti(ie,ee).bind(te.LINEAR,te.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(ie,te.TRIANGLES,jt.disabled,ri.disabled,X.colorModeForRenderPass(),Xt.disabled,$h(X,ee,0,1),null,null,ee.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,ee.paint,X.transform.zoom))})(b,A)})(t,a,l,f,_):h.cp(l)?(function(b,w,A,I,O){if(b.renderPass!=="translucent")return;const{isRenderingToTexture:j}=O,k=A.paint.get("line-opacity"),G=A.paint.get("line-width");if(k.constantOr(1)===0||G.constantOr(1)===0)return;const X=b.getDepthModeForSublayer(0,jt.ReadOnly),ee=b.colorModeForRenderPass(),ie=A.paint.get("line-dasharray"),te=ie.constantOr(1),ae=A.paint.get("line-pattern"),ce=ae.constantOr(1),re=A.paint.get("line-gradient"),ue=A.getCrossfadeParameters();let de;de=ce?"linePattern":te&&re?"lineGradientSDF":te?"lineSDF":re?"lineGradient":"line";const oe=b.context,ye=oe.gl,Ie=b.transform;let Me=!0;for(const ze of I){const Pe=w.getTile(ze);if(ce&&!Pe.patternsLoaded())continue;const tt=Pe.getBucket(A);if(!tt)continue;const it=tt.programConfigurations.get(A.id),He=b.context.program.get(),at=b.useProgram(de,it),Lt=Me||at.program!==He,yi=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ze),Ui=ae.constantOr(null),Li=ie&&ie.constantOr(null);if(Ui&&Pe.imageAtlas){const Wn=Pe.imageAtlas,_n=Wn.patternPositions[Ui.to.toString()],yn=Wn.patternPositions[Ui.from.toString()];_n&&yn&&it.setConstantPatternPositions(_n,yn)}else if(Li){const Wn=A.layout.get("line-cap")==="round",_n=b.lineAtlas.getDash(Li.to,Wn),yn=b.lineAtlas.getDash(Li.from,Wn);it.setConstantDashPositions(_n,yn)}const Xi=Ie.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),Ai=Ie.getPixelScale();let on;ce?(on=Xh(b,Pe,A,Ai,ue),ia(oe,ye,Pe,it,ue)):te&&re?(on=yo(b,Pe,A,Ai,ue,tt.lineClipsArray.length),kr(b,w,oe,ye,A,tt,ze,it,ue)):te?(on=Or(b,Pe,A,Ai,ue),an(b,oe,ye,it,Lt,ue)):re?(on=wd(b,Pe,A,Ai,tt.lineClipsArray.length),Br(b,w,oe,ye,A,tt,ze)):on=Xu(b,Pe,A,Ai);const Yi=b.stencilModeForClipping(ze);at.draw(oe,ye.TRIANGLES,X,Yi,ee,Xt.disabled,on,yi,Xi,A.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,A.paint,b.transform.zoom,it,tt.layoutVertexBuffer2),Me=!1}})(t,a,l,f,_):h.cq(l)?(function(b,w,A,I,O){const j=A.paint.get("fill-color"),k=A.paint.get("fill-opacity");if(k.constantOr(1)===0)return;const{isRenderingToTexture:G}=O,X=b.colorModeForRenderPass(),ee=A.paint.get("fill-pattern"),ie=b.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&j.constantOr(h.bp.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===ie){const te=b.getDepthModeForSublayer(1,b.renderPass==="opaque"?jt.ReadWrite:jt.ReadOnly);fs(b,w,A,I,te,X,!1,G)}if(b.renderPass==="translucent"&&A.paint.get("fill-antialias")){const te=b.getDepthModeForSublayer(A.getPaintProperty("fill-outline-color")?2:0,jt.ReadOnly);fs(b,w,A,I,te,X,!0,G)}})(t,a,l,f,_):h.cr(l)?(function(b,w,A,I,O){const j=A.paint.get("fill-extrusion-opacity");if(j===0)return;const{isRenderingToTexture:k}=O;if(b.renderPass==="translucent"){const G=new jt(b.context.gl.LEQUAL,jt.ReadWrite,b.depthRangeFor3D);if(j!==1||A.paint.get("fill-extrusion-pattern").constantOr(1))ds(b,w,A,I,G,ri.disabled,Mi.disabled,k),ds(b,w,A,I,G,b.stencilModeFor3D(),b.colorModeForRenderPass(),k);else{const X=b.colorModeForRenderPass();ds(b,w,A,I,G,ri.disabled,X,k)}}})(t,a,l,f,_):h.cs(l)?(function(b,w,A,I,O){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent")return;const{isRenderingToTexture:j}=O,k=b.context,G=b.style.projection.useSubdivision,X=b.getDepthModeForSublayer(0,jt.ReadOnly),ee=b.colorModeForRenderPass();if(b.renderPass==="offscreen")(function(ie,te,ae,ce,re,ue,de){const oe=ie.context,ye=oe.gl;for(const Ie of ae){const Me=te.getTile(Ie),ze=Me.dem;if(!ze||!ze.data||!Me.needsHillshadePrepare)continue;const Pe=ze.dim,tt=ze.stride,it=ze.getPixels();if(oe.activeTexture.set(ye.TEXTURE1),oe.pixelStoreUnpackPremultiplyAlpha.set(!1),Me.demTexture=Me.demTexture||ie.getTileTexture(tt),Me.demTexture){const at=Me.demTexture;at.update(it,{premultiply:!1}),at.bind(ye.NEAREST,ye.CLAMP_TO_EDGE)}else Me.demTexture=new h.T(oe,it,ye.RGBA,{premultiply:!1}),Me.demTexture.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);oe.activeTexture.set(ye.TEXTURE0);let He=Me.fbo;if(!He){const at=new h.T(oe,{width:Pe,height:Pe,data:null},ye.RGBA);at.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),He=Me.fbo=oe.createFramebuffer(Pe,Pe,!0,!1),He.colorAttachment.set(at.texture)}oe.bindFramebuffer.set(He.framebuffer),oe.viewport.set([0,0,Pe,Pe]),ie.useProgram("hillshadePrepare").draw(oe,ye.TRIANGLES,re,ue,de,Xt.disabled,bd(Me.tileID,ze),null,null,ce.id,ie.rasterBoundsBuffer,ie.quadTriangleIndexBuffer,ie.rasterBoundsSegments),Me.needsHillshadePrepare=!1}})(b,w,I,A,X,ri.disabled,ee),k.viewport.set([0,0,b.width,b.height]);else if(b.renderPass==="translucent")if(G){const[ie,te,ae]=b.stencilConfigForOverlapTwoPass(I);ps(b,w,A,ae,ie,X,ee,!1,j),ps(b,w,A,ae,te,X,ee,!0,j)}else{const[ie,te]=b.getStencilConfigForOverlapAndUpdateStencilID(I);ps(b,w,A,te,ie,X,ee,!1,j)}})(t,a,l,f,_):h.ct(l)?(function(b,w,A,I,O){if(b.renderPass!=="translucent"||!I.length)return;const{isRenderingToTexture:j}=O,k=b.style.projection.useSubdivision,G=b.getDepthModeForSublayer(0,jt.ReadOnly),X=b.colorModeForRenderPass();if(k){const[ee,ie,te]=b.stencilConfigForOverlapTwoPass(I);Fs(b,w,A,te,ee,G,X,!1,j),Fs(b,w,A,te,ie,G,X,!0,j)}else{const[ee,ie]=b.getStencilConfigForOverlapAndUpdateStencilID(I);Fs(b,w,A,ie,ee,G,X,!1,j)}})(t,a,l,f,_):h.bU(l)?(function(b,w,A,I,O){if(b.renderPass!=="translucent"||A.paint.get("raster-opacity")===0||!I.length)return;const{isRenderingToTexture:j}=O,k=w.getSource(),G=b.style.projection.useSubdivision;if(k instanceof Rr)xa(b,w,A,I,null,!1,!1,k.tileCoords,k.flippedWindingOrder,j);else if(G){const[X,ee,ie]=b.stencilConfigForOverlapTwoPass(I);xa(b,w,A,ie,X,!1,!0,js,!1,j),xa(b,w,A,ie,ee,!0,!0,js,!1,j)}else{const[X,ee]=b.getStencilConfigForOverlapAndUpdateStencilID(I);xa(b,w,A,ee,X,!1,!0,js,!1,j)}})(t,a,l,f,_):h.cu(l)?(function(b,w,A,I,O){const j=A.paint.get("background-color"),k=A.paint.get("background-opacity");if(k===0)return;const{isRenderingToTexture:G}=O,X=b.context,ee=X.gl,ie=b.style.projection,te=b.transform,ae=te.tileSize,ce=A.paint.get("background-pattern");if(b.isPatternMissing(ce))return;const re=!ce&&j.a===1&&k===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==re)return;const ue=ri.disabled,de=b.getDepthModeForSublayer(0,re==="opaque"?jt.ReadWrite:jt.ReadOnly),oe=b.colorModeForRenderPass(),ye=b.useProgram(ce?"backgroundPattern":"background"),Ie=I||fn(te,{tileSize:ae,terrain:b.style.map.terrain});ce&&(X.activeTexture.set(ee.TEXTURE0),b.imageManager.bind(b.context));const Me=A.getCrossfadeParameters();for(const ze of Ie){const Pe=te.getProjectionData({overscaledTileID:ze,applyGlobeMatrix:!G,applyTerrainMatrix:!0}),tt=ce?Wu(k,b,ce,{tileID:ze,tileSize:ae},Me):Ku(k,j),it=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ze),He=ie.getMeshFromTileID(X,ze.canonical,!1,!0,"raster");ye.draw(X,ee.TRIANGLES,de,ue,oe,Xt.backCCW,tt,it,Pe,A.id,He.vertexBuffer,He.indexBuffer,He.segments)}})(t,0,l,f,_):h.cv(l)&&(function(b,w,A,I){const{isRenderingGlobe:O}=I,j=b.context,k=A.implementation,G=b.style.projection,X=b.transform,ee=X.getProjectionDataForCustomLayer(O),ie={farZ:X.farZ,nearZ:X.nearZ,fov:X.fov*Math.PI/180,modelViewProjectionMatrix:X.modelViewProjectionMatrix,projectionMatrix:X.projectionMatrix,shaderData:{variantName:G.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${G.shaderPreludeCode.vertexSource}`,define:G.shaderDefine},defaultProjectionData:ee},te=k.renderingMode?k.renderingMode:"2d";if(b.renderPass==="offscreen"){const ae=k.prerender;ae&&(b.setCustomLayerDefaults(),j.setColorMode(b.colorModeForRenderPass()),ae.call(k,j.gl,ie),j.setDirty(),b.setBaseState())}else if(b.renderPass==="translucent"){b.setCustomLayerDefaults(),j.setColorMode(b.colorModeForRenderPass()),j.setStencilMode(ri.disabled);const ae=te==="3d"?b.getDepthModeFor3D():b.getDepthModeForSublayer(0,jt.ReadOnly);j.setDepthMode(ae),k.render(j.gl,ie),j.setDirty(),b.setBaseState(),j.bindFramebuffer.set(null)}})(t,0,l,_))}saveTileTexture(t){const a=this._tileTextures[t.size[0]];a?a.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const a=this._tileTextures[t];return a&&a.length>0?a.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const a=this.imageManager.getPattern(t.from.toString()),l=this.imageManager.getPattern(t.to.toString());return!a||!l}useProgram(t,a,l=!1,f=[]){this.cache=this.cache||{};const _=!!this.style.map.terrain,b=this.style.projection,w=l?Qi.projectionMercator:b.shaderPreludeCode,A=l?pn:b.shaderDefine,I=t+(a?a.cacheKey:"")+`/${l?Er:b.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(_?"/terrain":"")+(f?`/${f.join("/")}`:"");return this.cache[I]||(this.cache[I]=new _d(this.context,Qi[t],a,Td[t],this._showOverdrawInspector,_,w,A,f)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){var t,a;if(this._tileTextures){for(const l in this._tileTextures){const f=this._tileTextures[l];if(f)for(const _ of f)_.destroy()}this._tileTextures={}}if(this.tileExtentBuffer&&this.tileExtentBuffer.destroy(),this.debugBuffer&&this.debugBuffer.destroy(),this.rasterBoundsBuffer&&this.rasterBoundsBuffer.destroy(),this.rasterBoundsBufferPosOnly&&this.rasterBoundsBufferPosOnly.destroy(),this.viewportBuffer&&this.viewportBuffer.destroy(),this.tileBorderIndexBuffer&&this.tileBorderIndexBuffer.destroy(),this.quadTriangleIndexBuffer&&this.quadTriangleIndexBuffer.destroy(),this.tileExtentMesh&&((t=this.tileExtentMesh.vertexBuffer)===null||t===void 0||t.destroy()),this.tileExtentMesh&&((a=this.tileExtentMesh.indexBuffer)===null||a===void 0||a.destroy()),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.cache){for(const l in this.cache){const f=this.cache[l];f&&f.program&&this.context.gl.deleteProgram(f.program)}this.cache={}}this.context&&this.context.setDefault()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:a}=this.context.gl;return this.width!==t||this.height!==a}}function nf(m,t){let a,l=!1,f=null,_=null;const b=()=>{f=null,l&&(m.apply(_,a),f=setTimeout(b,t),l=!1)};return(...w)=>(l=!0,_=this,a=w,f||b(),f)}class Tn{constructor(t){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((f=>f.split("="))).forEach((f=>{f[0]===this._hashName&&(l=f)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let f=l;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${l}`);let _=window.location.hash.replace(f,"");_.startsWith("#&")?_=_.slice(0,1)+_.slice(2):_==="#"&&(_="");let b=window.location.href.replace(/(#.+)?$/,_);b=b.replace("&&","&"),window.history.replaceState(window.history.state,null,b)},this._updateHash=nf(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,f=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),_=Math.pow(10,f),b=Math.round(a.lng*_)/_,w=Math.round(a.lat*_)/_,A=this._map.getBearing(),I=this._map.getPitch();let O="";if(O+=t?`/${b}/${w}/${l}`:`${l}/${w}/${b}`,(A||I)&&(O+="/"+Math.round(10*A)/10),I&&(O+=`/${Math.round(I)}`),this._hashName){const j=this._hashName;let k=!1;const G=window.location.hash.slice(1).split("&").map((X=>{const ee=X.split("=")[0];return ee===j?(k=!0,`${ee}=${O}`):X})).filter((X=>X));return k||G.push(`${j}=${O}`),`#${G.join("&")}`}return`#${O}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new h.V(+t[2],+t[1])}catch{return!1}const a=+t[0],l=+(t[3]||0),f=+(t[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const _s={linearity:.3,easing:h.cw(0,0,.3,1)},ru=h.e({deceleration:2500,maxSpeed:1400},_s),gr=h.e({deceleration:20,maxSpeed:1400},_s),ra=h.e({deceleration:1e3,maxSpeed:360},_s),sl=h.e({deceleration:1e3,maxSpeed:90},_s),_r=h.e({deceleration:1e3,maxSpeed:360},_s);class Vp{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:rt(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,a=rt();for(;t.length>0&&a-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:_}of this._inertiaBuffer)a.zoom+=_.zoomDelta||0,a.bearing+=_.bearingDelta||0,a.pitch+=_.pitchDelta||0,a.roll+=_.rollDelta||0,_.panDelta&&a.pan._add(_.panDelta),_.around&&(a.around=_.around),_.pinchAround&&(a.pinchAround=_.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(a.pan.mag()){const _=ac(a.pan.mag(),l,h.e({},ru,t||{})),b=a.pan.mult(_.amount/a.pan.mag()),w=this._map.cameraHelper.handlePanInertia(b,this._map.transform);f.center=w.easingCenter,f.offset=w.easingOffset,au(f,_)}if(a.zoom){const _=ac(a.zoom,l,gr);f.zoom=this._map.transform.zoom+_.amount,au(f,_)}if(a.bearing){const _=ac(a.bearing,l,ra);f.bearing=this._map.transform.bearing+h.an(_.amount,-179,179),au(f,_)}if(a.pitch){const _=ac(a.pitch,l,sl);f.pitch=this._map.transform.pitch+_.amount,au(f,_)}if(a.roll){const _=ac(a.roll,l,_r);f.roll=this._map.transform.roll+h.an(_.amount,-179,179),au(f,_)}if(f.zoom||f.bearing){const _=a.pinchAround===void 0?a.around:a.pinchAround;f.around=_?this._map.unproject(_):this._map.getCenter()}return this.clear(),h.e(f,{noMoveStart:!0})}}function au(m,t){(!m.duration||m.duration<t.duration)&&(m.duration=t.duration,m.easing=t.easing)}function ac(m,t,a){const{maxSpeed:l,linearity:f,deceleration:_}=a,b=h.an(m*f/(t/1e3),-l,l),w=Math.abs(b)/(_*f);return{easing:a.easing,duration:1e3*w,amount:b*(w/2)}}class $n extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l,f={}){l=l instanceof MouseEvent?l:new MouseEvent(t,l);const _=xe.mousePos(a.getCanvas(),l),b=a.unproject(_);super(t,h.e({point:_,lngLat:b,originalEvent:l},f)),this._defaultPrevented=!1,this.target=a}}class Na extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){const f=t==="touchend"?l.changedTouches:l.touches,_=xe.touchPos(a.getCanvasContainer(),f),b=_.map((A=>a.unproject(A))),w=_.reduce(((A,I,O,j)=>A.add(I.div(j.length))),new h.P(0,0));super(t,{points:_,point:w,lngLats:b,lngLat:a.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class rh extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,a,l){super(t,{originalEvent:l}),this._defaultPrevented=!1}}class ah{constructor(t,a){this._map=t,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new rh(t.type,this._map,t))}mousedown(t,a){return this._mousedownPos=a,this._firePreventable(new $n(t.type,this._map,t))}mouseup(t){this._map.fire(new $n(t.type,this._map,t))}click(t,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new $n(t.type,this._map,t))}dblclick(t){return this._firePreventable(new $n(t.type,this._map,t))}mouseover(t){this._map.fire(new $n(t.type,this._map,t))}mouseout(t){this._map.fire(new $n(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Na(t.type,this._map,t))}touchmove(t){this._map.fire(new Na(t.type,this._map,t))}touchend(t){this._map.fire(new Na(t.type,this._map,t))}touchcancel(t){this._map.fire(new Na(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Md{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new $n(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $n("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new $n(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Va{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(h.P.convert(t),this._map.terrain)}}class Eo{constructor(t,a){this._map=t,this._tr=new Va(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,a){this.isEnabled()&&t.shiftKey&&t.button===0&&(xe.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(t,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=l,this._box||(this._box=xe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const _=Math.min(f.x,l.x),b=Math.max(f.x,l.x),w=Math.min(f.y,l.y),A=Math.max(f.y,l.y);xe.setTransform(this._box,`translate(${_}px,${w}px)`),this._box.style.width=b-_+"px",this._box.style.height=A-w+"px"}mouseupWindow(t,a){if(!this._active||t.button!==0)return;const l=this._startPos,f=a;if(this.reset(),xe.suppressClick(),l.x!==f.x||l.y!==f.y)return this._map.fire(new h.l("boxzoomend",{originalEvent:t})),{cameraAnimation:_=>_.fitScreenCoordinates(l,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(xe.remove(this._box),this._box=null),xe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,a){return this._map.fire(new h.l(t,{originalEvent:a}))}}function Fr(m,t){if(m.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${m.length}, points ${t.length}`);const a={};for(let l=0;l<m.length;l++)a[m[l].identifier]=t[l];return a}class ut{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),l.length===this.numTouches&&(this.centroid=(function(f){const _=new h.P(0,0);for(const b of f)_._add(b);return _.div(f.length)})(a),this.touches=Fr(l,a)))}touchmove(t,a,l){if(this.aborted||!this.centroid)return;const f=Fr(l,a);for(const _ in this.touches){const b=f[_];(!b||b.dist(this.touches[_])>30)&&(this.aborted=!0)}}touchend(t,a,l){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class sc{constructor(t){this.singleTap=new ut(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,a,l){this.singleTap.touchstart(t,a,l)}touchmove(t,a,l){this.singleTap.touchmove(t,a,l)}touchend(t,a,l){const f=this.singleTap.touchend(t,a,l);if(f){const _=t.timeStamp-this.lastTime<500,b=!this.lastTap||this.lastTap.dist(f)<30;if(_&&b||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class sh{constructor(t){this._tr=new Va(t),this._zoomIn=new sc({numTouches:1,numTaps:2}),this._zoomOut=new sc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,a,l){this._zoomIn.touchstart(t,a,l),this._zoomOut.touchstart(t,a,l)}touchmove(t,a,l){this._zoomIn.touchmove(t,a,l),this._zoomOut.touchmove(t,a,l)}touchend(t,a,l){const f=this._zoomIn.touchend(t,a,l),_=this._zoomOut.touchend(t,a,l),b=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:b.zoom+1,around:b.unproject(f)},{originalEvent:t})}):_?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:b.zoom-1,around:b.unproject(_)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wa{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const a=this._moveFunction(...t);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(t,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(a)?a[0]:a;return!this._moved&&f.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(l,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&xe.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ua=0,su=2,oh={[Ua]:1,[su]:2};class ys{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const a=xe.mouseButton(t);this._eventButton=a}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(a,l){const f=oh[l];return a.buttons===void 0||(a.buttons&f)!==f})(t,this._eventButton)}isValidEndEvent(t){return xe.mouseButton(t)===this._eventButton}}class ol{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class oc{constructor(t=new ys({checkCorrectEvent:()=>!0}),a=new ol){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(t,a,l){return t instanceof MouseEvent?a(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?l(t):void 0}startMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(t){this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const vs=m=>{m.mousedown=m.dragStart,m.mousemoveWindow=m.dragMove,m.mouseup=m.dragEnd,m.contextmenu=t=>{t.preventDefault()}};class lh{constructor(t,a){this._clickTolerance=t.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,a,l){return this._calculateTransform(t,a,l)}touchmove(t,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return t.preventDefault(),this._calculateTransform(t,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,a,l){this._calculateTransform(t,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,a,l){l.length>0&&(this._active=!0);const f=Fr(l,a),_=new h.P(0,0),b=new h.P(0,0);let w=0;for(const I in f){const O=f[I],j=this._touches[I];j&&(_._add(O),b._add(O.sub(j)),w++,f[I]=O)}if(this._touches=f,this._shouldBePrevented(w)||!b.mag())return;const A=b.div(w);return this._sum._add(A),this._sum.mag()<this._clickTolerance?void 0:{around:_.div(w),panDelta:A}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(t,a,l){if(!this._firstTwoTouches)return;t.preventDefault();const[f,_]=this._firstTwoTouches,b=bs(l,a,f),w=bs(l,a,_);if(!b||!w)return;const A=this._aroundCenter?null:b.add(w).div(2);return this._move([b,w],A,t)}touchend(t,a,l){if(!this._firstTwoTouches)return;const[f,_]=this._firstTwoTouches,b=bs(l,a,f),w=bs(l,a,_);b&&w||(this._active&&xe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function bs(m,t,a){for(let l=0;l<m.length;l++)if(m[l].identifier===a)return t[l]}function rf(m,t){return Math.log(m/t)/Math.LN2}class xs extends lc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,a){const l=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(rf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:rf(this._distance,l),pinchAround:a}}}function uh(m,t){return 180*m.angleWith(t)/Math.PI}class uc extends lc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,a,l){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:uh(this._vector,f),pinchAround:a}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const a=25/(Math.PI*this._minDiameter)*360,l=uh(t,this._startVector);return Math.abs(l)<a}}function ws(m){return Math.abs(m.y)>Math.abs(m.x)}class Us extends lc{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,a,l){super.touchstart(t,a,l),this._currentTouchCount=l.length}_start(t){this._lastPoints=t,ws(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),_=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,_,l.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+_.y)/2*-.5}):void 0}gestureBeginsVertically(t,a,l){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,_=a.mag()>=2;if(!f&&!_)return;if(!f||!_)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const b=t.y>0==a.y>0;return ws(t)&&ws(a)&&b}}const Ta={panStep:100,bearingStep:15,pitchStep:10};class xi{constructor(t){this._tr=new Va(t);const a=Ta;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let a=0,l=0,f=0,_=0,b=0;switch(t.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:t.shiftKey?l=-1:(t.preventDefault(),_=-1);break;case 39:t.shiftKey?l=1:(t.preventDefault(),_=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),b=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),b=1);break;default:return}return this._rotationDisabled&&(l=0,f=0),{cameraAnimation:w=>{const A=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:a?Math.round(A.zoom)+a*(t.shiftKey?2:1):A.zoom,bearing:A.bearing+l*this._bearingStep,pitch:A.pitch+f*this._pitchStep,offset:[-_*this._panStep,-b*this._panStep],center:A.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function af(m){return m*(2-m)}const Gs=4.000244140625,Mo=1/450;class cc{constructor(t,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=t,this._tr=new Va(t),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Mo}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let a=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const l=rt(),f=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Gs==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),t.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=t,this._delta-=a,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=xe.mousePos(this._map.getCanvas(),t),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(h.V.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Gs?this._wheelZoomRate:this._defaultZoomRate;let A=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&A!==0&&(A=1/A);const I=typeof this._targetZoom!="number"?t.scale:h.aq(this._targetZoom);this._targetZoom=t.applyConstrain(t.getCameraLngLat(),h.at(I*A)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,l=this._startZoom,f=this._easing;let _,b=!1;if(this._type==="wheel"&&l&&f){const w=rt()-this._lastWheelEventTime,A=Math.min((w+5)/200,1),I=f(A);_=h.G.number(l,a,I),A<1?this._frameId||(this._frameId=!0):b=!0}else _=a,b=!0;return this._active=!0,b&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=_,{noInertia:!0,needsRenderFrame:!b,zoomDelta:_-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let a=h.cy;if(this._prevEase){const l=this._prevEase,f=(rt()-l.start)/l.duration,_=l.easing(f+.01)-l.easing(f),b=.27/Math.sqrt(_*_+1e-4)*.01,w=Math.sqrt(.0729-b*b);a=h.cw(b,w,.25,1)}return this._prevEase={start:rt(),duration:t,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class ch{constructor(t,a){this._clickZoom=t,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ll{constructor(t){this._tr=new Va(t),this.reset()}reset(){this._active=!1}dblclick(t,a){return t.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hc{constructor(){this._tap=new sc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,a,l){if(!this._swipePoint)if(this._tapTime){const f=a[0],_=t.timeStamp-this._tapTime<500,b=this._tapPoint.dist(f)<30;_&&b?l.length>0&&(this._swipePoint=f,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(t,a,l)}touchmove(t,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const f=a[0],_=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:_/128}}}else this._tap.touchmove(t,a,l)}touchend(t,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const f=this._tap.touchend(t,a,l);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class sf{constructor(t,a,l){this._el=t,this._mousePan=a,this._touchPan=l}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class aa{constructor(t,a,l,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ul{constructor(t,a,l,f){this._el=t,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class ft{constructor(t,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=xe.create("div","maplibregl-cooperative-gesture-screen",t);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=a,this._container.appendChild(f);const _=document.createElement("div");_.className="maplibregl-mobile-message",_.textContent=l,this._container.appendChild(_),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(xe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,a){this._enabled&&(this._map.fire(new h.l("cooperativegestureprevented",{gestureType:t,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const _t=m=>m.zoom||m.drag||m.roll||m.pitch||m.rotate;class Sa extends h.l{}function ou(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta||m.rollDelta}class fc{constructor(t,a){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,_)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const b=f.type==="renderFrame"?void 0:f,w={needsRenderFrame:!1},A={},I={};for(const{handlerName:k,handler:G,allowed:X}of this._handlers){if(!G.isEnabled())continue;let ee;if(this._blockedByActive(I,X,k))G.reset();else if(G[_||f.type]){if(h.cz(f,_||f.type)){const ie=xe.mousePos(this._map.getCanvas(),f);ee=G[_||f.type](f,ie)}else if(h.cA(f,_||f.type)){const ie=this._getMapTouches(f.touches),te=xe.touchPos(this._map.getCanvas(),ie);ee=G[_||f.type](f,te,ie)}else h.cB(_||f.type)||(ee=G[_||f.type](f));this.mergeHandlerResult(w,A,ee,k,b),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()}(ee||G.isActive())&&(I[k]=G)}const O={};for(const k in this._previousActiveHandlers)I[k]||(O[k]=b);this._previousActiveHandlers=I,(Object.keys(O).length||ou(w))&&(this._changes.push([w,A,O]),this._triggerRenderFrame()),(Object.keys(I).length||ou(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=w;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vp(t),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,_,b]of this._listeners)xe.addEventListener(f,_,f===document?this.handleWindowEvent:this.handleEvent,b)}destroy(){for(const[t,a,l]of this._listeners)xe.removeEventListener(t,a,t===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(t){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new ah(a,t));const f=a.boxZoom=new Eo(a,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const _=a.cooperativeGestures=new ft(a,t.cooperativeGestures);this._add("cooperativeGestures",_),t.cooperativeGestures&&_.enable();const b=new sh(a),w=new ll(a);a.doubleClickZoom=new ch(w,b),this._add("tapZoom",b),this._add("clickZoom",w),t.interactive&&t.doubleClickZoom&&a.doubleClickZoom.enable();const A=new hc;this._add("tapDragZoom",A);const I=a.touchPitch=new Us(a);this._add("touchPitch",I),t.interactive&&t.touchPitch&&a.touchPitch.enable(t.touchPitch);const O=()=>a.project(a.getCenter()),j=(function({enable:re,clickTolerance:ue,aroundCenter:de=!0,minPixelCenterThreshold:oe=100,rotateDegreesPerPixelMoved:ye=.8},Ie){const Me=new ys({checkCorrectEvent:ze=>xe.mouseButton(ze)===0&&ze.ctrlKey||xe.mouseButton(ze)===2&&!ze.ctrlKey});return new wa({clickTolerance:ue,move:(ze,Pe)=>{const tt=Ie();if(de&&Math.abs(tt.y-ze.y)>oe)return{bearingDelta:h.cx(new h.P(ze.x,Pe.y),Pe,tt)};let it=(Pe.x-ze.x)*ye;return de&&Pe.y<tt.y&&(it=-it),{bearingDelta:it}},moveStateManager:Me,enable:re,assignEvents:vs})})(t,O),k=(function({enable:re,clickTolerance:ue,pitchDegreesPerPixelMoved:de=-.5}){const oe=new ys({checkCorrectEvent:ye=>xe.mouseButton(ye)===0&&ye.ctrlKey||xe.mouseButton(ye)===2});return new wa({clickTolerance:ue,move:(ye,Ie)=>({pitchDelta:(Ie.y-ye.y)*de}),moveStateManager:oe,enable:re,assignEvents:vs})})(t),G=(function({enable:re,clickTolerance:ue,rollDegreesPerPixelMoved:de=.3},oe){const ye=new ys({checkCorrectEvent:Ie=>xe.mouseButton(Ie)===2&&Ie.ctrlKey});return new wa({clickTolerance:ue,move:(Ie,Me)=>{const ze=oe();let Pe=(Me.x-Ie.x)*de;return Me.y<ze.y&&(Pe=-Pe),{rollDelta:Pe}},moveStateManager:ye,enable:re,assignEvents:vs})})(t,O);a.dragRotate=new aa(t,j,k,G),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",k,["mouseRotate","mouseRoll"]),this._add("mouseRoll",G,["mousePitch"]),t.interactive&&t.dragRotate&&a.dragRotate.enable();const X=(function({enable:re,clickTolerance:ue}){const de=new ys({checkCorrectEvent:oe=>xe.mouseButton(oe)===0&&!oe.ctrlKey});return new wa({clickTolerance:ue,move:(oe,ye)=>({around:ye,panDelta:ye.sub(oe)}),activateOnStart:!0,moveStateManager:de,enable:re,assignEvents:vs})})(t),ee=new lh(t,a);a.dragPan=new sf(l,X,ee),this._add("mousePan",X),this._add("touchPan",ee,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&a.dragPan.enable(t.dragPan);const ie=new uc,te=new xs;a.touchZoomRotate=new ul(l,te,ie,A),this._add("touchRotate",ie,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&a.touchZoomRotate.enable(t.touchZoomRotate),this._add("blockableMapEvent",new Md(a));const ae=a.scrollZoom=new cc(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ae,["mousePan"]),t.interactive&&t.scrollZoom&&a.scrollZoom.enable(t.scrollZoom);const ce=a.keyboard=new xi(a);this._add("keyboard",ce),t.interactive&&t.keyboard&&a.keyboard.enable()}_add(t,a,l){this._handlers.push({handlerName:t,handler:a,allowed:l}),this._handlersById[t]=a}stop(t){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!_t(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,a,l){for(const f in t)if(f!==l&&(!a||a.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const a=[];for(const l of t)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(t,a,l,f,_){if(!l)return;h.e(t,l);const b={handlerName:f,originalEvent:l.originalEvent||_};l.zoomDelta!==void 0&&(a.zoom=b),l.panDelta!==void 0&&(a.drag=b),l.rollDelta!==void 0&&(a.roll=b),l.pitchDelta!==void 0&&(a.pitch=b),l.bearingDelta!==void 0&&(a.rotate=b)}_applyChanges(){const t={},a={},l={};for(const[f,_,b]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new h.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),h.e(a,_),h.e(l,b);this._updateMapTransform(t,a,l),this._changes=[]}_updateMapTransform(t,a,l){const f=this._map,_=f._getTransformForUpdate(),b=f.terrain;if(!(ou(t)||b&&this._terrainMovement))return this._fireEvents(a,l,!0);f._stop(!0);let{panDelta:w,zoomDelta:A,bearingDelta:I,pitchDelta:O,rollDelta:j,around:k,pinchAround:G}=t;G!==void 0&&(k=G),k=k||f.transform.centerPoint,b&&!_.isPointOnMapSurface(k)&&(k=_.centerPoint);const X={panDelta:w,zoomDelta:A,rollDelta:j,pitchDelta:O,bearingDelta:I,around:k};this._map.cameraHelper.useGlobeControls&&!_.isPointOnMapSurface(k)&&(k=_.centerPoint);const ee=k.distSqr(_.centerPoint)<.01?_.center:_.screenPointToLocation(w?k.sub(w):k);this._handleMapControls({terrain:b,tr:_,deltasForHelper:X,preZoomAroundLoc:ee,combinedEventsInProgress:a,panDelta:w}),f._applyUpdatedTransform(_),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(a,l,!0)}_handleMapControls({terrain:t,tr:a,deltasForHelper:l,preZoomAroundLoc:f,combinedEventsInProgress:_,panDelta:b}){const w=this._map.cameraHelper;if(w.handleMapControlsRollPitchBearingZoom(l,a),t)return w.useGlobeControls?(this._terrainMovement||!_.drag&&!_.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void w.handleMapControlsPan(l,a,f)):this._terrainMovement||!_.drag&&!_.zoom?void(_.drag&&this._terrainMovement&&b?a.setCenter(a.screenPointToLocation(a.centerPoint.sub(b))):w.handleMapControlsPan(l,a,f)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void w.handleMapControlsPan(l,a,f));w.handleMapControlsPan(l,a,f)}_fireEvents(t,a,l){const f=_t(this._eventsInProgress),_=_t(t),b={};for(const j in t){const{originalEvent:k}=t[j];this._eventsInProgress[j]||(b[`${j}start`]=k),this._eventsInProgress[j]=t[j]}!f&&_&&this._fireEvent("movestart",_.originalEvent);for(const j in b)this._fireEvent(j,b[j]);_&&this._fireEvent("move",_.originalEvent);for(const j in t){const{originalEvent:k}=t[j];this._fireEvent(j,k)}const w={};let A;for(const j in this._eventsInProgress){const{handlerName:k,originalEvent:G}=this._eventsInProgress[j];this._handlersById[k].isActive()||(delete this._eventsInProgress[j],A=a[k]||G,w[`${j}end`]=A)}for(const j in w)this._fireEvent(j,w[j]);const I=_t(this._eventsInProgress),O=(f||_)&&!I;if(O&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const j=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&j.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(j)}if(l&&O){this._updatingCamera=!0;const j=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),k=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;!j||!j.essential&&yt.prefersReducedMotion?(this._map.fire(new h.l("moveend",{originalEvent:A})),k(this._map.getBearing())&&this._map.resetNorth()):(k(j.bearing||this._map.getBearing())&&(j.bearing=0),j.freezeElevation=!0,this._map.easeTo(j,{originalEvent:A})),this._updatingCamera=!1}}_fireEvent(t,a){this._map.fire(new h.l(t,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new Sa("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Sn extends h.E{constructor(t,a,l){super(),this._renderFrameCallback=()=>{const f=Math.min((rt()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,a){t.apply(this.transform,!0),this.transform=t,this.cameraHelper=a}getCenter(){return new h.V(this.transform.center.lng,this.transform.center.lat)}setCenter(t,a){return this.jumpTo({center:t},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,a){return this.jumpTo({elevation:t},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,a,l){return t=h.P.convert(t).mult(-1),this.panTo(this.transform.center,h.e({offset:t},a),l)}panTo(t,a,l){return this.easeTo(h.e({center:t},a),l)}getZoom(){return this.transform.zoom}setZoom(t,a){return this.jumpTo({zoom:t},a),this}zoomTo(t,a,l){return this.easeTo(h.e({zoom:t},a),l)}zoomIn(t,a){return this.zoomTo(this.getZoom()+1,t,a),this}zoomOut(t,a){return this.zoomTo(this.getZoom()-1,t,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,a){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new h.l("movestart",a)).fire(new h.l("move",a)).fire(new h.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(t,a){return this.jumpTo({bearing:t},a),this}getPadding(){return this.transform.padding}setPadding(t,a){return this.jumpTo({padding:t},a),this}rotateTo(t,a,l){return this.easeTo(h.e({bearing:t},a),l)}resetNorth(t,a){return this.rotateTo(0,h.e({duration:1e3},t),a),this}resetNorthPitch(t,a){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},t),a),this}snapToNorth(t,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,a):this}getPitch(){return this.transform.pitch}setPitch(t,a){return this.jumpTo({pitch:t},a),this}getRoll(){return this.transform.roll}setRoll(t,a){return this.jumpTo({roll:t},a),this}cameraForBounds(t,a){t=hn.convert(t).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),l,a)}_cameraForBoxAndBearing(t,a,l,f){const _={top:0,bottom:0,right:0,left:0};if(typeof(f=h.e({padding:_,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const I=f.padding;f.padding={top:I,bottom:I,right:I,left:I}}const b=h.e(_,f.padding);f.padding=b;const w=this.transform,A=new hn(t,a);return this.cameraHelper.cameraForBoxAndBearing(f,b,A,l,w)}fitBounds(t,a,l){return this._fitInternal(this.cameraForBounds(t,a),a,l)}fitScreenCoordinates(t,a,l,f,_){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(t)),this.transform.screenPointToLocation(h.P.convert(a)),l,f),f,_)}_fitInternal(t,a,l){return t?(delete(a=h.e(t,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(t,a){this.stop();const l=this._getTransformForUpdate();let f=!1,_=!1,b=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,t);const A=l.zoom!==w;return"elevation"in t&&l.elevation!==+t.elevation&&l.setElevation(+t.elevation),"bearing"in t&&l.bearing!==+t.bearing&&(f=!0,l.setBearing(+t.bearing)),"pitch"in t&&l.pitch!==+t.pitch&&(_=!0,l.setPitch(+t.pitch)),"roll"in t&&l.roll!==+t.roll&&(b=!0,l.setRoll(+t.roll)),t.padding==null||l.isPaddingEqual(t.padding)||l.setPadding(t.padding),this._applyUpdatedTransform(l),this.fire(new h.l("movestart",a)).fire(new h.l("move",a)),A&&this.fire(new h.l("zoomstart",a)).fire(new h.l("zoom",a)).fire(new h.l("zoomend",a)),f&&this.fire(new h.l("rotatestart",a)).fire(new h.l("rotate",a)).fire(new h.l("rotateend",a)),_&&this.fire(new h.l("pitchstart",a)).fire(new h.l("pitch",a)).fire(new h.l("pitchend",a)),b&&this.fire(new h.l("rollstart",a)).fire(new h.l("roll",a)).fire(new h.l("rollend",a)),this.fire(new h.l("moveend",a))}calculateCameraOptionsFromTo(t,a,l,f=0){const _=h.a9.fromLngLat(t,a),b=h.a9.fromLngLat(l,f),w=b.x-_.x,A=b.y-_.y,I=b.z-_.z,O=Math.hypot(w,A,I);if(O===0)throw new Error("Can't calculate camera options with same From and To");const j=Math.hypot(w,A),k=h.at(this.transform.cameraToCenterDistance/O/this.transform.tileSize),G=180*Math.atan2(w,-A)/Math.PI;let X=180*Math.acos(j/O)/Math.PI;return X=I<0?90-X:90+X,{center:b.toLngLat(),elevation:f,zoom:k,pitch:X,bearing:G}}calculateCameraOptionsFromCameraLngLatAltRotation(t,a,l,f,_){const b=this.transform.calculateCenterFromCameraLngLatAlt(t,a,l,f);return{center:b.center,elevation:b.elevation,zoom:b.zoom,bearing:l,pitch:f,roll:_}}easeTo(t,a){this._stop(!1,t.easeId),((t=h.e({offset:[0,0],duration:500,easing:h.cy},t)).animate===!1||!t.essential&&yt.prefersReducedMotion)&&(t.duration=0);const l=this._getTransformForUpdate(),f=this.getBearing(),_=l.pitch,b=l.roll,w="bearing"in t?this._normalizeBearing(t.bearing,f):f,A="pitch"in t?+t.pitch:_,I="roll"in t?this._normalizeBearing(t.roll,b):b,O="padding"in t?t.padding:l.padding,j=h.P.convert(t.offset);let k,G;t.around&&(k=h.V.convert(t.around),G=l.locationToScreenPoint(k));const X={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ee=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:A,roll:I,padding:O,around:k,aroundPoint:G,offsetAsPoint:j,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==w,this._pitching=this._pitching||A!==_,this._rolling=this._rolling||I!==b,this._padding=!l.isPaddingEqual(O),this._zooming=this._zooming||ee.isZooming,this._easeId=t.easeId,this._prepareEase(a,t.noMoveStart,X),this.terrain&&this._prepareElevation(ee.elevationCenter),this._ease((ie=>{ee.easeFunc(ie),this.terrain&&!t.freezeElevation&&this._updateElevation(ie),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(ie=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a,ie)}),t),this}_prepareEase(t,a,l={}){this._moving=!0,a||l.moving||this.fire(new h.l("movestart",t)),this._zooming&&!l.zooming&&this.fire(new h.l("zoomstart",t)),this._rotating&&!l.rotating&&this.fire(new h.l("rotatestart",t)),this._pitching&&!l.pitching&&this.fire(new h.l("pitchstart",t)),this._rolling&&!l.rolling&&this.fire(new h.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(l-(a-(l*t+this._elevationStart))/(1-t)),this._elevationTarget=a}this.transform.setElevation(h.G.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const a=t.getCameraLngLat(),l=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(a,t.zoom):0;if(l<f){const _=this.calculateCameraOptionsFromTo(a,f,t.center,t.elevation);return{pitch:_.pitch,zoom:_.zoom}}return{}}_applyUpdatedTransform(t){const a=[];if(a.push((f=>this._elevateCameraIfInsideTerrain(f))),this.transformCameraUpdate&&a.push((f=>this.transformCameraUpdate(f))),!a.length)return;const l=t.clone();for(const f of a){const _=l.clone(),{center:b,zoom:w,roll:A,pitch:I,bearing:O,elevation:j}=f(_);b&&_.setCenter(b),j!==void 0&&_.setElevation(j),w!==void 0&&_.setZoom(w),A!==void 0&&_.setRoll(A),I!==void 0&&_.setPitch(I),O!==void 0&&_.setBearing(O),l.apply(_,!1)}this.transform.apply(l,!1)}_fireMoveEvents(t){this.fire(new h.l("move",t)),this._zooming&&this.fire(new h.l("zoom",t)),this._rotating&&this.fire(new h.l("rotate",t)),this._pitching&&this.fire(new h.l("pitch",t)),this._rolling&&this.fire(new h.l("roll",t))}_afterEase(t,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,f=this._rotating,_=this._pitching,b=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new h.l("zoomend",t)),f&&this.fire(new h.l("rotateend",t)),_&&this.fire(new h.l("pitchend",t)),b&&this.fire(new h.l("rollend",t)),this.fire(new h.l("moveend",t))}flyTo(t,a){if(!t.essential&&yt.prefersReducedMotion){const Pe=h.U(t,["center","zoom","bearing","pitch","roll","elevation","padding"]);return this.jumpTo(Pe,a)}this.stop(),t=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.cy},t);const l=this._getTransformForUpdate(),f=l.bearing,_=l.pitch,b=l.roll,w=l.padding,A="bearing"in t?this._normalizeBearing(t.bearing,f):f,I="pitch"in t?+t.pitch:_,O="roll"in t?this._normalizeBearing(t.roll,b):b,j="padding"in t?t.padding:l.padding,k=h.P.convert(t.offset);let G=l.centerPoint.add(k);const X=l.screenPointToLocation(G),ee=this.cameraHelper.handleFlyTo(l,{bearing:A,pitch:I,roll:O,padding:j,locationAtOffset:X,offsetAsPoint:k,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ie=t.curve;const te=Math.max(l.width,l.height),ae=te/ee.scaleOfZoom,ce=ee.pixelPathLength;typeof ee.scaleOfMinZoom=="number"&&(ie=Math.sqrt(te/ee.scaleOfMinZoom/ce*2));const re=ie*ie;function ue(Pe){const tt=(ae*ae-te*te+(Pe?-1:1)*re*re*ce*ce)/(2*(Pe?ae:te)*re*ce);return Math.log(Math.sqrt(tt*tt+1)-tt)}function de(Pe){return(Math.exp(Pe)-Math.exp(-Pe))/2}function oe(Pe){return(Math.exp(Pe)+Math.exp(-Pe))/2}const ye=ue(!1);let Ie=function(Pe){return oe(ye)/oe(ye+ie*Pe)},Me=function(Pe){return te*((oe(ye)*(de(tt=ye+ie*Pe)/oe(tt))-de(ye))/re)/ce;var tt},ze=(ue(!0)-ye)/ie;if(Math.abs(ce)<2e-6||!isFinite(ze)){if(Math.abs(te-ae)<1e-6)return this.easeTo(t,a);const Pe=ae<te?-1:1;ze=Math.abs(Math.log(ae/te))/ie,Me=()=>0,Ie=tt=>Math.exp(Pe*ie*tt)}return t.duration="duration"in t?+t.duration:1e3*ze/("screenSpeed"in t?+t.screenSpeed/ie:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==A,this._pitching=I!==_,this._rolling=O!==b,this._padding=!l.isPaddingEqual(j),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(ee.targetCenter),this._ease((Pe=>{const tt=Pe*ze,it=1/Ie(tt),He=Me(tt);this._rotating&&l.setBearing(h.G.number(f,A,Pe)),this._pitching&&l.setPitch(h.G.number(_,I,Pe)),this._rolling&&l.setRoll(h.G.number(b,O,Pe)),this._padding&&(l.interpolatePadding(w,j,Pe),G=l.centerPoint.add(k)),ee.easeFunc(Pe,it,He,G),this.terrain&&!t.freezeElevation&&this._updateElevation(Pe),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,a)}return t||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(t,a,l){l.animate===!1||l.duration===0?(t(1),a()):(this._easeStart=rt(),this._easeOptions=l,this._onEaseFrame=t,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,a){t=h.W(t,-180,180);const l=Math.abs(t-a);return Math.abs(t-360-a)<l&&(t-=360),Math.abs(t+360-a)<l&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLat(h.V.convert(t),this.transform):null}}const sn={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class gn{constructor(t=sn){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=xe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=xe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=xe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){xe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,a){const l=this._map._getUIString(`AttributionControl.${a}`);t.title=l,t.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((f=>typeof f!="string"?"":f))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const a=this._map.style.tileManagers;for(const f in a){const _=a[f];if(_.used||_.usedForTerrain){const b=_.getSource();b.attribution&&t.indexOf(b.attribution)<0&&t.push(b.attribution)}}t=t.filter((f=>String(f).trim())),t.sort(((f,_)=>f.length-_.length)),t=t.filter(((f,_)=>{for(let b=_+1;b<t.length;b++)if(t[b].indexOf(f)>=0)return!1;return!0}));const l=t.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,t.length?(this._innerContainer.innerHTML=xe.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class dc{constructor(t={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=xe.create("div","maplibregl-ctrl");const a=xe.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){xe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class qs{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const a=++this._id;return this._queue.push({callback:t,id:a,cancelled:!1}),a}remove(t){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const f of l)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var $t=h.aU([{name:"a_pos3d",type:"Int16",components:3}]);class _i extends h.E{constructor(t){super(),this._lastTilesetChange=rt(),this.tileManager=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.tileManager.usedForTerrain=!1,this.tileManager.tileSize=null}getSource(){return this.tileManager._source}update(t,a){this.tileManager.update(t,a),this._renderableTilesKeys=[];const l={};for(const f of fn(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.tileManager._source.calculateTileZoom}))l[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),h.c7(f.terrainRttPosMatrix32f,0,h.a5,h.a5,0,0,1),this._tiles[f.key]=new Ue(f,this.tileSize),this._lastTilesetChange=rt());for(const f in this._tiles)l[f]||delete this._tiles[f]}freeRtt(t){for(const a in this._tiles){const l=this._tiles[a];(!t||l.tileID.equals(t)||l.tileID.isChildOf(t)||t.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,a){return a?this._getTerrainCoordsForTileRanges(t,a):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const a={};for(const l of this._renderableTilesKeys){const f=this._tiles[l].tileID,_=t.clone(),b=h.bk();if(f.canonical.equals(t.canonical))h.c7(b,0,h.a5,h.a5,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const w=f.canonical.z-t.canonical.z,A=f.canonical.x-(f.canonical.x>>w<<w),I=f.canonical.y-(f.canonical.y>>w<<w),O=h.a5>>w;h.c7(b,0,O,O,0,0,1),h.O(b,b,[-A*O,-I*O,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const w=t.canonical.z-f.canonical.z,A=t.canonical.x-(t.canonical.x>>w<<w),I=t.canonical.y-(t.canonical.y>>w<<w),O=h.a5>>w;h.c7(b,0,h.a5,h.a5,0,0,1),h.O(b,b,[A*O,I*O,0]),h.Q(b,b,[1/2**w,1/2**w,0])}}_.terrainRttPosMatrix32f=new Float32Array(b),a[l]=_}return a}_getTerrainCoordsForTileRanges(t,a){const l={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID;if(!this._isWithinTileRanges(_,a))continue;const b=t.clone(),w=h.bk();if(_.canonical.z===t.canonical.z){const A=t.canonical.x-_.canonical.x+t.wrap*(1<<t.canonical.z),I=t.canonical.y-_.canonical.y;h.c7(w,0,h.a5,h.a5,0,0,1),h.O(w,w,[A*h.a5,I*h.a5,0])}else if(_.canonical.z>t.canonical.z){const A=_.canonical.z-t.canonical.z,I=_.canonical.x-(_.canonical.x>>A<<A)+t.wrap*(1<<_.canonical.z),O=_.canonical.y-(_.canonical.y>>A<<A),j=t.canonical.x-(_.canonical.x>>A),k=t.canonical.y-(_.canonical.y>>A),G=h.a5>>A;h.c7(w,0,G,G,0,0,1),h.O(w,w,[-I*G+j*h.a5,-O*G+k*h.a5,0])}else{const A=t.canonical.z-_.canonical.z,I=t.canonical.x-(t.canonical.x>>A<<A)+t.wrap*(1<<t.canonical.z),O=t.canonical.y-(t.canonical.y>>A<<A),j=(t.canonical.x>>A)-_.canonical.x,k=(t.canonical.y>>A)-_.canonical.y,G=h.a5<<A;h.c7(w,0,G,G,0,0,1),h.O(w,w,[I*h.a5+j*G,O*h.a5+k*G,0])}b.terrainRttPosMatrix32f=new Float32Array(w),l[f]=b}return l}getSourceTile(t,a){const l=this.tileManager._source;let f=t.overscaledZ-this.deltaZoom;if(f>l.maxzoom&&(f=l.maxzoom),f<l.minzoom)return;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let _=this.findTileInCaches(this._sourceTileCache[t.key]);if(!_?.dem&&a)for(;f>=l.minzoom&&!_?.dem;)_=this.findTileInCaches(t.scaledTo(f--).key);return _}findTileInCaches(t){let a=this.tileManager.getTileByID(t);return a||(a=this.tileManager._outOfViewCache.getByKey(t),a)}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,a){const l=a[t.canonical.z];return!!l&&(t.wrap>l.minWrap||t.wrap<l.maxWrap||t.canonical.x>=l.minTileXWrapped&&t.canonical.x<=l.maxTileXWrapped&&t.canonical.y>=l.minTileY&&t.canonical.y<=l.maxTileY)}}class Ht{constructor(t,a,l){this._meshCache={},this.painter=t,this.tileManager=new _i(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,a,l,f=h.a5){var _;if(!(a>=0&&a<f&&l>=0&&l<f))return 0;const b=this.getTerrainData(t),w=(_=b.tile)===null||_===void 0?void 0:_.dem;if(!w)return 0;const A=h.cC([],[a/f*h.a5,l/f*h.a5],b.u_terrain_matrix),I=[A[0]*w.dim,A[1]*w.dim],O=Math.floor(I[0]),j=Math.floor(I[1]),k=I[0]-O,G=I[1]-j;return w.get(O,j)*(1-k)*(1-G)+w.get(O+1,j)*k*(1-G)+w.get(O,j+1)*(1-k)*G+w.get(O+1,j+1)*k*G}getElevationForLngLatZoom(t,a){if(!h.cD(a,t.wrap()))return 0;const{tileID:l,mercatorX:f,mercatorY:_}=this._getOverscaledTileIDFromLngLatZoom(t,a);return this.getElevation(l,f%h.a5,_%h.a5,h.a5)}getElevationForLngLat(t,a){const l=fn(a,{maxzoom:this.tileManager.maxzoom,minzoom:this.tileManager.minzoom,tileSize:512,terrain:this});let f=0;for(const _ of l)_.canonical.z>f&&(f=Math.min(_.canonical.z,this.tileManager.maxzoom));return this.getElevationForLngLatZoom(t,f)}getElevation(t,a,l,f=h.a5){return this.getDEMElevation(t,a,l,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,_=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new h.T(f,_,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new h.T(f,new h.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.ar([])}const a=this.tileManager.getSourceTile(t,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const f=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new h.T(f,a.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),a.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a.toString()+a.tileID.key+t.key;if(l&&!this._demMatrixCache[l]){const f=this.tileManager.getSource().maxzoom;let _=t.canonical.z-a.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?_=t.canonical.z-f:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const b=t.canonical.x-(t.canonical.x>>_<<_),w=t.canonical.y-(t.canonical.y>>_<<_),A=h.cE(new Float64Array(16),[1/(h.a5<<_),1/(h.a5<<_),0]);h.O(A,A,[b*h.a5,w*h.a5,0]),this._demMatrixCache[t.key]={matrix:A,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(t){const a=this.painter,l=a.width/devicePixelRatio,f=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new h.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new h.T(a.context,{width:l,height:f,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,f,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let _=0,b=0;_<this._coordsTextureSize;_++)for(let w=0;w<this._coordsTextureSize;w++,b+=4)a[b+0]=255&w,a[b+1]=255&_,a[b+2]=w>>8<<4|_>>8,a[b+3]=0;const l=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),f=new h.T(t,l,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,f=l.gl,_=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),b=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(_,w-b-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const A=a[0]+(a[2]>>4<<8),I=a[1]+((15&a[2])<<8),O=this.coordsIndex[255-a[3]],j=O&&this.tileManager.getTileByID(O);if(!j)return null;const k=this._coordsTextureSize,G=(1<<j.tileID.canonical.z)*k;return new h.a9((j.tileID.canonical.x*k+A)/G+j.tileID.wrap,(j.tileID.canonical.y*k+I)/G,this.getElevation(j.tileID,A,I,k))}depthAtPoint(t){const a=new Uint8Array(4),l=this.painter.context,f=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(t){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,f=l&&t.canonical.y===0,_=l&&t.canonical.y===(1<<t.canonical.z)-1,b=`m_${f?"n":""}_${_?"s":""}`;if(this._meshCache[b])return this._meshCache[b];const w=this.painter.context,A=new h.cF,I=new h.aY,O=this.meshSize,j=h.a5/O,k=O*O;for(let oe=0;oe<=O;oe++)for(let ye=0;ye<=O;ye++)A.emplaceBack(ye*j,oe*j,0);for(let oe=0;oe<k;oe+=O+1)for(let ye=0;ye<O;ye++)I.emplaceBack(ye+oe,O+ye+oe+1,O+ye+oe+2),I.emplaceBack(ye+oe,O+ye+oe+2,ye+oe+1);const G=A.length,X=G+(O+1),ee=(O+1)*O,ie=f?h.br:0,te=f?0:1,ae=_?h.bs:h.a5,ce=_?0:1;for(let oe=0;oe<=O;oe++)A.emplaceBack(oe*j,ie,te);for(let oe=0;oe<=O;oe++)A.emplaceBack(oe*j,ae,ce);for(let oe=0;oe<O;oe++)I.emplaceBack(ee+oe,X+oe,X+oe+1),I.emplaceBack(ee+oe,X+oe+1,ee+oe+1),I.emplaceBack(0+oe,G+oe+1,G+oe),I.emplaceBack(0+oe,0+oe+1,G+oe+1);const re=A.length,ue=re+2*(O+1);for(const oe of[0,1])for(let ye=0;ye<=O;ye++)for(const Ie of[0,1])A.emplaceBack(oe*h.a5,ye*j,Ie);for(let oe=0;oe<2*O;oe+=2)I.emplaceBack(re+oe,re+oe+1,re+oe+3),I.emplaceBack(re+oe,re+oe+3,re+oe+2),I.emplaceBack(ue+oe,ue+oe+3,ue+oe+1),I.emplaceBack(ue+oe,ue+oe+2,ue+oe+3);const de=new Ri(w.createVertexBuffer(A,$t.members),w.createIndexBuffer(I),h.aX.simpleSegment(0,0,A.length,I.length));return this._meshCache[b]=de,de}getMeshFrameDelta(t){return 2*Math.PI*h.bE/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,a){var l;if(!h.cD(a,t.wrap()))return 0;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,a);return(l=this.getMinMaxElevation(f).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(t){const a=this.getTerrainData(t).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(t,a){const l=h.a9.fromLngLat(t.wrap()),f=(1<<a)*h.a5,_=l.x*f,b=l.y*f,w=Math.floor(_/h.a5),A=Math.floor(b/h.a5);return{tileID:new h.a2(a,0,a,w,A),mercatorX:_,mercatorY:b}}}class Ji{constructor(t,a,l){this._context=t,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new h.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:t,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>t.id!==a)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const Ea={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ga{constructor(t,a){this.painter=t,this.terrain=a,this.pool=new Ji(t.context,30,a.tileManager.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.tileManager.getRenderableTiles(),this._renderableLayerIds=t._order.filter((l=>!t._layers[l].isHidden(a))),this._coordsAscending={};for(const l in t.tileManagers){this._coordsAscending[l]={};const f=t.tileManagers[l].getVisibleCoordinates(),_=t.tileManagers[l].getSource(),b=_ instanceof Rr?_.terrainTileRanges:null;for(const w of f){const A=this.terrain.tileManager.getTerrainCoords(w,b);for(const I in A)this._coordsAscending[l][I]||(this._coordsAscending[l][I]=[]),this._coordsAscending[l][I].push(A[I])}}this._coordsAscendingStr={};for(const l of t._order){const f=t._layers[l],_=f.source;if(Ea[f.type]&&!this._coordsAscendingStr[_]){this._coordsAscendingStr[_]={};for(const b in this._coordsAscending[_])this._coordsAscendingStr[_][b]=this._coordsAscending[_][b].map((w=>w.key)).sort().join()}}for(const l of this._renderableTiles)for(const f in this._coordsAscendingStr){const _=this._coordsAscendingStr[f][l.tileID.key];_&&_!==l.rttCoords[f]&&(l.rtt=[])}}renderLayer(t,a){if(t.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),f=t.type,_=this.painter,b=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Ea[f]&&(this._prevType&&Ea[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!b))return!0;if(Ea[this._prevType]||Ea[f]&&b){this._prevType=f;const w=this._stacks.length-1,A=this._stacks[w]||[];for(const I of this._renderableTiles){if(this.pool.isFull()&&(nh(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(I),I.rtt[w]){const j=this.pool.getObjectForId(I.rtt[w].id);if(j.stamp===I.rtt[w].stamp){this.pool.useObject(j);continue}}const O=this.pool.getOrCreateFreeObject();this.pool.useObject(O),this.pool.stampObject(O),I.rtt[w]={id:O.id,stamp:O.stamp},_.context.bindFramebuffer.set(O.fbo.framebuffer),_.context.clear({color:h.bp.transparent,stencil:0}),_.currentStencilSource=void 0;for(let j=0;j<A.length;j++){const k=_.style._layers[A[j]],G=k.source?this._coordsAscending[k.source][I.tileID.key]:[I.tileID];_.context.viewport.set([0,0,O.fbo.width,O.fbo.height]),_._renderTileClippingMasks(k,G,!0),_.renderLayer(_,_.style.tileManagers[k.source],k,G,l),k.source&&(I.rttCoords[k.source]=this._coordsAscendingStr[k.source][I.tileID.key])}}return nh(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),Ea[f]}return!1}}const cl={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},hl=ne,Zs={hash:!1,interactive:!0,bearingSnap:7,attributionControl:sn,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.c.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,transformConstrain:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,reduceMotion:void 0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0,experimentalZoomLevelsToOverscale:void 0},of={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class $i{constructor(t,a,l=!1){this.mousedown=_=>{this.startMove(_,xe.mousePos(this.element,_)),xe.addEventListener(window,"mousemove",this.mousemove),xe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=_=>{this.move(_,xe.mousePos(this.element,_))},this.mouseup=_=>{this._rotatePitchHandler.dragEnd(_),this.offTemp()},this.touchstart=_=>{_.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=xe.touchPos(this.element,_.targetTouches)[0],this.startMove(_,this._startPos),xe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.addEventListener(window,"touchend",this.touchend))},this.touchmove=_=>{_.targetTouches.length!==1?this.reset():(this._lastPos=xe.touchPos(this.element,_.targetTouches)[0],this.move(_,this._lastPos))},this.touchend=_=>{_.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const f=new oc;this._rotatePitchHandler=new wa({clickTolerance:3,move:(_,b)=>{const w=a.getBoundingClientRect(),A=new h.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:h.cx(new h.P(_.x,b.y),b,A),pitchDelta:l?-.5*(b.y-_.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,xe.addEventListener(a,"mousedown",this.mousedown),xe.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),xe.addEventListener(a,"touchcancel",this.reset)}startMove(t,a){this._rotatePitchHandler.dragStart(t,a),xe.disableDrag()}move(t,a){const l=this.map,{bearingDelta:f,pitchDelta:_}=this._rotatePitchHandler.dragMove(t,a)||{};f&&l.setBearing(l.getBearing()+f),_&&l.setPitch(l.getPitch()+_)}off(){const t=this.element;xe.removeEventListener(t,"mousedown",this.mousedown),xe.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend),xe.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){xe.enableDrag(),xe.removeEventListener(window,"mousemove",this.mousemove),xe.removeEventListener(window,"mouseup",this.mouseup),xe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),xe.removeEventListener(window,"touchend",this.touchend)}}let qa;function lu(m,t,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return m?.wrap();const f=new h.V(m.lng,m.lat);if(m=new h.V(m.lng,m.lat),t){const _=new h.V(m.lng-360,m.lat),b=new h.V(m.lng+360,m.lat),w=a.locationToScreenPoint(m).distSqr(t);a.locationToScreenPoint(_).distSqr(t)<w?m=_:a.locationToScreenPoint(b).distSqr(t)<w&&(m=b)}for(;Math.abs(m.lng-a.center.lng)>180;){const _=a.locationToScreenPoint(m);if(_.x>=0&&_.y>=0&&_.x<=a.width&&_.y<=a.height)break;m.lng>a.center.lng?m.lng-=360:m.lng+=360}return m.lng!==f.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(m))?m:f}const uu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pc(m,t,a){const l=m.classList;for(const f in uu)l.remove(`maplibregl-${a}-anchor-${f}`);l.add(`maplibregl-${a}-anchor-${t}`)}class mc extends h.E{constructor(t){if(super(),this._onKeyPress=a=>{const l=a.code,f=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=lu(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),xe.setTransform(this._element,`${uu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${f}`),yt.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.l("dragstart"))),this.fire(new h.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=h.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=xe.create("div");const a=xe.createNS("http://www.w3.org/2000/svg","svg"),l=41,f=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${f}px`),a.setAttributeNS(null,"viewBox",`0 0 ${f} ${l}`);const _=xe.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"stroke","none"),_.setAttributeNS(null,"stroke-width","1"),_.setAttributeNS(null,"fill","none"),_.setAttributeNS(null,"fill-rule","evenodd");const b=xe.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill-rule","nonzero");const w=xe.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const A=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of A){const ae=xe.createNS("http://www.w3.org/2000/svg","ellipse");ae.setAttributeNS(null,"opacity","0.04"),ae.setAttributeNS(null,"cx","10.5"),ae.setAttributeNS(null,"cy","5.80029008"),ae.setAttributeNS(null,"rx",te.rx),ae.setAttributeNS(null,"ry",te.ry),w.appendChild(ae)}const I=xe.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);const O=xe.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(O);const j=xe.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"opacity","0.25"),j.setAttributeNS(null,"fill","#000000");const k=xe.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),j.appendChild(k);const G=xe.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const X=xe.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ee=xe.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#000000"),ee.setAttributeNS(null,"opacity","0.25"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962");const ie=xe.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),X.appendChild(ee),X.appendChild(ie),b.appendChild(w),b.appendChild(I),b.appendChild(j),b.appendChild(G),b.appendChild(X),a.appendChild(b),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(a),this._offset=h.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),pc(this._element,this._anchor,"marker"),t&&t.className)for(const a of t.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),xe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=h.V.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var a,l;const f=(a=this._map)===null||a===void 0?void 0:a.terrain,_=this._map.transform.isLocationOccluded(this._lngLat);if(!f||_){const G=_?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==G&&(this._element.style.opacity=G))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const b=this._map,w=b.terrain.depthAtPoint(this._pos),A=b.terrain.getElevationForLngLat(this._lngLat,b.transform);if(b.transform.lngLatToCameraDepth(this._lngLat,A)-w<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/b.transform.pixelsPerMeter,O=Math.sin(b.getPitch()*Math.PI/180)*I,j=b.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),k=b.transform.lngLatToCameraDepth(this._lngLat,A+O)-j>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=h.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,a){return(this._opacity===void 0||t===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const gc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ao=0,Hs=!1;const ur={maxWidth:100,unit:"metric"};function en(m,t,a){const l=a&&a.maxWidth||100,f=m._container.clientHeight/2,_=m._container.clientWidth/2,b=m.unproject([_-l/2,f]),w=m.unproject([_+l/2,f]),A=Math.round(m.project(w).x-m.project(b).x),I=Math.min(l,A,m._container.clientWidth),O=b.distanceTo(w);if(a&&a.unit==="imperial"){const j=3.2808*O;j>5280?Ts(t,I,j/5280,m._getUIString("ScaleControl.Miles")):Ts(t,I,j,m._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Ts(t,I,O/1852,m._getUIString("ScaleControl.NauticalMiles")):O>=1e3?Ts(t,I,O/1e3,m._getUIString("ScaleControl.Kilometers")):Ts(t,I,O,m._getUIString("ScaleControl.Meters"))}function Ts(m,t,a,l){const f=(function(_){const b=Math.pow(10,`${Math.floor(_)}`.length-1);let w=_/b;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:(function(A){const I=Math.pow(10,Math.ceil(-Math.log(A)/Math.LN10));return Math.round(A*I)/I})(w),b*w})(a);m.style.width=t*(f/a)+"px",m.innerHTML=`${f}&nbsp;${l}`}const fl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0,padding:void 0},dl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function cu(m){if(m){if(typeof m=="number"){const t=Math.round(Math.abs(m)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,m),"top-left":new h.P(t,t),"top-right":new h.P(-t,t),bottom:new h.P(0,-m),"bottom-left":new h.P(t,-t),"bottom-right":new h.P(-t,-t),left:new h.P(m,0),right:new h.P(-m,0)}}if(m instanceof h.P||Array.isArray(m)){const t=h.P.convert(m);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:h.P.convert(m.center||[0,0]),top:h.P.convert(m.top||[0,0]),"top-left":h.P.convert(m["top-left"]||[0,0]),"top-right":h.P.convert(m["top-right"]||[0,0]),bottom:h.P.convert(m.bottom||[0,0]),"bottom-left":h.P.convert(m["bottom-left"]||[0,0]),"bottom-right":h.P.convert(m["bottom-right"]||[0,0]),left:h.P.convert(m.left||[0,0]),right:h.P.convert(m.right||[0,0])}}return cu(new h.P(0,0))}const Za=ne;P.AJAXError=h.cI,P.Event=h.l,P.Evented=h.E,P.LngLat=h.V,P.MercatorCoordinate=h.a9,P.Point=h.P,P.addProtocol=h.cJ,P.config=h.c,P.removeProtocol=h.cK,P.AttributionControl=gn,P.BoxZoomHandler=Eo,P.CanvasSource=$,P.CooperativeGesturesHandler=ft,P.DoubleClickZoomHandler=ch,P.DragPanHandler=sf,P.DragRotateHandler=aa,P.EdgeInsets=Qr,P.FullscreenControl=class extends h.E{constructor(m={}){super(),this._onFullscreenChange=()=>{var t;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=a?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){xe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const m=this._fullscreenButton=xe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);xe.create("span","maplibregl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.title=m}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},P.GeoJSONSource=Yn,P.GeolocateControl=class extends h.E{constructor(m){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new h.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const a=new h.V(t.coords.longitude,t.coords.latitude),l=t.coords.accuracy,f=this._map.getBearing(),_=h.e({bearing:f},this.options.fitBoundsOptions),b=hn.fromLngLat(a,l);this._map.fitBounds(b,_,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const a=new h.V(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Hs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=xe.create("button","maplibregl-ctrl-geolocate",this._container),xe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=xe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new mc({element:this._dotElement}),this._circleElement=xe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new mc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.l("trackuserlocationend")),this.fire(new h.l("userlocationlostfocus")))}))}},this.options=h.e({},gc,m)}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return h._(this,arguments,void 0,(function*(t=!1){if(qa!==void 0&&!t)return qa;if(window.navigator.permissions===void 0)return qa=!!window.navigator.geolocation,qa;try{qa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{qa=!!window.navigator.geolocation}return qa}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),xe.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ao=0,Hs=!1}_isOutOfMapMaxBounds(m){const t=this._map.getMaxBounds(),a=m.coords;return t&&(a.longitude<t.getWest()||a.longitude>t.getEast()||a.latitude<t.getSouth()||a.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const m=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&m))return;const t=this._map.project(m),a=this._map.unproject([t.x+100,t.y]),l=m.distanceTo(a)/100,f=2*this._accuracy/l;this._circleElement.style.width=`${f.toFixed(2)}px`,this._circleElement.style.height=`${f.toFixed(2)}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ao--,Hs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.l("trackuserlocationstart")),this.fire(new h.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ao++,Ao>1?(m={maximumAge:6e5,timeout:0},Hs=!0):(m=this.options.positionOptions,Hs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,m)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},P.GlobeControl=class{constructor(){this._toggleProjection=()=>{var m;const t=(m=this._map.getProjection())===null||m===void 0?void 0:m.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var m;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((m=this._map.getProjection())===null||m===void 0?void 0:m.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=xe.create("button","maplibregl-ctrl-globe",this._container),xe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){xe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},P.Hash=Tn,P.ImageSource=Rr,P.KeyboardHandler=xi,P.LngLatBounds=hn,P.LogoControl=dc,P.Map=class extends Sn{constructor(m){var t,a;h.cG.mark(h.cH.create);const l=Object.assign(Object.assign(Object.assign({},Zs),m),{canvasContextAttributes:Object.assign(Object.assign({},Zs.canvasContextAttributes),m.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new kn,_=new Yo;if(l.minZoom!==void 0&&f.setMinZoom(l.minZoom),l.maxZoom!==void 0&&f.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&f.setMinPitch(l.minPitch),l.maxPitch!==void 0&&f.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&f.setRenderWorldCopies(l.renderWorldCopies),l.transformConstrain!==null&&f.setConstrainOverride(l.transformConstrain),super(f,_,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new qs,this._controls=[],this._mapId=h.af(),this._lostContextStyle={style:null,images:null},this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.painter.destroy();for(const A of Object.values(this.style._layers))if(A.type==="custom"&&console.warn(`Custom layer with id '${A.id}' cannot be restored after WebGL context loss. You will need to re-add it manually after context restoration.`),A._listeners)for(const[I]of Object.entries(A._listeners))console.warn(`Custom layer with id '${A.id}' had event listeners for event '${I}' which cannot be restored after WebGL context loss. You will need to re-add them manually after context restoration.`);this._lostContextStyle=this._getStyleAndImages(),this.style.destroy(),this.style=null,this.fire(new h.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._lostContextStyle.style&&this.setStyle(this._lostContextStyle.style,{diff:!1}),this._lostContextStyle.images&&(this.style.imageManager.images=this._lostContextStyle.images),this._lostContextStyle={style:null,images:null},this._setupPainter(),this.resize(),this._update(),this._resizeInternal(),this.fire(new h.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},cl),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this._zoomLevelsToOverscale=l.experimentalZoomLevelsToOverscale,this.transformCameraUpdate=l.transformCameraUpdate,this.transformConstrain=l.transformConstrain,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,l.reduceMotion!==void 0&&(yt.prefersReducedMotion=l.reduceMotion),this._imageQueueHandle=St.addThrottleControl((()=>this.isMoving())),this._requestManager=new pi(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const A=nf((I=>{this._trackResize&&!this._removed&&(this.resize(I),this.redraw())}),50);this._resizeObserver=new ResizeObserver((I=>{w?A(I):w=!0})),this._resizeObserver.observe(this._container)}this.handlers=new fc(this,l),this._hash=l.hash&&new Tn(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,h.e({},l.fitBoundsOptions,{duration:0}))));const b=typeof l.style=="string"||((a=(t=l.style)===null||t===void 0?void 0:t.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,b),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new gn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new dc,l.logoPosition),this.on("style.load",(()=>{if(b||this._resizeTransform(),this.transform.unmodified){const w=h.U(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}})),this.on("data",(w=>{this._update(w.dataType==="style"),this.fire(new h.l(`${w.dataType}data`,w))})),this.on("dataloading",(w=>{this.fire(new h.l(`${w.dataType}dataloading`,w))})),this.on("dataabort",(w=>{this.fire(new h.l("sourcedataabort",w))}))}_getMapId(){return this._mapId}setGlobalStateProperty(m,t){return this.style.setGlobalStateProperty(m,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(m,t){if(t===void 0&&(t=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new h.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=m.onAdd(this);this._controls.push(m);const l=this._controlPositions[t];return t.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new h.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(m);return t>-1&&this._controls.splice(t,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}coveringTiles(m){return fn(this.transform,m)}calculateCameraOptionsFromTo(m,t,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLat(a,this.transform)),super.calculateCameraOptionsFromTo(m,t,a,l)}resize(m,t=!0){if(this._lostContextStyle.style!==null)return this;this._resizeInternal(t);const a=!this._moving;return a&&(this.stop(),this.fire(new h.l("movestart",m)).fire(new h.l("move",m))),this.fire(new h.l("resize",m)),a&&this.fire(new h.l("moveend",m)),this}_resizeInternal(m=!0){const[t,a]=this._containerDimensions(),l=this._getClampedPixelRatio(t,a);if(this._resizeCanvas(t,a,l),this.painter.resize(t,a,l),this.painter.overLimit()){const f=this.painter.context.gl;this._maxCanvasSize=[f.drawingBufferWidth,f.drawingBufferHeight];const _=this._getClampedPixelRatio(t,a);this._resizeCanvas(t,a,_),this.painter.resize(t,a,_)}this._resizeTransform(m)}_resizeTransform(m=!0){var t;const[a,l]=this._containerDimensions();this.transform.resize(a,l,m),(t=this._requestedCameraState)===null||t===void 0||t.resize(a,l,m)}_getClampedPixelRatio(m,t){const{0:a,1:l}=this._maxCanvasSize,f=this.getPixelRatio(),_=m*f,b=t*f;return Math.min(_>a?a/_:1,b>l?l/b:1)*f}getPixelRatio(){var m;return(m=this._overridePixelRatio)!==null&&m!==void 0?m:devicePixelRatio}setPixelRatio(m){this._overridePixelRatio=m,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(m){return this.transform.setMaxBounds(hn.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom){const t=this._getTransformForUpdate();return t.setMinZoom(m),this._applyUpdatedTransform(t),this._update(),this}throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom){const t=this._getTransformForUpdate();return t.setMaxZoom(m),this._applyUpdatedTransform(t),this._update(),this}throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.setMinPitch(m),this._update(),this.getPitch()<m&&this.setPitch(m),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(m>=this.transform.minPitch)return this.transform.setMaxPitch(m),this._update(),this.getPitch()>m&&this.setPitch(m),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.setRenderWorldCopies(m),this._update()}setTransformConstrain(m){return this.transform.setConstrainOverride(m),this._update()}project(m){return this.transform.locationToScreenPoint(h.V.convert(m),this.style&&this.terrain)}unproject(m){return this.transform.screenPointToLocation(h.P.convert(m),this.terrain)}isMoving(){var m;return this._moving||((m=this.handlers)===null||m===void 0?void 0:m.isMoving())}isZooming(){var m;return this._zooming||((m=this.handlers)===null||m===void 0?void 0:m.isZooming())}isRotating(){var m;return this._rotating||((m=this.handlers)===null||m===void 0?void 0:m.isRotating())}_createDelegatedListener(m,t,a){if(m==="mouseenter"||m==="mouseover"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:_=>{const b=t.filter((A=>this.getLayer(A))),w=b.length!==0?this.queryRenderedFeatures(_.point,{layers:b}):[];w.length?l||(l=!0,a.call(this,new $n(m,this,_.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(m==="mouseleave"||m==="mouseout"){let l=!1;return{layers:t,listener:a,delegates:{mousemove:b=>{const w=t.filter((A=>this.getLayer(A)));(w.length!==0?this.queryRenderedFeatures(b.point,{layers:w}):[]).length?l=!0:l&&(l=!1,a.call(this,new $n(m,this,b.originalEvent)))},mouseout:b=>{l&&(l=!1,a.call(this,new $n(m,this,b.originalEvent)))}}}}{const l=f=>{const _=t.filter((w=>this.getLayer(w))),b=_.length!==0?this.queryRenderedFeatures(f.point,{layers:_}):[];b.length&&(f.features=b,a.call(this,f),delete f.features)};return{layers:t,listener:a,delegates:{[m]:l}}}}_saveDelegatedListener(m,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(t)}_removeDelegatedListener(m,t,a){if(!this._delegatedListeners||!this._delegatedListeners[m])return;const l=this._delegatedListeners[m];for(let f=0;f<l.length;f++){const _=l[f];if(_.listener===a&&_.layers.length===t.length&&_.layers.every((b=>t.includes(b)))){for(const b in _.delegates)this.off(b,_.delegates[b]);return void l.splice(f,1)}}}on(m,t,a){if(a===void 0)return super.on(m,t);const l=typeof t=="string"?[t]:t,f=this._createDelegatedListener(m,l,a);this._saveDelegatedListener(m,f);for(const _ in f.delegates)this.on(_,f.delegates[_]);return{unsubscribe:()=>{this._removeDelegatedListener(m,l,a)}}}once(m,t,a){if(a===void 0)return super.once(m,t);const l=typeof t=="string"?[t]:t,f=this._createDelegatedListener(m,l,a);for(const _ in f.delegates){const b=f.delegates[_];f.delegates[_]=(...w)=>{this._removeDelegatedListener(m,l,a),b(...w)}}this._saveDelegatedListener(m,f);for(const _ in f.delegates)this.once(_,f.delegates[_]);return this}off(m,t,a){return a===void 0?super.off(m,t):(this._removeDelegatedListener(m,typeof t=="string"?[t]:t,a),this)}queryRenderedFeatures(m,t){if(!this.style)return[];let a;const l=m instanceof h.P||Array.isArray(m),f=l?m:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(l?{}:m)||{},f instanceof h.P||typeof f[0]=="number")a=[h.P.convert(f)];else{const _=h.P.convert(f[0]),b=h.P.convert(f[1]);a=[_,new h.P(b.x,_.y),b,new h.P(_.x,b.y),_]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(m,t){return this.style.querySourceFeatures(m,t)}setStyle(m,t){return(t=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&m?(this._diffStyle(m,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(m,t))}setTransformRequest(m){return this._requestManager.setTransformRequest(m),this}_getUIString(m){const t=this._locale[m];if(t==null)throw new Error(`Missing UI string '${m}'`);return t}_updateStyle(m,t){var a,l;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(m,t)));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!m)),m?(this.style=new mo(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m,t,f):this.style.loadJSON(m,t,f),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new mo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,t){if(typeof m=="string"){const a=this._requestManager.transformRequest(m,"Style");h.j(a,new AbortController).then((l=>{this._updateDiff(l.data,t)})).catch((l=>{l&&this.fire(new h.k(l))}))}else typeof m=="object"&&this._updateDiff(m,t)}_updateDiff(m,t){try{this.style.setState(m,t)&&this._update(!0)}catch(a){h.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(m,t)}}getStyle(){if(this.style)return this.style.serialize()}_getStyleAndImages(){return this.style?{style:this.style.serialize(),images:this.style.imageManager.cloneImages()}:{style:null,images:{}}}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(m,t){return this._lazyInitEmptyStyle(),this.style.addSource(m,t),this._update(!0)}isSourceLoaded(m){const t=this.style&&this.style.tileManagers[m];if(t!==void 0)return t.loaded();this.fire(new h.k(new Error(`There is no tile manager with ID '${m}'`)))}setTerrain(m){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),m){const t=this.style.tileManagers[m.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${m.source}`);this.terrain===null&&t.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===m.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===m.source&&h.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ht(this.painter,t,m),this.painter.renderToTexture=new Ga(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.tileManager.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==m.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.tileManager.freeRtt():this.terrain.tileManager.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.tileManager.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.l("terrain",{terrain:m})),this}getTerrain(){var m,t;return(t=(m=this.terrain)===null||m===void 0?void 0:m.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const m=this.style&&this.style.tileManagers;for(const t of Object.values(m))if(!t.areTilesLoaded())return!1;return!0}removeSource(m){return this.style.removeSource(m),this._update(!0)}getSource(m){return this.style.getSource(m)}setSourceTileLodParams(m,t,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=bi(Math.max(1,m),Math.max(1,t))}else for(const l in this.style.tileManagers)this.style.tileManagers[l].getSource().calculateTileZoom=bi(Math.max(1,m),Math.max(1,t));return this._update(!0),this}refreshTiles(m,t){const a=this.style.tileManagers[m];if(!a)throw new Error(`There is no tile manager with ID "${m}", cannot refresh tile`);t===void 0?a.reload(!0):a.refreshTiles(t.map((l=>new h.ac(l.z,l.x,l.y))))}addImage(m,t,a={}){const{pixelRatio:l=1,sdf:f=!1,stretchX:_,stretchY:b,content:w,textFitWidth:A,textFitHeight:I}=a;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||h.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:O,height:j,data:k}=t,G=t;return this.style.addImage(m,{data:new h.R({width:O,height:j},new Uint8Array(k)),pixelRatio:l,stretchX:_,stretchY:b,content:w,textFitWidth:A,textFitHeight:I,sdf:f,version:0,userImage:G}),G.onAdd&&G.onAdd(this,m),this}}{const{width:O,height:j,data:k}=yt.getImageData(t);this.style.addImage(m,{data:new h.R({width:O,height:j},k),pixelRatio:l,stretchX:_,stretchY:b,content:w,textFitWidth:A,textFitHeight:I,sdf:f,version:0})}}updateImage(m,t){const a=this.style.getImage(m);if(!a)return this.fire(new h.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=t instanceof HTMLImageElement||h.b(t)?yt.getImageData(t):t,{width:f,height:_,data:b}=l;if(f===void 0||_===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==a.data.width||_!==a.data.height)return this.fire(new h.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(t instanceof HTMLImageElement||h.b(t));return a.data.replace(b,w),this.style.updateImage(m,a),this}getImage(m){return this.style.getImage(m)}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new h.k(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m){return St.getImage(this._requestManager.transformRequest(m,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(m,t){return this._lazyInitEmptyStyle(),this.style.addLayer(m,t),this._update(!0)}moveLayer(m,t){return this.style.moveLayer(m,t),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(m,t,a){return this.style.setLayerZoomRange(m,t,a),this._update(!0)}setFilter(m,t,a={}){return this.style.setFilter(m,t,a),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,t,a,l={}){return this.style.setPaintProperty(m,t,a,l),this._update(!0)}getPaintProperty(m,t){return this.style.getPaintProperty(m,t)}setLayoutProperty(m,t,a,l={}){return this.style.setLayoutProperty(m,t,a,l),this._update(!0)}getLayoutProperty(m,t){return this.style.getLayoutProperty(m,t)}setGlyphs(m,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(m,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(m,t,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(m,t,a,(l=>{l||this._update(!0)})),this}removeSprite(m){return this._lazyInitEmptyStyle(),this.style.removeSprite(m),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(m,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(m,t,(a=>{a||this._update(!0)})),this}setLight(m,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(m,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(m,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(m,t){return this.style.setFeatureState(m,t),this._update()}removeFeatureState(m,t){return this.style.removeFeatureState(m,t),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let m=0,t=0;return this._container&&(m=this._container.clientWidth||400,t=this._container.clientHeight||300),[m,t]}_setupContainer(){const m=this._container;m.classList.add("maplibregl-map");const t=this._canvasContainer=xe.create("div","maplibregl-canvas-container",m);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=xe.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const f=this._controlContainer=xe.create("div","maplibregl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((b=>{_[b]=xe.create("div",`maplibregl-ctrl-${b} `,f)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,t,a){this._canvas.width=Math.floor(a*m),this._canvas.height=Math.floor(a*t),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const m=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{t={requestedAttributes:m},l&&(t.statusMessage=l.statusMessage,t.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,m):this._canvas.getContext("webgl2",m)||this._canvas.getContext("webgl",m),!a){const l="Failed to initialize WebGL";throw t?(t.message=l,new Error(JSON.stringify(t))):new Error(l)}this.painter=new Ed(a,this.transform),Jt.testSupport(a)}migrateProjection(m,t){super.migrateProjection(m,t),this.painter.transform=m,this.fire(new h.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_render(m){var t,a,l,f,_;const b=this._idleTriggered?this._fadeDuration:0,w=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(m),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,k=rt();this.style.zoomHistory.update(j,k);const G=new h.H(j,{now:k,fadeDuration:b,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),X=G.crossFadingFactor();X===1&&X===this._crossFadingFactor||(A=!0,this._crossFadingFactor=X),this.style.update(G)}const I=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(_=this.style.projection)===null||_===void 0?void 0:_.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||I)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.tileManager.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,b,this._crossSourceCollisions,I),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,showPadding:this.showPadding}),this.fire(new h.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cG.mark(h.cH.load),this.fire(new h.l("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const O=this._sourcesDirty||this._styleDirty||this._placementDirty;return O||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.l("idle")),!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,h.cG.mark(h.cH.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var m;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),St.removeThrottleControl(this._imageQueueHandle),(m=this._resizeObserver)===null||m===void 0||m.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),xe.remove(this._canvasContainer),xe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cG.clearMetrics(),this._removed=!0,this.fire(new h.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,yt.frame(this._frameRequest,(m=>{h.cG.frame(m),this._frameRequest=null;try{this._render(m)}catch(t){if(!h.Z(t)&&!(function(a){return a.message===To})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get version(){return hl}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(m){return this._lazyInitEmptyStyle(),this.style.setProjection(m),this._update(!0)}},P.MapMouseEvent=$n,P.MapTouchEvent=Na,P.MapWheelEvent=rh,P.Marker=mc,P.NavigationControl=class{constructor(m){this._updateZoomButtons=()=>{const t=this._map.getZoom(),a=t===this._map.getMaxZoom(),l=t===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);t.title=l,t.setAttribute("aria-label",l)},this.options=h.e({},of,m),this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),xe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),xe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=xe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $i(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){xe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(m,t){const a=xe.create("button",m,this._container);return a.type="button",a.addEventListener("click",t),a}},P.Popup=class extends h.E{constructor(m){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&xe.remove(this._content),this._container&&(xe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=xe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=xe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=lu(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const f=cu(this.options.offset);if(!l){const b=this._container.offsetWidth,w=this._container.offsetHeight,A=(function(O){var j,k,G,X;return O?{top:(j=O.top)!==null&&j!==void 0?j:0,right:(k=O.right)!==null&&k!==void 0?k:0,bottom:(G=O.bottom)!==null&&G!==void 0?G:0,left:(X=O.left)!==null&&X!==void 0?X:0}:{top:0,right:0,bottom:0,left:0}})(this.options.padding);let I;I=a.y+f.bottom.y<w+A.top?["top"]:a.y>this._map.transform.height-w-A.bottom?["bottom"]:[],a.x<b/2+A.left?I.push("left"):a.x>this._map.transform.width-b/2-A.right&&I.push("right"),l=I.length===0?"bottom":I.join("-")}let _=a.add(f[l]);this.options.subpixelPositioning||(_=_.round()),xe.setTransform(this._container,`${uu[l]} translate(${_.x}px,${_.y}px)`),pc(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(fl),m)}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(m){return this._lngLat=h.V.convert(m),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const t=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=m;l=a.firstChild,l;)t.appendChild(l);return this.setDOMContent(t)}getMaxWidth(){var m;return(m=this._container)===null||m===void 0?void 0:m.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=xe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(m),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(m){return this._container&&this._container.classList.add(m),this}removeClassName(m){return this._container&&this._container.classList.remove(m),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){if(this._container)return this._container.classList.toggle(m)}setSubpixelPositioning(m){this.options.subpixelPositioning=m}setPadding(m){this.options.padding=m,this._update()}_createCloseButton(){this.options.closeButton&&(this._closeButton=xe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(dl);m&&m.focus()}},P.RasterDEMTileSource=es,P.RasterTileSource=so,P.ScaleControl=class{constructor(m){this._onMove=()=>{en(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,en(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},ur),m)}getDefaultPosition(){return"bottom-left"}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",m.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){xe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},P.ScrollZoomHandler=cc,P.Style=mo,P.TerrainControl=class{constructor(m){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=m}onAdd(m){return this._map=m,this._container=xe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=xe.create("button","maplibregl-ctrl-terrain",this._container),xe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){xe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},P.TwoFingersTouchPitchHandler=Us,P.TwoFingersTouchRotateHandler=uc,P.TwoFingersTouchZoomHandler=xs,P.TwoFingersTouchZoomRotateHandler=ul,P.VectorTileSource=Ps,P.VideoSource=Se,P.addSourceType=(m,t)=>h._(void 0,void 0,void 0,(function*(){if(W(m))throw new Error(`A source type called "${m}" already exists.`);((a,l)=>{Z[a]=l})(m,t)})),P.clearPrewarmedResources=function(){const m=ei;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(bt),ei=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},P.createTileMesh=fd,P.getMaxParallelImageRequests=function(){return h.c.MAX_PARALLEL_IMAGE_REQUESTS},P.getRTLTextPluginStatus=function(){return we().getRTLTextPluginStatus()},P.getVersion=function(){return Za},P.getWorkerCount=function(){return At.workerCount},P.getWorkerUrl=function(){return h.c.WORKER_URL},P.importScriptInWorkers=function(m){return ao().broadcast("IS",m)},P.isTimeFrozen=function(){return Et.isFrozen()},P.now=rt,P.prewarm=function(){qi().acquire(bt)},P.restoreNow=function(){Et.restoreNow()},P.setMaxParallelImageRequests=function(m){h.c.MAX_PARALLEL_IMAGE_REQUESTS=m},P.setNow=function(m){Et.setNow(m)},P.setRTLTextPlugin=function(m,t){return we().setRTLTextPlugin(m,t)},P.setWorkerCount=function(m){At.workerCount=m},P.setWorkerUrl=function(m){h.c.WORKER_URL=m}}));var H=z;return H}))})(f_)),f_.exports}var xw=bw();const Dy=Gv(xw);function ww({container:v,onMapReady:S}){const z=un.useRef(null);return un.useEffect(()=>{if(!(z.current||!v))return z.current=new Dy.Map({container:v,style:{version:8,sources:{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:"&copy; OpenStreetMap contributors"}},layers:[{id:"osm",type:"raster",source:"osm"}]},center:[71.4491,51.1694],zoom:10,scrollZoom:!1}),z.current.addControl(new Dy.NavigationControl,"top-right"),S&&S(z.current),()=>{z.current&&(z.current.remove(),z.current=null)}},[v,S]),z}function Tw({map:v,dtpData:S,selectedPointId:z,onPointSelected:M,showClusters:F,showPoints:H}){un.useEffect(()=>{!v||!S||(v.getSource("traffic-accidents")?(v.getSource("traffic-accidents").setData(S),v.setPaintProperty("traffic-accidents-layer","circle-color",["case",["==",["id"],z],"#ff0000","#008000"]),v.setPaintProperty("traffic-accidents-layer","circle-radius",["case",["==",["id"],z],8,5])):(v.addSource("traffic-accidents",{type:"geojson",data:S,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),v.addLayer({id:"clusters",type:"circle",source:"traffic-accidents",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#51bbd6",5,"#f1f075",10,"#f28cb1"],"circle-radius":["step",["get","point_count"],20,5,30,10,40]}}),v.addLayer({id:"cluster-count",type:"symbol",source:"traffic-accidents",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-size":12}}),v.addLayer({id:"traffic-accidents-layer",type:"circle",source:"traffic-accidents",filter:["!",["has","point_count"]],paint:{"circle-radius":["case",["==",["id"],z],8,5],"circle-color":["case",["==",["id"],z],"#ff0000","#008000"],"circle-stroke-width":2,"circle-stroke-color":"#ffffff"}}),v.on("click","clusters",P=>{if(v.querySourceFeatures("traffic-accidents",{filter:["has","point_count"]}).find(ge=>ge.properties?.cluster_id===(P.features?.[0].properties?.cluster_id||null))){const ge=v.getZoom();v.easeTo({center:P.lngLat,zoom:ge+2})}}),v.on("mouseenter","clusters",()=>{v.getCanvas().style.cursor="pointer"}),v.on("mouseleave","clusters",()=>{v.getCanvas().style.cursor=""}),v.on("click","traffic-accidents-layer",P=>{if(P.features&&P.features.length>0){const h=P.features[0],ne=h.properties,ge=h.id;M(ge);const Le=`
                        <div class="popup-content">
                            <h3>Accident Details</h3>
                            <p><strong>ID:</strong> ${ge||"N/A"}</p>
                            <p><strong>Time:</strong> ${ne?.fd1r05p1||"N/A"}</p>
                        </div>
                    `;new Dy.Popup().setLngLat(P.lngLat).setHTML(Le).addTo(v)}}),v.on("mouseenter","traffic-accidents-layer",()=>{v.getCanvas().style.cursor="pointer"}),v.on("mouseleave","traffic-accidents-layer",()=>{v.getCanvas().style.cursor=""})),v.getLayer("clusters")&&v.setLayoutProperty("clusters","visibility",F?"visible":"none"),v.getLayer("cluster-count")&&v.setLayoutProperty("cluster-count","visibility",F?"visible":"none"),v.getLayer("traffic-accidents-layer")&&v.setLayoutProperty("traffic-accidents-layer","visibility",H?"visible":"none"))},[S,z,v,M,F,H])}class Sw{selectedPointId=null;constructor(){F0(this)}selectPoint(S){this.selectedPointId=S}clearSelection(){this.selectedPointId=null}}class Ew{showPoints=!0;showClusters=!0;showBorders=!0;constructor(){F0(this)}togglePoints(){this.showPoints=!this.showPoints}toggleClusters(){this.showClusters=!this.showClusters}toggleBorders(){this.showBorders=!this.showBorders}setShowPoints(S){this.showPoints=S}setShowClusters(S){this.showClusters=S}setShowBorders(S){this.showBorders=S}}const Mw=new Ew,Aw=new Sw,Y0=un.createContext(null);function Cw(){const v=un.useContext(Y0);if(!v)throw new Error("useStores must be used within a StoreProvider");return v}const Dw=uw(()=>{const{uiStore:v,selectionStore:S}=Cw(),z=un.useRef(null),M=ww({container:z.current}),{data:F,isLoading:H,error:P}=yw(),{data:h,isLoading:ne,error:ge}=gw(),Le=H||ne,Xe=P||ge;return Tw({map:M.current,dtpData:F,selectedPointId:S.selectedPointId,onPointSelected:Je=>S.selectPoint(Je),showClusters:v.showClusters,showPoints:v.showPoints}),_w({map:M.current,cityBorders:h,showBorders:v.showBorders}),wr.jsxs("div",{className:"wrapper",children:[wr.jsxs("header",{className:"app-header",children:[wr.jsx("h1",{children:"Traffic Accidents in Astana"}),Le&&wr.jsx("p",{style:{margin:"8px 0",color:"#666"},children:"Loading data..."}),Xe&&wr.jsx("p",{style:{color:"red"},children:"Error loading data"}),wr.jsxs("div",{style:{display:"flex",gap:"20px",marginTop:"10px"},children:[wr.jsxs("label",{children:[wr.jsx("input",{type:"checkbox",checked:v.showPoints,onChange:Je=>v.setShowPoints(Je.target.checked)}),"Show Points"]}),wr.jsxs("label",{children:[wr.jsx("input",{type:"checkbox",checked:v.showClusters,onChange:Je=>v.setShowClusters(Je.target.checked)}),"Show Clusters"]}),wr.jsxs("label",{children:[wr.jsx("input",{type:"checkbox",checked:v.showBorders,onChange:Je=>v.setShowBorders(Je.target.checked)}),"Show Borders"]})]})]}),wr.jsx("div",{className:"map-container",ref:z})]})});function zw(){return wr.jsx(Dw,{})}function Pw({children:v}){return wr.jsx(Y0.Provider,{value:{uiStore:Mw,selectionStore:Aw},children:v})}const Iw=new Ub;yb.createRoot(document.getElementById("root")).render(wr.jsx(un.StrictMode,{children:wr.jsx(qb,{client:Iw,children:wr.jsx(Pw,{children:wr.jsx(zw,{})})})}));
